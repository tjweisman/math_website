<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.3.0"/>
    <title>geometry_tools.utils.sagewrap API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../utils.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;geometry_tools.utils</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#I">I</a>
            </li>
            <li>
                    <a class="variable" href="#pi">pi</a>
            </li>
            <li>
                    <a class="class" href="#Integer">Integer</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Integer.__init__">Integer</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.list">list</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.str">str</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.ordinal_str">ordinal_str</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.hex">hex</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.oct">oct</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.binary">binary</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.bits">bits</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.bit_length">bit_length</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.nbits">nbits</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.trailing_zero_bits">trailing_zero_bits</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.digits">digits</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.balanced_digits">balanced_digits</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.ndigits">ndigits</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.nth_root">nth_root</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.exact_log">exact_log</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.log">log</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.exp">exp</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.prime_to_m_part">prime_to_m_part</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.prime_divisors">prime_divisors</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.divisors">divisors</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.euclidean_degree">euclidean_degree</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.sign">sign</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.quo_rem">quo_rem</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.powermod">powermod</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.rational_reconstruction">rational_reconstruction</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.trial_division">trial_division</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.factor">factor</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.support">support</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.coprime_integers">coprime_integers</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.divides">divides</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.valuation">valuation</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.p_primary_part">p_primary_part</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.val_unit">val_unit</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.odd_part">odd_part</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.divide_knowing_divisible_by">divide_knowing_divisible_by</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.denominator">denominator</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.numerator">numerator</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.as_integer_ratio">as_integer_ratio</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.factorial">factorial</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.multifactorial">multifactorial</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.gamma">gamma</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.floor">floor</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.ceil">ceil</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.trunc">trunc</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.round">round</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.real">real</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.imag">imag</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_one">is_one</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_integral">is_integral</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_rational">is_rational</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_integer">is_integer</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_unit">is_unit</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_square">is_square</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.perfect_power">perfect_power</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.global_height">global_height</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_power_of">is_power_of</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_prime_power">is_prime_power</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_prime">is_prime</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_irreducible">is_irreducible</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_pseudoprime">is_pseudoprime</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_pseudoprime_power">is_pseudoprime_power</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_perfect_power">is_perfect_power</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_norm">is_norm</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.jacobi">jacobi</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.kronecker">kronecker</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.class_number">class_number</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.squarefree_part">squarefree_part</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.next_probable_prime">next_probable_prime</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.next_prime">next_prime</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.previous_prime">previous_prime</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.next_prime_power">next_prime_power</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.previous_prime_power">previous_prime_power</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.additive_order">additive_order</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.multiplicative_order">multiplicative_order</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_squarefree">is_squarefree</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_discriminant">is_discriminant</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.is_fundamental_discriminant">is_fundamental_discriminant</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.sqrtrem">sqrtrem</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.isqrt">isqrt</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.sqrt">sqrt</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.xgcd">xgcd</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.inverse_of_unit">inverse_of_unit</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.inverse_mod">inverse_mod</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.crt">crt</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.test_bit">test_bit</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.popcount">popcount</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.conjugate">conjugate</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.binomial">binomial</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.prime_factors">prime_factors</a>
                        </li>
                        <li>
                                <a class="function" href="#Integer.ord">ord</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="variable" href="#SR">SR</a>
            </li>
            <li>
                    <a class="variable" href="#matrix_class">matrix_class</a>
            </li>
            <li>
                    <a class="variable" href="#vector_class">vector_class</a>
            </li>
            <li>
                    <a class="function" href="#ndarray_mat">ndarray_mat</a>
            </li>
            <li>
                    <a class="function" href="#apply_matrix_func">apply_matrix_func</a>
            </li>
            <li>
                    <a class="function" href="#sage_matrix_func">sage_matrix_func</a>
            </li>
            <li>
                    <a class="function" href="#sage_vector_list">sage_vector_list</a>
            </li>
            <li>
                    <a class="function" href="#sage_matrix_list">sage_matrix_list</a>
            </li>
            <li>
                    <a class="function" href="#guess_base_ring">guess_base_ring</a>
            </li>
            <li>
                    <a class="function" href="#change_base_ring">change_base_ring</a>
            </li>
            <li>
                    <a class="function" href="#invert">invert</a>
            </li>
            <li>
                    <a class="function" href="#kernel">kernel</a>
            </li>
            <li>
                    <a class="function" href="#eig">eig</a>
            </li>
            <li>
                    <a class="function" href="#eigh">eigh</a>
            </li>
            <li>
                    <a class="function" href="#det">det</a>
            </li>
            <li>
                    <a class="function" href="#real">real</a>
            </li>
            <li>
                    <a class="function" href="#imag">imag</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../geometry_tools.html">geometry_tools</a><wbr>.<a href="./../utils.html">utils</a><wbr>.sagewrap    </h1>

                
                        <input id="mod-sagewrap-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-sagewrap-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">sage</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="n">matrix</span> <span class="k">as</span> <span class="n">sage_matrix</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">from</span> <span class="nn">sage.all</span> <span class="kn">import</span> <span class="n">vector</span> <span class="k">as</span> <span class="n">sage_vector</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">numerical</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">types</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="n">I</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">I</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="n">pi</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">pi</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="n">Integer</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">Integer</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="n">SR</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">SR</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="n">matrix_class</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">matrix0</span><span class="o">.</span><span class="n">Matrix</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="n">vector_class</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">element</span><span class="o">.</span><span class="n">Vector</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="k">def</span> <span class="nf">ndarray_mat</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a>            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>            <span class="n">category</span><span class="o">=</span><span class="ne">PendingDeprecationWarning</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>        <span class="p">)</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="k">def</span> <span class="nf">_vectorize</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>    <span class="k">def</span> <span class="nf">vfunc</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>        <span class="n">flat_res</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">([</span><span class="n">func</span><span class="p">(</span><span class="n">elt</span><span class="p">)</span> <span class="k">for</span> <span class="n">elt</span> <span class="ow">in</span> <span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()],</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>                               <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>        <span class="k">return</span> <span class="n">flat_res</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>    <span class="k">return</span> <span class="n">vfunc</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="k">def</span> <span class="nf">_sage_eig</span><span class="p">(</span><span class="n">mat</span><span class="p">):</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>    <span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">diagonal</span><span class="p">(),</span> <span class="n">P</span><span class="p">)</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="c1">#return not np.can_cast(dtype, int) and (</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>    <span class="c1">#    np.can_cast(dtype, np.dtype(&quot;complex&quot;)) or</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a>    <span class="c1">#    np.can_cast(dtype, float)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a>    <span class="c1">#)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="k">def</span> <span class="nf">apply_matrix_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">numpy_func</span><span class="p">,</span> <span class="n">sage_func</span><span class="p">,</span> <span class="n">expected_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a>        <span class="k">return</span> <span class="n">numpy_func</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a>    <span class="k">return</span> <span class="n">sage_matrix_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">sage_func</span><span class="p">,</span> <span class="n">expected_shape</span><span class="p">)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="k">def</span> <span class="nf">sage_matrix_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">sage_func</span><span class="p">,</span> <span class="n">expected_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>    <span class="k">if</span> <span class="n">expected_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>            <span class="n">expected_shape</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>    <span class="n">mat_flat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]))</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="n">mat_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">sage_func</span><span class="p">(</span><span class="n">sage_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>               <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">mat_flat</span><span class="p">]</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="k">return</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">mat_res</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">expected_shape</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="k">def</span> <span class="nf">sage_vector_list</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>    <span class="n">v_flat</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">sage_vector</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">v_flat</span><span class="p">]</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="k">def</span> <span class="nf">sage_matrix_list</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>    <span class="n">mat_flat</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">sage_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">mat_flat</span><span class="p">]</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="k">def</span> <span class="nf">guess_base_ring</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>    <span class="k">return</span> <span class="n">sage_vector</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="k">def</span> <span class="nf">change_base_ring</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span> <span class="n">rational_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>    <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="k">return</span> <span class="n">arr</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="n">ring_convert</span> <span class="o">=</span> <span class="n">base_ring</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>    <span class="k">if</span> <span class="n">rational_approx</span><span class="p">:</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="n">ring_convert</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">base_ring</span><span class="p">(</span><span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">QQ</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="k">return</span> <span class="n">ring_convert</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>    <span class="k">return</span> <span class="n">_vectorize</span><span class="p">(</span><span class="n">ring_convert</span><span class="p">)(</span><span class="n">arr</span><span class="p">)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>    <span class="k">return</span> <span class="n">apply_matrix_func</span><span class="p">(</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">M</span> <span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="p">)</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="k">def</span> <span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">assume_full_rank</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">matching_rank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>           <span class="n">with_dimensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>    <span class="k">if</span> <span class="n">assume_full_rank</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">matching_rank</span><span class="p">:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;matching_rank must be True if assume_full_rank is True&quot;</span><span class="p">)</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="k">return</span> <span class="n">numerical</span><span class="o">.</span><span class="n">svd_kernel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">assume_full_rank</span><span class="o">=</span><span class="n">assume_full_rank</span><span class="p">,</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>                                    <span class="n">matching_rank</span><span class="o">=</span><span class="n">matching_rank</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>                                    <span class="n">with_dimensions</span><span class="o">=</span><span class="n">with_dimensions</span><span class="p">,</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>                                    <span class="n">with_loc</span><span class="o">=</span><span class="n">with_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="n">A_arr</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>    <span class="n">orig_shape</span> <span class="o">=</span> <span class="n">A_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>    <span class="n">matrix_list</span> <span class="o">=</span> <span class="n">sage_matrix_list</span><span class="p">(</span><span class="n">A_arr</span><span class="p">)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>    <span class="c1">#for stupid sage/numpy compatibility reasons, DON&#39;T transpose</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>    <span class="c1">#these until later</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>    <span class="n">kernel_mats</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="n">M</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">()</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>        <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">matrix_list</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="p">]</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">kernel_mats</span><span class="p">)</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>        <span class="n">actual_ranks_match</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>        <span class="n">actual_ranks_match</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>    <span class="k">if</span> <span class="n">matching_rank</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">actual_ranks_match</span><span class="p">:</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                <span class="s2">&quot;Input matrices do not have matching rank. Try calling &quot;</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                <span class="s2">&quot;this function with matching_rank=False.&quot;</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    <span class="n">matrix_arr</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">kernel_mats</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="k">if</span> <span class="n">matching_rank</span><span class="p">:</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="n">matrix_arr</span> <span class="o">=</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig_shape</span> <span class="o">+</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="n">kernel_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>        <span class="n">M</span><span class="o">.</span><span class="n">dimensions</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">kernel_mats</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>    <span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig_shape</span><span class="p">)</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>    <span class="n">matrix_arr</span> <span class="o">=</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig_shape</span><span class="p">)</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="n">possible_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">kernel_dims</span><span class="p">)</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>    <span class="n">kernel_bases</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>    <span class="n">kernel_dim_loc</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>    <span class="k">for</span> <span class="n">kernel_dim</span> <span class="ow">in</span> <span class="n">possible_dims</span><span class="p">:</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="n">where_dim</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_dims</span> <span class="o">==</span> <span class="n">kernel_dim</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="n">kernel_bases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="n">ndarray_mat</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">matrix_arr</span><span class="p">[</span><span class="n">where_dim</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="p">)</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>        <span class="n">kernel_dim_loc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">where_dim</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>    <span class="c1"># flat is better than nested, still</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">with_loc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_dimensions</span><span class="p">:</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>    <span class="k">if</span> <span class="n">with_dimensions</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_loc</span><span class="p">:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">possible_dims</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">))</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">if</span> <span class="n">with_loc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_dimensions</span><span class="p">:</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_dim_loc</span><span class="p">))</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">possible_dims</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_dim_loc</span><span class="p">))</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="k">def</span> <span class="nf">eig</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>    <span class="n">mat_flat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]))</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>    <span class="n">eig_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sage_eig</span><span class="p">(</span><span class="n">sage_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">mat_flat</span><span class="p">]</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>    <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">eig_res</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">ndarray_mat</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],)),</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">eigvecs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="k">def</span> <span class="nf">eigh</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="k">return</span> <span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="k">def</span> <span class="nf">det</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>    <span class="k">return</span> <span class="n">apply_matrix_func</span><span class="p">(</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">M</span><span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">det</span><span class="p">(),</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="n">expected_shape</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>    <span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>    <span class="k">return</span> <span class="n">_vectorize</span><span class="p">(</span><span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">real</span><span class="p">)(</span><span class="n">arr</span><span class="p">)</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="k">def</span> <span class="nf">imag</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>    <span class="k">return</span> <span class="n">_vectorize</span><span class="p">(</span><span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">imag</span><span class="p">)(</span><span class="n">arr</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="I">
                    <div class="attr variable">
            <span class="name">I</span>        =
<span class="default_value">I</span>

        
    </div>
    <a class="headerlink" href="#I"></a>
    
    

                </section>
                <section id="pi">
                    <div class="attr variable">
            <span class="name">pi</span>        =
<span class="default_value">pi</span>

        
    </div>
    <a class="headerlink" href="#pi"></a>
    
    

                </section>
                <section id="Integer">
                    <div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Integer</span><wbr>(<span class="base">sage.structure.element.EuclideanDomainElement</span>):

        
    </div>
    <a class="headerlink" href="#Integer"></a>
    
            <div class="docstring"><p>Integer(x=None, base=0)
File: sage/rings/integer.pyx (starting at line 393)</p>

<pre><code>The `Integer` class represents arbitrary precision
integers. It derives from the `Element` class, so
integers can be used as ring elements anywhere in Sage.

The constructor of `Integer` interprets strings that begin with ``0o`` as octal numbers,
strings that begin with ``0x`` as hexadecimal numbers and strings
that begin with ``0b`` as binary numbers.

The class `Integer` is implemented in Cython, as a wrapper of the
GMP ``mpz_t`` integer type.

EXAMPLES::

    sage: Integer(123)
    123
    sage: Integer("123")
    123

Sage Integers support :pep:`3127` literals::

    sage: Integer('0x12')
    18
    sage: Integer('-0o12')
    -10
    sage: Integer('+0b101010')
    42

Conversion from PARI::

    sage: Integer(pari('-10380104371593008048799446356441519384'))                  # needs sage.libs.pari
    -10380104371593008048799446356441519384
    sage: Integer(pari('Pol([-3])'))                                                # needs sage.libs.pari
    -3

Conversion from gmpy2::

    sage: from gmpy2 import mpz
    sage: Integer(mpz(3))
    3

.. automethod:: __pow__
</code></pre>
</div>


                            <div id="Integer.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">Integer</span><span class="signature pdoc-code condensed">()</span>

        
    </div>
    <a class="headerlink" href="#Integer.__init__"></a>
    
            <div class="docstring"><p>File: sage/rings/integer.pyx (starting at line 443)</p>

<p>EXAMPLES::</p>

<pre><code>sage: a = int(-901824309821093821093812093810928309183091832091)
sage: b = ZZ(a); b
-901824309821093821093812093810928309183091832091
sage: ZZ(b)
-901824309821093821093812093810928309183091832091
sage: ZZ('-901824309821093821093812093810928309183091832091')
-901824309821093821093812093810928309183091832091
sage: ZZ(int(-93820984323))
-93820984323
sage: ZZ(ZZ(-901824309821093821093812093810928309183091832091))
-901824309821093821093812093810928309183091832091
sage: ZZ(QQ(-901824309821093821093812093810928309183091832091))
-901824309821093821093812093810928309183091832091
sage: ZZ(RR(2.0)^80)
1208925819614629174706176
sage: ZZ(QQbar(sqrt(28-10*sqrt(3)) + sqrt(3)))                              # needs sage.rings.number_field sage.symbolic
5
sage: ZZ(AA(32).nth_root(5))                                                # needs sage.rings.number_field
2
sage: ZZ(pari('Mod(-3,7)'))                                                 # needs sage.libs.pari
4
sage: ZZ('sage')
Traceback (most recent call last):
...
TypeError: unable to convert 'sage' to an integer
sage: Integer('zz',36).str(36)
'zz'
sage: ZZ('0x3b').str(16)
'3b'
sage: ZZ( ZZ(5).digits(3) , 3)
5
sage: import numpy                                                          # needs numpy
sage: ZZ(numpy.int64(7^7))                                                  # needs numpy
823543
sage: ZZ(numpy.ubyte(-7))                                                   # needs numpy
249
sage: ZZ(True)
1
sage: ZZ(False)
0
sage: ZZ(1==0)
0
sage: ZZ('+10')
10
sage: from gmpy2 import mpz
sage: ZZ(mpz(42))
42
</code></pre>

<p>::</p>

<pre><code>sage: k = GF(2)
sage: ZZ((k(0),k(1)), 2)
2
</code></pre>

<p>::</p>

<pre><code>sage: ZZ(float(2.0))
2
sage: ZZ(float(1.0/0.0))
Traceback (most recent call last):
...
OverflowError: cannot convert float infinity to integer
sage: ZZ(float(0.0/0.0))
Traceback (most recent call last):
...
ValueError: cannot convert float NaN to integer
</code></pre>

<p>::</p>

<pre><code>sage: class MyInt(int):
....:     pass
sage: class MyFloat(float):
....:     pass
sage: ZZ(MyInt(3))
3
sage: ZZ(MyFloat(5))
5
</code></pre>

<p>::</p>

<pre><code>sage: Integer('0')
0
sage: Integer('0X2AEEF')
175855
</code></pre>

<p>Test conversion from PARI (:trac:<code>11685</code>)::</p>

<pre><code>sage: # needs sage.libs.pari
sage: ZZ(pari(-3))
-3
sage: ZZ(pari("-3.0"))
-3
sage: ZZ(pari("-3.5"))
Traceback (most recent call last):
...
TypeError: Attempt to coerce non-integral real number to an Integer
sage: ZZ(pari("1e100"))
Traceback (most recent call last):
...
PariError: precision too low in truncr (precision loss in truncation)
sage: ZZ(pari("10^50"))
100000000000000000000000000000000000000000000000000
sage: ZZ(pari("Pol(3)"))
3
sage: ZZ(GF(3^20,'t')(1))                                                   # needs sage.rings.finite_rings
1
sage: ZZ(pari(GF(3^20,'t')(1)))                                             # needs sage.rings.finite_rings
1
sage: x = polygen(QQ)
sage: K.&lt;a&gt; = NumberField(x^2 + 3)                                          # needs sage.rings.number_field
sage: ZZ(a^2)                                                               # needs sage.rings.number_field
-3
sage: ZZ(pari(a)^2)                                                         # needs sage.rings.number_field
-3
sage: ZZ(pari("Mod(x, x^3+x+1)"))   # Note error message refers to lifted element
Traceback (most recent call last):
...
TypeError: Unable to coerce PARI x to an Integer
</code></pre>

<p>Test coercion of p-adic with negative valuation::</p>

<pre><code>sage: ZZ(pari(Qp(11)(11^-7)))                                               # needs sage.libs.pari sage.rings.padics
Traceback (most recent call last):
...
TypeError: cannot convert p-adic with negative valuation to an integer
</code></pre>

<p>Test converting a list with a very large base::</p>

<pre><code>sage: a = ZZ(randint(0, 2^128 - 1))
sage: L = a.digits(2^64)
sage: a == sum([x * 2^(64*i) for i,x in enumerate(L)])
True
sage: a == ZZ(L, base=2^64)
True
</code></pre>

<p>Test comparisons with numpy types (see :trac:<code>13386</code> and :trac:<code>18076</code>)::</p>

<pre><code>sage: import numpy                                                          # needs numpy
sage: numpy.int8('12') == 12                                                # needs numpy
True
sage: 12 == numpy.int8('12')                                                # needs numpy
True

sage: float('15') == 15
True
sage: 15 == float('15')
True
</code></pre>

<p>Test underscores as digit separators (PEP 515,
https://www.python.org/dev/peps/pep-0515/)::</p>

<pre><code>sage: Integer('1_3')
13
sage: Integer(b'1_3')
13
</code></pre>
</div>


                            </div>
                            <div id="Integer.list" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.list"></a>
    
            <div class="docstring"><p><a href="#Integer.list">Integer.list</a>(self)
File: sage/rings/integer.pyx (starting at line 959)</p>

<pre><code>    Return a list with this integer in it, to be compatible with the
    method for number fields.

    EXAMPLES::

        sage: m = 5
        sage: m.list()
        [5]
</code></pre>
</div>


                            </div>
                            <div id="Integer.str" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">str</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.str"></a>
    
            <div class="docstring"><p><a href="#Integer.str">Integer.str</a>(self, int base=10)
File: sage/rings/integer.pyx (starting at line 1063)</p>

<pre><code>    Return the string representation of ``self`` in the
    given base.

    EXAMPLES::

        sage: Integer(2^10).str(2)
        '10000000000'
        sage: Integer(2^10).str(17)
        '394'

    ::

        sage: two = Integer(2)
        sage: two.str(1)
        Traceback (most recent call last):
        ...
        ValueError: base (=1) must be between 2 and 36

    ::

        sage: two.str(37)
        Traceback (most recent call last):
        ...
        ValueError: base (=37) must be between 2 and 36

    ::

        sage: big = 10^5000000
        sage: s = big.str()       # long time (2s on sage.math, 2014)
        sage: len(s)              # long time (depends on above defn of s)
        5000001
        sage: s[:10]              # long time (depends on above defn of s)
        '1000000000'
</code></pre>
</div>


                            </div>
                            <div id="Integer.ordinal_str" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ordinal_str</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.ordinal_str"></a>
    
            <div class="docstring"><p><a href="#Integer.ordinal_str">Integer.ordinal_str</a>(self)
File: sage/rings/integer.pyx (starting at line 1125)</p>

<pre><code>    Return a string representation of the ordinal associated to ``self``.

    EXAMPLES::

        sage: [ZZ(n).ordinal_str() for n in range(25)]
        ['0th',
        '1st',
        '2nd',
        '3rd',
        '4th',
        ...
        '10th',
        '11th',
        '12th',
        '13th',
        '14th',
        ...
        '20th',
        '21st',
        '22nd',
        '23rd',
        '24th']

        sage: ZZ(1001).ordinal_str()
        '1001st'

        sage: ZZ(113).ordinal_str()
        '113th'
        sage: ZZ(112).ordinal_str()
        '112th'
        sage: ZZ(111).ordinal_str()
        '111th'
</code></pre>
</div>


                            </div>
                            <div id="Integer.hex" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.hex"></a>
    
            <div class="docstring"><p><a href="#Integer.hex">Integer.hex</a>(self)
File: sage/rings/integer.pyx (starting at line 1174)</p>

<pre><code>    Return the hexadecimal digits of ``self`` in lower case.

    .. NOTE::

       '0x' is *not* prepended to the result like is done by the
       corresponding Python function on ``int``. This is for
       efficiency sake--adding and stripping the string wastes
       time; since this function is used for conversions from
       integers to other C-library structures, it is important
       that it be fast.

    EXAMPLES::

        sage: print(Integer(15).hex())
        f
        sage: print(Integer(16).hex())
        10
        sage: print(Integer(16938402384092843092843098243).hex())
        36bb1e3929d1a8fe2802f083
</code></pre>
</div>


                            </div>
                            <div id="Integer.oct" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">oct</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.oct"></a>
    
            <div class="docstring"><p><a href="#Integer.oct">Integer.oct</a>(self)
File: sage/rings/integer.pyx (starting at line 1198)</p>

<pre><code>    Return the digits of ``self`` in base 8.

    .. NOTE::

       '0' (or '0o') is *not* prepended to the result like is done by the
       corresponding Python function on ``int``. This is for
       efficiency sake--adding and stripping the string wastes
       time; since this function is used for conversions from
       integers to other C-library structures, it is important
       that it be fast.

    EXAMPLES::

        sage: print(Integer(800).oct())
        1440
        sage: print(Integer(8).oct())
        10
        sage: print(Integer(-50).oct())
        -62
        sage: print(Integer(-899).oct())
        -1603
        sage: print(Integer(16938402384092843092843098243).oct())
        15535436162247215217705000570203

    Behavior of Sage integers vs. Python integers::

        sage: Integer(10).oct()
        '12'
        sage: oct(int(10))
        '0o12'

        sage: Integer(-23).oct()
        '-27'
        sage: oct(int(-23))
        '-0o27'
</code></pre>
</div>


                            </div>
                            <div id="Integer.binary" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">binary</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.binary"></a>
    
            <div class="docstring"><p><a href="#Integer.binary">Integer.binary</a>(self)
File: sage/rings/integer.pyx (starting at line 1238)</p>

<pre><code>    Return the binary digits of ``self`` as a string.

    EXAMPLES::

        sage: print(Integer(15).binary())
        1111
        sage: print(Integer(16).binary())
        10000
        sage: print(Integer(16938402384092843092843098243).binary())
        1101101011101100011110001110010010100111010001101010001111111000101000000000101111000010000011
</code></pre>
</div>


                            </div>
                            <div id="Integer.bits" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.bits"></a>
    
            <div class="docstring"><p><a href="#Integer.bits">Integer.bits</a>(self)
File: sage/rings/integer.pyx (starting at line 1253)</p>

<pre><code>    Return the bits in ``self`` as a list, least significant first. The
    result satisfies the identity

    ::

        x == sum(b*2^e for e, b in enumerate(x.bits()))

    Negative numbers will have negative "bits". (So, strictly
    speaking, the entries of the returned list are not really
    members of `\ZZ/2\ZZ`.)

    This method just calls `digits()` with ``base=2``.

    .. SEEALSO::

        - `bit_length()`, a faster way to compute ``len(x.bits())``
        - `binary()`, which returns a string in perhaps more familiar notation

    EXAMPLES::

        sage: 500.bits()
        [0, 0, 1, 0, 1, 1, 1, 1, 1]
        sage: 11.bits()
        [1, 1, 0, 1]
        sage: (-99).bits()
        [-1, -1, 0, 0, 0, -1, -1]
</code></pre>
</div>


                            </div>
                            <div id="Integer.bit_length" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bit_length</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.bit_length"></a>
    
            <div class="docstring"><p><a href="#Integer.bit_length">Integer.bit_length</a>(self)
File: sage/rings/integer.pyx (starting at line 1284)</p>

<pre><code>    Return the number of bits required to represent this integer.

    Identical to `int.bit_length()`.

    EXAMPLES::

        sage: 500.bit_length()
        9
        sage: 5.bit_length()
        3
        sage: 0.bit_length() == len(0.bits()) == 0.ndigits(base=2)
        True
        sage: 12345.bit_length() == len(12345.binary())
        True
        sage: 1023.bit_length()
        10
        sage: 1024.bit_length()
        11

    TESTS::

        sage: {ZZ(n).bit_length() == int(n).bit_length() for n in range(-9999, 9999)}
        {True}
        sage: n = randrange(-2^99, 2^99)
        sage: ZZ(n).bit_length() == int(n).bit_length()
        True
        sage: n = randrange(-2^999, 2^999)
        sage: ZZ(n).bit_length() == int(n).bit_length()
        True
        sage: n = randrange(-2^9999, 2^9999)
        sage: ZZ(n).bit_length() == int(n).bit_length()
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.nbits" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nbits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.nbits"></a>
    
            <div class="docstring"><p><a href="#Integer.nbits">Integer.nbits</a>(self)
File: sage/rings/integer.pyx (starting at line 1325)</p>

<pre><code>    Alias for `bit_length()`.

    TESTS::

        sage: {ZZ(n).nbits() == ZZ(n).bit_length() for n in range(-9999, 9999)}
        {True}
</code></pre>
</div>


                            </div>
                            <div id="Integer.trailing_zero_bits" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trailing_zero_bits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.trailing_zero_bits"></a>
    
            <div class="docstring"><p><a href="#Integer.trailing_zero_bits">Integer.trailing_zero_bits</a>(self)
File: sage/rings/integer.pyx (starting at line 1336)</p>

<pre><code>    Return the number of trailing zero bits in ``self``, i.e.
    the exponent of the largest power of 2 dividing self.

    EXAMPLES::

        sage: 11.trailing_zero_bits()
        0
        sage: (-11).trailing_zero_bits()
        0
        sage: (11&lt;&lt;5).trailing_zero_bits()
        5
        sage: (-11&lt;&lt;5).trailing_zero_bits()
        5
        sage: 0.trailing_zero_bits()
        0
</code></pre>
</div>


                            </div>
                            <div id="Integer.digits" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">digits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.digits"></a>
    
            <div class="docstring"><p><a href="#Integer.digits">Integer.digits</a>(self, base=10, digits=None, padto=0)
File: sage/rings/integer.pyx (starting at line 1359)</p>

<pre><code>    Return a list of digits for ``self`` in the given base in little
    endian order.

    The returned value is unspecified if ``self`` is a negative number
    and the digits are given.

    INPUT:

    -  ``base`` - integer (default: 10)

    -  ``digits`` - optional indexable object as source for
       the digits

    -  ``padto`` - the minimal length of the returned list,
       sufficient number of zeros are added to make the list minimum that
       length (default: 0)

    As a shorthand for ``digits(2)``, you can use `.bits()`.

    Also see `ndigits()`.

    EXAMPLES::

        sage: 17.digits()
        [7, 1]
        sage: 5.digits(base=2, digits=["zero","one"])
        ['one', 'zero', 'one']
        sage: 5.digits(3)
        [2, 1]
        sage: 0.digits(base=10)  # 0 has 0 digits
        []
        sage: 0.digits(base=2)  # 0 has 0 digits
        []
        sage: 10.digits(16,'0123456789abcdef')
        ['a']
        sage: 0.digits(16,'0123456789abcdef')
        []
        sage: 0.digits(16,'0123456789abcdef',padto=1)
        ['0']
        sage: 123.digits(base=10,padto=5)
        [3, 2, 1, 0, 0]
        sage: 123.digits(base=2,padto=3)       # padto is the minimal length
        [1, 1, 0, 1, 1, 1, 1]
        sage: 123.digits(base=2,padto=10,digits=(1,-1))
        [-1, -1, 1, -1, -1, -1, -1, 1, 1, 1]
        sage: a=9939082340; a.digits(10)
        [0, 4, 3, 2, 8, 0, 9, 3, 9, 9]
        sage: a.digits(512)
        [100, 302, 26, 74]
        sage: (-12).digits(10)
        [-2, -1]
        sage: (-12).digits(2)
        [0, 0, -1, -1]

    We support large bases.

    ::

        sage: n=2^6000
        sage: n.digits(2^3000)
        [0, 0, 1]

    ::

        sage: base=3; n=25
        sage: l=n.digits(base)
        sage: # the next relationship should hold for all n,base
        sage: sum(base^i*l[i] for i in range(len(l)))==n
        True
        sage: base=3; n=-30; l=n.digits(base); sum(base^i*l[i] for i in range(len(l)))==n
        True

    The inverse of this method -- constructing an integer from a
    list of digits and a base -- can be done using the above method
    or by simply using `ZZ()
    &lt;sage.rings.integer_ring.IntegerRing_class&gt;` with a base::

        sage: x = 123; ZZ(x.digits(), 10)
        123
        sage: x == ZZ(x.digits(6), 6)
        True
        sage: x == ZZ(x.digits(25), 25)
        True

    Using `sum()` and `enumerate()` to do the same thing is
    slightly faster in many cases (and
    `~sage.misc.misc_c.balanced_sum()` may be faster yet). Of
    course it gives the same result::

        sage: base = 4
        sage: sum(digit * base^i for i, digit in enumerate(x.digits(base))) == ZZ(x.digits(base), base)
        True

    Note: In some cases it is faster to give a digits collection. This
    would be particularly true for computing the digits of a series of
    small numbers. In these cases, the code is careful to allocate as
    few python objects as reasonably possible.

    ::

        sage: digits = list(range(15))
        sage: l = [ZZ(i).digits(15,digits) for i in range(100)]
        sage: l[16]
        [1, 1]

    This function is comparable to `str()` for speed.

    ::

        sage: n=3^100000
        sage: n.digits(base=10)[-1]  # slightly slower than str
        1
        sage: n=10^10000
        sage: n.digits(base=10)[-1]  # slightly faster than str
        1

    AUTHORS:

    - Joel B. Mohler (2008-03-02):  significantly rewrote this entire function
</code></pre>
</div>


                            </div>
                            <div id="Integer.balanced_digits" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">balanced_digits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.balanced_digits"></a>
    
            <div class="docstring"><p><a href="#Integer.balanced_digits">Integer.balanced_digits</a>(self, base=10, positive_shift=True)
File: sage/rings/integer.pyx (starting at line 1585)</p>

<pre><code>    Return the list of balanced digits for ``self`` in the given base.

    The balanced base ``b`` uses ``b`` digits centered around zero. Thus
    if ``b`` is odd, there is only one possibility, namely digits
    between ``-b//2`` and ``b//2`` (both included). For instance in base 9,
    one uses digits from -4 to 4. If ``b`` is even, one has to choose
    between digits from ``-b//2`` to ``b//2 - 1`` or ``-b//2 + 1`` to ``b//2``
    (base 10 for instance: either `-5` to `4` or `-4` to `5`), and this is
    defined by the value of ``positive_shift``.

    INPUT:

    - ``base`` -- integer (default: 10); when ``base`` is 2, only the
      nonnegative or the nonpositive integers can be represented by
      ``balanced_digits``. Thus we say base must be greater than 2.

    - ``positive_shift`` -- boolean (default: ``True``); for even bases, the
      representation uses digits from ``-b//2 + 1`` to ``b//2`` if set to
      ``True``, and from ``-b//2`` to ``b//2 - 1`` otherwise. This has no
      effect for odd bases.

    EXAMPLES::

        sage: 8.balanced_digits(3)
        [-1, 0, 1]
        sage: (-15).balanced_digits(5)
        [0, 2, -1]
        sage: 17.balanced_digits(6)
        [-1, 3]
        sage: 17.balanced_digits(6, positive_shift=False)
        [-1, -3, 1]
        sage: (-46).balanced_digits()
        [4, 5, -1]
        sage: (-46).balanced_digits(positive_shift=False)
        [4, -5]
        sage: (-23).balanced_digits(12)
        [1, -2]
        sage: (-23).balanced_digits(12, positive_shift=False)
        [1, -2]
        sage: 0.balanced_digits(7)
        []
        sage: 14.balanced_digits(5.8)
        Traceback (most recent call last):
        ...
        ValueError: base must be an integer
        sage: 14.balanced_digits(2)
        Traceback (most recent call last):
        ...
        ValueError: base must be &gt; 2

    TESTS::

        sage: base = 5; n = 39
        sage: l = n.balanced_digits(base)
        sage: sum(l[i]*base^i for i in range(len(l))) == n
        True
        sage: base = 12; n = -52
        sage: l = n.balanced_digits(base)
        sage: sum(l[i]*base^i for i in range(len(l))) == n
        True
        sage: base = 8; n = 37
        sage: l = n.balanced_digits(base)
        sage: sum(l[i]*base^i for i in range(len(l))) == n
        True
        sage: base = 8; n = 37
        sage: l = n.balanced_digits(base, positive_shift=False)
        sage: sum(l[i]*base^i for i in range(len(l))) == n
        True

    .. SEEALSO::

        `digits &lt;digits&gt;()`
</code></pre>
</div>


                            </div>
                            <div id="Integer.ndigits" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ndigits</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.ndigits"></a>
    
            <div class="docstring"><p><a href="#Integer.ndigits">Integer.ndigits</a>(self, base=10)
File: sage/rings/integer.pyx (starting at line 1693)</p>

<pre><code>    Return the number of digits of ``self`` expressed in the given base.

    INPUT:

    -  ``base`` - integer (default: 10)

    EXAMPLES::

        sage: n = 52
        sage: n.ndigits()
        2
        sage: n = -10003
        sage: n.ndigits()
        5
        sage: n = 15
        sage: n.ndigits(2)
        4
        sage: n = 1000**1000000+1
        sage: n.ndigits()
        3000001
        sage: n = 1000**1000000-1
        sage: n.ndigits()
        3000000
        sage: n = 10**10000000-10**9999990
        sage: n.ndigits()
        10000000
</code></pre>
</div>


                            </div>
                            <div id="Integer.nth_root" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">nth_root</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.nth_root"></a>
    
            <div class="docstring"><p><a href="#Integer.nth_root">Integer.nth_root</a>(self, int n, bool truncate_mode=0)
File: sage/rings/integer.pyx (starting at line 2315)</p>

<pre><code>    Return the (possibly truncated) ``n``-th root of ``self``.

    INPUT:

    -  ``n`` - integer `\geq 1` (must fit in the C ``int`` type).

    -  ``truncate_mode`` - boolean, whether to allow truncation if
       ``self`` is not an ``n``-th power.

    OUTPUT:

    If ``truncate_mode`` is 0 (default), then returns the exact n'th root
    if ``self`` is an n'th power, or raises a `ValueError`
    if it is not.

    If ``truncate_mode`` is 1, then if either ``n`` is odd or ``self`` is
    positive, returns a pair ``(root, exact_flag)`` where ``root`` is the
    truncated ``n``-th root (rounded towards zero) and ``exact_flag`` is a
    boolean indicating whether the root extraction was exact;
    otherwise raises a `ValueError`.

    AUTHORS:

    - David Harvey (2006-09-15)
    - Interface changed by John Cremona (2009-04-04)

    EXAMPLES::

        sage: Integer(125).nth_root(3)
        5
        sage: Integer(124).nth_root(3)
        Traceback (most recent call last):
        ...
        ValueError: 124 is not a 3rd power
        sage: Integer(124).nth_root(3, truncate_mode=1)
        (4, False)
        sage: Integer(125).nth_root(3, truncate_mode=1)
        (5, True)
        sage: Integer(126).nth_root(3, truncate_mode=1)
        (5, False)

    ::

        sage: Integer(-125).nth_root(3)
        -5
        sage: Integer(-125).nth_root(3,truncate_mode=1)
        (-5, True)
        sage: Integer(-124).nth_root(3,truncate_mode=1)
        (-4, False)
        sage: Integer(-126).nth_root(3,truncate_mode=1)
        (-5, False)

    ::

        sage: Integer(125).nth_root(2, True)
        (11, False)
        sage: Integer(125).nth_root(3, True)
        (5, True)

    ::

        sage: Integer(125).nth_root(-5)
        Traceback (most recent call last):
        ...
        ValueError: n (=-5) must be positive

    ::

        sage: Integer(-25).nth_root(2)
        Traceback (most recent call last):
        ...
        ValueError: cannot take even root of negative number

    ::

        sage: a=9
        sage: a.nth_root(3)
        Traceback (most recent call last):
        ...
        ValueError: 9 is not a 3rd power

        sage: a.nth_root(22)
        Traceback (most recent call last):
        ...
        ValueError: 9 is not a 22nd power

        sage: ZZ(2^20).nth_root(21)
        Traceback (most recent call last):
        ...
        ValueError: 1048576 is not a 21st power

        sage: ZZ(2^20).nth_root(21, truncate_mode=1)
        (1, False)
</code></pre>
</div>


                            </div>
                            <div id="Integer.exact_log" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exact_log</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.exact_log"></a>
    
            <div class="docstring"><p><a href="#Integer.exact_log">Integer.exact_log</a>(self, m)
File: sage/rings/integer.pyx (starting at line 2603)</p>

<pre><code>    Return the largest integer `k` such that `m^k \leq \text{self}`,
    i.e., the floor of `\log_m(\text{self})`.

    This is guaranteed to return the correct answer even when the usual
    log function doesn't have sufficient precision.

    INPUT:

    -  ``m`` - integer `\geq 2`

    AUTHORS:

    - David Harvey (2006-09-15)
    - Joel B. Mohler (2009-04-08) -- rewrote this to handle small cases
      and/or easy cases up to 100x faster..

    EXAMPLES::

        sage: Integer(125).exact_log(5)
        3
        sage: Integer(124).exact_log(5)
        2
        sage: Integer(126).exact_log(5)
        3
        sage: Integer(3).exact_log(5)
        0
        sage: Integer(1).exact_log(5)
        0
        sage: Integer(178^1700).exact_log(178)
        1700
        sage: Integer(178^1700-1).exact_log(178)
        1699
        sage: Integer(178^1700+1).exact_log(178)
        1700
        sage: # we need to exercise the large base code path too
        sage: Integer(1780^1700-1).exact_log(1780)
        1699

        sage: # The following are very very fast.
        sage: # Note that for base m a perfect power of 2, we get the exact log by counting bits.
        sage: n = 2983579823750185701375109835; m = 32
        sage: n.exact_log(m)
        18
        sage: # The next is a favorite of mine.  The log2 approximate is exact and immediately provable.
        sage: n = 90153710570912709517902579010793251709257901270941709247901209742124
        sage: m = 213509721309572
        sage: n.exact_log(m)
        4

    ::

        sage: # needs sage.rings.real_mpfr
        sage: x = 3^100000
        sage: RR(log(RR(x), 3))
        100000.000000000
        sage: RR(log(RR(x + 100000), 3))
        100000.000000000

    ::

        sage: # needs sage.rings.real_mpfr
        sage: x.exact_log(3)
        100000
        sage: (x + 1).exact_log(3)
        100000
        sage: (x - 1).exact_log(3)
        99999

    ::

        sage: # needs sage.rings.real_mpfr
        sage: x.exact_log(2.5)
        Traceback (most recent call last):
        ...
        TypeError: Attempt to coerce non-integral RealNumber to Integer
</code></pre>
</div>


                            </div>
                            <div id="Integer.log" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">log</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.log"></a>
    
            <div class="docstring"><p><a href="#Integer.log">Integer.log</a>(self, m=None, prec=None)
File: sage/rings/integer.pyx (starting at line 2754)</p>

<pre><code>    Return symbolic log by default, unless the logarithm is exact (for
    an integer argument). When ``prec`` is given, the `RealField`
    approximation to that bit precision is used.

    This function is provided primarily so that Sage integers may be
    treated in the same manner as real numbers when convenient. Direct
    use of `exact_log()` is probably best for arithmetic log computation.

    INPUT:

    -  ``m`` - default: natural log base e

    -  ``prec`` - integer (default: ``None``): if ``None``, returns
       symbolic, else to given bits of precision as in `RealField`

    EXAMPLES::

        sage: Integer(124).log(5)                                                   # needs sage.symbolic
        log(124)/log(5)
        sage: Integer(124).log(5, 100)                                              # needs sage.rings.real_mpfr
        2.9950093311241087454822446806
        sage: Integer(125).log(5)
        3
        sage: Integer(125).log(5, prec=53)                                          # needs sage.rings.real_mpfr
        3.00000000000000
        sage: log(Integer(125))                                                     # needs sage.symbolic
        3*log(5)

    For extremely large numbers, this works::

        sage: x = 3^100000
        sage: log(x, 3)
        100000

    Also ``log(x)``, giving a symbolic output,
    works in a reasonable amount of time for this ``x``::

        sage: x = 3^100000
        sage: log(x)                                                                # needs sage.symbolic
        log(1334971414230...5522000001)

    But approximations are probably more useful in this
    case, and work to as high a precision as we desire::

        sage: x.log(3, 53)  # default precision for RealField                       # needs sage.rings.real_mpfr
        100000.000000000
        sage: (x + 1).log(3, 53)                                                    # needs sage.rings.real_mpfr
        100000.000000000
        sage: (x + 1).log(3, 1000)                                                  # needs sage.rings.real_mpfr
        100000.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

    We can use non-integer bases, with default e::

        sage: x.log(2.5, prec=53)                                                   # needs sage.rings.real_mpfr
        119897.784671579

    We also get logarithms of negative integers, via the
    symbolic ring, using the branch from `-\pi` to `\pi`::

        sage: log(-1)                                                               # needs sage.symbolic
        I*pi

    The logarithm of zero is done likewise::

        sage: log(0)                                                                # needs sage.symbolic
        -Infinity

    Some rational bases yield integer logarithms (:trac:`21517`)::

        sage: ZZ(8).log(1/2)
        -3

    Check that Python ints are accepted (:trac:`21518`)::

        sage: ZZ(8).log(int(2))
        3

    TESTS::

        sage: (-2).log(3)                                                           # needs sage.symbolic
        (I*pi + log(2))/log(3)
</code></pre>
</div>


                            </div>
                            <div id="Integer.exp" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exp</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.exp"></a>
    
            <div class="docstring"><p><a href="#Integer.exp">Integer.exp</a>(self, prec=None)
File: sage/rings/integer.pyx (starting at line 2876)</p>

<pre><code>    Return the exponential function of ``self`` as a real number.

    This function is provided only so that Sage integers may be treated
    in the same manner as real numbers when convenient.

    INPUT:


    -  ``prec`` - integer (default: None): if None, returns
       symbolic, else to given bits of precision as in `RealField`


    EXAMPLES::

        sage: Integer(8).exp()                                                      # needs sage.symbolic
        e^8
        sage: Integer(8).exp(prec=100)                                              # needs sage.symbolic
        2980.9579870417282747435920995
        sage: exp(Integer(8))                                                       # needs sage.symbolic
        e^8

    For even fairly large numbers, this may not be useful.

    ::

        sage: y = Integer(145^145)
        sage: y.exp()                                                               # needs sage.symbolic
        e^25024207011349079210459585279553675697932183658421565260323592409432707306554163224876110094014450895759296242775250476115682350821522931225499163750010280453185147546962559031653355159703678703793369785727108337766011928747055351280379806937944746847277089168867282654496776717056860661614337004721164703369140625
        sage: y.exp(prec=53)  # default RealField precision                         # needs sage.symbolic
        +infinity
</code></pre>
</div>


                            </div>
                            <div id="Integer.prime_to_m_part" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prime_to_m_part</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.prime_to_m_part"></a>
    
            <div class="docstring"><p><a href="#Integer.prime_to_m_part">Integer.prime_to_m_part</a>(self, m)
File: sage/rings/integer.pyx (starting at line 2915)</p>

<pre><code>    Return the prime-to-`m` part of ``self``, i.e., the largest divisor of
    ``self`` that is coprime to `m`.

    INPUT:

    -  ``m`` - Integer

    OUTPUT: Integer

    EXAMPLES::

        sage: 43434.prime_to_m_part(20)
        21717
        sage: 2048.prime_to_m_part(2)
        1
        sage: 2048.prime_to_m_part(3)
        2048

        sage: 0.prime_to_m_part(2)
        Traceback (most recent call last):
        ...
        ArithmeticError: self must be nonzero
</code></pre>
</div>


                            </div>
                            <div id="Integer.prime_divisors" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prime_divisors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.prime_divisors"></a>
    
            <div class="docstring"><p><a href="#Integer.prime_divisors">Integer.prime_divisors</a>(self, <em>args, *</em>kwds)
File: sage/rings/integer.pyx (starting at line 2957)</p>

<pre><code>    Return the prime divisors of this integer, sorted in increasing order.

    If this integer is negative, we do *not* include `-1` among
    its prime divisors, since `-1` is not a prime number.

    INPUT:

    - ``limit`` -- (integer, optional keyword argument)
      Return only prime divisors up to this bound, and the factorization
      is done by checking primes up to ``limit`` using trial division.

    Any additional arguments are passed on to the `factor()` method.

    EXAMPLES::

        sage: a = 1; a.prime_divisors()
        []
        sage: a = 100; a.prime_divisors()
        [2, 5]
        sage: a = -100; a.prime_divisors()
        [2, 5]
        sage: a = 2004; a.prime_divisors()
        [2, 3, 167]

    Setting the optional ``limit`` argument works as expected::

        sage: a = 10^100 + 1
        sage: a.prime_divisors()                                                    # needs sage.libs.pari
        [73, 137, 401, 1201, 1601, 1676321, 5964848081,
         129694419029057750551385771184564274499075700947656757821537291527196801]
        sage: a.prime_divisors(limit=10^3)
        [73, 137, 401]
        sage: a.prime_divisors(limit=10^7)
        [73, 137, 401, 1201, 1601, 1676321]
</code></pre>
</div>


                            </div>
                            <div id="Integer.divisors" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">divisors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.divisors"></a>
    
            <div class="docstring"><p><a href="#Integer.divisors">Integer.divisors</a>(self, method=None)
File: sage/rings/integer.pyx (starting at line 3002)</p>

<pre><code>    Return the list of all positive integer divisors of this integer,
    sorted in increasing order.

    EXAMPLES:

    ::

        sage: (-3).divisors()
        [1, 3]
        sage: 6.divisors()
        [1, 2, 3, 6]
        sage: 28.divisors()
        [1, 2, 4, 7, 14, 28]
        sage: (2^5).divisors()
        [1, 2, 4, 8, 16, 32]
        sage: 100.divisors()
        [1, 2, 4, 5, 10, 20, 25, 50, 100]
        sage: 1.divisors()
        [1]
        sage: 0.divisors()
        Traceback (most recent call last):
        ...
        ValueError: n must be nonzero
        sage: (2^3 * 3^2 * 17).divisors()
        [1, 2, 3, 4, 6, 8, 9, 12, 17, 18, 24, 34, 36, 51, 68, 72,
        102, 136, 153, 204, 306, 408, 612, 1224]
        sage: a = odd_part(factorial(31))
        sage: v = a.divisors()                                                      # needs sage.libs.pari
        sage: len(v)                                                                # needs sage.libs.pari
        172800
        sage: prod(e + 1 for p, e in factor(a))                                     # needs sage.libs.pari
        172800
        sage: all(t.divides(a) for t in v)                                          # needs sage.libs.pari
        True

    ::

        sage: n = 2^551 - 1
        sage: L = n.divisors()                                                      # needs sage.libs.pari
        sage: len(L)                                                                # needs sage.libs.pari
        256
        sage: L[-1] == n                                                            # needs sage.libs.pari
        True

    TESTS:

    Overflow::

        sage: prod(primes_first_n(64)).divisors()                                   # needs sage.libs.pari
        Traceback (most recent call last):
        ...
        OverflowError: value too large
        sage: prod(primes_first_n(58)).divisors()                                   # needs sage.libs.pari
        Traceback (most recent call last):
        ...
        OverflowError: value too large                                 # 32-bit
        MemoryError: failed to allocate 288230376151711744 * 24 bytes  # 64-bit

    Check for memory leaks and ability to interrupt
    (the ``divisors`` call below allocates about 800 MB every time,
    so a memory leak will not go unnoticed)::

        sage: n = prod(primes_first_n(25))                                          # needs sage.libs.pari
        sage: for i in range(20):           # long time                             # needs sage.libs.pari
        ....:     try:
        ....:         alarm(RDF.random_element(1e-3, 0.5))
        ....:         _ = n.divisors()
        ....:         cancel_alarm()  # we never get here
        ....:     except AlarmInterrupt:
        ....:         pass

    Test a strange method::

        sage: 100.divisors(method='hey')
        Traceback (most recent call last):
        ...
        ValueError: method must be 'pari' or 'sage'


    .. NOTE::

       If one first computes all the divisors and then sorts it,
       the sorting step can easily dominate the runtime. Note,
       however, that (non-negative) multiplication on the left
       preserves relative order. One can leverage this fact to
       keep the list in order as one computes it using a process
       similar to that of the merge sort algorithm.
</code></pre>
</div>


                            </div>
                            <div id="Integer.euclidean_degree" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">euclidean_degree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.euclidean_degree"></a>
    
            <div class="docstring"><p><a href="#Integer.euclidean_degree">Integer.euclidean_degree</a>(self)
File: sage/rings/integer.pyx (starting at line 3275)</p>

<pre><code>    Return the degree of this element as an element of an Euclidean domain.

    If this is an element in the ring of integers, this is simply its
    absolute value.

    EXAMPLES::

        sage: ZZ(1).euclidean_degree()
        1
</code></pre>
</div>


                            </div>
                            <div id="Integer.sign" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sign</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.sign"></a>
    
            <div class="docstring"><p><a href="#Integer.sign">Integer.sign</a>(self)
File: sage/rings/integer.pyx (starting at line 3293)</p>

<pre><code>    Return the sign of this integer, which is `-1`, `0`, or `1`
    depending on whether this number is negative, zero, or positive
    respectively.

    OUTPUT: Integer

    EXAMPLES::

        sage: 500.sign()
        1
        sage: 0.sign()
        0
        sage: (-10^43).sign()
        -1
</code></pre>
</div>


                            </div>
                            <div id="Integer.quo_rem" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">quo_rem</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.quo_rem"></a>
    
            <div class="docstring"><p><a href="#Integer.quo_rem">Integer.quo_rem</a>(self, other)
File: sage/rings/integer.pyx (starting at line 3398)</p>

<pre><code>    Return the quotient and the remainder of ``self`` divided by other.
    Note that the remainder returned is always either zero or of the
    same sign as other.

    INPUT:

    -  ``other`` - the divisor

    OUTPUT:

    -  ``q`` - the quotient of self/other

    -  ``r`` - the remainder of self/other

    EXAMPLES::

        sage: z = Integer(231)
        sage: z.quo_rem(2)
        (115, 1)
        sage: z.quo_rem(-2)
        (-116, -1)
        sage: z.quo_rem(0)
        Traceback (most recent call last):
        ...
        ZeroDivisionError: Integer division by zero

        sage: a = ZZ.random_element(10**50)
        sage: b = ZZ.random_element(10**15)
        sage: q, r = a.quo_rem(b)
        sage: q*b + r == a
        True

        sage: 3.quo_rem(ZZ['x'].0)
        (0, 3)

    TESTS:

    The divisor can be rational as well, although the remainder
    will always be zero (:trac:`7965`)::

        sage: 5.quo_rem(QQ(2))
        (5/2, 0)
        sage: 5.quo_rem(2/3)
        (15/2, 0)

    Check that :trac:`29009` is fixed:

        sage: divmod(1, sys.maxsize+1r)  # should not raise OverflowError: Python int too large to convert to C long
        (0, 1)

        sage: import mpmath                                                         # needs mpmath
        sage: mpmath.mp.prec = 1000                                                 # needs mpmath
        sage: root = mpmath.findroot(lambda x: x^2 - 3, 2)                          # needs mpmath
        sage: len(str(root))                                                        # needs mpmath
        301
</code></pre>
</div>


                            </div>
                            <div id="Integer.powermod" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">powermod</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.powermod"></a>
    
            <div class="docstring"><p><a href="#Integer.powermod">Integer.powermod</a>(self, exp, mod)
File: sage/rings/integer.pyx (starting at line 3489)</p>

<pre><code>    Compute ``self**exp`` modulo ``mod``.

    EXAMPLES::

        sage: z = 2
        sage: z.powermod(31,31)
        2
        sage: z.powermod(0,31)
        1
        sage: z.powermod(-31,31) == 2^-31 % 31
        True

    As expected, the following is invalid::

        sage: z.powermod(31,0)
        Traceback (most recent call last):
        ...
        ZeroDivisionError: cannot raise to a power modulo 0
</code></pre>
</div>


                            </div>
                            <div id="Integer.rational_reconstruction" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">rational_reconstruction</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.rational_reconstruction"></a>
    
            <div class="docstring"><p><a href="#Integer.rational_reconstruction">Integer.rational_reconstruction</a>(self, Integer m)
File: sage/rings/integer.pyx (starting at line 3523)</p>

<pre><code>    Return the rational reconstruction of this integer modulo `m`, i.e.,
    the unique (if it exists) rational number that reduces to ``self``
    modulo m and whose numerator and denominator is bounded by
    `\sqrt{m/2}`.

    INPUT:

    - ``self`` -- Integer

    - ``m`` -- Integer

    OUTPUT:

    - a `Rational`

    EXAMPLES::

        sage: (3/7)%100
        29
        sage: (29).rational_reconstruction(100)
        3/7

    TESTS:

    Check that :trac:`9345` is fixed::

        sage: 0.rational_reconstruction(0)
        Traceback (most recent call last):
        ...
        ZeroDivisionError: rational reconstruction with zero modulus
        sage: ZZ.random_element(-10^6, 10^6).rational_reconstruction(0)
        Traceback (most recent call last):
        ...
        ZeroDivisionError: rational reconstruction with zero modulus
</code></pre>
</div>


                            </div>
                            <div id="Integer.trial_division" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trial_division</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.trial_division"></a>
    
            <div class="docstring"><p><a href="#Integer.trial_division">Integer.trial_division</a>(self, long bound=LONG_MAX, long start=2)
File: sage/rings/integer.pyx (starting at line 3692)</p>

<pre><code>    Return smallest prime divisor of ``self`` up to bound, beginning
    checking at ``start``, or ``abs(self)`` if no such divisor is found.

    INPUT:

    - ``bound`` -- a positive integer that fits in a C ``signed long``
    - ``start`` -- a positive integer that fits in a C ``signed long``

    OUTPUT: A positive integer

    EXAMPLES::

        sage: # needs sage.libs.pari
        sage: n = next_prime(10^6)*next_prime(10^7); n.trial_division()
        1000003
        sage: (-n).trial_division()
        1000003
        sage: n.trial_division(bound=100)
        10000049000057
        sage: n.trial_division(bound=-10)
        Traceback (most recent call last):
        ...
        ValueError: bound must be positive
        sage: n.trial_division(bound=0)
        Traceback (most recent call last):
        ...
        ValueError: bound must be positive
        sage: ZZ(0).trial_division()
        Traceback (most recent call last):
        ...
        ValueError: self must be nonzero

        sage: # needs sage.libs.pari
        sage: n = next_prime(10^5) * next_prime(10^40); n.trial_division()
        100003
        sage: n.trial_division(bound=10^4)
        1000030000000000000000000000000000000012100363
        sage: (-n).trial_division(bound=10^4)
        1000030000000000000000000000000000000012100363
        sage: (-n).trial_division()
        100003
        sage: n = 2 * next_prime(10^40); n.trial_division()
        2
        sage: n = 3 * next_prime(10^40); n.trial_division()
        3
        sage: n = 5 * next_prime(10^40); n.trial_division()
        5
        sage: n = 2 * next_prime(10^4); n.trial_division()
        2
        sage: n = 3 * next_prime(10^4); n.trial_division()
        3
        sage: n = 5 * next_prime(10^4); n.trial_division()
        5

    You can specify a starting point::

        sage: n = 3*5*101*103
        sage: n.trial_division(start=50)
        101
</code></pre>
</div>


                            </div>
                            <div id="Integer.factor" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">factor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.factor"></a>
    
            <div class="docstring"><p><a href="#Integer.factor">Integer.factor</a>(self, algorithm=u'pari', proof=None, limit=None, int_=False, verbose=0)
File: sage/rings/integer.pyx (starting at line 3829)</p>

<pre><code>    Return the prime factorization of this integer as a
    formal Factorization object.

    INPUT:

    -  ``algorithm`` - string

       - ``'pari'`` - (default) use the PARI library

       - ``'flint'`` - use the FLINT library

       - ``'kash'`` - use the KASH computer algebra system (requires
         kash)

       - ``'magma'`` - use the MAGMA computer algebra system (requires
         an installation of MAGMA)

       - ``'qsieve'`` - use Bill Hart's quadratic sieve code;
         WARNING: this may not work as expected, see qsieve? for
         more information

       - ``'ecm'`` - use ECM-GMP, an implementation of Hendrik
         Lenstra's elliptic curve method.

    - ``proof`` - bool (default: ``True``) whether or not to prove
      primality of each factor (only applicable for ``'pari'``
      and ``'ecm'``).

    - ``limit`` - int or None (default: None) if limit is
      given it must fit in a ``signed int``, and the factorization is done
      using trial division and primes up to limit.

    OUTPUT:

    -  a Factorization object containing the prime factors and
       their multiplicities

    EXAMPLES::

        sage: n = 2^100 - 1; n.factor()                                             # needs sage.libs.pari
        3 * 5^3 * 11 * 31 * 41 * 101 * 251 * 601 * 1801 * 4051 * 8101 * 268501

    This factorization can be converted into a list of pairs `(p,
    e)`, where `p` is prime and `e` is a positive integer.  Each
    pair can also be accessed directly by its index (ordered by
    increasing size of the prime)::

        sage: f = 60.factor()
        sage: list(f)
        [(2, 2), (3, 1), (5, 1)]
        sage: f[2]
        (5, 1)

    Similarly, the factorization can be converted to a dictionary
    so the exponent can be extracted for each prime::

        sage: f = (3^6).factor()
        sage: dict(f)
        {3: 6}
        sage: dict(f)[3]
        6

    We use ``proof=False``, which doesn't prove correctness of the primes
    that appear in the factorization::

        sage: n = 920384092842390423848290348203948092384082349082
        sage: n.factor(proof=False)                                                 # needs sage.libs.pari
        2 * 11 * 1531 * 4402903 * 10023679 * 619162955472170540533894518173
        sage: n.factor(proof=True)                                                  # needs sage.libs.pari
        2 * 11 * 1531 * 4402903 * 10023679 * 619162955472170540533894518173

    We factor using trial division only::

        sage: n.factor(limit=1000)
        2 * 11 * 41835640583745019265831379463815822381094652231

    An example where FLINT is used::

        sage: n = 82862385732327628428164127822
        sage: n.factor(algorithm='flint')                                           # needs sage.libs.flint
        2 * 3 * 11 * 13 * 41 * 73 * 22650083 * 1424602265462161

    We factor using a quadratic sieve algorithm::

        sage: # needs sage.libs.pari
        sage: p = next_prime(10^20)
        sage: q = next_prime(10^21)
        sage: n = p * q
        sage: n.factor(algorithm='qsieve')                                          # needs sage.libs.flint
        doctest:... RuntimeWarning: the factorization returned
        by qsieve may be incomplete (the factors may not be prime)
        or even wrong; see qsieve? for details
        100000000000000000039 * 1000000000000000000117

    We factor using the elliptic curve method::

        sage: # needs sage.libs.pari
        sage: p = next_prime(10^15)
        sage: q = next_prime(10^21)
        sage: n = p * q
        sage: n.factor(algorithm='ecm')
        1000000000000037 * 1000000000000000000117

    TESTS::

        sage: n = 42
        sage: n.factor(algorithm='foobar')
        Traceback (most recent call last):
        ...
        ValueError: Algorithm is not known
</code></pre>
</div>


                            </div>
                            <div id="Integer.support" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">support</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.support"></a>
    
            <div class="docstring"><p><a href="#Integer.support">Integer.support</a>(self)
File: sage/rings/integer.pyx (starting at line 4033)</p>

<pre><code>    Return a sorted list of the primes dividing this integer.

    OUTPUT: The sorted list of primes appearing in the factorization of
    this rational with positive exponent.

    EXAMPLES::

        sage: factorial(10).support()
        [2, 3, 5, 7]
        sage: (-999).support()
        [3, 37]

    Trying to find the support of 0 raises an `ArithmeticError`::

        sage: 0.support()
        Traceback (most recent call last):
        ...
        ArithmeticError: Support of 0 not defined.
</code></pre>
</div>


                            </div>
                            <div id="Integer.coprime_integers" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coprime_integers</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.coprime_integers"></a>
    
            <div class="docstring"><p><a href="#Integer.coprime_integers">Integer.coprime_integers</a>(self, m)
File: sage/rings/integer.pyx (starting at line 4058)</p>

<pre><code>    Return the non-negative integers `&lt; m` that are coprime to
    this integer.

    EXAMPLES::

        sage: n = 8
        sage: n.coprime_integers(8)
        [1, 3, 5, 7]
        sage: n.coprime_integers(11)
        [1, 3, 5, 7, 9]
        sage: n = 5; n.coprime_integers(10)
        [1, 2, 3, 4, 6, 7, 8, 9]
        sage: n.coprime_integers(5)
        [1, 2, 3, 4]
        sage: n = 99; n.coprime_integers(99)
        [1, 2, 4, 5, 7, 8, 10, 13, 14, 16, 17, 19, 20, 23, 25, 26, 28, 29, 31, 32, 34, 35, 37, 38, 40, 41, 43, 46, 47, 49, 50, 52, 53, 56, 58, 59, 61, 62, 64, 65, 67, 68, 70, 71, 73, 74, 76, 79, 80, 82, 83, 85, 86, 89, 91, 92, 94, 95, 97, 98]

    TESTS::

        sage: 0.coprime_integers(10^100)
        [1]
        sage: 1.coprime_integers(10^100)
        Traceback (most recent call last):
        ...
        OverflowError: bound is too large
        sage: for n in srange(-6, 7):
        ....:     for m in range(-1, 10):
        ....:         assert n.coprime_integers(m) == [k for k in srange(0, m) if gcd(k, n) == 1]

    AUTHORS:

    - Naqi Jaffery (2006-01-24): examples

    - David Roe (2017-10-02): Use sieving

    - Jeroen Demeyer (2018-06-25): allow returning zero (only relevant for 1.coprime_integers(n))

    ALGORITHM:

    Create an integer with `m` bits and set bits at every multiple
    of a prime `p` that divides this integer and is less than `m`.
    Then return a list of integers corresponding to the unset bits.
</code></pre>
</div>


                            </div>
                            <div id="Integer.divides" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">divides</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.divides"></a>
    
            <div class="docstring"><p><a href="#Integer.divides">Integer.divides</a>(self, n)
File: sage/rings/integer.pyx (starting at line 4153)</p>

<pre><code>    Return ``True`` if ``self`` divides ``n``.

    EXAMPLES::

        sage: Z = IntegerRing()
        sage: Z(5).divides(Z(10))
        True
        sage: Z(0).divides(Z(5))
        False
        sage: Z(10).divides(Z(5))
        False
</code></pre>
</div>


                            </div>
                            <div id="Integer.valuation" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">valuation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.valuation"></a>
    
            <div class="docstring"><p><a href="#Integer.valuation">Integer.valuation</a>(self, p)
File: sage/rings/integer.pyx (starting at line 4227)</p>

<pre><code>    Return the p-adic valuation of ``self``.

    INPUT:

    -  ``p`` - an integer at least 2.

    EXAMPLES::

        sage: n = 60
        sage: n.valuation(2)
        2
        sage: n.valuation(3)
        1
        sage: n.valuation(7)
        0
        sage: n.valuation(1)
        Traceback (most recent call last):
        ...
        ValueError: You can only compute the valuation with respect to a integer larger than 1.

    We do not require that ``p`` is a prime::

        sage: (2^11).valuation(4)
        5
</code></pre>
</div>


                            </div>
                            <div id="Integer.p_primary_part" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">p_primary_part</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.p_primary_part"></a>
    
            <div class="docstring"><p><a href="#Integer.p_primary_part">Integer.p_primary_part</a>(self, p)
File: sage/rings/integer.pyx (starting at line 4259)</p>

<pre><code>    Return the ``p``-primary part of ``self``.

    INPUT:

    - ``p`` -- a prime integer.

    OUTPUT: Largest power of ``p`` dividing ``self``.

    EXAMPLES::

        sage: n = 40
        sage: n.p_primary_part(2)
        8
        sage: n.p_primary_part(5)
        5
        sage: n.p_primary_part(7)
        1
        sage: n.p_primary_part(6)
        Traceback (most recent call last):
        ...
        ValueError: 6 is not a prime number
</code></pre>
</div>


                            </div>
                            <div id="Integer.val_unit" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">val_unit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.val_unit"></a>
    
            <div class="docstring"><p><a href="#Integer.val_unit">Integer.val_unit</a>(self, p)
File: sage/rings/integer.pyx (starting at line 4288)</p>

<pre><code>    Return a pair: the p-adic valuation of ``self``, and the p-adic unit
    of ``self``.

    INPUT:

    -  ``p`` - an integer at least 2.

    OUTPUT:

    -  ``v_p(self)`` - the p-adic valuation of ``self``

    -  ``u_p(self)`` - ``self`` / `p^{v_p(\mathrm{self})}`

    EXAMPLES::

        sage: n = 60
        sage: n.val_unit(2)
        (2, 15)
        sage: n.val_unit(3)
        (1, 20)
        sage: n.val_unit(7)
        (0, 60)
        sage: (2^11).val_unit(4)
        (5, 2)
        sage: 0.val_unit(2)
        (+Infinity, 1)
</code></pre>
</div>


                            </div>
                            <div id="Integer.odd_part" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">odd_part</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.odd_part"></a>
    
            <div class="docstring"><p><a href="#Integer.odd_part">Integer.odd_part</a>(self)
File: sage/rings/integer.pyx (starting at line 4319)</p>

<pre><code>    The odd part of the integer `n`. This is `n / 2^v`,
    where `v = \mathrm{valuation}(n,2)`.

    IMPLEMENTATION:

    Currently returns 0 when ``self`` is 0.  This behaviour is fairly arbitrary,
    and in Sage 4.6 this special case was not handled at all, eventually
    propagating a TypeError.  The caller should not rely on the behaviour
    in case ``self`` is 0.

    EXAMPLES::

        sage: odd_part(5)
        5
        sage: odd_part(4)
        1
        sage: odd_part(factorial(31))
        122529844256906551386796875
</code></pre>
</div>


                            </div>
                            <div id="Integer.divide_knowing_divisible_by" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">divide_knowing_divisible_by</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.divide_knowing_divisible_by"></a>
    
            <div class="docstring"><p><a href="#Integer.divide_knowing_divisible_by">Integer.divide_knowing_divisible_by</a>(self, right)
File: sage/rings/integer.pyx (starting at line 4377)</p>

<pre><code>    Return the integer ``self`` / ``right`` when ``self`` is divisible by ``right``.

    If ``self`` is not divisible by right, the return value is undefined,
    and may not even be close to ``self`` / ``right`` for multi-word integers.

    EXAMPLES::

        sage: a = 8; b = 4
        sage: a.divide_knowing_divisible_by(b)
        2
        sage: (100000).divide_knowing_divisible_by(25)
        4000
        sage: (100000).divide_knowing_divisible_by(26) # close (random)
        3846

    However, often it's way off.

    ::

        sage: a = 2^70; a
        1180591620717411303424
        sage: a // 11  # floor divide
        107326510974310118493
        sage: a.divide_knowing_divisible_by(11) # way off and possibly random
        43215361478743422388970455040
</code></pre>
</div>


                            </div>
                            <div id="Integer.denominator" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">denominator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.denominator"></a>
    
            <div class="docstring"><p><a href="#Integer.denominator">Integer.denominator</a>(self)
File: sage/rings/integer.pyx (starting at line 4446)</p>

<pre><code>    Return the denominator of this integer, which of course is
    always 1.

    EXAMPLES::

        sage: x = 5
        sage: x.denominator()
        1
        sage: x = 0
        sage: x.denominator()
        1
</code></pre>
</div>


                            </div>
                            <div id="Integer.numerator" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">numerator</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.numerator"></a>
    
            <div class="docstring"><p><a href="#Integer.numerator">Integer.numerator</a>(self)
File: sage/rings/integer.pyx (starting at line 4462)</p>

<pre><code>    Return the numerator of this integer.

    EXAMPLES::

        sage: x = 5
        sage: x.numerator()
        5

    ::

        sage: x = 0
        sage: x.numerator()
        0
</code></pre>
</div>


                            </div>
                            <div id="Integer.as_integer_ratio" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">as_integer_ratio</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.as_integer_ratio"></a>
    
            <div class="docstring"><p><a href="#Integer.as_integer_ratio">Integer.as_integer_ratio</a>(self)
File: sage/rings/integer.pyx (starting at line 4480)</p>

<pre><code>    Return the pair ``(self.numerator(), self.denominator())``,
    which is ``(self, 1)``.

    EXAMPLES::

        sage: x = -12
        sage: x.as_integer_ratio()
        (-12, 1)
</code></pre>
</div>


                            </div>
                            <div id="Integer.factorial" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">factorial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.factorial"></a>
    
            <div class="docstring"><p><a href="#Integer.factorial">Integer.factorial</a>(self)
File: sage/rings/integer.pyx (starting at line 4493)</p>

<pre><code>    Return the factorial `n! = 1 \cdot 2 \cdot 3 \cdots n`.

    If the input does not fit in an ``unsigned long int``, an `OverflowError`
    is raised.

    EXAMPLES::

        sage: for n in srange(7):
        ....:     print("{} {}".format(n, n.factorial()))
        0 1
        1 1
        2 2
        3 6
        4 24
        5 120
        6 720

    Large integers raise an `OverflowError`::

        sage: (2**64).factorial()
        Traceback (most recent call last):
        ...
        OverflowError: argument too large for factorial

    And negative ones a `ValueError`::

        sage: (-1).factorial()
        Traceback (most recent call last):
        ...
        ValueError: factorial only defined for non-negative integers
</code></pre>
</div>


                            </div>
                            <div id="Integer.multifactorial" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">multifactorial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.multifactorial"></a>
    
            <div class="docstring"><p><a href="#Integer.multifactorial">Integer.multifactorial</a>(self, long k)
File: sage/rings/integer.pyx (starting at line 4540)</p>

<pre><code>    Compute the k-th factorial `n!^{(k)}` of ``self``.

    The multifactorial number `n!^{(k)}` is defined for non-negative
    integers `n` as follows. For `k=1` this is the standard factorial,
    and for `k` greater than `1` it is the product of every `k`-th
    terms down from `n` to `1`. The recursive definition is used to
    extend this function to the negative integers `n`.

    This function uses direct call to GMP if `k` and `n` are non-negative
    and uses simple transformation for other cases.

    EXAMPLES::

        sage: 5.multifactorial(1)
        120
        sage: 5.multifactorial(2)
        15
        sage: 5.multifactorial(3)
        10

        sage: 23.multifactorial(2)
        316234143225
        sage: prod([1..23, step=2])
        316234143225

        sage: (-29).multifactorial(7)
        1/2640
        sage: (-3).multifactorial(5)
        1/2
        sage: (-9).multifactorial(3)
        Traceback (most recent call last):
        ...
        ValueError: multifactorial undefined

    When entries are too large an `OverflowError` is raised::

        sage: (2**64).multifactorial(2)
        Traceback (most recent call last):
        ...
        OverflowError: argument too large for multifactorial
</code></pre>
</div>


                            </div>
                            <div id="Integer.gamma" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">gamma</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.gamma"></a>
    
            <div class="docstring"><p><a href="#Integer.gamma">Integer.gamma</a>(self)
File: sage/rings/integer.pyx (starting at line 4621)</p>

<pre><code>    The gamma function on integers is the factorial function (shifted by
    one) on positive integers, and `\pm \infty` on non-positive integers.

    EXAMPLES::

        sage: # needs sage.symbolic
        sage: gamma(5)
        24
        sage: gamma(0)
        Infinity
        sage: gamma(-1)
        Infinity
        sage: gamma(-2^150)
        Infinity
</code></pre>
</div>


                            </div>
                            <div id="Integer.floor" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">floor</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.floor"></a>
    
            <div class="docstring"><p><a href="#Integer.floor">Integer.floor</a>(self)
File: sage/rings/integer.pyx (starting at line 4643)</p>

<pre><code>    Return the floor of ``self``, which is just self since ``self`` is an
    integer.

    EXAMPLES::

        sage: n = 6
        sage: n.floor()
        6
</code></pre>
</div>


                            </div>
                            <div id="Integer.ceil" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ceil</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.ceil"></a>
    
            <div class="docstring"><p><a href="#Integer.ceil">Integer.ceil</a>(self)
File: sage/rings/integer.pyx (starting at line 4656)</p>

<pre><code>    Return the ceiling of ``self``, which is ``self`` since ``self`` is an
    integer.

    EXAMPLES::

        sage: n = 6
        sage: n.ceil()
        6
</code></pre>
</div>


                            </div>
                            <div id="Integer.trunc" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">trunc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.trunc"></a>
    
            <div class="docstring"><p><a href="#Integer.trunc">Integer.trunc</a>(self)
File: sage/rings/integer.pyx (starting at line 4669)</p>

<pre><code>    Round this number to the nearest integer, which is ``self`` since
    ``self`` is an integer.

    EXAMPLES::

        sage: n = 6
        sage: n.trunc()
        6
</code></pre>
</div>


                            </div>
                            <div id="Integer.round" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">round</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.round"></a>
    
            <div class="docstring"><p><a href="#Integer.round">Integer.round</a>(self, mode=u'away')
File: sage/rings/integer.pyx (starting at line 4682)</p>

<pre><code>    Return the nearest integer to ``self``, which is ``self`` since
    ``self`` is an integer.

    EXAMPLES:

    This example addresses :trac:`23502`::

        sage: n = 6
        sage: n.round()
        6
</code></pre>
</div>


                            </div>
                            <div id="Integer.real" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">real</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.real"></a>
    
            <div class="docstring"><p><a href="#Integer.real">Integer.real</a>(self)
File: sage/rings/integer.pyx (starting at line 4697)</p>

<pre><code>    Return the real part of ``self``, which is ``self``.

    EXAMPLES::

        sage: Integer(-4).real()
        -4
</code></pre>
</div>


                            </div>
                            <div id="Integer.imag" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">imag</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.imag"></a>
    
            <div class="docstring"><p><a href="#Integer.imag">Integer.imag</a>(self)
File: sage/rings/integer.pyx (starting at line 4708)</p>

<pre><code>    Return the imaginary part of ``self``, which is zero.

    EXAMPLES::

        sage: Integer(9).imag()
        0
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_one" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_one</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_one"></a>
    
            <div class="docstring"><p><a href="#Integer.is_one">Integer.is_one</a>(self)
File: sage/rings/integer.pyx (starting at line 4719)</p>

<pre><code>    Return ``True`` if the integer is `1`, otherwise ``False``.

    EXAMPLES::

        sage: Integer(1).is_one()
        True
        sage: Integer(0).is_one()
        False
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_integral" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_integral</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_integral"></a>
    
            <div class="docstring"><p><a href="#Integer.is_integral">Integer.is_integral</a>(self)
File: sage/rings/integer.pyx (starting at line 4745)</p>

<pre><code>    Return ``True`` since integers are integral, i.e.,
    satisfy a monic polynomial with integer coefficients.

    EXAMPLES::

        sage: Integer(3).is_integral()
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_rational" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_rational</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_rational"></a>
    
            <div class="docstring"><p><a href="#Integer.is_rational">Integer.is_rational</a>(self)
File: sage/rings/integer.pyx (starting at line 4757)</p>

<pre><code>    Return ``True`` as an integer is a rational number.

    EXAMPLES::

        sage: 5.is_rational()
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_integer" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_integer</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_integer"></a>
    
            <div class="docstring"><p><a href="#Integer.is_integer">Integer.is_integer</a>(self)
File: sage/rings/integer.pyx (starting at line 4768)</p>

<pre><code>    Return ``True`` as they are integers

    EXAMPLES::

        sage: sqrt(4).is_integer()
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_unit" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_unit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_unit"></a>
    
            <div class="docstring"><p><a href="#Integer.is_unit">Integer.is_unit</a>(self)
File: sage/rings/integer.pyx (starting at line 4779)</p>

<pre><code>    Return ``True`` if this integer is a unit, i.e., `1` or `-1`.

    EXAMPLES::

        sage: for n in srange(-2,3):
        ....:     print("{} {}".format(n, n.is_unit()))
        -2 False
        -1 True
        0 False
        1 True
        2 False
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_square" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_square</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_square"></a>
    
            <div class="docstring"><p><a href="#Integer.is_square">Integer.is_square</a>(self)
File: sage/rings/integer.pyx (starting at line 4795)</p>

<pre><code>    Return ``True`` if ``self`` is a perfect square.

    EXAMPLES::

        sage: Integer(4).is_square()
        True
        sage: Integer(41).is_square()
        False
</code></pre>
</div>


                            </div>
                            <div id="Integer.perfect_power" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">perfect_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.perfect_power"></a>
    
            <div class="docstring"><p><a href="#Integer.perfect_power">Integer.perfect_power</a>(self)
File: sage/rings/integer.pyx (starting at line 4808)</p>

<pre><code>    Return ``(a, b)``, where this integer is `a^b` and `b` is maximal.

    If called on `-1`, `0` or `1`, `b` will be `1`, since there is no
    maximal value of `b`.

    .. SEEALSO::

        - `is_perfect_power()`: testing whether an integer is a perfect
          power is usually faster than finding `a` and `b`.
        - `is_prime_power()`: checks whether the base is prime.
        - `is_power_of()`: if you know the base already, this method is
          the fastest option.

    EXAMPLES::

        sage: 144.perfect_power()                                                   # needs sage.libs.pari
        (12, 2)
        sage: 1.perfect_power()
        (1, 1)
        sage: 0.perfect_power()
        (0, 1)
        sage: (-1).perfect_power()
        (-1, 1)
        sage: (-8).perfect_power()                                                  # needs sage.libs.pari
        (-2, 3)
        sage: (-4).perfect_power()
        (-4, 1)
        sage: (101^29).perfect_power()                                              # needs sage.libs.pari
        (101, 29)
        sage: (-243).perfect_power()                                                # needs sage.libs.pari
        (-3, 5)
        sage: (-64).perfect_power()                                                 # needs sage.libs.pari
        (-4, 3)

    TESTS::

        sage: 4.perfect_power()
        (2, 2)
        sage: 256.perfect_power()
        (2, 8)
</code></pre>
</div>


                            </div>
                            <div id="Integer.global_height" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">global_height</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.global_height"></a>
    
            <div class="docstring"><p><a href="#Integer.global_height">Integer.global_height</a>(self, prec=None)
File: sage/rings/integer.pyx (starting at line 4868)</p>

<pre><code>    Return the absolute logarithmic height of this rational integer.

    INPUT:

    - ``prec`` (int) -- desired floating point precision (default:
      default RealField precision).

    OUTPUT:

    (real) The absolute logarithmic height of this rational integer.

    ALGORITHM:

    The height of the integer `n` is `\log |n|`.

    EXAMPLES::

        sage: # needs sage.rings.real_mpfr
        sage: ZZ(5).global_height()
        1.60943791243410
        sage: ZZ(-2).global_height(prec=100)
        0.69314718055994530941723212146
        sage: exp(_)
        2.0000000000000000000000000000
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_power_of" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_power_of</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_power_of"></a>
    
            <div class="docstring"><p><a href="#Integer.is_power_of">Integer.is_power_of</a>(self, n)
File: sage/rings/integer.pyx (starting at line 5024)</p>

<pre><code>    Return ``True`` if there is an integer `b` with
    `\mathtt{self} = n^b`.

    .. SEEALSO::

        - `perfect_power()`: Finds the minimal base for which this
          integer is a perfect power.
        - `is_perfect_power()`: If you don't know the base but just
          want to know if this integer is a perfect power, use this
          function.
        - `is_prime_power()`: Checks whether the base is prime.

    EXAMPLES::

        sage: Integer(64).is_power_of(4)
        True
        sage: Integer(64).is_power_of(16)
        False

    TESTS::

        sage: Integer(-64).is_power_of(-4)
        True
        sage: Integer(-32).is_power_of(-2)
        True
        sage: Integer(1).is_power_of(1)
        True
        sage: Integer(-1).is_power_of(-1)
        True
        sage: Integer(0).is_power_of(1)
        False
        sage: Integer(0).is_power_of(0)
        True
        sage: Integer(1).is_power_of(0)
        True
        sage: Integer(1).is_power_of(8)
        True
        sage: Integer(-8).is_power_of(2)
        False
        sage: Integer(-81).is_power_of(-3)
        False

    .. NOTE::

       For large integers ``self``, `is_power_of()` is faster than
       `is_perfect_power()`. The following examples give some indication of
       how much faster.

    ::

        sage: b = lcm(range(1,10000))
        sage: b.exact_log(2)
        14446
        sage: t = cputime()
        sage: for a in range(2, 1000): k = b.is_perfect_power()
        sage: cputime(t)      # random
        0.53203299999999976
        sage: t = cputime()
        sage: for a in range(2, 1000): k = b.is_power_of(2)
        sage: cputime(t)      # random
        0.0
        sage: t = cputime()
        sage: for a in range(2, 1000): k = b.is_power_of(3)
        sage: cputime(t)      # random
        0.032002000000000308

    ::

        sage: b = lcm(range(1, 1000))
        sage: b.exact_log(2)
        1437
        sage: t = cputime()
        sage: for a in range(2, 10000):  # note: changed range from the example above
        ....:     k = b.is_perfect_power()
        sage: cputime(t)      # random
        0.17201100000000036
        sage: t = cputime(); TWO = int(2)
        sage: for a in range(2, 10000): k = b.is_power_of(TWO)
        sage: cputime(t)      # random
        0.0040000000000000036
        sage: t = cputime()
        sage: for a in range(2, 10000): k = b.is_power_of(3)
        sage: cputime(t)      # random
        0.040003000000000011
        sage: t = cputime()
        sage: for a in range(2, 10000): k = b.is_power_of(a)
        sage: cputime(t)      # random
        0.02800199999999986
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_prime_power" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_prime_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_prime_power"></a>
    
            <div class="docstring"><p><a href="#Integer.is_prime_power">Integer.is_prime_power</a>(self, *, proof=None, bool get_data=False)
File: sage/rings/integer.pyx (starting at line 5119)</p>

<pre><code>    Return ``True`` if this integer is a prime power, and ``False`` otherwise.

    A prime power is a prime number raised to a positive power. Hence `1` is
    not a prime power.

    For a method that uses a pseudoprimality test instead see
    `is_pseudoprime_power()`.

    INPUT:

    - ``proof`` -- Boolean or ``None`` (default). If ``False``, use a strong
      pseudo-primality test (see `is_pseudoprime()`).  If ``True``, use
      a provable primality test. If unset, use the default arithmetic proof
      flag.

    - ``get_data`` -- (default ``False``), if ``True`` return a pair
      ``(p,k)`` such that this integer equals ``p^k`` with ``p`` a prime
      and ``k`` a positive integer or the pair ``(self,0)`` otherwise.

    .. SEEALSO::

        - `perfect_power()`: Finds the minimal base for which integer
          is a perfect power.
        - `is_perfect_power()`: Doesn't test whether the base is prime.
        - `is_power_of()`: If you know the base already this method is
          the fastest option.
        - `is_pseudoprime_power()`: If the entry is very large.

    EXAMPLES::

        sage: # needs sage.libs.pari
        sage: 17.is_prime_power()
        True
        sage: 10.is_prime_power()
        False
        sage: 64.is_prime_power()
        True
        sage: (3^10000).is_prime_power()
        True
        sage: (10000).is_prime_power()
        False
        sage: (-3).is_prime_power()
        False
        sage: 0.is_prime_power()
        False
        sage: 1.is_prime_power()
        False
        sage: p = next_prime(10^20); p
        100000000000000000039
        sage: p.is_prime_power()
        True
        sage: (p^97).is_prime_power()
        True
        sage: (p + 1).is_prime_power()
        False

    With the ``get_data`` keyword set to ``True``::

        sage: # needs sage.libs.pari
        sage: (3^100).is_prime_power(get_data=True)
        (3, 100)
        sage: 12.is_prime_power(get_data=True)
        (12, 0)
        sage: (p^97).is_prime_power(get_data=True)
        (100000000000000000039, 97)
        sage: q = p.next_prime(); q
        100000000000000000129
        sage: (p*q).is_prime_power(get_data=True)
        (10000000000000000016800000000000000005031, 0)

    The method works for large entries when ``proof=False``::

        sage: proof.arithmetic(False)
        sage: ((10^500 + 961)^4).is_prime_power()                                   # needs sage.libs.pari
        True
        sage: proof.arithmetic(True)

    We check that :trac:`4777` is fixed::

        sage: n = 150607571^14
        sage: n.is_prime_power()                                                    # needs sage.libs.pari
        True

    TESTS::

        sage: 2.is_prime_power(get_data=True)
        (2, 1)
        sage: 4.is_prime_power(get_data=True)
        (2, 2)
        sage: 512.is_prime_power(get_data=True)
        (2, 9)
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_prime" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_prime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_prime"></a>
    
            <div class="docstring"><p><a href="#Integer.is_prime">Integer.is_prime</a>(self, proof=None)
File: sage/rings/integer.pyx (starting at line 5275)</p>

<pre><code>    Test whether ``self`` is prime.

    INPUT:

    - ``proof`` -- Boolean or ``None`` (default). If ``False``, use a
      strong pseudo-primality test (see `is_pseudoprime()`).
      If ``True``, use a provable primality test.  If unset, use the
      `default arithmetic proof flag &lt;sage.structure.proof.proof&gt;`.

    .. NOTE::

       Integer primes are by definition *positive*! This is
       different than Magma, but the same as in PARI. See also the
       `is_irreducible()()` method.

    EXAMPLES::

        sage: z = 2^31 - 1
        sage: z.is_prime()                                                          # needs sage.libs.pari
        True
        sage: z = 2^31
        sage: z.is_prime()
        False
        sage: z = 7
        sage: z.is_prime()
        True
        sage: z = -7
        sage: z.is_prime()
        False
        sage: z.is_irreducible()
        True

    ::

        sage: z = 10^80 + 129
        sage: z.is_prime(proof=False)                                               # needs sage.libs.pari
        True
        sage: z.is_prime(proof=True)                                                # needs sage.libs.pari
        True

    When starting Sage the arithmetic proof flag is True. We can change
    it to False as follows::

        sage: proof.arithmetic()
        True
        sage: n = 10^100 + 267
        sage: timeit("n.is_prime()")        # not tested                            # needs sage.libs.pari
        5 loops, best of 3: 163 ms per loop
        sage: proof.arithmetic(False)
        sage: proof.arithmetic()
        False
        sage: timeit("n.is_prime()")        # not tested                            # needs sage.libs.pari
        1000 loops, best of 3: 573 us per loop

    ALGORITHM:

    Calls the PARI function :pari:`isprime`.

    TESTS:

    We compare the output of this method to a straightforward sieve::

        sage: size = 10000
        sage: tab = [0,0] + [1] * (size-2)
        sage: for i in range(size):
        ....:     if tab[i]:
        ....:         for j in range(2*i, size, i):
        ....:             tab[j] = 0
        sage: all(ZZ(i).is_prime() == b for i,b in enumerate(tab))                  # needs sage.libs.pari
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_irreducible" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_irreducible</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_irreducible"></a>
    
            <div class="docstring"><p><a href="#Integer.is_irreducible">Integer.is_irreducible</a>(self)
File: sage/rings/integer.pyx (starting at line 5400)</p>

<pre><code>    Return ``True`` if ``self`` is irreducible, i.e. +/-
    prime

    EXAMPLES::

        sage: z = 2^31 - 1
        sage: z.is_irreducible()                                                    # needs sage.libs.pari
        True
        sage: z = 2^31
        sage: z.is_irreducible()
        False
        sage: z = 7
        sage: z.is_irreducible()
        True
        sage: z = -7
        sage: z.is_irreducible()
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_pseudoprime" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_pseudoprime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_pseudoprime"></a>
    
            <div class="docstring"><p><a href="#Integer.is_pseudoprime">Integer.is_pseudoprime</a>(self)
File: sage/rings/integer.pyx (starting at line 5423)</p>

<pre><code>    Test whether ``self`` is a pseudoprime.

    This uses PARI's Baillie-PSW probabilistic primality
    test. Currently, there are no known pseudoprimes for
    Baillie-PSW that are not actually prime. However, it is
    conjectured that there are infinitely many.

    See :wikipedia:`Baillie-PSW_primality_test`

    EXAMPLES::

        sage: z = 2^31 - 1
        sage: z.is_pseudoprime()                                                    # needs sage.libs.pari
        True
        sage: z = 2^31
        sage: z.is_pseudoprime()                                                    # needs sage.libs.pari
        False
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_pseudoprime_power" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_pseudoprime_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_pseudoprime_power"></a>
    
            <div class="docstring"><p><a href="#Integer.is_pseudoprime_power">Integer.is_pseudoprime_power</a>(self, get_data=False)
File: sage/rings/integer.pyx (starting at line 5445)</p>

<pre><code>    Test if this number is a power of a pseudoprime number.

    For large numbers, this method might be faster than
    `is_prime_power()`.

    INPUT:

    - ``get_data`` -- (default ``False``) if ``True`` return a pair `(p,k)`
      such that this number equals `p^k` with `p` a pseudoprime and `k` a
      positive integer or the pair ``(self,0)`` otherwise.

    EXAMPLES::

        sage: # needs sage.libs.pari
        sage: x = 10^200 + 357
        sage: x.is_pseudoprime()
        True
        sage: (x^12).is_pseudoprime_power()
        True
        sage: (x^12).is_pseudoprime_power(get_data=True)
        (1000...000357, 12)
        sage: (997^100).is_pseudoprime_power()
        True
        sage: (998^100).is_pseudoprime_power()
        False
        sage: ((10^1000 + 453)^2).is_pseudoprime_power()
        True

    TESTS::

        sage: 0.is_pseudoprime_power()
        False
        sage: (-1).is_pseudoprime_power()
        False
        sage: 1.is_pseudoprime_power()                                              # needs sage.libs.pari
        False
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_perfect_power" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_perfect_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_perfect_power"></a>
    
            <div class="docstring"><p><a href="#Integer.is_perfect_power">Integer.is_perfect_power</a>(self)
File: sage/rings/integer.pyx (starting at line 5486)</p>

<pre><code>    Return ``True`` if ``self`` is a perfect power, ie if there exist integers
    `a` and `b`, `b &gt; 1` with ``self`` `= a^b`.

    .. SEEALSO::

        - `perfect_power()`: Finds the minimal base for which this
          integer is a perfect power.
        - `is_power_of()`: If you know the base already, this method is
          the fastest option.
        - `is_prime_power()`: Checks whether the base is prime.

    EXAMPLES::

        sage: Integer(-27).is_perfect_power()
        True
        sage: Integer(12).is_perfect_power()
        False

        sage: z = 8
        sage: z.is_perfect_power()
        True
        sage: 144.is_perfect_power()
        True
        sage: 10.is_perfect_power()
        False
        sage: (-8).is_perfect_power()
        True
        sage: (-4).is_perfect_power()
        False

    TESTS:

    This is a test to make sure we work around a bug in GMP, see
    :trac:`4612`.

    ::

        sage: [ -a for a in srange(100) if not (-a^3).is_perfect_power() ]
        []
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_norm" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_norm</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_norm"></a>
    
            <div class="docstring"><p><a href="#Integer.is_norm">Integer.is_norm</a>(self, K, element=False, proof=True)
File: sage/rings/integer.pyx (starting at line 5542)</p>

<pre><code>    See ``QQ(self).is_norm()``.

    EXAMPLES::

        sage: n = 7
        sage: n.is_norm(QQ)
        True
        sage: n.is_norm(QQ, element=True)
        (True, 7)

        sage: # needs sage.rings.number_field
        sage: x = polygen(ZZ, 'x')
        sage: K = NumberField(x^2 - 2, 'beta')
        sage: n = 4
        sage: n.is_norm(K)
        True
        sage: 5.is_norm(K)
        False
        sage: n.is_norm(K, element=True)
        (True, -4*beta + 6)
        sage: n.is_norm(K, element=True)[1].norm()
        4
        sage: n = 5
        sage: n.is_norm(K, element=True)
        (False, None)
</code></pre>
</div>


                            </div>
                            <div id="Integer.jacobi" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">jacobi</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.jacobi"></a>
    
            <div class="docstring"><p><a href="#Integer.jacobi">Integer.jacobi</a>(self, b)
File: sage/rings/integer.pyx (starting at line 5587)</p>

<pre><code>    Calculate the Jacobi symbol `\left(\frac{\text{self}}{b}\right)`.

    EXAMPLES::

        sage: z = -1
        sage: z.jacobi(17)
        1
        sage: z.jacobi(19)
        -1
        sage: z.jacobi(17*19)
        -1
        sage: (2).jacobi(17)
        1
        sage: (3).jacobi(19)
        -1
        sage: (6).jacobi(17*19)
        -1
        sage: (6).jacobi(33)
        0
        sage: a = 3; b = 7
        sage: a.jacobi(b) == -b.jacobi(a)
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.kronecker" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">kronecker</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.kronecker"></a>
    
            <div class="docstring"><p><a href="#Integer.kronecker">Integer.kronecker</a>(self, b)
File: sage/rings/integer.pyx (starting at line 5624)</p>

<pre><code>    Calculate the Kronecker symbol `\left(\frac{\text{self}}{b}\right)`
    with the Kronecker extension `(\text{self}/2)=(2/\text{self})` when ``self`` is odd,
    or `(\text{self}/2)=0` when ``self`` is even.

    EXAMPLES::

        sage: z = 5
        sage: z.kronecker(41)
        1
        sage: z.kronecker(43)
        -1
        sage: z.kronecker(8)
        -1
        sage: z.kronecker(15)
        0
        sage: a = 2; b = 5
        sage: a.kronecker(b) == b.kronecker(a)
        True
</code></pre>
</div>


                            </div>
                            <div id="Integer.class_number" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">class_number</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.class_number"></a>
    
            <div class="docstring"><p><a href="#Integer.class_number">Integer.class_number</a>(self, proof=True)
File: sage/rings/integer.pyx (starting at line 5651)</p>

<pre><code>    Return the class number of the quadratic order with this discriminant.

    INPUT:

    - ``self`` -- an integer congruent to `0` or `1` mod `4` which is
      not a square

    - ``proof`` (boolean, default ``True``) -- if ``False``, then
      for negative discriminants a faster algorithm is used by
      the PARI library which is known to give incorrect results
      when the class group has many cyclic factors.  However, the
      results are correct for discriminants `D` with `|D|\le 2\cdot10^{10}`.

    OUTPUT:

    (integer) the class number of the quadratic order with this
    discriminant.

    .. NOTE::

       For positive `D`, this is not always equal to the number of classes of
       primitive binary quadratic forms of discriminant `D`, which
       is equal to the narrow class number. The two notions are
       the same when `D&lt;0`, or `D&gt;0` and the fundamental unit of
       the order has negative norm; otherwise the number of
       classes of forms is twice this class number.

    EXAMPLES::

        sage: (-163).class_number()                                                 # needs sage.libs.pari
        1
        sage: (-104).class_number()                                                 # needs sage.libs.pari
        6
        sage: [((4*n + 1), (4*n + 1).class_number()) for n in [21..29]]             # needs sage.libs.pari
        [(85, 2),
        (89, 1),
        (93, 1),
        (97, 1),
        (101, 1),
        (105, 2),
        (109, 1),
        (113, 1),
        (117, 1)]

    TESTS:

    The integer must not be a square, or an error is raised::

       sage: 100.class_number()
       Traceback (most recent call last):
       ...
       ValueError: class_number not defined for square integers


    The integer must be 0 or 1 mod 4, or an error is raised::

       sage: 10.class_number()
       Traceback (most recent call last):
       ...
       ValueError: class_number only defined for integers congruent to 0 or 1 modulo 4
       sage: 3.class_number()
       Traceback (most recent call last):
       ...
       ValueError: class_number only defined for integers congruent to 0 or 1 modulo 4
</code></pre>
</div>


                            </div>
                            <div id="Integer.squarefree_part" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">squarefree_part</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.squarefree_part"></a>
    
            <div class="docstring"><p><a href="#Integer.squarefree_part">Integer.squarefree_part</a>(self, long bound=-1)
File: sage/rings/integer.pyx (starting at line 5729)</p>

<pre><code>    Return the square free part of `x` (=self), i.e., the unique integer
    `z` that `x = z y^2`, with `y^2` a perfect square and `z` square-free.

    Use ``self.radical()`` for the product of the primes that divide self.

    If ``self`` is 0, just returns 0.

    EXAMPLES::

        sage: squarefree_part(100)
        1
        sage: squarefree_part(12)
        3
        sage: squarefree_part(17*37*37)
        17
        sage: squarefree_part(-17*32)
        -34
        sage: squarefree_part(1)
        1
        sage: squarefree_part(-1)
        -1
        sage: squarefree_part(-2)
        -2
        sage: squarefree_part(-4)
        -1

    ::

        sage: a = 8 * 5^6 * 101^2
        sage: a.squarefree_part(bound=2).factor()
        2 * 5^6 * 101^2
        sage: a.squarefree_part(bound=5).factor()
        2 * 101^2
        sage: a.squarefree_part(bound=1000)
        2
        sage: a.squarefree_part(bound=2**14)
        2
        sage: a = 7^3 * next_prime(2^100)^2 * next_prime(2^200)                     # needs sage.libs.pari
        sage: a / a.squarefree_part(bound=1000)                                     # needs sage.libs.pari
        49
</code></pre>
</div>


                            </div>
                            <div id="Integer.next_probable_prime" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_probable_prime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.next_probable_prime"></a>
    
            <div class="docstring"><p><a href="#Integer.next_probable_prime">Integer.next_probable_prime</a>(self)
File: sage/rings/integer.pyx (starting at line 5810)</p>

<pre><code>    Return the next probable prime after ``self``, as determined by PARI.

    EXAMPLES::

        sage: # needs sage.libs.pari
        sage: (-37).next_probable_prime()
        2
        sage: (100).next_probable_prime()
        101
        sage: (2^512).next_probable_prime()
        13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084171
        sage: 0.next_probable_prime()
        2
        sage: 126.next_probable_prime()
        127
        sage: 144168.next_probable_prime()
        144169
</code></pre>
</div>


                            </div>
                            <div id="Integer.next_prime" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_prime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.next_prime"></a>
    
            <div class="docstring"><p><a href="#Integer.next_prime">Integer.next_prime</a>(self, proof=None)
File: sage/rings/integer.pyx (starting at line 5832)</p>

<pre><code>    Return the next prime after ``self``.

    This method calls the PARI function :pari:`nextprime`.

    INPUT:

    -  ``proof`` - bool or None (default: None, see
       ``proof.arithmetic`` or `sage.structure.proof`) Note that the global Sage
       default is ``proof=True``

    EXAMPLES::

        sage: 100.next_prime()                                                      # needs sage.libs.pari
        101
        sage: (10^50).next_prime()                                                  # needs sage.libs.pari
        100000000000000000000000000000000000000000000000151

    Use ``proof=False``, which is way faster since it does not need
    a primality proof::

        sage: b = (2^1024).next_prime(proof=False)                                  # needs sage.libs.pari
        sage: b - 2^1024                                                            # needs sage.libs.pari
        643

    ::

        sage: Integer(0).next_prime()                                               # needs sage.libs.pari
        2
        sage: Integer(1001).next_prime()                                            # needs sage.libs.pari
        1009
</code></pre>
</div>


                            </div>
                            <div id="Integer.previous_prime" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">previous_prime</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.previous_prime"></a>
    
            <div class="docstring"><p><a href="#Integer.previous_prime">Integer.previous_prime</a>(self, proof=None)
File: sage/rings/integer.pyx (starting at line 5871)</p>

<pre><code>    Return the previous prime before ``self``.

    This method calls the PARI function :pari:`precprime`.

    INPUT:

    - ``proof`` - if ``True`` ensure that the returned value is the next
      prime power and if set to ``False`` uses probabilistic methods
      (i.e. the result is not guaranteed). By default it uses global
      configuration variables to determine which alternative to use (see
      `proof.arithmetic` or `sage.structure.proof`).

    .. SEEALSO::

        - `next_prime()`

    EXAMPLES::

        sage: 10.previous_prime()                                                   # needs sage.libs.pari
        7
        sage: 7.previous_prime()                                                    # needs sage.libs.pari
        5
        sage: 14376485.previous_prime()                                             # needs sage.libs.pari
        14376463

        sage: 2.previous_prime()
        Traceback (most recent call last):
        ...
        ValueError: no prime less than 2

    An example using ``proof=False``, which is way faster since it does not
    need a primality proof::

        sage: b = (2^1024).previous_prime(proof=False)                              # needs sage.libs.pari
        sage: 2^1024 - b                                                            # needs sage.libs.pari
        105
</code></pre>
</div>


                            </div>
                            <div id="Integer.next_prime_power" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">next_prime_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.next_prime_power"></a>
    
            <div class="docstring"><p><a href="#Integer.next_prime_power">Integer.next_prime_power</a>(self, proof=None)
File: sage/rings/integer.pyx (starting at line 5919)</p>

<pre><code>    Return the next prime power after ``self``.

    INPUT:

    - ``proof`` - if ``True`` ensure that the returned value is the next
      prime power and if set to ``False`` uses probabilistic methods
      (i.e. the result is not guaranteed). By default it uses global
      configuration variables to determine which alternative to use (see
      `proof.arithmetic` or `sage.structure.proof`).

    ALGORITHM:

    The algorithm is naive. It computes the next power of 2 and goes through
    the odd numbers calling `is_prime_power()`.

    .. SEEALSO::

        - `previous_prime_power()`
        - `is_prime_power()`
        - `next_prime()`
        - `previous_prime()`

    EXAMPLES::

        sage: (-1).next_prime_power()
        2
        sage: 2.next_prime_power()
        3
        sage: 103.next_prime_power()                                                # needs sage.libs.pari
        107
        sage: 107.next_prime_power()
        109
        sage: 2044.next_prime_power()                                               # needs sage.libs.pari
        2048

    TESTS::

        sage: [(2**k - 1).next_prime_power() for k in range(1,10)]
        [2, 4, 8, 16, 32, 64, 128, 256, 512]
        sage: [(2**k).next_prime_power() for k in range(10)]                        # needs sage.libs.pari
        [2, 3, 5, 9, 17, 37, 67, 131, 257, 521]

        sage: for _ in range(10):                                                   # needs sage.libs.pari
        ....:     n = ZZ.random_element(2**256).next_prime_power()
        ....:     m = n.next_prime_power().previous_prime_power()
        ....:     assert m == n, "problem with n = {}".format(n)
</code></pre>
</div>


                            </div>
                            <div id="Integer.previous_prime_power" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">previous_prime_power</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.previous_prime_power"></a>
    
            <div class="docstring"><p><a href="#Integer.previous_prime_power">Integer.previous_prime_power</a>(self, proof=None)
File: sage/rings/integer.pyx (starting at line 5985)</p>

<pre><code>    Return the previous prime power before ``self``.

    INPUT:

    - ``proof`` - if ``True`` ensure that the returned value is the next
      prime power and if set to ``False`` uses probabilistic methods
      (i.e. the result is not guaranteed). By default it uses global
      configuration variables to determine which alternative to use (see
      `proof.arithmetic` or `sage.structure.proof`).

    ALGORITHM:

    The algorithm is naive. It computes the previous power of 2 and goes
    through the odd numbers calling the method `is_prime_power()`.

    .. SEEALSO::

        - `next_prime_power()`
        - `is_prime_power()`
        - `previous_prime()`
        - `next_prime()`

    EXAMPLES::

        sage: # needs sage.libs.pari
        sage: 3.previous_prime_power()
        2
        sage: 103.previous_prime_power()
        101
        sage: 107.previous_prime_power()
        103
        sage: 2044.previous_prime_power()
        2039

        sage: 2.previous_prime_power()
        Traceback (most recent call last):
        ...
        ValueError: no prime power less than 2

    TESTS::

        sage: [(2**k + 1).previous_prime_power() for k in range(1,10)]
        [2, 4, 8, 16, 32, 64, 128, 256, 512]
        sage: [(2**k).previous_prime_power() for k in range(2, 10)]                 # needs sage.libs.pari
        [3, 7, 13, 31, 61, 127, 251, 509]

        sage: for _ in range(10):                                                   # needs sage.libs.pari
        ....:     n = ZZ.random_element(3,2**256).previous_prime_power()
        ....:     m = n.previous_prime_power().next_prime_power()
        ....:     assert m == n, "problem with n = {}".format(n)
</code></pre>
</div>


                            </div>
                            <div id="Integer.additive_order" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">additive_order</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.additive_order"></a>
    
            <div class="docstring"><p><a href="#Integer.additive_order">Integer.additive_order</a>(self)
File: sage/rings/integer.pyx (starting at line 6057)</p>

<pre><code>    Return the additive order of ``self``.

    EXAMPLES::

        sage: ZZ(0).additive_order()
        1
        sage: ZZ(1).additive_order()
        +Infinity
</code></pre>
</div>


                            </div>
                            <div id="Integer.multiplicative_order" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">multiplicative_order</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.multiplicative_order"></a>
    
            <div class="docstring"><p><a href="#Integer.multiplicative_order">Integer.multiplicative_order</a>(self)
File: sage/rings/integer.pyx (starting at line 6073)</p>

<pre><code>    Return the multiplicative order of ``self``.

    EXAMPLES::

        sage: ZZ(1).multiplicative_order()
        1
        sage: ZZ(-1).multiplicative_order()
        2
        sage: ZZ(0).multiplicative_order()
        +Infinity
        sage: ZZ(2).multiplicative_order()
        +Infinity
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_squarefree" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_squarefree</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_squarefree"></a>
    
            <div class="docstring"><p><a href="#Integer.is_squarefree">Integer.is_squarefree</a>(self)
File: sage/rings/integer.pyx (starting at line 6095)</p>

<pre><code>    Return ``True`` if this integer is not divisible by the square of any
    prime and ``False`` otherwise.

    EXAMPLES::

        sage: 100.is_squarefree()                                                   # needs sage.libs.pari
        False
        sage: 102.is_squarefree()                                                   # needs sage.libs.pari
        True
        sage: 0.is_squarefree()                                                     # needs sage.libs.pari
        False
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_discriminant" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_discriminant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_discriminant"></a>
    
            <div class="docstring"><p><a href="#Integer.is_discriminant">Integer.is_discriminant</a>(self)
File: sage/rings/integer.pyx (starting at line 6111)</p>

<pre><code>    Return ``True`` if this integer is a discriminant.

    .. NOTE::

        A discriminant is an integer congruent to 0 or 1 modulo 4.

    EXAMPLES::

        sage: (-1).is_discriminant()
        False
        sage: (-4).is_discriminant()
        True
        sage: 100.is_discriminant()
        True
        sage: 101.is_discriminant()
        True

    TESTS::

        sage: 0.is_discriminant()
        True
        sage: 1.is_discriminant()
        True
        sage: len([D for D in srange(-100,100) if D.is_discriminant()])
        100
</code></pre>
</div>


                            </div>
                            <div id="Integer.is_fundamental_discriminant" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_fundamental_discriminant</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.is_fundamental_discriminant"></a>
    
            <div class="docstring"><p><a href="#Integer.is_fundamental_discriminant">Integer.is_fundamental_discriminant</a>(self)
File: sage/rings/integer.pyx (starting at line 6141)</p>

<pre><code>    Return ``True`` if this integer is a fundamental discriminant.

    .. NOTE::

        A fundamental discriminant is a discrimimant, not 0 or 1 and not a square multiple of a smaller discriminant.

    EXAMPLES::

        sage: (-4).is_fundamental_discriminant()                                    # needs sage.libs.pari
        True
        sage: (-12).is_fundamental_discriminant()
        False
        sage: 101.is_fundamental_discriminant()                                     # needs sage.libs.pari
        True

    TESTS::

        sage: 0.is_fundamental_discriminant()
        False
        sage: 1.is_fundamental_discriminant()
        False
        sage: len([D for D in srange(-100,100)                                      # needs sage.libs.pari
        ....:      if D.is_fundamental_discriminant()])
        61
</code></pre>
</div>


                            </div>
                            <div id="Integer.sqrtrem" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sqrtrem</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.sqrtrem"></a>
    
            <div class="docstring"><p><a href="#Integer.sqrtrem">Integer.sqrtrem</a>(self)
File: sage/rings/integer.pyx (starting at line 6317)</p>

<pre><code>    Return `(s, r)` where `s` is the integer square root of ``self`` and
    `r` is the remainder such that `\text{self} = s^2 + r`.
    Raises `ValueError` if ``self`` is negative.

    EXAMPLES::

        sage: 25.sqrtrem()
        (5, 0)
        sage: 27.sqrtrem()
        (5, 2)
        sage: 0.sqrtrem()
        (0, 0)

    ::

        sage: Integer(-102).sqrtrem()
        Traceback (most recent call last):
        ...
        ValueError: square root of negative integer not defined.
</code></pre>
</div>


                            </div>
                            <div id="Integer.isqrt" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isqrt</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.isqrt"></a>
    
            <div class="docstring"><p><a href="#Integer.isqrt">Integer.isqrt</a>(self)
File: sage/rings/integer.pyx (starting at line 6347)</p>

<pre><code>    Return the integer floor of the square root of ``self``, or raises an
    `ValueError` if ``self`` is negative.

    EXAMPLES::

        sage: a = Integer(5)
        sage: a.isqrt()
        2

    ::

        sage: Integer(-102).isqrt()
        Traceback (most recent call last):
        ...
        ValueError: square root of negative integer not defined.
</code></pre>
</div>


                            </div>
                            <div id="Integer.sqrt" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sqrt</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.sqrt"></a>
    
            <div class="docstring"><p><a href="#Integer.sqrt">Integer.sqrt</a>(self, prec=None, extend=True, all=False)
File: sage/rings/integer.pyx (starting at line 6376)</p>

<pre><code>    The square root function.

    INPUT:

    -  ``prec`` -- integer (default: ``None``): if ``None``, return an exact
       square root; otherwise return a numerical square root, to the
       given bits of precision.

    -  ``extend`` -- bool (default: ``True``); if ``True``, return a
       square root in an extension ring, if necessary. Otherwise, raise a
       `ValueError` if the square is not in the base ring. Ignored if ``prec``
       is not ``None``.

    -  ``all`` - bool (default: ``False``); if ``True``, return all
       square roots of ``self`` (a list of length 0, 1, or 2).

    EXAMPLES::

        sage: Integer(144).sqrt()
        12
        sage: sqrt(Integer(144))
        12
        sage: Integer(102).sqrt()                                                   # needs sage.symbolic
        sqrt(102)

    ::

        sage: n = 2
        sage: n.sqrt(all=True)                                                      # needs sage.symbolic
        [sqrt(2), -sqrt(2)]
        sage: n.sqrt(prec=10)                                                       # needs sage.rings.real_mpfr
        1.4
        sage: n.sqrt(prec=100)                                                      # needs sage.rings.real_mpfr
        1.4142135623730950488016887242
        sage: n.sqrt(prec=100, all=True)                                            # needs sage.rings.real_mpfr
        [1.4142135623730950488016887242, -1.4142135623730950488016887242]
        sage: n.sqrt(extend=False)
        Traceback (most recent call last):
        ...
        ArithmeticError: square root of 2 is not an integer
        sage: (-1).sqrt(extend=False)
        Traceback (most recent call last):
        ...
        ArithmeticError: square root of -1 is not an integer
        sage: Integer(144).sqrt(all=True)
        [12, -12]
        sage: Integer(0).sqrt(all=True)
        [0]

    TESTS::

        sage: type(5.sqrt())                                                        # needs sage.symbolic
        &lt;class 'sage.symbolic.expression.Expression'&gt;
        sage: type(5.sqrt(prec=53))                                                 # needs sage.rings.real_mpfr
        &lt;class 'sage.rings.real_mpfr.RealNumber'&gt;
        sage: type((-5).sqrt(prec=53))                                              # needs sage.rings.real_mpfr
        &lt;class 'sage.rings.complex_mpfr.ComplexNumber'&gt;
        sage: type(0.sqrt(prec=53))                                                 # needs sage.rings.real_mpfr
        &lt;class 'sage.rings.real_mpfr.RealNumber'&gt;

    Check that :trac:`9466` and :trac:`26509` are fixed::

        sage: 3.sqrt(extend=False, all=True)
        []
        sage: (-1).sqrt(extend=False, all=True)
        []
</code></pre>
</div>


                            </div>
                            <div id="Integer.xgcd" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">xgcd</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.xgcd"></a>
    
            <div class="docstring"><p><a href="#Integer.xgcd">Integer.xgcd</a>(self, Integer n)
File: sage/rings/integer.pyx (starting at line 6478)</p>

<pre><code>    Return the extended gcd of this element and ``n``.

    INPUT:

    - ``n`` -- an integer

    OUTPUT:

    A triple ``(g, s, t)`` such that ``g`` is the non-negative gcd of
    ``self`` and ``n``, and ``s`` and ``t`` are cofactors satisfying the
    Bezout identity

    .. MATH::

        g = s \cdot \mathrm{self} + t \cdot n.

    .. NOTE::

        There is no guarantee that the cofactors will be minimal. If you
        need the cofactors to be minimal use `_xgcd()`. Also, using
        `_xgcd()` directly might be faster in some cases, see
        :trac:`13628`.

    EXAMPLES::

        sage: 6.xgcd(4)
        (2, 1, -1)
</code></pre>
</div>


                            </div>
                            <div id="Integer.inverse_of_unit" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">inverse_of_unit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.inverse_of_unit"></a>
    
            <div class="docstring"><p><a href="#Integer.inverse_of_unit">Integer.inverse_of_unit</a>(self)
File: sage/rings/integer.pyx (starting at line 6853)</p>

<pre><code>    Return inverse of ``self`` if ``self`` is a unit in the integers, i.e.,
    ``self`` is `-1` or `1`. Otherwise, raise a `ZeroDivisionError`.

    EXAMPLES::

        sage: (1).inverse_of_unit()
        1
        sage: (-1).inverse_of_unit()
        -1
        sage: 5.inverse_of_unit()
        Traceback (most recent call last):
        ...
        ArithmeticError: inverse does not exist
        sage: 0.inverse_of_unit()
        Traceback (most recent call last):
        ...
        ArithmeticError: inverse does not exist
</code></pre>
</div>


                            </div>
                            <div id="Integer.inverse_mod" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">inverse_mod</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.inverse_mod"></a>
    
            <div class="docstring"><p><a href="#Integer.inverse_mod">Integer.inverse_mod</a>(self, n)
File: sage/rings/integer.pyx (starting at line 6878)</p>

<pre><code>    Return the inverse of ``self`` modulo `n`, if this inverse exists.

    Otherwise, raise a `ZeroDivisionError` exception.

    INPUT:

    -  ``self`` - Integer

    -  ``n`` - Integer, or ideal of integer ring

    OUTPUT:

    -  ``x`` - Integer such that x\*self = 1 (mod m), or
       raises ZeroDivisionError.

    IMPLEMENTATION:

    Call the ``mpz_invert`` GMP library function.

    EXAMPLES::

        sage: a = Integer(189)
        sage: a.inverse_mod(10000)
        4709
        sage: a.inverse_mod(-10000)
        4709
        sage: a.inverse_mod(1890)
        Traceback (most recent call last):
        ...
        ZeroDivisionError: inverse of Mod(189, 1890) does not exist
        sage: a = Integer(19)**100000  # long time
        sage: c = a.inverse_mod(a*a)   # long time
        Traceback (most recent call last):
        ...
        ZeroDivisionError: inverse of Mod(..., ...) does not exist

    We check that :trac:`10625` is fixed::

        sage: ZZ(2).inverse_mod(ZZ.ideal(3))
        2

    We check that :trac:`9955` is fixed::

        sage: Rational(3) % Rational(-1)
        0
</code></pre>
</div>


                            </div>
                            <div id="Integer.crt" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">crt</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.crt"></a>
    
            <div class="docstring"><p><a href="#Integer.crt">Integer.crt</a>(self, y, m, n)
File: sage/rings/integer.pyx (starting at line 6940)</p>

<pre><code>    Return the unique integer between `0` and `mn` that is congruent to
    the integer modulo `m` and to `y` modulo `n`. We assume that `m` and
    `n` are coprime.

    EXAMPLES::

        sage: n = 17
        sage: m = n.crt(5, 23, 11); m
        247
        sage: m%23
        17
        sage: m%11
        5
</code></pre>
</div>


                            </div>
                            <div id="Integer.test_bit" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">test_bit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.test_bit"></a>
    
            <div class="docstring"><p><a href="#Integer.test_bit">Integer.test_bit</a>(self, long index)
File: sage/rings/integer.pyx (starting at line 6965)</p>

<pre><code>    Return the bit at ``index``.

    If the index is negative, returns 0.

    Although internally a sign-magnitude representation is used
    for integers, this method pretends to use a two's complement
    representation.  This is illustrated with a negative integer
    below.

    EXAMPLES::

        sage: w = 6
        sage: w.str(2)
        '110'
        sage: w.test_bit(2)
        1
        sage: w.test_bit(-1)
        0
        sage: x = -20
        sage: x.str(2)
        '-10100'
        sage: x.test_bit(4)
        0
        sage: x.test_bit(5)
        1
        sage: x.test_bit(6)
        1
</code></pre>
</div>


                            </div>
                            <div id="Integer.popcount" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">popcount</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.popcount"></a>
    
            <div class="docstring"><p><a href="#Integer.popcount">Integer.popcount</a>(self)
File: sage/rings/integer.pyx (starting at line 7000)</p>

<pre><code>    Return the number of 1 bits in the binary representation.
    If ``self`` &lt; 0, we return Infinity.

    EXAMPLES::

        sage: n = 123
        sage: n.str(2)
        '1111011'
        sage: n.popcount()
        6

        sage: n = -17
        sage: n.popcount()
        +Infinity
</code></pre>
</div>


                            </div>
                            <div id="Integer.conjugate" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">conjugate</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.conjugate"></a>
    
            <div class="docstring"><p><a href="#Integer.conjugate">Integer.conjugate</a>(self)
File: sage/rings/integer.pyx (starting at line 7022)</p>

<pre><code>    Return the complex conjugate of this integer, which is the
    integer itself.

    EXAMPLES::

        sage: n = 205
        sage: n.conjugate()
        205
</code></pre>
</div>


                            </div>
                            <div id="Integer.binomial" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">binomial</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.binomial"></a>
    
            <div class="docstring"><p><a href="#Integer.binomial">Integer.binomial</a>(self, m, algorithm=u'gmp')
File: sage/rings/integer.pyx (starting at line 7035)</p>

<pre><code>    Return the binomial coefficient "``self`` choose ``m``".

    INPUT:

    - ``m`` -- an integer

    - ``algorithm`` -- ``'gmp'`` (default), ``'mpir'`` (an alias for
      ``gmp``), or ``'pari'``; ``'gmp'`` is faster for small ``m``,
      and ``'pari'`` tends to be faster for large ``m``

    OUTPUT: integer

    EXAMPLES::

        sage: 10.binomial(2)
        45
        sage: 10.binomial(2, algorithm='pari')                                      # needs sage.libs.pari
        45
        sage: 10.binomial(-2)
        0
        sage: (-2).binomial(3)
        -4
        sage: (-3).binomial(0)
        1

    The argument ``m`` or (``self - m``) must fit into an ``unsigned long``::

        sage: (2**256).binomial(2**256)
        1
        sage: (2**256).binomial(2**256 - 1)
        115792089237316195423570985008687907853269984665640564039457584007913129639936
        sage: (2**256).binomial(2**128)
        Traceback (most recent call last):
        ...
        OverflowError: m must fit in an unsigned long

    TESTS::

        sage: 0.binomial(0)
        1
        sage: 0.binomial(1)
        0
        sage: 0.binomial(-1)
        0
        sage: 13.binomial(2r)
        78

    Check that it can be interrupted (:trac:`17852`)::

        sage: alarm(0.5); (2^100).binomial(2^22, algorithm='mpir')
        Traceback (most recent call last):
        ...
        AlarmInterrupt

    For PARI, we try 10 interrupts with increasing intervals to
    check for reliable interrupting, see :trac:`18919`::

        sage: from cysignals import AlarmInterrupt
        sage: for i in [1..10]:             # long time (5s)                        # needs sage.libs.pari
        ....:     try:
        ....:         alarm(i/11)
        ....:         (2^100).binomial(2^22, algorithm='pari')
        ....:     except AlarmInterrupt:
        ....:         pass
        doctest:...: RuntimeWarning: cypari2 leaked ... bytes on the PARI stack...
</code></pre>
</div>


                            </div>
                            <div id="Integer.prime_factors" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prime_factors</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.prime_factors"></a>
    
            <div class="docstring"><p><a href="#Integer.prime_divisors">Integer.prime_divisors</a>(self, <em>args, *</em>kwds)
File: sage/rings/integer.pyx (starting at line 2957)</p>

<pre><code>    Return the prime divisors of this integer, sorted in increasing order.

    If this integer is negative, we do *not* include `-1` among
    its prime divisors, since `-1` is not a prime number.

    INPUT:

    - ``limit`` -- (integer, optional keyword argument)
      Return only prime divisors up to this bound, and the factorization
      is done by checking primes up to ``limit`` using trial division.

    Any additional arguments are passed on to the `factor()` method.

    EXAMPLES::

        sage: a = 1; a.prime_divisors()
        []
        sage: a = 100; a.prime_divisors()
        [2, 5]
        sage: a = -100; a.prime_divisors()
        [2, 5]
        sage: a = 2004; a.prime_divisors()
        [2, 3, 167]

    Setting the optional ``limit`` argument works as expected::

        sage: a = 10^100 + 1
        sage: a.prime_divisors()                                                    # needs sage.libs.pari
        [73, 137, 401, 1201, 1601, 1676321, 5964848081,
         129694419029057750551385771184564274499075700947656757821537291527196801]
        sage: a.prime_divisors(limit=10^3)
        [73, 137, 401]
        sage: a.prime_divisors(limit=10^7)
        [73, 137, 401, 1201, 1601, 1676321]
</code></pre>
</div>


                            </div>
                            <div id="Integer.ord" class="classattr">
                                <div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ord</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">unknown</span></span><span class="return-annotation">):</span></span>

        
    </div>
    <a class="headerlink" href="#Integer.ord"></a>
    
            <div class="docstring"><p><a href="#Integer.valuation">Integer.valuation</a>(self, p)
File: sage/rings/integer.pyx (starting at line 4227)</p>

<pre><code>    Return the p-adic valuation of ``self``.

    INPUT:

    -  ``p`` - an integer at least 2.

    EXAMPLES::

        sage: n = 60
        sage: n.valuation(2)
        2
        sage: n.valuation(3)
        1
        sage: n.valuation(7)
        0
        sage: n.valuation(1)
        Traceback (most recent call last):
        ...
        ValueError: You can only compute the valuation with respect to a integer larger than 1.

    We do not require that ``p`` is a prime::

        sage: (2^11).valuation(4)
        5
</code></pre>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>sage.structure.element.EuclideanDomainElement</dt>
                                <dd id="Integer.degree" class="function">degree</dd>
                <dd id="Integer.leading_coefficient" class="function">leading_coefficient</dd>

            </div>
            <div><dt>sage.structure.element.PrincipalIdealDomainElement</dt>
                                <dd id="Integer.gcd" class="function">gcd</dd>
                <dd id="Integer.lcm" class="function">lcm</dd>

            </div>
            <div><dt>sage.structure.element.IntegralDomainElement</dt>
                                <dd id="Integer.is_nilpotent" class="function">is_nilpotent</dd>

            </div>
            <div><dt>sage.structure.element.CommutativeRingElement</dt>
                                <dd id="Integer.mod" class="function">mod</dd>

            </div>
            <div><dt>sage.structure.element.RingElement</dt>
                                <dd id="Integer.powers" class="function">powers</dd>
                <dd id="Integer.abs" class="function">abs</dd>

            </div>
            <div><dt>sage.structure.element.ModuleElement</dt>
                                <dd id="Integer.order" class="function">order</dd>

            </div>
            <div><dt>sage.structure.element.Element</dt>
                                <dd id="Integer.base_extend" class="function">base_extend</dd>
                <dd id="Integer.base_ring" class="function">base_ring</dd>
                <dd id="Integer.category" class="function">category</dd>
                <dd id="Integer.parent" class="function">parent</dd>
                <dd id="Integer.subs" class="function">subs</dd>
                <dd id="Integer.numerical_approx" class="function">numerical_approx</dd>
                <dd id="Integer.n" class="function">n</dd>
                <dd id="Integer.substitute" class="function">substitute</dd>
                <dd id="Integer.is_zero" class="function">is_zero</dd>

            </div>
            <div><dt>sage.structure.sage_object.SageObject</dt>
                                <dd id="Integer.rename" class="function">rename</dd>
                <dd id="Integer.reset_name" class="function">reset_name</dd>
                <dd id="Integer.get_custom_name" class="function">get_custom_name</dd>
                <dd id="Integer.save" class="function">save</dd>
                <dd id="Integer.dump" class="function">dump</dd>
                <dd id="Integer.dumps" class="function">dumps</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="SR">
                    <div class="attr variable">
            <span class="name">SR</span>        =
<span class="default_value">Symbolic Ring</span>

        
    </div>
    <a class="headerlink" href="#SR"></a>
    
    

                </section>
                <section id="matrix_class">
                    <div class="attr variable">
            <span class="name">matrix_class</span>        =
<span class="default_value">&lt;class &#39;sage.matrix.matrix0.Matrix&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#matrix_class"></a>
    
    

                </section>
                <section id="vector_class">
                    <div class="attr variable">
            <span class="name">vector_class</span>        =
<span class="default_value">&lt;class &#39;sage.structure.element.Vector&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#vector_class"></a>
    
    

                </section>
                <section id="ndarray_mat">
                            <input id="ndarray_mat-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ndarray_mat</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">mat</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ndarray_mat-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ndarray_mat"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ndarray_mat-20"><a href="#ndarray_mat-20"><span class="linenos">20</span></a><span class="k">def</span> <span class="nf">ndarray_mat</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ndarray_mat-21"><a href="#ndarray_mat-21"><span class="linenos">21</span></a>    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
</span><span id="ndarray_mat-22"><a href="#ndarray_mat-22"><span class="linenos">22</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
</span><span id="ndarray_mat-23"><a href="#ndarray_mat-23"><span class="linenos">23</span></a>            <span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span>
</span><span id="ndarray_mat-24"><a href="#ndarray_mat-24"><span class="linenos">24</span></a>            <span class="n">category</span><span class="o">=</span><span class="ne">PendingDeprecationWarning</span>
</span><span id="ndarray_mat-25"><a href="#ndarray_mat-25"><span class="linenos">25</span></a>        <span class="p">)</span>
</span><span id="ndarray_mat-26"><a href="#ndarray_mat-26"><span class="linenos">26</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="apply_matrix_func">
                            <input id="apply_matrix_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply_matrix_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span>, </span><span class="param"><span class="n">numpy_func</span>, </span><span class="param"><span class="n">sage_func</span>, </span><span class="param"><span class="n">expected_shape</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="apply_matrix_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#apply_matrix_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="apply_matrix_func-44"><a href="#apply_matrix_func-44"><span class="linenos">44</span></a><span class="k">def</span> <span class="nf">apply_matrix_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">numpy_func</span><span class="p">,</span> <span class="n">sage_func</span><span class="p">,</span> <span class="n">expected_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="apply_matrix_func-45"><a href="#apply_matrix_func-45"><span class="linenos">45</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="apply_matrix_func-46"><a href="#apply_matrix_func-46"><span class="linenos">46</span></a>        <span class="k">return</span> <span class="n">numpy_func</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="apply_matrix_func-47"><a href="#apply_matrix_func-47"><span class="linenos">47</span></a>
</span><span id="apply_matrix_func-48"><a href="#apply_matrix_func-48"><span class="linenos">48</span></a>    <span class="k">return</span> <span class="n">sage_matrix_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">sage_func</span><span class="p">,</span> <span class="n">expected_shape</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="sage_matrix_func">
                            <input id="sage_matrix_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sage_matrix_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span>, </span><span class="param"><span class="n">sage_func</span>, </span><span class="param"><span class="n">expected_shape</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sage_matrix_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sage_matrix_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sage_matrix_func-50"><a href="#sage_matrix_func-50"><span class="linenos">50</span></a><span class="k">def</span> <span class="nf">sage_matrix_func</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">sage_func</span><span class="p">,</span> <span class="n">expected_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="sage_matrix_func-51"><a href="#sage_matrix_func-51"><span class="linenos">51</span></a>    <span class="k">if</span> <span class="n">expected_shape</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="sage_matrix_func-52"><a href="#sage_matrix_func-52"><span class="linenos">52</span></a>            <span class="n">expected_shape</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span>
</span><span id="sage_matrix_func-53"><a href="#sage_matrix_func-53"><span class="linenos">53</span></a>
</span><span id="sage_matrix_func-54"><a href="#sage_matrix_func-54"><span class="linenos">54</span></a>    <span class="n">mat_flat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]))</span>
</span><span id="sage_matrix_func-55"><a href="#sage_matrix_func-55"><span class="linenos">55</span></a>    <span class="n">mat_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">sage_func</span><span class="p">(</span><span class="n">sage_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span>
</span><span id="sage_matrix_func-56"><a href="#sage_matrix_func-56"><span class="linenos">56</span></a>               <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">mat_flat</span><span class="p">]</span>
</span><span id="sage_matrix_func-57"><a href="#sage_matrix_func-57"><span class="linenos">57</span></a>
</span><span id="sage_matrix_func-58"><a href="#sage_matrix_func-58"><span class="linenos">58</span></a>    <span class="k">return</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">mat_res</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;O&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">expected_shape</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="sage_vector_list">
                            <input id="sage_vector_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sage_vector_list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">v</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sage_vector_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sage_vector_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sage_vector_list-60"><a href="#sage_vector_list-60"><span class="linenos">60</span></a><span class="k">def</span> <span class="nf">sage_vector_list</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
</span><span id="sage_vector_list-61"><a href="#sage_vector_list-61"><span class="linenos">61</span></a>    <span class="n">v_flat</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</span><span id="sage_vector_list-62"><a href="#sage_vector_list-62"><span class="linenos">62</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">sage_vector</span><span class="p">(</span><span class="n">vec</span><span class="p">)</span> <span class="k">for</span> <span class="n">vec</span> <span class="ow">in</span> <span class="n">v_flat</span><span class="p">]</span>
</span></pre></div>


    

                </section>
                <section id="sage_matrix_list">
                            <input id="sage_matrix_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sage_matrix_list</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sage_matrix_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sage_matrix_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sage_matrix_list-64"><a href="#sage_matrix_list-64"><span class="linenos">64</span></a><span class="k">def</span> <span class="nf">sage_matrix_list</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="sage_matrix_list-65"><a href="#sage_matrix_list-65"><span class="linenos">65</span></a>    <span class="n">mat_flat</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
</span><span id="sage_matrix_list-66"><a href="#sage_matrix_list-66"><span class="linenos">66</span></a>    <span class="k">return</span> <span class="p">[</span><span class="n">sage_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">mat_flat</span><span class="p">]</span>
</span></pre></div>


    

                </section>
                <section id="guess_base_ring">
                            <input id="guess_base_ring-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">guess_base_ring</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">arr</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="guess_base_ring-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#guess_base_ring"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="guess_base_ring-68"><a href="#guess_base_ring-68"><span class="linenos">68</span></a><span class="k">def</span> <span class="nf">guess_base_ring</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="guess_base_ring-69"><a href="#guess_base_ring-69"><span class="linenos">69</span></a>    <span class="k">return</span> <span class="n">sage_vector</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
</span></pre></div>


    

                </section>
                <section id="change_base_ring">
                            <input id="change_base_ring-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_base_ring</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">arr</span>, </span><span class="param"><span class="n">base_ring</span>, </span><span class="param"><span class="n">rational_approx</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="change_base_ring-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#change_base_ring"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="change_base_ring-71"><a href="#change_base_ring-71"><span class="linenos">71</span></a><span class="k">def</span> <span class="nf">change_base_ring</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span> <span class="n">rational_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="change_base_ring-72"><a href="#change_base_ring-72"><span class="linenos">72</span></a>    <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="change_base_ring-73"><a href="#change_base_ring-73"><span class="linenos">73</span></a>        <span class="k">return</span> <span class="n">arr</span>
</span><span id="change_base_ring-74"><a href="#change_base_ring-74"><span class="linenos">74</span></a>
</span><span id="change_base_ring-75"><a href="#change_base_ring-75"><span class="linenos">75</span></a>    <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</span><span id="change_base_ring-76"><a href="#change_base_ring-76"><span class="linenos">76</span></a>
</span><span id="change_base_ring-77"><a href="#change_base_ring-77"><span class="linenos">77</span></a>    <span class="n">ring_convert</span> <span class="o">=</span> <span class="n">base_ring</span>
</span><span id="change_base_ring-78"><a href="#change_base_ring-78"><span class="linenos">78</span></a>    <span class="k">if</span> <span class="n">rational_approx</span><span class="p">:</span>
</span><span id="change_base_ring-79"><a href="#change_base_ring-79"><span class="linenos">79</span></a>        <span class="n">ring_convert</span> <span class="o">=</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">base_ring</span><span class="p">(</span><span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">QQ</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</span><span id="change_base_ring-80"><a href="#change_base_ring-80"><span class="linenos">80</span></a>
</span><span id="change_base_ring-81"><a href="#change_base_ring-81"><span class="linenos">81</span></a>    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
</span><span id="change_base_ring-82"><a href="#change_base_ring-82"><span class="linenos">82</span></a>        <span class="k">return</span> <span class="n">ring_convert</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="change_base_ring-83"><a href="#change_base_ring-83"><span class="linenos">83</span></a>
</span><span id="change_base_ring-84"><a href="#change_base_ring-84"><span class="linenos">84</span></a>    <span class="k">return</span> <span class="n">_vectorize</span><span class="p">(</span><span class="n">ring_convert</span><span class="p">)(</span><span class="n">arr</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="invert">
                            <input id="invert-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">invert</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="invert-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#invert"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="invert-86"><a href="#invert-86"><span class="linenos">86</span></a><span class="k">def</span> <span class="nf">invert</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="invert-87"><a href="#invert-87"><span class="linenos">87</span></a>    <span class="k">return</span> <span class="n">apply_matrix_func</span><span class="p">(</span>
</span><span id="invert-88"><a href="#invert-88"><span class="linenos">88</span></a>        <span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">M</span> <span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
</span><span id="invert-89"><a href="#invert-89"><span class="linenos">89</span></a>    <span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="kernel">
                            <input id="kernel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">kernel</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">A</span>,</span><span class="param">	<span class="n">assume_full_rank</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">matching_rank</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">with_dimensions</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="n">with_loc</span><span class="o">=</span><span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="kernel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#kernel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="kernel-91"><a href="#kernel-91"><span class="linenos"> 91</span></a><span class="k">def</span> <span class="nf">kernel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">assume_full_rank</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">matching_rank</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="kernel-92"><a href="#kernel-92"><span class="linenos"> 92</span></a>           <span class="n">with_dimensions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">with_loc</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="kernel-93"><a href="#kernel-93"><span class="linenos"> 93</span></a>
</span><span id="kernel-94"><a href="#kernel-94"><span class="linenos"> 94</span></a>    <span class="k">if</span> <span class="n">assume_full_rank</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">matching_rank</span><span class="p">:</span>
</span><span id="kernel-95"><a href="#kernel-95"><span class="linenos"> 95</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;matching_rank must be True if assume_full_rank is True&quot;</span><span class="p">)</span>
</span><span id="kernel-96"><a href="#kernel-96"><span class="linenos"> 96</span></a>
</span><span id="kernel-97"><a href="#kernel-97"><span class="linenos"> 97</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="kernel-98"><a href="#kernel-98"><span class="linenos"> 98</span></a>        <span class="k">return</span> <span class="n">numerical</span><span class="o">.</span><span class="n">svd_kernel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">assume_full_rank</span><span class="o">=</span><span class="n">assume_full_rank</span><span class="p">,</span>
</span><span id="kernel-99"><a href="#kernel-99"><span class="linenos"> 99</span></a>                                    <span class="n">matching_rank</span><span class="o">=</span><span class="n">matching_rank</span><span class="p">,</span>
</span><span id="kernel-100"><a href="#kernel-100"><span class="linenos">100</span></a>                                    <span class="n">with_dimensions</span><span class="o">=</span><span class="n">with_dimensions</span><span class="p">,</span>
</span><span id="kernel-101"><a href="#kernel-101"><span class="linenos">101</span></a>                                    <span class="n">with_loc</span><span class="o">=</span><span class="n">with_loc</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="kernel-102"><a href="#kernel-102"><span class="linenos">102</span></a>
</span><span id="kernel-103"><a href="#kernel-103"><span class="linenos">103</span></a>    <span class="n">A_arr</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
</span><span id="kernel-104"><a href="#kernel-104"><span class="linenos">104</span></a>    <span class="n">orig_shape</span> <span class="o">=</span> <span class="n">A_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="kernel-105"><a href="#kernel-105"><span class="linenos">105</span></a>
</span><span id="kernel-106"><a href="#kernel-106"><span class="linenos">106</span></a>    <span class="n">matrix_list</span> <span class="o">=</span> <span class="n">sage_matrix_list</span><span class="p">(</span><span class="n">A_arr</span><span class="p">)</span>
</span><span id="kernel-107"><a href="#kernel-107"><span class="linenos">107</span></a>
</span><span id="kernel-108"><a href="#kernel-108"><span class="linenos">108</span></a>    <span class="c1">#for stupid sage/numpy compatibility reasons, DON&#39;T transpose</span>
</span><span id="kernel-109"><a href="#kernel-109"><span class="linenos">109</span></a>    <span class="c1">#these until later</span>
</span><span id="kernel-110"><a href="#kernel-110"><span class="linenos">110</span></a>    <span class="n">kernel_mats</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="kernel-111"><a href="#kernel-111"><span class="linenos">111</span></a>        <span class="n">M</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">()</span>
</span><span id="kernel-112"><a href="#kernel-112"><span class="linenos">112</span></a>        <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">matrix_list</span>
</span><span id="kernel-113"><a href="#kernel-113"><span class="linenos">113</span></a>    <span class="p">]</span>
</span><span id="kernel-114"><a href="#kernel-114"><span class="linenos">114</span></a>    <span class="k">try</span><span class="p">:</span>
</span><span id="kernel-115"><a href="#kernel-115"><span class="linenos">115</span></a>        <span class="n">_</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">kernel_mats</span><span class="p">)</span>
</span><span id="kernel-116"><a href="#kernel-116"><span class="linenos">116</span></a>        <span class="n">actual_ranks_match</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="kernel-117"><a href="#kernel-117"><span class="linenos">117</span></a>    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
</span><span id="kernel-118"><a href="#kernel-118"><span class="linenos">118</span></a>        <span class="n">actual_ranks_match</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="kernel-119"><a href="#kernel-119"><span class="linenos">119</span></a>
</span><span id="kernel-120"><a href="#kernel-120"><span class="linenos">120</span></a>    <span class="k">if</span> <span class="n">matching_rank</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">actual_ranks_match</span><span class="p">:</span>
</span><span id="kernel-121"><a href="#kernel-121"><span class="linenos">121</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="kernel-122"><a href="#kernel-122"><span class="linenos">122</span></a>                <span class="s2">&quot;Input matrices do not have matching rank. Try calling &quot;</span>
</span><span id="kernel-123"><a href="#kernel-123"><span class="linenos">123</span></a>                <span class="s2">&quot;this function with matching_rank=False.&quot;</span>
</span><span id="kernel-124"><a href="#kernel-124"><span class="linenos">124</span></a>            <span class="p">)</span>
</span><span id="kernel-125"><a href="#kernel-125"><span class="linenos">125</span></a>
</span><span id="kernel-126"><a href="#kernel-126"><span class="linenos">126</span></a>    <span class="n">matrix_arr</span> <span class="o">=</span> <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">kernel_mats</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span>
</span><span id="kernel-127"><a href="#kernel-127"><span class="linenos">127</span></a>    <span class="k">if</span> <span class="n">matching_rank</span><span class="p">:</span>
</span><span id="kernel-128"><a href="#kernel-128"><span class="linenos">128</span></a>        <span class="n">matrix_arr</span> <span class="o">=</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="kernel-129"><a href="#kernel-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig_shape</span> <span class="o">+</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>
</span><span id="kernel-130"><a href="#kernel-130"><span class="linenos">130</span></a>
</span><span id="kernel-131"><a href="#kernel-131"><span class="linenos">131</span></a>    <span class="n">kernel_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="kernel-132"><a href="#kernel-132"><span class="linenos">132</span></a>        <span class="n">M</span><span class="o">.</span><span class="n">dimensions</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">kernel_mats</span>
</span><span id="kernel-133"><a href="#kernel-133"><span class="linenos">133</span></a>    <span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig_shape</span><span class="p">)</span>
</span><span id="kernel-134"><a href="#kernel-134"><span class="linenos">134</span></a>
</span><span id="kernel-135"><a href="#kernel-135"><span class="linenos">135</span></a>    <span class="n">matrix_arr</span> <span class="o">=</span> <span class="n">matrix_arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">orig_shape</span><span class="p">)</span>
</span><span id="kernel-136"><a href="#kernel-136"><span class="linenos">136</span></a>
</span><span id="kernel-137"><a href="#kernel-137"><span class="linenos">137</span></a>    <span class="n">possible_dims</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">kernel_dims</span><span class="p">)</span>
</span><span id="kernel-138"><a href="#kernel-138"><span class="linenos">138</span></a>    <span class="n">kernel_bases</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="kernel-139"><a href="#kernel-139"><span class="linenos">139</span></a>    <span class="n">kernel_dim_loc</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="kernel-140"><a href="#kernel-140"><span class="linenos">140</span></a>
</span><span id="kernel-141"><a href="#kernel-141"><span class="linenos">141</span></a>    <span class="k">for</span> <span class="n">kernel_dim</span> <span class="ow">in</span> <span class="n">possible_dims</span><span class="p">:</span>
</span><span id="kernel-142"><a href="#kernel-142"><span class="linenos">142</span></a>        <span class="n">where_dim</span> <span class="o">=</span> <span class="p">(</span><span class="n">kernel_dims</span> <span class="o">==</span> <span class="n">kernel_dim</span><span class="p">)</span>
</span><span id="kernel-143"><a href="#kernel-143"><span class="linenos">143</span></a>        <span class="n">kernel_bases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
</span><span id="kernel-144"><a href="#kernel-144"><span class="linenos">144</span></a>            <span class="n">ndarray_mat</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">matrix_arr</span><span class="p">[</span><span class="n">where_dim</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;O&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="kernel-145"><a href="#kernel-145"><span class="linenos">145</span></a>        <span class="p">)</span>
</span><span id="kernel-146"><a href="#kernel-146"><span class="linenos">146</span></a>        <span class="n">kernel_dim_loc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">where_dim</span><span class="p">)</span>
</span><span id="kernel-147"><a href="#kernel-147"><span class="linenos">147</span></a>
</span><span id="kernel-148"><a href="#kernel-148"><span class="linenos">148</span></a>    <span class="c1"># flat is better than nested, still</span>
</span><span id="kernel-149"><a href="#kernel-149"><span class="linenos">149</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">with_loc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_dimensions</span><span class="p">:</span>
</span><span id="kernel-150"><a href="#kernel-150"><span class="linenos">150</span></a>        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">)</span>
</span><span id="kernel-151"><a href="#kernel-151"><span class="linenos">151</span></a>
</span><span id="kernel-152"><a href="#kernel-152"><span class="linenos">152</span></a>    <span class="k">if</span> <span class="n">with_dimensions</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_loc</span><span class="p">:</span>
</span><span id="kernel-153"><a href="#kernel-153"><span class="linenos">153</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">possible_dims</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">))</span>
</span><span id="kernel-154"><a href="#kernel-154"><span class="linenos">154</span></a>
</span><span id="kernel-155"><a href="#kernel-155"><span class="linenos">155</span></a>    <span class="k">if</span> <span class="n">with_loc</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">with_dimensions</span><span class="p">:</span>
</span><span id="kernel-156"><a href="#kernel-156"><span class="linenos">156</span></a>        <span class="k">return</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_dim_loc</span><span class="p">))</span>
</span><span id="kernel-157"><a href="#kernel-157"><span class="linenos">157</span></a>
</span><span id="kernel-158"><a href="#kernel-158"><span class="linenos">158</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">possible_dims</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_bases</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">kernel_dim_loc</span><span class="p">))</span>
</span></pre></div>


    

                </section>
                <section id="eig">
                            <input id="eig-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eig</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="eig-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#eig"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="eig-160"><a href="#eig-160"><span class="linenos">160</span></a><span class="k">def</span> <span class="nf">eig</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="eig-161"><a href="#eig-161"><span class="linenos">161</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="eig-162"><a href="#eig-162"><span class="linenos">162</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="eig-163"><a href="#eig-163"><span class="linenos">163</span></a>
</span><span id="eig-164"><a href="#eig-164"><span class="linenos">164</span></a>    <span class="n">mat_flat</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]))</span>
</span><span id="eig-165"><a href="#eig-165"><span class="linenos">165</span></a>
</span><span id="eig-166"><a href="#eig-166"><span class="linenos">166</span></a>    <span class="n">eig_res</span> <span class="o">=</span> <span class="p">[</span><span class="n">_sage_eig</span><span class="p">(</span><span class="n">sage_matrix</span><span class="p">(</span><span class="n">mat</span><span class="p">))</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">mat_flat</span><span class="p">]</span>
</span><span id="eig-167"><a href="#eig-167"><span class="linenos">167</span></a>    <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">eig_res</span><span class="p">)</span>
</span><span id="eig-168"><a href="#eig-168"><span class="linenos">168</span></a>
</span><span id="eig-169"><a href="#eig-169"><span class="linenos">169</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">ndarray_mat</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],)),</span>
</span><span id="eig-170"><a href="#eig-170"><span class="linenos">170</span></a>            <span class="n">ndarray_mat</span><span class="p">(</span><span class="n">eigvecs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span></pre></div>


    

                </section>
                <section id="eigh">
                            <input id="eigh-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eigh</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="eigh-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#eigh"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="eigh-172"><a href="#eigh-172"><span class="linenos">172</span></a><span class="k">def</span> <span class="nf">eigh</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="eigh-173"><a href="#eigh-173"><span class="linenos">173</span></a>    <span class="k">if</span> <span class="n">types</span><span class="o">.</span><span class="n">is_linalg_type</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="eigh-174"><a href="#eigh-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span><span id="eigh-175"><a href="#eigh-175"><span class="linenos">175</span></a>
</span><span id="eigh-176"><a href="#eigh-176"><span class="linenos">176</span></a>    <span class="k">return</span> <span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="det">
                            <input id="det-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">det</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">A</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="det-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#det"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="det-178"><a href="#det-178"><span class="linenos">178</span></a><span class="k">def</span> <span class="nf">det</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
</span><span id="det-179"><a href="#det-179"><span class="linenos">179</span></a>    <span class="k">return</span> <span class="n">apply_matrix_func</span><span class="p">(</span>
</span><span id="det-180"><a href="#det-180"><span class="linenos">180</span></a>        <span class="n">A</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">M</span><span class="p">:</span> <span class="n">M</span><span class="o">.</span><span class="n">det</span><span class="p">(),</span>
</span><span id="det-181"><a href="#det-181"><span class="linenos">181</span></a>        <span class="n">expected_shape</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="det-182"><a href="#det-182"><span class="linenos">182</span></a>    <span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="real">
                            <input id="real-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">real</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">arr</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="real-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#real"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="real-184"><a href="#real-184"><span class="linenos">184</span></a><span class="k">def</span> <span class="nf">real</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="real-185"><a href="#real-185"><span class="linenos">185</span></a>    <span class="k">return</span> <span class="n">_vectorize</span><span class="p">(</span><span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">real</span><span class="p">)(</span><span class="n">arr</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="imag">
                            <input id="imag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">imag</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">arr</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="imag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#imag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="imag-187"><a href="#imag-187"><span class="linenos">187</span></a><span class="k">def</span> <span class="nf">imag</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="imag-188"><a href="#imag-188"><span class="linenos">188</span></a>    <span class="k">return</span> <span class="n">_vectorize</span><span class="p">(</span><span class="n">sage</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">imag</span><span class="p">)(</span><span class="n">arr</span><span class="p">)</span>
</span></pre></div>


    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>