<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.3.0"/>
    <title>geometry_tools.projective API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../geometry_tools.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;geometry_tools</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#ProjectiveObject">ProjectiveObject</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ProjectiveObject.__init__">ProjectiveObject</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProjectiveObject.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProjectiveObject.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProjectiveObject.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProjectiveObject.dimension">dimension</a>
                        </li>
                        <li>
                                <a class="variable" href="#ProjectiveObject.shape">shape</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.reshape">reshape</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.set">set</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.astype">astype</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.change_base_ring">change_base_ring</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.projective_coords">projective_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.affine_coords">affine_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.combine">combine</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveObject.set_ndims">set_ndims</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Point">Point</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Point.__init__">Point</a>
                        </li>
                        <li>
                                <a class="variable" href="#Point.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Point.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Point.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.in_affine_chart">in_affine_chart</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PointCollection">PointCollection</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PointCollection.__init__">PointCollection</a>
                        </li>
                        <li>
                                <a class="variable" href="#PointCollection.unit_ndims">unit_ndims</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PointPair">PointPair</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PointPair.__init__">PointPair</a>
                        </li>
                        <li>
                                <a class="variable" href="#PointPair.endpoints">endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.set_endpoints">set_endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.get_endpoints">get_endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.get_end_pair">get_end_pair</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.endpoint_affine_coords">endpoint_affine_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.endpoint_projective_coords">endpoint_projective_coords</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Polygon">Polygon</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Polygon.__init__">Polygon</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.in_standard_chart">in_standard_chart</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polygon.vertices">vertices</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polygon.edges">edges</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.get_edges">get_edges</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.get_vertices">get_vertices</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Simplex">Simplex</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Simplex.__init__">Simplex</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simplex.n">n</a>
                        </li>
                        <li>
                                <a class="function" href="#Simplex.skeleton">skeleton</a>
                        </li>
                        <li>
                                <a class="function" href="#Simplex.faces">faces</a>
                        </li>
                        <li>
                                <a class="function" href="#Simplex.edges">edges</a>
                        </li>
                        <li>
                                <a class="function" href="#Simplex.vertices">vertices</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Subspace">Subspace</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Subspace.__init__">Subspace</a>
                        </li>
                        <li>
                                <a class="variable" href="#Subspace.n">n</a>
                        </li>
                        <li>
                                <a class="function" href="#Subspace.intersect">intersect</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ConvexPolygon">ConvexPolygon</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ConvexPolygon.__init__">ConvexPolygon</a>
                        </li>
                        <li>
                                <a class="function" href="#ConvexPolygon.add_points">add_points</a>
                        </li>
                        <li>
                                <a class="function" href="#ConvexPolygon.set">set</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Transformation">Transformation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Transformation.__init__">Transformation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transformation.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transformation.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transformation.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Transformation.matrix">matrix</a>
                        </li>
                        <li>
                                <a class="function" href="#Transformation.apply">apply</a>
                        </li>
                        <li>
                                <a class="function" href="#Transformation.eigenvector">eigenvector</a>
                        </li>
                        <li>
                                <a class="function" href="#Transformation.commute">commute</a>
                        </li>
                        <li>
                                <a class="function" href="#Transformation.diagonalize">diagonalize</a>
                        </li>
                        <li>
                                <a class="function" href="#Transformation.inv">inv</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ProjectiveRepresentation">ProjectiveRepresentation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ProjectiveRepresentation.wrap_func">wrap_func</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveRepresentation.unwrap_func">unwrap_func</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveRepresentation.array_wrap_func">array_wrap_func</a>
                        </li>
                        <li>
                                <a class="function" href="#ProjectiveRepresentation.transformations">transformations</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#hyperplane_coordinate_transform">hyperplane_coordinate_transform</a>
            </li>
            <li>
                    <a class="function" href="#affine_coords">affine_coords</a>
            </li>
            <li>
                    <a class="function" href="#projective_coords">projective_coords</a>
            </li>
            <li>
                    <a class="function" href="#identity">identity</a>
            </li>
            <li>
                    <a class="function" href="#affine_linear_map">affine_linear_map</a>
            </li>
            <li>
                    <a class="function" href="#affine_translation">affine_translation</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../geometry_tools.html">geometry_tools</a><wbr>.projective    </h1>

                        <div class="docstring"><p>Work with projective space in numerical coordinates.</p>

<p>This module provides abstractions for various objects in projective
geometry (points, lines, subspaces, projective transformations) and
gives a unified framework for acting on these objects by projective
transformations.</p>

<p>The underlying field can be either real or complex (or, in principle,
any data type supported by numpy ndarrays, although this is largely
untested).</p>

<p>Most of the power of the <code><a href="">geometry_tools.projective</a></code> module comes from
the fact that it is possible to build "composite" projective objects
out of arrays of subobjects, and then act on the entire composite
object by either a single projective transformation or an array of
projective transformations.</p>

<p>This means you can largely avoid using (slow!) native python loops,
and instead rely on numpy's efficient numerical array computations.</p>

<p>For example, we can build an array of points, and act on all of those
points by a single projective transformation:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">geometry_tools</span> <span class="kn">import</span> <span class="n">projective</span>

<span class="c1"># make three points, using coordinates in a standard affine chart</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">],</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># package these points together into a single projective object</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">])</span>

<span class="c1"># get a projective transformation acting on RP^2</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">5.0</span><span class="p">]]),</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="p">(</span><span class="n">transform</span> <span class="o">@</span> <span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">()</span>
</code></pre>
</div>

<pre><code>array([[ 0.   ,  0.04 ],
       [ 0.2  ,  0.08 ],
       [ 0.1  , -0.004]])
</code></pre>

<p>Here is a more complicated (but possibly more useful) example. We can
create an array of points, and turn that into a single polygon
object. Then, we can act on that polygon object by a collection of
projective transformations to get a collection of polygons.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">geometry_tools</span> <span class="kn">import</span> <span class="n">projective</span><span class="p">,</span> <span class="n">drawtools</span>

<span class="c1"># make a polygon out of several points</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">p3</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">triangle</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Polygon</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">])</span>

<span class="c1"># make a diagonalizable projective transformation</span>
<span class="n">aff_transform</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mf">1.8</span><span class="p">]]),</span>
    <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="c1"># conjugate this transformation so that its attracting/repelling points</span>
<span class="c1"># are at (4, -2) and (4,2)</span>
<span class="n">non_aff</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
              <span class="p">[</span><span class="mf">4.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]]),</span>
    <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="n">proj_transform</span> <span class="o">=</span> <span class="n">non_aff</span> <span class="o">@</span> <span class="n">aff_transform</span> <span class="o">@</span> <span class="n">non_aff</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>

<span class="c1"># construct the cyclic group generated by this projective transformation</span>
<span class="n">rep</span> <span class="o">=</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">()</span>
<span class="n">rep</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">proj_transform</span>

<span class="c1"># get proj_transform^n for |n| &lt; 10, and apply these transformations</span>
<span class="c1"># to the triangle</span>
<span class="n">powers</span> <span class="o">=</span> <span class="n">rep</span><span class="o">.</span><span class="n">freely_reduced_elements</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">transformed_triangles</span> <span class="o">=</span> <span class="n">powers</span> <span class="o">@</span> <span class="n">triangle</span>

<span class="c1"># draw a picture of the result</span>
<span class="n">drawing</span> <span class="o">=</span> <span class="n">drawtools</span><span class="o">.</span><span class="n">ProjectiveDrawing</span><span class="p">()</span>
<span class="n">drawing</span><span class="o">.</span><span class="n">draw_polygon</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="n">drawing</span><span class="o">.</span><span class="n">draw_polygon</span><span class="p">(</span><span class="n">transformed_triangles</span><span class="p">)</span>

<span class="n">drawing</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre>
</div>

<p>This code produces the image:</p>

<p><img src="projective_triangles.png" alt="Triangles transformed by many projective transformations" /></p>
</div>

                        <input id="mod-projective-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-projective-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;Work with projective space in numerical coordinates.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">This module provides abstractions for various objects in projective</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">geometry (points, lines, subspaces, projective transformations) and</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">gives a unified framework for acting on these objects by projective</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">transformations.</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="sd">The underlying field can be either real or complex (or, in principle,</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">any data type supported by numpy ndarrays, although this is largely</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="sd">untested).</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="sd">Most of the power of the `geometry_tools.projective` module comes from</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="sd">the fact that it is possible to build &quot;composite&quot; projective objects</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="sd">out of arrays of subobjects, and then act on the entire composite</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">object by either a single projective transformation or an array of</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="sd">projective transformations.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="sd">This means you can largely avoid using (slow!) native python loops,</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="sd">and instead rely on numpy&#39;s efficient numerical array computations.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">For example, we can build an array of points, and act on all of those</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">points by a single projective transformation:</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">```python</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="sd">import numpy as np</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">from geometry_tools import projective</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a><span class="sd"># make three points, using coordinates in a standard affine chart</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">p1 = projective.Point([0, 1.0], chart_index=0)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">p2 = projective.Point([1.0, 2.0], chart_index=0)</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a><span class="sd">p3 = projective.Point([0.5, -0.1], chart_index=0)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd"># package these points together into a single projective object</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">points = projective.Point([p1, p2, p3])</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd"># get a projective transformation acting on RP^2</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">transform = projective.Transformation(</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">    np.array([[5.0, 0.0, 0.0],</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">              [0.0, 1.0, 0.0],</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a><span class="sd">              [0.0, 0.0, 1/5.0]]), column_vectors=True)</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">(transform @ points).affine_coords()</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">```</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">    array([[ 0.   ,  0.04 ],</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">           [ 0.2  ,  0.08 ],</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">           [ 0.1  , -0.004]])</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">Here is a more complicated (but possibly more useful) example. We can</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">create an array of points, and turn that into a single polygon</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd">object. Then, we can act on that polygon object by a collection of</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">projective transformations to get a collection of polygons.</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a><span class="sd">```python</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">import numpy as np</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">from geometry_tools import projective, drawtools</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd"># make a polygon out of several points</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">p1 = projective.Point([0., 0.], chart_index=0)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">p2 = projective.Point([1., 0.], chart_index=0)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">p3 = projective.Point([1., 1.], chart_index=0)</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">triangle = projective.Polygon([p1, p2, p3])</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd"># make a diagonalizable projective transformation</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">aff_transform = projective.Transformation(</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    np.array([[1.8, 0.0, 0.0],</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a><span class="sd">              [0.0, 1.0, 0.0],</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">              [0.0, 0.0, 1/1.8]]),</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    column_vectors=True</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd"># conjugate this transformation so that its attracting/repelling points</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd"># are at (4, -2) and (4,2)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">non_aff = projective.Transformation(</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    np.array([[1.0, 0.0, 1.0],</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a><span class="sd">              [4.0, 1.0, 4.0],</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">              [-2.0, 0.0, 2.0]]),</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    column_vectors=True</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">)</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">proj_transform = non_aff @ aff_transform @ non_aff.inv()</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd"># construct the cyclic group generated by this projective transformation</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">rep = projective.ProjectiveRepresentation()</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">rep[&quot;a&quot;] = proj_transform</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd"># get proj_transform^n for |n| &lt; 10, and apply these transformations</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd"># to the triangle</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd">powers = rep.freely_reduced_elements(10)</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">transformed_triangles = powers @ triangle</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd"># draw a picture of the result</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd">drawing = drawtools.ProjectiveDrawing()</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd">drawing.draw_polygon(triangle)</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd">drawing.draw_polygon(transformed_triangles)</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">drawing.show()</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">```</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">This code produces the image:</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">![Triangles transformed by many projective transformations](projective_triangles.png)</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="kn">import</span> <span class="nn">itertools</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="kn">from</span> <span class="nn">scipy.spatial</span> <span class="kn">import</span> <span class="n">ConvexHull</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">utils</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>    <span class="kn">from</span> <span class="nn">geometry_tools.utils</span> <span class="kn">import</span> <span class="n">sagewrap</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">representation</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="kn">from</span> <span class="nn">.base</span> <span class="kn">import</span> <span class="n">GeometryError</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="k">class</span> <span class="nc">ProjectiveObject</span><span class="p">:</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a>    <span class="sd">&quot;&quot;&quot;Represent some object in projective geometry (possibly a composite</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">    object).</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">    The underlying data of a projective object is stored as a numpy</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">    ndarray. The last `unit_ndims` ndims of this array describe a</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">    *single* instance of this type of object.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">    For example, a `Polygon` object has `unit_ndims` equal to 2, since</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">    a single `Polygon` is represented by an array of shape `(n,d)`,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a><span class="sd">    where `n` is the number of vertices and `d` is the dimension of</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">    the underlying vector space. So, a `Polygon` object whose</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">    underlying array has shape `(5, 6, 4, 3)` represents a 5x6 array</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">    of quadrilaterals in RP^2 (i.e. the projectivization of R^3).</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>                 <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a>        <span class="sd">&quot;&quot;&quot;Parameters</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">        -----------</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">            underyling data describing this projective object</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">        aux_data : ndarray</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">            auxiliary data describing this projective</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">            object. Auxiliary data is any data which is in principle</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">            computable from `proj_data`, but is convenient to keep as</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">            part of the object definition for transformation purposes.</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">        dual_data : ndarray</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">            data describing this projective object which transforms</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">            covariantly, i.e. as a dual vector in projective space.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a><span class="sd">        unit_ndims : int</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a><span class="sd">            number of ndims of an array representing a &quot;unit&quot; version</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a><span class="sd">            of this object. For example, an object representing a</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a><span class="sd">            single point in hyperbolic space has `unit_ndims` 1, while</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a><span class="sd">            an object representing a line segment has `unit_ndims`</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a><span class="sd">            equal to 2.</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a><span class="sd">        aux_ndims : int</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a><span class="sd">            like `unit_ndims`, but for auxiliary data.</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a><span class="sd">        dual_ndims : int</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="sd">            like `unit_ndims`, but for covariant (dual) data.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">        base_ring : object</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">            *(requires sage).* Base ring for matrix entries of the</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a><span class="sd">             underlying data for this object. This allows for exact</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">             computations in projective space (at the cost of</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">             performance) by supplying a ring that supports exact</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">             computations. The dtype of the underlying data is</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">             automatically converted to &quot;object&quot; if this is specified.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">        rational_approx : bool</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">            *(requires sage).* If base_ring is specified, coerce</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">             floating-point data to a rational approximation before</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">             converting to the specified ring. This is useful for</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">             combining computations with floating-point values with</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">             computations in algebraic number fields.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">aux_ndims</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">dual_ndims</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>    <span class="nd">@property</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>            <span class="k">return</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>            <span class="k">if</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>                <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>                    <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> expects an array with ndim at least </span><span class="si">{}</span><span class="s2">, got array of shape </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a>                    <span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a>                <span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>                <span class="p">(</span><span class="s2">&quot;Data provided to </span><span class="si">{}</span><span class="s2"> must be a numpy array&quot;</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a>            <span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>    <span class="k">def</span> <span class="nf">_assert_aux_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">):</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a>            <span class="k">return</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a>        <span class="k">if</span> <span class="n">aux_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> expects an auxiliary array with&quot;</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a>            <span class="s2">&quot; ndim at least </span><span class="si">{}</span><span class="s2">, got array of shape </span><span class="si">{}</span><span class="s2">&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>                <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span> <span class="p">)</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>    <span class="k">def</span> <span class="nf">_assert_dual_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">):</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>            <span class="k">return</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>            <span class="k">if</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>                <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> expects a dual array with&quot;</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>                <span class="s2">&quot; ndim at least </span><span class="si">{}</span><span class="s2">, got array of shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">,</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>                    <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">((</span><span class="s2">&quot;Dual data provided to </span><span class="si">{}</span><span class="s2"> must be a&quot;</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>            <span class="s2">&quot; numpy array&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="k">def</span> <span class="nf">_assert_data_consistent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">):</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>        <span class="n">proj_shape</span> <span class="o">=</span> <span class="n">aux_shape</span> <span class="o">=</span> <span class="n">dual_shape</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>            <span class="n">proj_shape</span> <span class="o">=</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">]</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>            <span class="n">aux_shape</span> <span class="o">=</span> <span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">]</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>            <span class="n">dual_shape</span> <span class="o">=</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">]</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">shape</span> <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="p">[</span><span class="n">proj_shape</span><span class="p">,</span> <span class="n">aux_shape</span><span class="p">,</span> <span class="n">dual_shape</span><span class="p">]</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>                  <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">==</span> <span class="n">shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>            <span class="k">return</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Mismatched regular/aux/dual data shapes for </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>    <span class="k">def</span> <span class="nf">_construct_from_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>        <span class="sd">&quot;&quot;&quot;if we&#39;re passed a projective object or an array of projective</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a><span class="sd">        objects, build a new one out of them</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>        <span class="n">type_error</span> <span class="o">=</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>            <span class="s2">&quot;hyp_obj is not a projective object or an iterable of &quot;</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>            <span class="s2">&quot;projective objects.&quot;</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>        <span class="p">)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyp_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>                     <span class="n">aux_data</span><span class="o">=</span><span class="n">hyp_obj</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>                     <span class="n">dual_data</span><span class="o">=</span><span class="n">hyp_obj</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>            <span class="k">return</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>            <span class="k">pass</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="n">unrolled_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hyp_obj</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unrolled_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>            <span class="k">raise</span> <span class="n">type_error</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>            <span class="n">hyp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">proj_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">unrolled_obj</span><span class="p">])</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>            <span class="n">aux_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">aux_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">unrolled_obj</span><span class="p">])</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>            <span class="n">dual_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">dual_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">unrolled_obj</span><span class="p">])</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>            <span class="k">raise</span> <span class="n">type_error</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">hyp_array</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>            <span class="n">hyp_array</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">aux_array</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>            <span class="n">aux_array</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">dual_array</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a>            <span class="n">dual_array</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyp_array</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_array</span><span class="p">,</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a>                     <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_array</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>            <span class="k">raise</span> <span class="n">type_error</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="nd">@property</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="sd">&quot;&quot;&quot;Get the shape of the ndarray of &quot;unit objects&quot; this</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">        ProjectiveObject represents.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">        Returns</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">        -------</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        tuple</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">]</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="n">old_proj_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>        <span class="n">proj_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>            <span class="n">shape</span> <span class="o">+</span> <span class="n">old_proj_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:]</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>        <span class="p">)</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>        <span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a>            <span class="n">old_aux_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a>                <span class="n">shape</span> <span class="o">+</span> <span class="n">old_aux_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">:]</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>            <span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a>        <span class="n">dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>            <span class="n">old_dual_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>                <span class="n">shape</span> <span class="o">+</span> <span class="n">old_dual_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">:]</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>            <span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>                                   <span class="n">aux_data</span><span class="p">,</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>                                   <span class="n">dual_data</span><span class="p">,</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>                                   <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>                                   <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>                                   <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a>            <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a>        <span class="sd">&quot;&quot;&quot;set the underlying data of the hyperbolic object.</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        Subclasses may override this method to give special names to</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">        portions of the underlying data.</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">        Parameters</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a><span class="sd">        ----------</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">            underyling data representing this projective object.</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">        aux_data : ndarray</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">            underyling auxiliary data for this projective object.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">        dual_data : ndarray</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">            underlying dual data for this projective object.</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">        base_ring : object</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">            *(requires sage).* Base ring for matrix entries of the</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">             underlying data for this object. This allows for exact</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">             computations in projective space (at the cost of</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">             performance) by supplying a ring that supports exact</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">             computations. The dtype of the underlying data is</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a><span class="sd">             automatically converted to &quot;object&quot; if this is specified.</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">        rational_approx : bool</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">            *(requires sage).* If base_ring is specified, coerce</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">             floating-point data to a rational approximation before</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">             converting to the specified ring. This is useful for</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">             combining computations with floating-point values with</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">             computations in algebraic number fields.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">        Raises</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">        ------</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">        EnvironmentError</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">            Raised if base_ring is specified but sage is not available</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">            for import.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>        <span class="c1">#TODO: add &quot;like&quot; and &quot;dtype&quot; to kwargs</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_dual_valid</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_aux_data</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_aux_valid</span><span class="p">(</span><span class="n">aux_data</span><span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="n">proj_data</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="n">aux_data</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">dual_data</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_optional</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>    <span class="k">def</span> <span class="nf">_set_optional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rational_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_ring</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a>                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a>                    <span class="s2">&quot;Cannot specify base ring unless sage is available&quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a>                <span class="p">)</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="n">base_ring</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>                                  <span class="n">rational_approx</span><span class="o">=</span><span class="n">rational_approx</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a>    <span class="k">def</span> <span class="nf">flatten_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a>        <span class="sd">&quot;&quot;&quot;Get a flattened version of the projective object.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">        This method reshapes the underlying data of the projective</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">        object to get a &quot;flat&quot; composite list of objects. For example,</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">        if called on a Segment object whose underlying array has shape</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a><span class="sd">        (4, 5, 2, 3), this method uses the `unit_ndims` data member to</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a><span class="sd">        interprets this array as an array of segments with shape</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a><span class="sd">        (4,5), and returns a Segment object whose underlying array has</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a><span class="sd">        shape (20, 2, 3).</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a><span class="sd">        Parameters</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a><span class="sd">        ----------</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">        unit : int</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="sd">            the number of ndims to treat as a &quot;unit&quot; when flattening</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">            this object into units.</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="n">aux_unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>        <span class="n">dual_unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>            <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>            <span class="n">aux_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>            <span class="n">dual_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>        <span class="n">flattened</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>        <span class="n">new_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">unit</span><span class="p">:]</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="n">new_proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>        <span class="n">new_aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>            <span class="n">new_aux_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">aux_unit</span><span class="p">:]</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>            <span class="n">new_aux_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">new_aux_shape</span><span class="p">)</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>        <span class="n">new_dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>            <span class="n">new_dual_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">dual_unit</span><span class="p">:]</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="n">new_dual_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">new_dual_shape</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>        <span class="n">flattened</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">new_proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">new_aux_data</span><span class="p">,</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>                      <span class="n">dual_data</span><span class="o">=</span><span class="n">new_dual_data</span><span class="p">)</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>        <span class="k">return</span> <span class="n">flattened</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>    <span class="k">def</span> <span class="nf">flatten_to_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>        <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="p">)</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> with data:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>        <span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;len() of unsized object&quot;</span><span class="p">)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>    <span class="k">def</span> <span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="n">new_proj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="n">new_aux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>        <span class="n">new_dual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>            <span class="n">new_aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>            <span class="n">new_dual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="n">newobj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">new_aux</span><span class="p">,</span> <span class="n">new_dual</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>                                  <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newobj</span><span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>    <span class="k">def</span> <span class="nf">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>                <span class="s2">&quot;Cannot change base ring unless sage is available&quot;</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>            <span class="p">)</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>        <span class="n">newproj</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>                                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>        <span class="n">newaux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>            <span class="n">newaux</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>                                               <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>        <span class="n">newdual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>            <span class="n">newdual</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>                                                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>            <span class="n">newobj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">newproj</span><span class="p">,</span> <span class="n">newaux</span><span class="p">,</span> <span class="n">newdual</span><span class="p">,</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>                                      <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>                                      <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>                                      <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newobj</span><span class="p">)</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="n">newproj</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="n">newaux</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">newdual</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>    <span class="k">def</span> <span class="nf">projective_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a>        <span class="sd">&quot;&quot;&quot;Wrapper for ProjectiveObject.set, since underlying coordinates are</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">        projective.&quot;&quot;&quot;</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a>    <span class="k">def</span> <span class="nf">affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a>        <span class="sd">&quot;&quot;&quot;Get or set affine coordinates for this object.</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">        Parameters</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">        ----------</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">        aff_data : ndarray</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">            if not `None`, coordinate data for this point in an affine</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">            chart.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">        chart_index : int</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">            index of standard affine chart to get/set coordinates in</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">        Returns</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">        -------</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">        ndarray</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">            affine coordinates of this Point, in the specified</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">            standard affine chart.</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>        <span class="k">if</span> <span class="n">aff_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">aff_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">),</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>        <span class="k">return</span> <span class="n">affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">,</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>                             <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>    <span class="k">def</span> <span class="nf">_assert_prop_equal</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">propname</span><span class="p">):</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>            <span class="k">return</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="n">properties</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">propname</span><span class="p">]</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>                               <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">])</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">properties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">properties</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">propname</span><span class="si">}</span><span class="s2"> does not match for objects.&quot;</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>            <span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>    <span class="nd">@classmethod</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">to_combine</span><span class="p">):</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="sd">&quot;&quot;&quot;Construct a new ProjectiveObject of combining the</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a><span class="sd">        data of an array of objects.</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a><span class="sd">        All of the objects in the given array will be flattened to</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">        unit dimensions before combining. If dimensions of the</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">        underlying data do not match, this will raise an error.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">        Parameters</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="sd">        ----------</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        to_combine : array of ProjectiveObjects with a common type</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">        Returns</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">        -------</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">        ProjectiveObject</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">            Object of the appropriate type containing (flattened)</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">            combined data.</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_combine</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>            <span class="k">return</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;unit_ndims&quot;</span><span class="p">)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;aux_ndims&quot;</span><span class="p">)</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;dual_ndims&quot;</span><span class="p">)</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>        <span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unit_ndims</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>        <span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">aux_ndims</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>        <span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dual_ndims</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="n">flattened_objs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">()</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_combine</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>        <span class="p">]</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>        <span class="c1"># first make a generic ProjectiveObject</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>        <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">proj_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">unit_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="p">)</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>        <span class="n">new_aux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>        <span class="n">new_dual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>        <span class="k">if</span> <span class="n">aux_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>                <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">aux_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>                <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">aux_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>            <span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>            <span class="n">new_aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">flat_self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">flat_other</span><span class="o">.</span><span class="n">aux_data</span><span class="p">],</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>                                     <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="k">if</span> <span class="n">dual_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>                <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">dual_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>                <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">dual_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>            <span class="p">)</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>        <span class="n">newObj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">new_aux</span><span class="p">,</span> <span class="n">new_dual</span><span class="p">,</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                                  <span class="n">dual_ndims</span><span class="o">=</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>        <span class="c1"># construct an object with the correct type from this underlying data</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">newObj</span><span class="p">)</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>    <span class="k">def</span> <span class="nf">set_ndims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a>        <span class="k">if</span> <span class="n">unit_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>        <span class="k">if</span> <span class="n">aux_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">aux_ndims</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>        <span class="k">if</span> <span class="n">dual_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">dual_ndims</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>    <span class="sd">&quot;&quot;&quot;A point (or collection of points) in projective space.</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>        <span class="sd">&quot;&quot;&quot;Parameters</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">        ----------</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">        point : ndarray or ProjectiveObject or iterable</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">            Data to use to construct a Point object. If `point` is an</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">            `ndarray`, then it is interpreted as data in either</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">            projective or affine coordinates, depending on whether</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">            `chart_index` is specified. If `point` is a</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">            `ProjectiveObject`, then construct a `Point` from the</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">            underlying data of that object.</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a><span class="sd">        chart_index : int</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">            if `None` (default), then assume that `point` is data in</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">            projective coordinates, or a ProjectiveObject. Otherwise,</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">            interpret `point` as data in affine coordinates, and use</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="sd">            `chart_index` as the index of the standard affine chart</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">            those coordinates are in.</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>            <span class="k">return</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>            <span class="k">pass</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>    <span class="k">def</span> <span class="nf">in_affine_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="k">class</span> <span class="nc">PointCollection</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>        <span class="n">Point</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="k">class</span> <span class="nc">PointPair</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="sd">&quot;&quot;&quot;A pair of points (or a composite object consisting of a collection</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a><span class="sd">    of pairs of points) in projective space.</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="sd">    This is mostly useful as an interface for subclasses which provide</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">    more involved functionality.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a>                 <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a>        <span class="sd">&quot;&quot;&quot;If `endpoint2` is `None`, interpret `endpoint1` as either an</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">        `ndarray` of shape (2, ..., n) (where n is the dimension of</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">        the underlying vector space), or else a composite `Point`</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">        object which can be unpacked into two Points (which may</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">        themselves be composite).</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">        If `endpoint2` is given, then both `endpoint1` and `endpoint2`</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        can be used to construct `Point` objects, which serve as the</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">        endpoints for this pair of points.</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        Parameters</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">        ----------</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_ndims</span><span class="p">(</span><span class="n">unit_ndims</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>                <span class="k">return</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>                <span class="k">pass</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_endpoints</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a>    <span class="nd">@property</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>    <span class="k">def</span> <span class="nf">set_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>        <span class="sd">&quot;&quot;&quot;Set the endpoints of a segment.</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">        If `endpoint2` is `None`, expect `endpoint1` to be an array of</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">        points with shape `(..., 2, n)`. Otherwise, expect `endpoint1`</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">        and `endpoint2` to be arrays of points with the same shape.</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a><span class="sd">        Parameters</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="sd">        ----------</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>            <span class="k">return</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a>        <span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a>        <span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint2</span><span class="p">)</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pt1</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">pt2</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a>    <span class="k">def</span> <span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a>        <span class="sd">&quot;&quot;&quot;Get a Point representing the endpoints of this pair</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">        Returns</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">        -------</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="sd">        Point</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">            A composite Point object representing the endpoints of</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">            this (possibly composite) PointPair</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">)</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>    <span class="k">def</span> <span class="nf">get_end_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>        <span class="sd">&quot;&quot;&quot;Return a pair of point objects, one for each endpoint</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">        Returns</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">        -------</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">        tuple</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="sd">            Tuple of the form `(endpoint1, endpoint2)`, where</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">            `endpoint1` and `endpoint2` are (possibly composite)</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="sd">            `Point` objects representing the endpoints of this pair</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>                <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>    <span class="k">def</span> <span class="nf">endpoint_affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a>        <span class="sd">&quot;&quot;&quot;Get endpoints of this segment in affine coordinates</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">        Parameters</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">        ----------</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">        chart_index : int</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">            Index of the standard affine chart to take coordinates in</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        Returns</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">        -------</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">        ndarray</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">            Affine coordinates of the endpoints of this pair of</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">            points.</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>    <span class="k">def</span> <span class="nf">endpoint_projective_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>        <span class="sd">&quot;&quot;&quot;Get endpoints of this segment in projective coordinates.</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a><span class="sd">        Returns</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">        -------</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a><span class="sd">        ndarray</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">            Projective coordinates of the endpoints of this pair of</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">            points.</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">()</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="k">class</span> <span class="nc">Polygon</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>    <span class="sd">&quot;&quot;&quot;A finite-sided polygon in projective space.</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">        Parameters</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">        ----------</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        vertices : Point or ndarray or iterable</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">            vertices of the polygon, as either an ndarray or a</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">            composite Point object (provided in the proper order for</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">            this polygon).</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">        aux_data : PointPair or ndarray</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">            Data to use to construct the edges of the polygon. If</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">            `None`, use the vertex data to compute the edge data.</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a>                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a>    <span class="k">def</span> <span class="nf">in_standard_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>        <span class="n">coord_signs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">()[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">coord_signs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">coord_signs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>    <span class="nd">@property</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a>    <span class="nd">@property</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a>        <span class="n">segments</span> <span class="o">=</span> <span class="n">PointPair</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>        <span class="k">return</span> <span class="n">segments</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a>        <span class="sd">&quot;&quot;&quot;Get the edges of this polygon</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">        Returns</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">        -------</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        PointPair</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">            Edges of this polygon, as a composite PointPair object.</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>        <span class="sd">&quot;&quot;&quot;Get the vertices of the polygon.</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="sd">        Returns</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a><span class="sd">        -------</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        Point</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">            Vertices of this polygon, as a composite Point object.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="k">class</span> <span class="nc">Simplex</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>    <span class="sd">&quot;&quot;&quot;An n-simplex in projective space.</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">        Parameters</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="sd">        ----------</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">        vertices : ProjectiveObject or ndarray</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a><span class="sd">            Data giving the vertices of the simplex (or a composite of</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">            several simplices)</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>    <span class="nd">@property</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="sd">&quot;&quot;&quot;Number of vertices in the simplex.</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>    <span class="k">def</span> <span class="nf">skeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>        <span class="sd">&quot;&quot;&quot;Get the k-skeleton of this simplex, as a composite Simplex.</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        Parameters</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        ----------</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        k : int</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">            Dimension of the skeleton to get</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        Returns</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">        -------</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">        Simplex</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">            Composite Simplex object, with one subobject for each</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">            k-dimensional face of this simplex.</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">k</span><span class="p">))</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>        <span class="k">return</span> <span class="n">Simplex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>    <span class="k">def</span> <span class="nf">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>        <span class="sd">&quot;&quot;&quot;Get the codimension-1 faces of the simplex.</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">        Alias for self.skeleton(n - 1), where n is the number of</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">        vertices in this simplex.</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="sd">&quot;&quot;&quot;Get the edges of the simplex.</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a><span class="sd">        Alias for PointPair(self.skeleton(2)).&quot;&quot;&quot;</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>        <span class="sd">&quot;&quot;&quot;Get the vertices of this simplex as a Point object.</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="k">class</span> <span class="nc">Subspace</span><span class="p">(</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>    <span class="sd">&quot;&quot;&quot;A projective subspace (or composite object consisting of projective</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">    subspaces with the same dimension)</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">        Parameters</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">        ----------</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">        proj_data : ProjectiveObject or ndarray</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">            data specifying a spanning set for this projective</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">            subspace. These are presumed to be a set of linearly</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">            independent vectors.</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>    <span class="nd">@property</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a>        <span class="sd">&quot;&quot;&quot;Dimension of the vector space underlying this subspace.</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">):</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>        <span class="sd">&quot;&quot;&quot;Get a subspace giving the intersection of self with other.</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        All intersections are presumed to be transverse. So, the</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="sd">        dimension of the underlying vector space of the returned</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        subspace is always: (dimension of self) + (dimension of other)</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">        - (dimension of ambient vector space).</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">        Parameters</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">        ----------</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">        other : Subspace or ndarray</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">            Subspace to intersect with.</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">        broadcast : {&quot;elementwise&quot;, &quot;pairwise&quot;}</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">            If &quot;elementwise&quot; (the default), and self/other are</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">            composite objects, then compute the element-by-element</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">            intersection. For this to work properly, self and other</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a><span class="sd">            must have the same shape (as composite objects).</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">            If &quot;pairwise&quot;, compute intersections between every</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">            subspace in self and every subspace in other. If self has</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">            a (composite) shape (N1, N2, ... Ni) and other has</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">            composite shape (M1, M2, ..., Mj), then the returned</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">            object has composite shape (N1, N2, ... Ni, M1, M2, ...,</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">            Mj).</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">        Returns</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">        -------</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">        Subspace</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">            Intersection of self and other.</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="n">other_obj</span> <span class="o">=</span> <span class="n">Subspace</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>        <span class="k">if</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;elementwise&quot;</span><span class="p">:</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">other_obj</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>        <span class="k">elif</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">broadcast_match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>                                          <span class="n">other_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized broadcast rule: &#39;</span><span class="si">{</span><span class="n">broadcast</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>        <span class="n">spans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>        <span class="n">kernel_coeffs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>        <span class="n">subspace_coeffs</span> <span class="o">=</span> <span class="n">kernel_coeffs</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="k">return</span> <span class="n">Subspace</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">matrix_product</span><span class="p">(</span><span class="n">subspace_coeffs</span><span class="p">,</span> <span class="n">p1</span><span class="p">))</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="k">class</span> <span class="nc">ConvexPolygon</span><span class="p">(</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>    <span class="sd">&quot;&quot;&quot;A finite-sided convex polygon in projective space.</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;When providing point data for this polygon, non-extreme points</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">        (i.e. points in the interior of the convex hull) are</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">        discarded. To determine which points lie in the interior of</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">        the convex hull, the constructor either:</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">        - uses the provided `dual_data` to determine an affine</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">          chart in which the convex polygon lies (this chart is</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">          the complement of the hyperplane specified in</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">          `dual_data`), or</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">        - interprets the projective coordinates of the provided points</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a><span class="sd">          as preferred lifts of those points in $\mathbb{R}^n$, and</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">          computes an affine chart containing the projectivization of</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">          the convex hull of those lifts.</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        Parameters</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">        ----------</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">        vertices : Point or ndarray</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">            points contained in this polygon</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">        aux_data : PointPair or None</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">            Data to construct the edges of this polygon. If `None`,</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">            use vertex data to construct edge data.</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">        dual_data : ProjectiveObject</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">            Dual vector specifying an affine chart containing every</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">            point in this convex polygon. If `None`, then compute a</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">            dual vector using lifts of the vertex data.</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_data</span><span class="p">,</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>                                  <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>    <span class="k">def</span> <span class="nf">add_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="sd">&quot;&quot;&quot;Add points to an existing convex polygon.</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a><span class="sd">        Parameters</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a><span class="sd">        ----------</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a><span class="sd">        points : Point or ndarray</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a><span class="sd">            Points to add to the convex polygon. Redundant points</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a><span class="sd">            (lying in the interior of the convex hull) will be</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">            discarded.</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="sd">        in_place : bool</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">            if `True`, modify this convex polygon object in-place</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a><span class="sd">            instead of returning a new one.</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        Raises</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">        ------</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">        GeometryError</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a><span class="sd">            Raised if points are added to a composite ConvexPolygon</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">            (currently unsupported)</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">        Returns</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">        -------</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        ConvexPolygon</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a><span class="sd">            if `in_place` is `False`, return a modified ConvexPolygon</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">            object with the new points added.</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>                <span class="s2">&quot;Adding new points to a composite ConvexPolygon object is currently&quot;</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>                <span class="s2">&quot; unsupported.&quot;</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>            <span class="p">)</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>        <span class="n">to_add</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>        <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">to_add</span><span class="o">.</span><span class="n">proj_data</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="k">return</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>        <span class="n">new_poly</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="k">return</span> <span class="n">new_poly</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>    <span class="k">def</span> <span class="nf">_convexify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>                <span class="s2">&quot;Cannot auto-convexify a composite ConvexPolygon object.&quot;</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>            <span class="p">)</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_positive_functional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>        <span class="n">to_std_aff</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                                                       <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">))</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>        <span class="n">standardized_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">@</span> <span class="n">to_std_aff</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>        <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">standardized_coords</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="n">vertex_indices</span><span class="p">]</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_convexify</span><span class="p">()</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="k">class</span> <span class="nc">Transformation</span><span class="p">(</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>    <span class="sd">&quot;&quot;&quot;A projective transformation (or a composite object consisting of a</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">    collection of projective transformations).</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>        <span class="sd">&quot;&quot;&quot;By default, the underlying data for a projective</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        transformation is a *row matrix* (or an ndarray of row</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">        matrices), acting on vectors on the *right*.</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">        Parameters</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        ----------</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a><span class="sd">        proj_data : ProjectiveObject or ndarray</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">            Data to use to construct a projective transformation (or</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">            array of projective transformations).</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">        column_vectors : bool</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">            If `True`, interpret proj_data as a *column matrix* acting</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a><span class="sd">            on the left. Otherwise proj_data gives a *row matrix*.</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>            <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>            <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>                <span class="p">(</span><span class="s2">&quot;Projective transformation must be ndarray of n x n&quot;</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>                 <span class="s2">&quot; matrices, got array with shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>                     <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>    <span class="nd">@property</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>    <span class="k">def</span> <span class="nf">_apply_to_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>        <span class="k">if</span> <span class="n">dual</span><span class="p">:</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">matrix_product</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>                                    <span class="n">matrix</span><span class="p">,</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>                                    <span class="n">unit_ndims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>                                    <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">)</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">):</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>        <span class="sd">&quot;&quot;&quot;Apply this transformation to another object in projective space.</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">        Parameters</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">        ----------</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">        proj_obj : ProjectiveObject or ndarray</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">            Projective object to apply this transformation to. This object</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">            may be composite.</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">        broadcast : string</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">            Broadcasting behavior for applying composite</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">            transformation objects. If &quot;elementwise&quot;, then the shape</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">            of this (composite) transformation object and the shape of</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">            the (composite) object to apply transformations to need to</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">            be broadcastable. If &quot;pairwise&quot;, then apply every element</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">            of this (composite) transformation object to every element</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">            of the target object (i.e. take an outer product).</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">        Returns</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">        -------</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">        ProjectiveObject</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">            Transformed (possibly composite) projective object. The</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">            type of this object is the same type as the original</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">            (untransformed) object. If the original object was</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">            provided as an ndarray, then the returned object has type</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">            ProjectiveObject.</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">proj_obj</span><span class="p">)</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>            <span class="n">proj_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>            <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>                <span class="n">proj_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>                                                   <span class="n">new_obj</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">)</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>            <span class="n">aux_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>            <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>                <span class="n">aux_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>                                                  <span class="n">new_obj</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">)</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">dual_data</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>            <span class="n">dual_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>            <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>                <span class="n">dual_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>                                                   <span class="n">new_obj</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>            <span class="n">new_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="o">=</span><span class="n">proj_product</span><span class="p">,</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>                        <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_product</span><span class="p">,</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>                        <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_product</span><span class="p">)</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>            <span class="k">return</span> <span class="n">new_obj</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>            <span class="k">pass</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>        <span class="c1">#otherwise, it&#39;s an array of vectors which we&#39;ll interpret as</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>        <span class="c1">#some kind of hyperbolic object</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>        <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">proj_obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">)</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_to_object</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>    <span class="k">def</span> <span class="nf">eigenvector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>        <span class="sd">&quot;&quot;&quot;Get a point corresponding to an eigenvector with the given</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">        eigenvalue.</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">        Parameters</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">        ----------</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">        eigenvalue : float</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">            Eigenvalue for the returned eigenvector. If None, return</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">            an arbitrary eigenvector.</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="sd">        Returns</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">        -------</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">        Point</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a><span class="sd">            Point object in projective space giving an eigenvector for</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="sd">            the given eigenvalue. The projective coordinates of this</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">            point will be degenerate (i.e. zero) if no nonzero</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">            eigenvector with this eigenvalue exists.</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>        <span class="n">eigvec_coords</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>        <span class="k">if</span> <span class="n">eigenvalue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>            <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">eigvals</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="p">)</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>        <span class="n">where_ic</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">where_ic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">where_ic</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>                <span class="n">eigvec_coords</span> <span class="o">=</span> <span class="p">(</span><span class="n">eigvecs</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="n">where_ic</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>                <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">eigvec_coords</span><span class="p">)</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>                <span class="p">(</span><span class="s2">&quot;Transformation does not have </span><span class="si">{}</span><span class="s2"> as an approximate eigenvalue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>                    <span class="n">eigenvalue</span><span class="p">)</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>            <span class="p">)</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>        <span class="n">unind</span><span class="p">,</span> <span class="n">indind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">where_ic</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>                                  <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>        <span class="n">eigvec_coords</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="n">unind</span><span class="o">.</span><span class="n">T</span><span class="p">])]</span> <span class="o">=</span> <span class="n">eigvecs</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)[</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>            <span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">where_ic</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="n">indind</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>        <span class="p">]</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">eigvec_coords</span><span class="p">)</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>    <span class="k">def</span> <span class="nf">commute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>        <span class="n">s_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>        <span class="n">o_inv</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>        <span class="k">if</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>            <span class="n">slen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>            <span class="n">olen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">o_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>            <span class="n">s_inv</span> <span class="o">=</span> <span class="n">s_inv</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s_inv</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">olen</span><span class="p">)</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>            <span class="n">o_inv</span> <span class="o">=</span> <span class="n">o_inv</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">slen</span> <span class="o">+</span> <span class="n">o_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">)</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="n">commutator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">s_inv</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="n">commutator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">o_inv</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">commutator</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>                       <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>                       <span class="n">atol</span><span class="o">=</span><span class="n">tol</span><span class="p">),</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>            <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>        <span class="p">)</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>    <span class="k">def</span> <span class="nf">diagonalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_inv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>        <span class="sd">&quot;&quot;&quot;Get a matrix diagonalizing this projective transformation.</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">        If self is a diagonalizable transformation, this function</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">        returns a Transformation object representing a projective</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a><span class="sd">        transformation M such that M.inv() @ (self) @ M is diagonal.</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a><span class="sd">        No claims are made about the behavior of this function if M is</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a><span class="sd">        not diagonalizable. The function may throw an error, or it may</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a><span class="sd">        return nonsense - no effort has been made on this front.</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a><span class="sd">        Parameters</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a><span class="sd">        ----------</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a><span class="sd">        return_inv : bool</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="sd">            If True, return a pair of Transformations, giving M and</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a><span class="sd">            M.inv(). Otherwise, just return M.</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">        Returns</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a><span class="sd">        -------</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a><span class="sd">        Transformation</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a><span class="sd">            Projective transformation M diagonalizing this</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a><span class="sd">            transformation.</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">conj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>        <span class="n">conj_transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">conj</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_inv</span><span class="p">:</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>            <span class="k">return</span> <span class="n">conj_transform</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>        <span class="k">return</span> <span class="n">conj_transform</span><span class="p">,</span> <span class="n">conj_transform</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>    <span class="k">def</span> <span class="nf">_data_to_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="k">return</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>        <span class="sd">&quot;&quot;&quot;Get the inverse of this transformation.</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">        Returns</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">        -------</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a><span class="sd">        ProjectiveTransformation</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a><span class="sd">            Inverse of this transformation.</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">))</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a><span class="k">class</span> <span class="nc">ProjectiveRepresentation</span><span class="p">(</span><span class="n">representation</span><span class="o">.</span><span class="n">Representation</span><span class="p">):</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>    <span class="sd">&quot;&quot;&quot;A representation (of a free group) lying in PGL(V). Passing words</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a><span class="sd">    (in the generators) to this representation yields `Transformation`</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a><span class="sd">    objects.</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>    <span class="k">def</span> <span class="nf">wrap_func</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">):</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>        <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>    <span class="k">def</span> <span class="nf">unwrap_func</span><span class="p">(</span><span class="n">wrapped_matrix</span><span class="p">):</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>        <span class="k">return</span> <span class="n">wrapped_matrix</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>    <span class="k">def</span> <span class="nf">array_wrap_func</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">):</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>        <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>    <span class="k">def</span> <span class="nf">transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>        <span class="sd">&quot;&quot;&quot;Get a composite transformation, representing a sequence of words in</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">        the generators for this representation.</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">        Parameters</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">        ----------</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a><span class="sd">        words : iterable of strings</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">            Sequence of words to apply this representation to.</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a><span class="sd">        Returns</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a><span class="sd">        -------</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">        Transformation</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a><span class="sd">            Composite transformation object containing one</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">            transformation for each word in `words`.</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="k">def</span> <span class="nf">hyperplane_coordinate_transform</span><span class="p">(</span><span class="n">normal</span><span class="p">):</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find an orthogonal matrix taking the affine chart $\{\vec{x} :</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="sd">       \vec{x} \cdot \vec{n} \ne 0\}$ to the standard affine chart</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a><span class="sd">       $\{\vec{x} = (x_0, \ldots, x_n) : x_0 \ne 0\}$.</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a><span class="sd">    Parameters</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a><span class="sd">    ----------</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a><span class="sd">    normal : array</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a><span class="sd">        The vector $\vec{n}$, normal to some hyperplane in R^n.</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a><span class="sd">    Returns</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">    -------</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">    Transformation</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a><span class="sd">        Projective transformation (orthogonal in the standard inner</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a><span class="sd">        product on R^n) taking the desired affine chart to the</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a><span class="sd">        standard chart with index 0.</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_definite_isometry</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a><span class="k">def</span> <span class="nf">affine_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>    <span class="sd">&quot;&quot;&quot;Get affine coordinates for an array of points in projective space</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">    in one of the standard affine charts.</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">    Parameters</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">    ----------</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a><span class="sd">    points: ndarray</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a><span class="sd">        `ndarray` of points in projective space. the last dimension is</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        assumed to be the same as the dimension of the underlying</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="sd">        vector space.</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a><span class="sd">    chart_index: int</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a><span class="sd">        which of the n affine charts to take coordinates in. If</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="sd">        `None`, determine the chart automatically.</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">    column_vectors: bool</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a><span class="sd">        if `True`, interpret the second-to-last index as the dimension</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">        of the underlying vector space.</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">    Returns</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">    -------</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">    ndarray</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">        If chart_index is specified, return an array of points in</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">        affine coordinates in that chart. Otherwise, return a tuple</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        `(affine, chart_index)`, where `chart_index` is the affine</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">        chart used.</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">        If `column_vectors` is `False` (the default), then the last</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="sd">        index of the returned array is the dimension of the affine</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">        space. Otherwise, the second-to-last index is the dimension of</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">        affine space.</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>    <span class="n">apoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>        <span class="n">apoints</span> <span class="o">=</span> <span class="n">apoints</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>    <span class="n">_chart_index</span> <span class="o">=</span> <span class="n">chart_index</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>    <span class="c1">#auto-determine chart</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>    <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="n">_chart_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">apoints</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">apoints</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>        <span class="p">)</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">apoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">_chart_index</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a>        <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>                <span class="s2">&quot;points don&#39;t lie in the specified affine chart&quot;</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>            <span class="p">)</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>                <span class="s2">&quot;points don&#39;t lie in any standard affine chart&quot;</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>            <span class="p">)</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>    <span class="n">affine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>        <span class="p">(</span><span class="n">apoints</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">apoints</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">_chart_index</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>        <span class="n">_chart_index</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>    <span class="p">)</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>        <span class="n">affine</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>    <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">affine</span><span class="p">,</span> <span class="n">_chart_index</span><span class="p">)</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>        <span class="k">return</span> <span class="n">affine</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="k">def</span> <span class="nf">projective_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>    <span class="sd">&quot;&quot;&quot;Get projective coordinates for points in affine space</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a><span class="sd">    Parameters</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="sd">    ----------</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a><span class="sd">    points : ndarray or sequence</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a><span class="sd">        Points in affine coordinates. The last dimension of the array</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="sd">        is the dimension of affine space.</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a><span class="sd">    chart_index: int</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="sd">        Index of the affine chart we assume these points are lying in</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a><span class="sd">    column_vectors: bool</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a><span class="sd">        If `True`, interpret the second-to-last index as the dimension</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a><span class="sd">        of affine space.</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a><span class="sd">    Returns</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a><span class="sd">    -------</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a><span class="sd">    ndarray</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a><span class="sd">        Projective coordinates of the given points. The last dimension</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a><span class="sd">        of the array is the dimension of the underlying vector space</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a><span class="sd">        (or the second-to-last dimension, if `column_vectors` is</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a><span class="sd">        `True`).</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>                         <span class="n">like</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>    <span class="n">indices</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>    <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>    <span class="c1"># wrap literal numerical 1 (for sage)</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>    <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>    <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>    <span class="k">return</span> <span class="n">result</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>    <span class="sd">&quot;&quot;&quot;Get the identity projective transformation.</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a><span class="sd">    Parameters</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="sd">    ----------</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="sd">    dimension : int</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a><span class="sd">        Dimension of the projective space to act on.</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">    Returns</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a><span class="sd">    -------</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">    Transformation</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="sd">        The identity map on RP^n, where n = `dimension`.</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="k">def</span> <span class="nf">affine_linear_map</span><span class="p">(</span><span class="n">linear_map</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>    <span class="sd">&quot;&quot;&quot;Get a projective transformation restricting to a linear map on a</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">       standard affine chart.</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a><span class="sd">    Parameters</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a><span class="sd">    ----------</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a><span class="sd">    linear_map : ndarray</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a><span class="sd">        A linear map giving an affine transformation on a standard</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a><span class="sd">        affine chart</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a><span class="sd">    chart_index : int</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a><span class="sd">        Index of the standard affine chart where this projective</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a><span class="sd">        transformation acts</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a><span class="sd">    column_vectors :</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a><span class="sd">        It `True`, interpret `linear_map` as a matrix acting on column</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a><span class="sd">        vectors (on the left). Otherwise, `linear_map` acts on row</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a><span class="sd">        vectors (on the right).</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a><span class="sd">    Returns</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a><span class="sd">    -------</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a><span class="sd">    Transformation</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a><span class="sd">        Projective transformation preserving a standard affine chart</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a><span class="sd">        and acting by a linear map on that affine space (i.e. fixing a</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a><span class="sd">        point in that affine space).</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">linear_map</span><span class="o">.</span><span class="n">shape</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>    <span class="n">tf_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">(</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>        <span class="p">[[</span><span class="n">linear_map</span><span class="p">[:</span><span class="n">chart_index</span><span class="p">,</span> <span class="p">:</span><span class="n">chart_index</span><span class="p">],</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">chart_index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">linear_map</span><span class="p">[:</span><span class="n">chart_index</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">:]],</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>         <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">)),</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">-</span> <span class="n">chart_index</span><span class="p">))],</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>         <span class="p">[</span><span class="n">linear_map</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:,</span> <span class="p">:</span><span class="n">chart_index</span><span class="p">],</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">h</span> <span class="o">-</span> <span class="n">chart_index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">linear_map</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:,</span> <span class="n">chart_index</span><span class="p">:]]])</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">tf_mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a><span class="k">def</span> <span class="nf">affine_translation</span><span class="p">(</span><span class="n">translation</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>    <span class="sd">&quot;&quot;&quot;Get a translation in a standard affine chart.</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a><span class="sd">    Parameters</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a><span class="sd">    ----------</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="sd">    translation : ndarray</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a><span class="sd">        vector to translate along in affine space</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">    chart_index : int</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a><span class="sd">        index of the standard affine chart this translation acts on</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a><span class="sd">    Returns</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a><span class="sd">    -------</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a><span class="sd">    Transformation</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a><span class="sd">        Projective transformation preserving a standard affine chart</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a><span class="sd">        and acting by an affine translation in that affine space.</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>    <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">translation</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>    <span class="n">tf</span><span class="p">[</span><span class="n">chart_index</span><span class="p">,</span> <span class="p">:</span><span class="n">chart_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">translation</span><span class="p">[:</span><span class="n">chart_index</span><span class="p">]</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>    <span class="n">tf</span><span class="p">[</span><span class="n">chart_index</span><span class="p">,</span> <span class="n">chart_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">translation</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:]</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="ProjectiveObject">
                            <input id="ProjectiveObject-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ProjectiveObject</span>:

                <label class="view-source-button" for="ProjectiveObject-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject-124"><a href="#ProjectiveObject-124"><span class="linenos">124</span></a><span class="k">class</span> <span class="nc">ProjectiveObject</span><span class="p">:</span>
</span><span id="ProjectiveObject-125"><a href="#ProjectiveObject-125"><span class="linenos">125</span></a>    <span class="sd">&quot;&quot;&quot;Represent some object in projective geometry (possibly a composite</span>
</span><span id="ProjectiveObject-126"><a href="#ProjectiveObject-126"><span class="linenos">126</span></a><span class="sd">    object).</span>
</span><span id="ProjectiveObject-127"><a href="#ProjectiveObject-127"><span class="linenos">127</span></a>
</span><span id="ProjectiveObject-128"><a href="#ProjectiveObject-128"><span class="linenos">128</span></a><span class="sd">    The underlying data of a projective object is stored as a numpy</span>
</span><span id="ProjectiveObject-129"><a href="#ProjectiveObject-129"><span class="linenos">129</span></a><span class="sd">    ndarray. The last `unit_ndims` ndims of this array describe a</span>
</span><span id="ProjectiveObject-130"><a href="#ProjectiveObject-130"><span class="linenos">130</span></a><span class="sd">    *single* instance of this type of object.</span>
</span><span id="ProjectiveObject-131"><a href="#ProjectiveObject-131"><span class="linenos">131</span></a>
</span><span id="ProjectiveObject-132"><a href="#ProjectiveObject-132"><span class="linenos">132</span></a><span class="sd">    For example, a `Polygon` object has `unit_ndims` equal to 2, since</span>
</span><span id="ProjectiveObject-133"><a href="#ProjectiveObject-133"><span class="linenos">133</span></a><span class="sd">    a single `Polygon` is represented by an array of shape `(n,d)`,</span>
</span><span id="ProjectiveObject-134"><a href="#ProjectiveObject-134"><span class="linenos">134</span></a><span class="sd">    where `n` is the number of vertices and `d` is the dimension of</span>
</span><span id="ProjectiveObject-135"><a href="#ProjectiveObject-135"><span class="linenos">135</span></a><span class="sd">    the underlying vector space. So, a `Polygon` object whose</span>
</span><span id="ProjectiveObject-136"><a href="#ProjectiveObject-136"><span class="linenos">136</span></a><span class="sd">    underlying array has shape `(5, 6, 4, 3)` represents a 5x6 array</span>
</span><span id="ProjectiveObject-137"><a href="#ProjectiveObject-137"><span class="linenos">137</span></a><span class="sd">    of quadrilaterals in RP^2 (i.e. the projectivization of R^3).</span>
</span><span id="ProjectiveObject-138"><a href="#ProjectiveObject-138"><span class="linenos">138</span></a>
</span><span id="ProjectiveObject-139"><a href="#ProjectiveObject-139"><span class="linenos">139</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-140"><a href="#ProjectiveObject-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ProjectiveObject-141"><a href="#ProjectiveObject-141"><span class="linenos">141</span></a>                 <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject-142"><a href="#ProjectiveObject-142"><span class="linenos">142</span></a>        <span class="sd">&quot;&quot;&quot;Parameters</span>
</span><span id="ProjectiveObject-143"><a href="#ProjectiveObject-143"><span class="linenos">143</span></a><span class="sd">        -----------</span>
</span><span id="ProjectiveObject-144"><a href="#ProjectiveObject-144"><span class="linenos">144</span></a>
</span><span id="ProjectiveObject-145"><a href="#ProjectiveObject-145"><span class="linenos">145</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="ProjectiveObject-146"><a href="#ProjectiveObject-146"><span class="linenos">146</span></a><span class="sd">            underyling data describing this projective object</span>
</span><span id="ProjectiveObject-147"><a href="#ProjectiveObject-147"><span class="linenos">147</span></a>
</span><span id="ProjectiveObject-148"><a href="#ProjectiveObject-148"><span class="linenos">148</span></a><span class="sd">        aux_data : ndarray</span>
</span><span id="ProjectiveObject-149"><a href="#ProjectiveObject-149"><span class="linenos">149</span></a><span class="sd">            auxiliary data describing this projective</span>
</span><span id="ProjectiveObject-150"><a href="#ProjectiveObject-150"><span class="linenos">150</span></a><span class="sd">            object. Auxiliary data is any data which is in principle</span>
</span><span id="ProjectiveObject-151"><a href="#ProjectiveObject-151"><span class="linenos">151</span></a><span class="sd">            computable from `proj_data`, but is convenient to keep as</span>
</span><span id="ProjectiveObject-152"><a href="#ProjectiveObject-152"><span class="linenos">152</span></a><span class="sd">            part of the object definition for transformation purposes.</span>
</span><span id="ProjectiveObject-153"><a href="#ProjectiveObject-153"><span class="linenos">153</span></a>
</span><span id="ProjectiveObject-154"><a href="#ProjectiveObject-154"><span class="linenos">154</span></a><span class="sd">        dual_data : ndarray</span>
</span><span id="ProjectiveObject-155"><a href="#ProjectiveObject-155"><span class="linenos">155</span></a><span class="sd">            data describing this projective object which transforms</span>
</span><span id="ProjectiveObject-156"><a href="#ProjectiveObject-156"><span class="linenos">156</span></a><span class="sd">            covariantly, i.e. as a dual vector in projective space.</span>
</span><span id="ProjectiveObject-157"><a href="#ProjectiveObject-157"><span class="linenos">157</span></a>
</span><span id="ProjectiveObject-158"><a href="#ProjectiveObject-158"><span class="linenos">158</span></a><span class="sd">        unit_ndims : int</span>
</span><span id="ProjectiveObject-159"><a href="#ProjectiveObject-159"><span class="linenos">159</span></a><span class="sd">            number of ndims of an array representing a &quot;unit&quot; version</span>
</span><span id="ProjectiveObject-160"><a href="#ProjectiveObject-160"><span class="linenos">160</span></a><span class="sd">            of this object. For example, an object representing a</span>
</span><span id="ProjectiveObject-161"><a href="#ProjectiveObject-161"><span class="linenos">161</span></a><span class="sd">            single point in hyperbolic space has `unit_ndims` 1, while</span>
</span><span id="ProjectiveObject-162"><a href="#ProjectiveObject-162"><span class="linenos">162</span></a><span class="sd">            an object representing a line segment has `unit_ndims`</span>
</span><span id="ProjectiveObject-163"><a href="#ProjectiveObject-163"><span class="linenos">163</span></a><span class="sd">            equal to 2.</span>
</span><span id="ProjectiveObject-164"><a href="#ProjectiveObject-164"><span class="linenos">164</span></a>
</span><span id="ProjectiveObject-165"><a href="#ProjectiveObject-165"><span class="linenos">165</span></a><span class="sd">        aux_ndims : int</span>
</span><span id="ProjectiveObject-166"><a href="#ProjectiveObject-166"><span class="linenos">166</span></a><span class="sd">            like `unit_ndims`, but for auxiliary data.</span>
</span><span id="ProjectiveObject-167"><a href="#ProjectiveObject-167"><span class="linenos">167</span></a>
</span><span id="ProjectiveObject-168"><a href="#ProjectiveObject-168"><span class="linenos">168</span></a><span class="sd">        dual_ndims : int</span>
</span><span id="ProjectiveObject-169"><a href="#ProjectiveObject-169"><span class="linenos">169</span></a><span class="sd">            like `unit_ndims`, but for covariant (dual) data.</span>
</span><span id="ProjectiveObject-170"><a href="#ProjectiveObject-170"><span class="linenos">170</span></a>
</span><span id="ProjectiveObject-171"><a href="#ProjectiveObject-171"><span class="linenos">171</span></a><span class="sd">        base_ring : object</span>
</span><span id="ProjectiveObject-172"><a href="#ProjectiveObject-172"><span class="linenos">172</span></a><span class="sd">            *(requires sage).* Base ring for matrix entries of the</span>
</span><span id="ProjectiveObject-173"><a href="#ProjectiveObject-173"><span class="linenos">173</span></a><span class="sd">             underlying data for this object. This allows for exact</span>
</span><span id="ProjectiveObject-174"><a href="#ProjectiveObject-174"><span class="linenos">174</span></a><span class="sd">             computations in projective space (at the cost of</span>
</span><span id="ProjectiveObject-175"><a href="#ProjectiveObject-175"><span class="linenos">175</span></a><span class="sd">             performance) by supplying a ring that supports exact</span>
</span><span id="ProjectiveObject-176"><a href="#ProjectiveObject-176"><span class="linenos">176</span></a><span class="sd">             computations. The dtype of the underlying data is</span>
</span><span id="ProjectiveObject-177"><a href="#ProjectiveObject-177"><span class="linenos">177</span></a><span class="sd">             automatically converted to &quot;object&quot; if this is specified.</span>
</span><span id="ProjectiveObject-178"><a href="#ProjectiveObject-178"><span class="linenos">178</span></a>
</span><span id="ProjectiveObject-179"><a href="#ProjectiveObject-179"><span class="linenos">179</span></a><span class="sd">        rational_approx : bool</span>
</span><span id="ProjectiveObject-180"><a href="#ProjectiveObject-180"><span class="linenos">180</span></a><span class="sd">            *(requires sage).* If base_ring is specified, coerce</span>
</span><span id="ProjectiveObject-181"><a href="#ProjectiveObject-181"><span class="linenos">181</span></a><span class="sd">             floating-point data to a rational approximation before</span>
</span><span id="ProjectiveObject-182"><a href="#ProjectiveObject-182"><span class="linenos">182</span></a><span class="sd">             converting to the specified ring. This is useful for</span>
</span><span id="ProjectiveObject-183"><a href="#ProjectiveObject-183"><span class="linenos">183</span></a><span class="sd">             combining computations with floating-point values with</span>
</span><span id="ProjectiveObject-184"><a href="#ProjectiveObject-184"><span class="linenos">184</span></a><span class="sd">             computations in algebraic number fields.</span>
</span><span id="ProjectiveObject-185"><a href="#ProjectiveObject-185"><span class="linenos">185</span></a>
</span><span id="ProjectiveObject-186"><a href="#ProjectiveObject-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-187"><a href="#ProjectiveObject-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="ProjectiveObject-188"><a href="#ProjectiveObject-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">aux_ndims</span>
</span><span id="ProjectiveObject-189"><a href="#ProjectiveObject-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">dual_ndims</span>
</span><span id="ProjectiveObject-190"><a href="#ProjectiveObject-190"><span class="linenos">190</span></a>
</span><span id="ProjectiveObject-191"><a href="#ProjectiveObject-191"><span class="linenos">191</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject-192"><a href="#ProjectiveObject-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-193"><a href="#ProjectiveObject-193"><span class="linenos">193</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="ProjectiveObject-194"><a href="#ProjectiveObject-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-195"><a href="#ProjectiveObject-195"><span class="linenos">195</span></a>
</span><span id="ProjectiveObject-196"><a href="#ProjectiveObject-196"><span class="linenos">196</span></a>    <span class="nd">@property</span>
</span><span id="ProjectiveObject-197"><a href="#ProjectiveObject-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject-198"><a href="#ProjectiveObject-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="ProjectiveObject-199"><a href="#ProjectiveObject-199"><span class="linenos">199</span></a>
</span><span id="ProjectiveObject-200"><a href="#ProjectiveObject-200"><span class="linenos">200</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="ProjectiveObject-201"><a href="#ProjectiveObject-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-202"><a href="#ProjectiveObject-202"><span class="linenos">202</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-203"><a href="#ProjectiveObject-203"><span class="linenos">203</span></a>
</span><span id="ProjectiveObject-204"><a href="#ProjectiveObject-204"><span class="linenos">204</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject-205"><a href="#ProjectiveObject-205"><span class="linenos">205</span></a>            <span class="k">if</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:</span>
</span><span id="ProjectiveObject-206"><a href="#ProjectiveObject-206"><span class="linenos">206</span></a>                <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="ProjectiveObject-207"><a href="#ProjectiveObject-207"><span class="linenos">207</span></a>                    <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> expects an array with ndim at least </span><span class="si">{}</span><span class="s2">, got array of shape </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="ProjectiveObject-208"><a href="#ProjectiveObject-208"><span class="linenos">208</span></a>                    <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ProjectiveObject-209"><a href="#ProjectiveObject-209"><span class="linenos">209</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject-210"><a href="#ProjectiveObject-210"><span class="linenos">210</span></a>                    <span class="p">)</span>
</span><span id="ProjectiveObject-211"><a href="#ProjectiveObject-211"><span class="linenos">211</span></a>                <span class="p">)</span>
</span><span id="ProjectiveObject-212"><a href="#ProjectiveObject-212"><span class="linenos">212</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="ProjectiveObject-213"><a href="#ProjectiveObject-213"><span class="linenos">213</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="ProjectiveObject-214"><a href="#ProjectiveObject-214"><span class="linenos">214</span></a>                <span class="p">(</span><span class="s2">&quot;Data provided to </span><span class="si">{}</span><span class="s2"> must be a numpy array&quot;</span>
</span><span id="ProjectiveObject-215"><a href="#ProjectiveObject-215"><span class="linenos">215</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="ProjectiveObject-216"><a href="#ProjectiveObject-216"><span class="linenos">216</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-217"><a href="#ProjectiveObject-217"><span class="linenos">217</span></a>
</span><span id="ProjectiveObject-218"><a href="#ProjectiveObject-218"><span class="linenos">218</span></a>    <span class="k">def</span> <span class="nf">_assert_aux_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">):</span>
</span><span id="ProjectiveObject-219"><a href="#ProjectiveObject-219"><span class="linenos">219</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-220"><a href="#ProjectiveObject-220"><span class="linenos">220</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-221"><a href="#ProjectiveObject-221"><span class="linenos">221</span></a>
</span><span id="ProjectiveObject-222"><a href="#ProjectiveObject-222"><span class="linenos">222</span></a>        <span class="k">if</span> <span class="n">aux_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">:</span>
</span><span id="ProjectiveObject-223"><a href="#ProjectiveObject-223"><span class="linenos">223</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> expects an auxiliary array with&quot;</span>
</span><span id="ProjectiveObject-224"><a href="#ProjectiveObject-224"><span class="linenos">224</span></a>            <span class="s2">&quot; ndim at least </span><span class="si">{}</span><span class="s2">, got array of shape </span><span class="si">{}</span><span class="s2">&quot;</span> <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ProjectiveObject-225"><a href="#ProjectiveObject-225"><span class="linenos">225</span></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-226"><a href="#ProjectiveObject-226"><span class="linenos">226</span></a>                <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span> <span class="p">)</span>
</span><span id="ProjectiveObject-227"><a href="#ProjectiveObject-227"><span class="linenos">227</span></a>
</span><span id="ProjectiveObject-228"><a href="#ProjectiveObject-228"><span class="linenos">228</span></a>    <span class="k">def</span> <span class="nf">_assert_dual_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">):</span>
</span><span id="ProjectiveObject-229"><a href="#ProjectiveObject-229"><span class="linenos">229</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-230"><a href="#ProjectiveObject-230"><span class="linenos">230</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-231"><a href="#ProjectiveObject-231"><span class="linenos">231</span></a>
</span><span id="ProjectiveObject-232"><a href="#ProjectiveObject-232"><span class="linenos">232</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject-233"><a href="#ProjectiveObject-233"><span class="linenos">233</span></a>            <span class="k">if</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">:</span>
</span><span id="ProjectiveObject-234"><a href="#ProjectiveObject-234"><span class="linenos">234</span></a>                <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> expects a dual array with&quot;</span>
</span><span id="ProjectiveObject-235"><a href="#ProjectiveObject-235"><span class="linenos">235</span></a>                <span class="s2">&quot; ndim at least </span><span class="si">{}</span><span class="s2">, got array of shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ProjectiveObject-236"><a href="#ProjectiveObject-236"><span class="linenos">236</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-237"><a href="#ProjectiveObject-237"><span class="linenos">237</span></a>                    <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="p">)</span>
</span><span id="ProjectiveObject-238"><a href="#ProjectiveObject-238"><span class="linenos">238</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="ProjectiveObject-239"><a href="#ProjectiveObject-239"><span class="linenos">239</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">((</span><span class="s2">&quot;Dual data provided to </span><span class="si">{}</span><span class="s2"> must be a&quot;</span>
</span><span id="ProjectiveObject-240"><a href="#ProjectiveObject-240"><span class="linenos">240</span></a>            <span class="s2">&quot; numpy array&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
</span><span id="ProjectiveObject-241"><a href="#ProjectiveObject-241"><span class="linenos">241</span></a>
</span><span id="ProjectiveObject-242"><a href="#ProjectiveObject-242"><span class="linenos">242</span></a>    <span class="k">def</span> <span class="nf">_assert_data_consistent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">):</span>
</span><span id="ProjectiveObject-243"><a href="#ProjectiveObject-243"><span class="linenos">243</span></a>        <span class="n">proj_shape</span> <span class="o">=</span> <span class="n">aux_shape</span> <span class="o">=</span> <span class="n">dual_shape</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-244"><a href="#ProjectiveObject-244"><span class="linenos">244</span></a>
</span><span id="ProjectiveObject-245"><a href="#ProjectiveObject-245"><span class="linenos">245</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-246"><a href="#ProjectiveObject-246"><span class="linenos">246</span></a>            <span class="n">proj_shape</span> <span class="o">=</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">]</span>
</span><span id="ProjectiveObject-247"><a href="#ProjectiveObject-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-248"><a href="#ProjectiveObject-248"><span class="linenos">248</span></a>            <span class="n">aux_shape</span> <span class="o">=</span> <span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">]</span>
</span><span id="ProjectiveObject-249"><a href="#ProjectiveObject-249"><span class="linenos">249</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-250"><a href="#ProjectiveObject-250"><span class="linenos">250</span></a>            <span class="n">dual_shape</span> <span class="o">=</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">]</span>
</span><span id="ProjectiveObject-251"><a href="#ProjectiveObject-251"><span class="linenos">251</span></a>
</span><span id="ProjectiveObject-252"><a href="#ProjectiveObject-252"><span class="linenos">252</span></a>        <span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="n">shape</span> <span class="k">for</span> <span class="n">shape</span> <span class="ow">in</span> <span class="p">[</span><span class="n">proj_shape</span><span class="p">,</span> <span class="n">aux_shape</span><span class="p">,</span> <span class="n">dual_shape</span><span class="p">]</span>
</span><span id="ProjectiveObject-253"><a href="#ProjectiveObject-253"><span class="linenos">253</span></a>                  <span class="k">if</span> <span class="n">shape</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
</span><span id="ProjectiveObject-254"><a href="#ProjectiveObject-254"><span class="linenos">254</span></a>
</span><span id="ProjectiveObject-255"><a href="#ProjectiveObject-255"><span class="linenos">255</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">shapes</span><span class="p">)</span> <span class="o">==</span> <span class="n">shapes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="ProjectiveObject-256"><a href="#ProjectiveObject-256"><span class="linenos">256</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-257"><a href="#ProjectiveObject-257"><span class="linenos">257</span></a>
</span><span id="ProjectiveObject-258"><a href="#ProjectiveObject-258"><span class="linenos">258</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Mismatched regular/aux/dual data shapes for </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="ProjectiveObject-259"><a href="#ProjectiveObject-259"><span class="linenos">259</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</span><span id="ProjectiveObject-260"><a href="#ProjectiveObject-260"><span class="linenos">260</span></a>
</span><span id="ProjectiveObject-261"><a href="#ProjectiveObject-261"><span class="linenos">261</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="ProjectiveObject-262"><a href="#ProjectiveObject-262"><span class="linenos">262</span></a>        <span class="k">return</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-263"><a href="#ProjectiveObject-263"><span class="linenos">263</span></a>
</span><span id="ProjectiveObject-264"><a href="#ProjectiveObject-264"><span class="linenos">264</span></a>    <span class="k">def</span> <span class="nf">_construct_from_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyp_obj</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject-265"><a href="#ProjectiveObject-265"><span class="linenos">265</span></a>        <span class="sd">&quot;&quot;&quot;if we&#39;re passed a projective object or an array of projective</span>
</span><span id="ProjectiveObject-266"><a href="#ProjectiveObject-266"><span class="linenos">266</span></a><span class="sd">        objects, build a new one out of them</span>
</span><span id="ProjectiveObject-267"><a href="#ProjectiveObject-267"><span class="linenos">267</span></a>
</span><span id="ProjectiveObject-268"><a href="#ProjectiveObject-268"><span class="linenos">268</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-269"><a href="#ProjectiveObject-269"><span class="linenos">269</span></a>
</span><span id="ProjectiveObject-270"><a href="#ProjectiveObject-270"><span class="linenos">270</span></a>        <span class="n">type_error</span> <span class="o">=</span> <span class="ne">TypeError</span><span class="p">(</span>
</span><span id="ProjectiveObject-271"><a href="#ProjectiveObject-271"><span class="linenos">271</span></a>            <span class="s2">&quot;hyp_obj is not a projective object or an iterable of &quot;</span>
</span><span id="ProjectiveObject-272"><a href="#ProjectiveObject-272"><span class="linenos">272</span></a>            <span class="s2">&quot;projective objects.&quot;</span>
</span><span id="ProjectiveObject-273"><a href="#ProjectiveObject-273"><span class="linenos">273</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject-274"><a href="#ProjectiveObject-274"><span class="linenos">274</span></a>
</span><span id="ProjectiveObject-275"><a href="#ProjectiveObject-275"><span class="linenos">275</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject-276"><a href="#ProjectiveObject-276"><span class="linenos">276</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyp_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-277"><a href="#ProjectiveObject-277"><span class="linenos">277</span></a>                     <span class="n">aux_data</span><span class="o">=</span><span class="n">hyp_obj</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-278"><a href="#ProjectiveObject-278"><span class="linenos">278</span></a>                     <span class="n">dual_data</span><span class="o">=</span><span class="n">hyp_obj</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-279"><a href="#ProjectiveObject-279"><span class="linenos">279</span></a>                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-280"><a href="#ProjectiveObject-280"><span class="linenos">280</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-281"><a href="#ProjectiveObject-281"><span class="linenos">281</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="ProjectiveObject-282"><a href="#ProjectiveObject-282"><span class="linenos">282</span></a>            <span class="k">pass</span>
</span><span id="ProjectiveObject-283"><a href="#ProjectiveObject-283"><span class="linenos">283</span></a>
</span><span id="ProjectiveObject-284"><a href="#ProjectiveObject-284"><span class="linenos">284</span></a>        <span class="n">unrolled_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">hyp_obj</span><span class="p">)</span>
</span><span id="ProjectiveObject-285"><a href="#ProjectiveObject-285"><span class="linenos">285</span></a>
</span><span id="ProjectiveObject-286"><a href="#ProjectiveObject-286"><span class="linenos">286</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unrolled_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-287"><a href="#ProjectiveObject-287"><span class="linenos">287</span></a>            <span class="k">raise</span> <span class="n">type_error</span>
</span><span id="ProjectiveObject-288"><a href="#ProjectiveObject-288"><span class="linenos">288</span></a>
</span><span id="ProjectiveObject-289"><a href="#ProjectiveObject-289"><span class="linenos">289</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject-290"><a href="#ProjectiveObject-290"><span class="linenos">290</span></a>            <span class="n">hyp_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">proj_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">unrolled_obj</span><span class="p">])</span>
</span><span id="ProjectiveObject-291"><a href="#ProjectiveObject-291"><span class="linenos">291</span></a>            <span class="n">aux_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">aux_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">unrolled_obj</span><span class="p">])</span>
</span><span id="ProjectiveObject-292"><a href="#ProjectiveObject-292"><span class="linenos">292</span></a>            <span class="n">dual_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="n">dual_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">unrolled_obj</span><span class="p">])</span>
</span><span id="ProjectiveObject-293"><a href="#ProjectiveObject-293"><span class="linenos">293</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="ProjectiveObject-294"><a href="#ProjectiveObject-294"><span class="linenos">294</span></a>            <span class="k">raise</span> <span class="n">type_error</span>
</span><span id="ProjectiveObject-295"><a href="#ProjectiveObject-295"><span class="linenos">295</span></a>
</span><span id="ProjectiveObject-296"><a href="#ProjectiveObject-296"><span class="linenos">296</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">hyp_array</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="ProjectiveObject-297"><a href="#ProjectiveObject-297"><span class="linenos">297</span></a>            <span class="n">hyp_array</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-298"><a href="#ProjectiveObject-298"><span class="linenos">298</span></a>
</span><span id="ProjectiveObject-299"><a href="#ProjectiveObject-299"><span class="linenos">299</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">aux_array</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="ProjectiveObject-300"><a href="#ProjectiveObject-300"><span class="linenos">300</span></a>            <span class="n">aux_array</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-301"><a href="#ProjectiveObject-301"><span class="linenos">301</span></a>
</span><span id="ProjectiveObject-302"><a href="#ProjectiveObject-302"><span class="linenos">302</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">dual_array</span> <span class="o">==</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="ProjectiveObject-303"><a href="#ProjectiveObject-303"><span class="linenos">303</span></a>            <span class="n">dual_array</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-304"><a href="#ProjectiveObject-304"><span class="linenos">304</span></a>
</span><span id="ProjectiveObject-305"><a href="#ProjectiveObject-305"><span class="linenos">305</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject-306"><a href="#ProjectiveObject-306"><span class="linenos">306</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyp_array</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_array</span><span class="p">,</span>
</span><span id="ProjectiveObject-307"><a href="#ProjectiveObject-307"><span class="linenos">307</span></a>                     <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_array</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-308"><a href="#ProjectiveObject-308"><span class="linenos">308</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="ProjectiveObject-309"><a href="#ProjectiveObject-309"><span class="linenos">309</span></a>            <span class="k">raise</span> <span class="n">type_error</span>
</span><span id="ProjectiveObject-310"><a href="#ProjectiveObject-310"><span class="linenos">310</span></a>
</span><span id="ProjectiveObject-311"><a href="#ProjectiveObject-311"><span class="linenos">311</span></a>    <span class="nd">@property</span>
</span><span id="ProjectiveObject-312"><a href="#ProjectiveObject-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject-313"><a href="#ProjectiveObject-313"><span class="linenos">313</span></a>        <span class="sd">&quot;&quot;&quot;Get the shape of the ndarray of &quot;unit objects&quot; this</span>
</span><span id="ProjectiveObject-314"><a href="#ProjectiveObject-314"><span class="linenos">314</span></a><span class="sd">        ProjectiveObject represents.</span>
</span><span id="ProjectiveObject-315"><a href="#ProjectiveObject-315"><span class="linenos">315</span></a>
</span><span id="ProjectiveObject-316"><a href="#ProjectiveObject-316"><span class="linenos">316</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveObject-317"><a href="#ProjectiveObject-317"><span class="linenos">317</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveObject-318"><a href="#ProjectiveObject-318"><span class="linenos">318</span></a><span class="sd">        tuple</span>
</span><span id="ProjectiveObject-319"><a href="#ProjectiveObject-319"><span class="linenos">319</span></a>
</span><span id="ProjectiveObject-320"><a href="#ProjectiveObject-320"><span class="linenos">320</span></a>
</span><span id="ProjectiveObject-321"><a href="#ProjectiveObject-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-322"><a href="#ProjectiveObject-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">]</span>
</span><span id="ProjectiveObject-323"><a href="#ProjectiveObject-323"><span class="linenos">323</span></a>
</span><span id="ProjectiveObject-324"><a href="#ProjectiveObject-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
</span><span id="ProjectiveObject-325"><a href="#ProjectiveObject-325"><span class="linenos">325</span></a>        <span class="n">old_proj_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject-326"><a href="#ProjectiveObject-326"><span class="linenos">326</span></a>        <span class="n">proj_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="ProjectiveObject-327"><a href="#ProjectiveObject-327"><span class="linenos">327</span></a>            <span class="n">shape</span> <span class="o">+</span> <span class="n">old_proj_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:]</span>
</span><span id="ProjectiveObject-328"><a href="#ProjectiveObject-328"><span class="linenos">328</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject-329"><a href="#ProjectiveObject-329"><span class="linenos">329</span></a>
</span><span id="ProjectiveObject-330"><a href="#ProjectiveObject-330"><span class="linenos">330</span></a>        <span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-331"><a href="#ProjectiveObject-331"><span class="linenos">331</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-332"><a href="#ProjectiveObject-332"><span class="linenos">332</span></a>            <span class="n">old_aux_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject-333"><a href="#ProjectiveObject-333"><span class="linenos">333</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="ProjectiveObject-334"><a href="#ProjectiveObject-334"><span class="linenos">334</span></a>                <span class="n">shape</span> <span class="o">+</span> <span class="n">old_aux_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">:]</span>
</span><span id="ProjectiveObject-335"><a href="#ProjectiveObject-335"><span class="linenos">335</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-336"><a href="#ProjectiveObject-336"><span class="linenos">336</span></a>
</span><span id="ProjectiveObject-337"><a href="#ProjectiveObject-337"><span class="linenos">337</span></a>        <span class="n">dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-338"><a href="#ProjectiveObject-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-339"><a href="#ProjectiveObject-339"><span class="linenos">339</span></a>            <span class="n">old_dual_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject-340"><a href="#ProjectiveObject-340"><span class="linenos">340</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="ProjectiveObject-341"><a href="#ProjectiveObject-341"><span class="linenos">341</span></a>                <span class="n">shape</span> <span class="o">+</span> <span class="n">old_dual_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">:]</span>
</span><span id="ProjectiveObject-342"><a href="#ProjectiveObject-342"><span class="linenos">342</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-343"><a href="#ProjectiveObject-343"><span class="linenos">343</span></a>
</span><span id="ProjectiveObject-344"><a href="#ProjectiveObject-344"><span class="linenos">344</span></a>        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-345"><a href="#ProjectiveObject-345"><span class="linenos">345</span></a>                                   <span class="n">aux_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-346"><a href="#ProjectiveObject-346"><span class="linenos">346</span></a>                                   <span class="n">dual_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-347"><a href="#ProjectiveObject-347"><span class="linenos">347</span></a>                                   <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-348"><a href="#ProjectiveObject-348"><span class="linenos">348</span></a>                                   <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-349"><a href="#ProjectiveObject-349"><span class="linenos">349</span></a>                                   <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject-350"><a href="#ProjectiveObject-350"><span class="linenos">350</span></a>
</span><span id="ProjectiveObject-351"><a href="#ProjectiveObject-351"><span class="linenos">351</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
</span><span id="ProjectiveObject-352"><a href="#ProjectiveObject-352"><span class="linenos">352</span></a>
</span><span id="ProjectiveObject-353"><a href="#ProjectiveObject-353"><span class="linenos">353</span></a>
</span><span id="ProjectiveObject-354"><a href="#ProjectiveObject-354"><span class="linenos">354</span></a>
</span><span id="ProjectiveObject-355"><a href="#ProjectiveObject-355"><span class="linenos">355</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ProjectiveObject-356"><a href="#ProjectiveObject-356"><span class="linenos">356</span></a>            <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject-357"><a href="#ProjectiveObject-357"><span class="linenos">357</span></a>        <span class="sd">&quot;&quot;&quot;set the underlying data of the hyperbolic object.</span>
</span><span id="ProjectiveObject-358"><a href="#ProjectiveObject-358"><span class="linenos">358</span></a>
</span><span id="ProjectiveObject-359"><a href="#ProjectiveObject-359"><span class="linenos">359</span></a><span class="sd">        Subclasses may override this method to give special names to</span>
</span><span id="ProjectiveObject-360"><a href="#ProjectiveObject-360"><span class="linenos">360</span></a><span class="sd">        portions of the underlying data.</span>
</span><span id="ProjectiveObject-361"><a href="#ProjectiveObject-361"><span class="linenos">361</span></a>
</span><span id="ProjectiveObject-362"><a href="#ProjectiveObject-362"><span class="linenos">362</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject-363"><a href="#ProjectiveObject-363"><span class="linenos">363</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject-364"><a href="#ProjectiveObject-364"><span class="linenos">364</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="ProjectiveObject-365"><a href="#ProjectiveObject-365"><span class="linenos">365</span></a><span class="sd">            underyling data representing this projective object.</span>
</span><span id="ProjectiveObject-366"><a href="#ProjectiveObject-366"><span class="linenos">366</span></a>
</span><span id="ProjectiveObject-367"><a href="#ProjectiveObject-367"><span class="linenos">367</span></a><span class="sd">        aux_data : ndarray</span>
</span><span id="ProjectiveObject-368"><a href="#ProjectiveObject-368"><span class="linenos">368</span></a><span class="sd">            underyling auxiliary data for this projective object.</span>
</span><span id="ProjectiveObject-369"><a href="#ProjectiveObject-369"><span class="linenos">369</span></a>
</span><span id="ProjectiveObject-370"><a href="#ProjectiveObject-370"><span class="linenos">370</span></a><span class="sd">        dual_data : ndarray</span>
</span><span id="ProjectiveObject-371"><a href="#ProjectiveObject-371"><span class="linenos">371</span></a><span class="sd">            underlying dual data for this projective object.</span>
</span><span id="ProjectiveObject-372"><a href="#ProjectiveObject-372"><span class="linenos">372</span></a>
</span><span id="ProjectiveObject-373"><a href="#ProjectiveObject-373"><span class="linenos">373</span></a><span class="sd">        base_ring : object</span>
</span><span id="ProjectiveObject-374"><a href="#ProjectiveObject-374"><span class="linenos">374</span></a><span class="sd">            *(requires sage).* Base ring for matrix entries of the</span>
</span><span id="ProjectiveObject-375"><a href="#ProjectiveObject-375"><span class="linenos">375</span></a><span class="sd">             underlying data for this object. This allows for exact</span>
</span><span id="ProjectiveObject-376"><a href="#ProjectiveObject-376"><span class="linenos">376</span></a><span class="sd">             computations in projective space (at the cost of</span>
</span><span id="ProjectiveObject-377"><a href="#ProjectiveObject-377"><span class="linenos">377</span></a><span class="sd">             performance) by supplying a ring that supports exact</span>
</span><span id="ProjectiveObject-378"><a href="#ProjectiveObject-378"><span class="linenos">378</span></a><span class="sd">             computations. The dtype of the underlying data is</span>
</span><span id="ProjectiveObject-379"><a href="#ProjectiveObject-379"><span class="linenos">379</span></a><span class="sd">             automatically converted to &quot;object&quot; if this is specified.</span>
</span><span id="ProjectiveObject-380"><a href="#ProjectiveObject-380"><span class="linenos">380</span></a>
</span><span id="ProjectiveObject-381"><a href="#ProjectiveObject-381"><span class="linenos">381</span></a><span class="sd">        rational_approx : bool</span>
</span><span id="ProjectiveObject-382"><a href="#ProjectiveObject-382"><span class="linenos">382</span></a><span class="sd">            *(requires sage).* If base_ring is specified, coerce</span>
</span><span id="ProjectiveObject-383"><a href="#ProjectiveObject-383"><span class="linenos">383</span></a><span class="sd">             floating-point data to a rational approximation before</span>
</span><span id="ProjectiveObject-384"><a href="#ProjectiveObject-384"><span class="linenos">384</span></a><span class="sd">             converting to the specified ring. This is useful for</span>
</span><span id="ProjectiveObject-385"><a href="#ProjectiveObject-385"><span class="linenos">385</span></a><span class="sd">             combining computations with floating-point values with</span>
</span><span id="ProjectiveObject-386"><a href="#ProjectiveObject-386"><span class="linenos">386</span></a><span class="sd">             computations in algebraic number fields.</span>
</span><span id="ProjectiveObject-387"><a href="#ProjectiveObject-387"><span class="linenos">387</span></a>
</span><span id="ProjectiveObject-388"><a href="#ProjectiveObject-388"><span class="linenos">388</span></a><span class="sd">        Raises</span>
</span><span id="ProjectiveObject-389"><a href="#ProjectiveObject-389"><span class="linenos">389</span></a><span class="sd">        ------</span>
</span><span id="ProjectiveObject-390"><a href="#ProjectiveObject-390"><span class="linenos">390</span></a><span class="sd">        EnvironmentError</span>
</span><span id="ProjectiveObject-391"><a href="#ProjectiveObject-391"><span class="linenos">391</span></a><span class="sd">            Raised if base_ring is specified but sage is not available</span>
</span><span id="ProjectiveObject-392"><a href="#ProjectiveObject-392"><span class="linenos">392</span></a><span class="sd">            for import.</span>
</span><span id="ProjectiveObject-393"><a href="#ProjectiveObject-393"><span class="linenos">393</span></a>
</span><span id="ProjectiveObject-394"><a href="#ProjectiveObject-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-395"><a href="#ProjectiveObject-395"><span class="linenos">395</span></a>
</span><span id="ProjectiveObject-396"><a href="#ProjectiveObject-396"><span class="linenos">396</span></a>        <span class="c1">#TODO: add &quot;like&quot; and &quot;dtype&quot; to kwargs</span>
</span><span id="ProjectiveObject-397"><a href="#ProjectiveObject-397"><span class="linenos">397</span></a>
</span><span id="ProjectiveObject-398"><a href="#ProjectiveObject-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-399"><a href="#ProjectiveObject-399"><span class="linenos">399</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-400"><a href="#ProjectiveObject-400"><span class="linenos">400</span></a>
</span><span id="ProjectiveObject-401"><a href="#ProjectiveObject-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-402"><a href="#ProjectiveObject-402"><span class="linenos">402</span></a>
</span><span id="ProjectiveObject-403"><a href="#ProjectiveObject-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-404"><a href="#ProjectiveObject-404"><span class="linenos">404</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-405"><a href="#ProjectiveObject-405"><span class="linenos">405</span></a>
</span><span id="ProjectiveObject-406"><a href="#ProjectiveObject-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_dual_valid</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-407"><a href="#ProjectiveObject-407"><span class="linenos">407</span></a>
</span><span id="ProjectiveObject-408"><a href="#ProjectiveObject-408"><span class="linenos">408</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-409"><a href="#ProjectiveObject-409"><span class="linenos">409</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_aux_data</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-410"><a href="#ProjectiveObject-410"><span class="linenos">410</span></a>
</span><span id="ProjectiveObject-411"><a href="#ProjectiveObject-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_aux_valid</span><span class="p">(</span><span class="n">aux_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-412"><a href="#ProjectiveObject-412"><span class="linenos">412</span></a>
</span><span id="ProjectiveObject-413"><a href="#ProjectiveObject-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="n">proj_data</span>
</span><span id="ProjectiveObject-414"><a href="#ProjectiveObject-414"><span class="linenos">414</span></a>
</span><span id="ProjectiveObject-415"><a href="#ProjectiveObject-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-416"><a href="#ProjectiveObject-416"><span class="linenos">416</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="n">aux_data</span>
</span><span id="ProjectiveObject-417"><a href="#ProjectiveObject-417"><span class="linenos">417</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ProjectiveObject-418"><a href="#ProjectiveObject-418"><span class="linenos">418</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-419"><a href="#ProjectiveObject-419"><span class="linenos">419</span></a>
</span><span id="ProjectiveObject-420"><a href="#ProjectiveObject-420"><span class="linenos">420</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-421"><a href="#ProjectiveObject-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">dual_data</span>
</span><span id="ProjectiveObject-422"><a href="#ProjectiveObject-422"><span class="linenos">422</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ProjectiveObject-423"><a href="#ProjectiveObject-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-424"><a href="#ProjectiveObject-424"><span class="linenos">424</span></a>
</span><span id="ProjectiveObject-425"><a href="#ProjectiveObject-425"><span class="linenos">425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_optional</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-426"><a href="#ProjectiveObject-426"><span class="linenos">426</span></a>
</span><span id="ProjectiveObject-427"><a href="#ProjectiveObject-427"><span class="linenos">427</span></a>    <span class="k">def</span> <span class="nf">_set_optional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rational_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="ProjectiveObject-428"><a href="#ProjectiveObject-428"><span class="linenos">428</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">base_ring</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-429"><a href="#ProjectiveObject-429"><span class="linenos">429</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-430"><a href="#ProjectiveObject-430"><span class="linenos">430</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="ProjectiveObject-431"><a href="#ProjectiveObject-431"><span class="linenos">431</span></a>                <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
</span><span id="ProjectiveObject-432"><a href="#ProjectiveObject-432"><span class="linenos">432</span></a>                    <span class="s2">&quot;Cannot specify base ring unless sage is available&quot;</span>
</span><span id="ProjectiveObject-433"><a href="#ProjectiveObject-433"><span class="linenos">433</span></a>                <span class="p">)</span>
</span><span id="ProjectiveObject-434"><a href="#ProjectiveObject-434"><span class="linenos">434</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="n">base_ring</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="ProjectiveObject-435"><a href="#ProjectiveObject-435"><span class="linenos">435</span></a>                                  <span class="n">rational_approx</span><span class="o">=</span><span class="n">rational_approx</span><span class="p">)</span>
</span><span id="ProjectiveObject-436"><a href="#ProjectiveObject-436"><span class="linenos">436</span></a>
</span><span id="ProjectiveObject-437"><a href="#ProjectiveObject-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">flatten_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ProjectiveObject-438"><a href="#ProjectiveObject-438"><span class="linenos">438</span></a>        <span class="sd">&quot;&quot;&quot;Get a flattened version of the projective object.</span>
</span><span id="ProjectiveObject-439"><a href="#ProjectiveObject-439"><span class="linenos">439</span></a>
</span><span id="ProjectiveObject-440"><a href="#ProjectiveObject-440"><span class="linenos">440</span></a><span class="sd">        This method reshapes the underlying data of the projective</span>
</span><span id="ProjectiveObject-441"><a href="#ProjectiveObject-441"><span class="linenos">441</span></a><span class="sd">        object to get a &quot;flat&quot; composite list of objects. For example,</span>
</span><span id="ProjectiveObject-442"><a href="#ProjectiveObject-442"><span class="linenos">442</span></a><span class="sd">        if called on a Segment object whose underlying array has shape</span>
</span><span id="ProjectiveObject-443"><a href="#ProjectiveObject-443"><span class="linenos">443</span></a><span class="sd">        (4, 5, 2, 3), this method uses the `unit_ndims` data member to</span>
</span><span id="ProjectiveObject-444"><a href="#ProjectiveObject-444"><span class="linenos">444</span></a><span class="sd">        interprets this array as an array of segments with shape</span>
</span><span id="ProjectiveObject-445"><a href="#ProjectiveObject-445"><span class="linenos">445</span></a><span class="sd">        (4,5), and returns a Segment object whose underlying array has</span>
</span><span id="ProjectiveObject-446"><a href="#ProjectiveObject-446"><span class="linenos">446</span></a><span class="sd">        shape (20, 2, 3).</span>
</span><span id="ProjectiveObject-447"><a href="#ProjectiveObject-447"><span class="linenos">447</span></a>
</span><span id="ProjectiveObject-448"><a href="#ProjectiveObject-448"><span class="linenos">448</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject-449"><a href="#ProjectiveObject-449"><span class="linenos">449</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject-450"><a href="#ProjectiveObject-450"><span class="linenos">450</span></a>
</span><span id="ProjectiveObject-451"><a href="#ProjectiveObject-451"><span class="linenos">451</span></a><span class="sd">        unit : int</span>
</span><span id="ProjectiveObject-452"><a href="#ProjectiveObject-452"><span class="linenos">452</span></a><span class="sd">            the number of ndims to treat as a &quot;unit&quot; when flattening</span>
</span><span id="ProjectiveObject-453"><a href="#ProjectiveObject-453"><span class="linenos">453</span></a><span class="sd">            this object into units.</span>
</span><span id="ProjectiveObject-454"><a href="#ProjectiveObject-454"><span class="linenos">454</span></a>
</span><span id="ProjectiveObject-455"><a href="#ProjectiveObject-455"><span class="linenos">455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-456"><a href="#ProjectiveObject-456"><span class="linenos">456</span></a>
</span><span id="ProjectiveObject-457"><a href="#ProjectiveObject-457"><span class="linenos">457</span></a>        <span class="n">aux_unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="ProjectiveObject-458"><a href="#ProjectiveObject-458"><span class="linenos">458</span></a>        <span class="n">dual_unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="ProjectiveObject-459"><a href="#ProjectiveObject-459"><span class="linenos">459</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-460"><a href="#ProjectiveObject-460"><span class="linenos">460</span></a>            <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span>
</span><span id="ProjectiveObject-461"><a href="#ProjectiveObject-461"><span class="linenos">461</span></a>            <span class="n">aux_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span>
</span><span id="ProjectiveObject-462"><a href="#ProjectiveObject-462"><span class="linenos">462</span></a>            <span class="n">dual_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span>
</span><span id="ProjectiveObject-463"><a href="#ProjectiveObject-463"><span class="linenos">463</span></a>
</span><span id="ProjectiveObject-464"><a href="#ProjectiveObject-464"><span class="linenos">464</span></a>        <span class="n">flattened</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ProjectiveObject-465"><a href="#ProjectiveObject-465"><span class="linenos">465</span></a>        <span class="n">new_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">unit</span><span class="p">:]</span>
</span><span id="ProjectiveObject-466"><a href="#ProjectiveObject-466"><span class="linenos">466</span></a>        <span class="n">new_proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
</span><span id="ProjectiveObject-467"><a href="#ProjectiveObject-467"><span class="linenos">467</span></a>
</span><span id="ProjectiveObject-468"><a href="#ProjectiveObject-468"><span class="linenos">468</span></a>        <span class="n">new_aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-469"><a href="#ProjectiveObject-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-470"><a href="#ProjectiveObject-470"><span class="linenos">470</span></a>            <span class="n">new_aux_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">aux_unit</span><span class="p">:]</span>
</span><span id="ProjectiveObject-471"><a href="#ProjectiveObject-471"><span class="linenos">471</span></a>            <span class="n">new_aux_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">new_aux_shape</span><span class="p">)</span>
</span><span id="ProjectiveObject-472"><a href="#ProjectiveObject-472"><span class="linenos">472</span></a>
</span><span id="ProjectiveObject-473"><a href="#ProjectiveObject-473"><span class="linenos">473</span></a>        <span class="n">new_dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-474"><a href="#ProjectiveObject-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-475"><a href="#ProjectiveObject-475"><span class="linenos">475</span></a>            <span class="n">new_dual_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">dual_unit</span><span class="p">:]</span>
</span><span id="ProjectiveObject-476"><a href="#ProjectiveObject-476"><span class="linenos">476</span></a>            <span class="n">new_dual_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">new_dual_shape</span><span class="p">)</span>
</span><span id="ProjectiveObject-477"><a href="#ProjectiveObject-477"><span class="linenos">477</span></a>
</span><span id="ProjectiveObject-478"><a href="#ProjectiveObject-478"><span class="linenos">478</span></a>        <span class="n">flattened</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">new_proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">new_aux_data</span><span class="p">,</span>
</span><span id="ProjectiveObject-479"><a href="#ProjectiveObject-479"><span class="linenos">479</span></a>                      <span class="n">dual_data</span><span class="o">=</span><span class="n">new_dual_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-480"><a href="#ProjectiveObject-480"><span class="linenos">480</span></a>
</span><span id="ProjectiveObject-481"><a href="#ProjectiveObject-481"><span class="linenos">481</span></a>        <span class="k">return</span> <span class="n">flattened</span>
</span><span id="ProjectiveObject-482"><a href="#ProjectiveObject-482"><span class="linenos">482</span></a>
</span><span id="ProjectiveObject-483"><a href="#ProjectiveObject-483"><span class="linenos">483</span></a>    <span class="k">def</span> <span class="nf">flatten_to_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject-484"><a href="#ProjectiveObject-484"><span class="linenos">484</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject-485"><a href="#ProjectiveObject-485"><span class="linenos">485</span></a>
</span><span id="ProjectiveObject-486"><a href="#ProjectiveObject-486"><span class="linenos">486</span></a>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject-487"><a href="#ProjectiveObject-487"><span class="linenos">487</span></a>        <span class="k">return</span> <span class="s2">&quot;(</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ProjectiveObject-488"><a href="#ProjectiveObject-488"><span class="linenos">488</span></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span>
</span><span id="ProjectiveObject-489"><a href="#ProjectiveObject-489"><span class="linenos">489</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span>
</span><span id="ProjectiveObject-490"><a href="#ProjectiveObject-490"><span class="linenos">490</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject-491"><a href="#ProjectiveObject-491"><span class="linenos">491</span></a>
</span><span id="ProjectiveObject-492"><a href="#ProjectiveObject-492"><span class="linenos">492</span></a>    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject-493"><a href="#ProjectiveObject-493"><span class="linenos">493</span></a>        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> with data:</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="ProjectiveObject-494"><a href="#ProjectiveObject-494"><span class="linenos">494</span></a>            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
</span><span id="ProjectiveObject-495"><a href="#ProjectiveObject-495"><span class="linenos">495</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject-496"><a href="#ProjectiveObject-496"><span class="linenos">496</span></a>
</span><span id="ProjectiveObject-497"><a href="#ProjectiveObject-497"><span class="linenos">497</span></a>    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
</span><span id="ProjectiveObject-498"><a href="#ProjectiveObject-498"><span class="linenos">498</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
</span><span id="ProjectiveObject-499"><a href="#ProjectiveObject-499"><span class="linenos">499</span></a>
</span><span id="ProjectiveObject-500"><a href="#ProjectiveObject-500"><span class="linenos">500</span></a>    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
</span><span id="ProjectiveObject-501"><a href="#ProjectiveObject-501"><span class="linenos">501</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="ProjectiveObject-502"><a href="#ProjectiveObject-502"><span class="linenos">502</span></a>
</span><span id="ProjectiveObject-503"><a href="#ProjectiveObject-503"><span class="linenos">503</span></a>    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject-504"><a href="#ProjectiveObject-504"><span class="linenos">504</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:</span>
</span><span id="ProjectiveObject-505"><a href="#ProjectiveObject-505"><span class="linenos">505</span></a>            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;len() of unsized object&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject-506"><a href="#ProjectiveObject-506"><span class="linenos">506</span></a>
</span><span id="ProjectiveObject-507"><a href="#ProjectiveObject-507"><span class="linenos">507</span></a>        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject-508"><a href="#ProjectiveObject-508"><span class="linenos">508</span></a>
</span><span id="ProjectiveObject-509"><a href="#ProjectiveObject-509"><span class="linenos">509</span></a>    <span class="k">def</span> <span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
</span><span id="ProjectiveObject-510"><a href="#ProjectiveObject-510"><span class="linenos">510</span></a>        <span class="n">new_proj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ProjectiveObject-511"><a href="#ProjectiveObject-511"><span class="linenos">511</span></a>        <span class="n">new_aux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-512"><a href="#ProjectiveObject-512"><span class="linenos">512</span></a>        <span class="n">new_dual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-513"><a href="#ProjectiveObject-513"><span class="linenos">513</span></a>
</span><span id="ProjectiveObject-514"><a href="#ProjectiveObject-514"><span class="linenos">514</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-515"><a href="#ProjectiveObject-515"><span class="linenos">515</span></a>            <span class="n">new_aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ProjectiveObject-516"><a href="#ProjectiveObject-516"><span class="linenos">516</span></a>
</span><span id="ProjectiveObject-517"><a href="#ProjectiveObject-517"><span class="linenos">517</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-518"><a href="#ProjectiveObject-518"><span class="linenos">518</span></a>            <span class="n">new_dual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ProjectiveObject-519"><a href="#ProjectiveObject-519"><span class="linenos">519</span></a>
</span><span id="ProjectiveObject-520"><a href="#ProjectiveObject-520"><span class="linenos">520</span></a>
</span><span id="ProjectiveObject-521"><a href="#ProjectiveObject-521"><span class="linenos">521</span></a>        <span class="n">newobj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">new_aux</span><span class="p">,</span> <span class="n">new_dual</span><span class="p">,</span>
</span><span id="ProjectiveObject-522"><a href="#ProjectiveObject-522"><span class="linenos">522</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-523"><a href="#ProjectiveObject-523"><span class="linenos">523</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-524"><a href="#ProjectiveObject-524"><span class="linenos">524</span></a>                                  <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject-525"><a href="#ProjectiveObject-525"><span class="linenos">525</span></a>
</span><span id="ProjectiveObject-526"><a href="#ProjectiveObject-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newobj</span><span class="p">)</span>
</span><span id="ProjectiveObject-527"><a href="#ProjectiveObject-527"><span class="linenos">527</span></a>
</span><span id="ProjectiveObject-528"><a href="#ProjectiveObject-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject-529"><a href="#ProjectiveObject-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="ProjectiveObject-530"><a href="#ProjectiveObject-530"><span class="linenos">530</span></a>            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
</span><span id="ProjectiveObject-531"><a href="#ProjectiveObject-531"><span class="linenos">531</span></a>                <span class="s2">&quot;Cannot change base ring unless sage is available&quot;</span>
</span><span id="ProjectiveObject-532"><a href="#ProjectiveObject-532"><span class="linenos">532</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-533"><a href="#ProjectiveObject-533"><span class="linenos">533</span></a>
</span><span id="ProjectiveObject-534"><a href="#ProjectiveObject-534"><span class="linenos">534</span></a>        <span class="n">newproj</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="ProjectiveObject-535"><a href="#ProjectiveObject-535"><span class="linenos">535</span></a>                                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-536"><a href="#ProjectiveObject-536"><span class="linenos">536</span></a>
</span><span id="ProjectiveObject-537"><a href="#ProjectiveObject-537"><span class="linenos">537</span></a>        <span class="n">newaux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-538"><a href="#ProjectiveObject-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-539"><a href="#ProjectiveObject-539"><span class="linenos">539</span></a>            <span class="n">newaux</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="ProjectiveObject-540"><a href="#ProjectiveObject-540"><span class="linenos">540</span></a>                                               <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-541"><a href="#ProjectiveObject-541"><span class="linenos">541</span></a>
</span><span id="ProjectiveObject-542"><a href="#ProjectiveObject-542"><span class="linenos">542</span></a>        <span class="n">newdual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-543"><a href="#ProjectiveObject-543"><span class="linenos">543</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-544"><a href="#ProjectiveObject-544"><span class="linenos">544</span></a>            <span class="n">newdual</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="ProjectiveObject-545"><a href="#ProjectiveObject-545"><span class="linenos">545</span></a>                                                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-546"><a href="#ProjectiveObject-546"><span class="linenos">546</span></a>
</span><span id="ProjectiveObject-547"><a href="#ProjectiveObject-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
</span><span id="ProjectiveObject-548"><a href="#ProjectiveObject-548"><span class="linenos">548</span></a>            <span class="n">newobj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">newproj</span><span class="p">,</span> <span class="n">newaux</span><span class="p">,</span> <span class="n">newdual</span><span class="p">,</span>
</span><span id="ProjectiveObject-549"><a href="#ProjectiveObject-549"><span class="linenos">549</span></a>                                      <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-550"><a href="#ProjectiveObject-550"><span class="linenos">550</span></a>                                      <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-551"><a href="#ProjectiveObject-551"><span class="linenos">551</span></a>                                      <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject-552"><a href="#ProjectiveObject-552"><span class="linenos">552</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newobj</span><span class="p">)</span>
</span><span id="ProjectiveObject-553"><a href="#ProjectiveObject-553"><span class="linenos">553</span></a>
</span><span id="ProjectiveObject-554"><a href="#ProjectiveObject-554"><span class="linenos">554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="n">newproj</span>
</span><span id="ProjectiveObject-555"><a href="#ProjectiveObject-555"><span class="linenos">555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="n">newaux</span>
</span><span id="ProjectiveObject-556"><a href="#ProjectiveObject-556"><span class="linenos">556</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">newdual</span>
</span><span id="ProjectiveObject-557"><a href="#ProjectiveObject-557"><span class="linenos">557</span></a>
</span><span id="ProjectiveObject-558"><a href="#ProjectiveObject-558"><span class="linenos">558</span></a>    <span class="k">def</span> <span class="nf">projective_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject-559"><a href="#ProjectiveObject-559"><span class="linenos">559</span></a>        <span class="sd">&quot;&quot;&quot;Wrapper for ProjectiveObject.set, since underlying coordinates are</span>
</span><span id="ProjectiveObject-560"><a href="#ProjectiveObject-560"><span class="linenos">560</span></a><span class="sd">        projective.&quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-561"><a href="#ProjectiveObject-561"><span class="linenos">561</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-562"><a href="#ProjectiveObject-562"><span class="linenos">562</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-563"><a href="#ProjectiveObject-563"><span class="linenos">563</span></a>
</span><span id="ProjectiveObject-564"><a href="#ProjectiveObject-564"><span class="linenos">564</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="ProjectiveObject-565"><a href="#ProjectiveObject-565"><span class="linenos">565</span></a>
</span><span id="ProjectiveObject-566"><a href="#ProjectiveObject-566"><span class="linenos">566</span></a>    <span class="k">def</span> <span class="nf">affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject-567"><a href="#ProjectiveObject-567"><span class="linenos">567</span></a>        <span class="sd">&quot;&quot;&quot;Get or set affine coordinates for this object.</span>
</span><span id="ProjectiveObject-568"><a href="#ProjectiveObject-568"><span class="linenos">568</span></a>
</span><span id="ProjectiveObject-569"><a href="#ProjectiveObject-569"><span class="linenos">569</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject-570"><a href="#ProjectiveObject-570"><span class="linenos">570</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject-571"><a href="#ProjectiveObject-571"><span class="linenos">571</span></a><span class="sd">        aff_data : ndarray</span>
</span><span id="ProjectiveObject-572"><a href="#ProjectiveObject-572"><span class="linenos">572</span></a><span class="sd">            if not `None`, coordinate data for this point in an affine</span>
</span><span id="ProjectiveObject-573"><a href="#ProjectiveObject-573"><span class="linenos">573</span></a><span class="sd">            chart.</span>
</span><span id="ProjectiveObject-574"><a href="#ProjectiveObject-574"><span class="linenos">574</span></a>
</span><span id="ProjectiveObject-575"><a href="#ProjectiveObject-575"><span class="linenos">575</span></a><span class="sd">        chart_index : int</span>
</span><span id="ProjectiveObject-576"><a href="#ProjectiveObject-576"><span class="linenos">576</span></a><span class="sd">            index of standard affine chart to get/set coordinates in</span>
</span><span id="ProjectiveObject-577"><a href="#ProjectiveObject-577"><span class="linenos">577</span></a>
</span><span id="ProjectiveObject-578"><a href="#ProjectiveObject-578"><span class="linenos">578</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveObject-579"><a href="#ProjectiveObject-579"><span class="linenos">579</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveObject-580"><a href="#ProjectiveObject-580"><span class="linenos">580</span></a><span class="sd">        ndarray</span>
</span><span id="ProjectiveObject-581"><a href="#ProjectiveObject-581"><span class="linenos">581</span></a><span class="sd">            affine coordinates of this Point, in the specified</span>
</span><span id="ProjectiveObject-582"><a href="#ProjectiveObject-582"><span class="linenos">582</span></a><span class="sd">            standard affine chart.</span>
</span><span id="ProjectiveObject-583"><a href="#ProjectiveObject-583"><span class="linenos">583</span></a>
</span><span id="ProjectiveObject-584"><a href="#ProjectiveObject-584"><span class="linenos">584</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-585"><a href="#ProjectiveObject-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="n">aff_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-586"><a href="#ProjectiveObject-586"><span class="linenos">586</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">aff_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">),</span>
</span><span id="ProjectiveObject-587"><a href="#ProjectiveObject-587"><span class="linenos">587</span></a>                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject-588"><a href="#ProjectiveObject-588"><span class="linenos">588</span></a>
</span><span id="ProjectiveObject-589"><a href="#ProjectiveObject-589"><span class="linenos">589</span></a>        <span class="k">return</span> <span class="n">affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">,</span>
</span><span id="ProjectiveObject-590"><a href="#ProjectiveObject-590"><span class="linenos">590</span></a>                             <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="ProjectiveObject-591"><a href="#ProjectiveObject-591"><span class="linenos">591</span></a>
</span><span id="ProjectiveObject-592"><a href="#ProjectiveObject-592"><span class="linenos">592</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveObject-593"><a href="#ProjectiveObject-593"><span class="linenos">593</span></a>    <span class="k">def</span> <span class="nf">_assert_prop_equal</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">propname</span><span class="p">):</span>
</span><span id="ProjectiveObject-594"><a href="#ProjectiveObject-594"><span class="linenos">594</span></a>
</span><span id="ProjectiveObject-595"><a href="#ProjectiveObject-595"><span class="linenos">595</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-596"><a href="#ProjectiveObject-596"><span class="linenos">596</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-597"><a href="#ProjectiveObject-597"><span class="linenos">597</span></a>
</span><span id="ProjectiveObject-598"><a href="#ProjectiveObject-598"><span class="linenos">598</span></a>        <span class="n">properties</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">obj</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">propname</span><span class="p">]</span>
</span><span id="ProjectiveObject-599"><a href="#ProjectiveObject-599"><span class="linenos">599</span></a>                               <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">])</span>
</span><span id="ProjectiveObject-600"><a href="#ProjectiveObject-600"><span class="linenos">600</span></a>
</span><span id="ProjectiveObject-601"><a href="#ProjectiveObject-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">properties</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">properties</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="ProjectiveObject-602"><a href="#ProjectiveObject-602"><span class="linenos">602</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="ProjectiveObject-603"><a href="#ProjectiveObject-603"><span class="linenos">603</span></a>                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">propname</span><span class="si">}</span><span class="s2"> does not match for objects.&quot;</span>
</span><span id="ProjectiveObject-604"><a href="#ProjectiveObject-604"><span class="linenos">604</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-605"><a href="#ProjectiveObject-605"><span class="linenos">605</span></a>
</span><span id="ProjectiveObject-606"><a href="#ProjectiveObject-606"><span class="linenos">606</span></a>
</span><span id="ProjectiveObject-607"><a href="#ProjectiveObject-607"><span class="linenos">607</span></a>    <span class="nd">@classmethod</span>
</span><span id="ProjectiveObject-608"><a href="#ProjectiveObject-608"><span class="linenos">608</span></a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">to_combine</span><span class="p">):</span>
</span><span id="ProjectiveObject-609"><a href="#ProjectiveObject-609"><span class="linenos">609</span></a>        <span class="sd">&quot;&quot;&quot;Construct a new ProjectiveObject of combining the</span>
</span><span id="ProjectiveObject-610"><a href="#ProjectiveObject-610"><span class="linenos">610</span></a><span class="sd">        data of an array of objects.</span>
</span><span id="ProjectiveObject-611"><a href="#ProjectiveObject-611"><span class="linenos">611</span></a>
</span><span id="ProjectiveObject-612"><a href="#ProjectiveObject-612"><span class="linenos">612</span></a><span class="sd">        All of the objects in the given array will be flattened to</span>
</span><span id="ProjectiveObject-613"><a href="#ProjectiveObject-613"><span class="linenos">613</span></a><span class="sd">        unit dimensions before combining. If dimensions of the</span>
</span><span id="ProjectiveObject-614"><a href="#ProjectiveObject-614"><span class="linenos">614</span></a><span class="sd">        underlying data do not match, this will raise an error.</span>
</span><span id="ProjectiveObject-615"><a href="#ProjectiveObject-615"><span class="linenos">615</span></a>
</span><span id="ProjectiveObject-616"><a href="#ProjectiveObject-616"><span class="linenos">616</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject-617"><a href="#ProjectiveObject-617"><span class="linenos">617</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject-618"><a href="#ProjectiveObject-618"><span class="linenos">618</span></a><span class="sd">        to_combine : array of ProjectiveObjects with a common type</span>
</span><span id="ProjectiveObject-619"><a href="#ProjectiveObject-619"><span class="linenos">619</span></a>
</span><span id="ProjectiveObject-620"><a href="#ProjectiveObject-620"><span class="linenos">620</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveObject-621"><a href="#ProjectiveObject-621"><span class="linenos">621</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveObject-622"><a href="#ProjectiveObject-622"><span class="linenos">622</span></a><span class="sd">        ProjectiveObject</span>
</span><span id="ProjectiveObject-623"><a href="#ProjectiveObject-623"><span class="linenos">623</span></a><span class="sd">            Object of the appropriate type containing (flattened)</span>
</span><span id="ProjectiveObject-624"><a href="#ProjectiveObject-624"><span class="linenos">624</span></a><span class="sd">            combined data.</span>
</span><span id="ProjectiveObject-625"><a href="#ProjectiveObject-625"><span class="linenos">625</span></a>
</span><span id="ProjectiveObject-626"><a href="#ProjectiveObject-626"><span class="linenos">626</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject-627"><a href="#ProjectiveObject-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_combine</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-628"><a href="#ProjectiveObject-628"><span class="linenos">628</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject-629"><a href="#ProjectiveObject-629"><span class="linenos">629</span></a>
</span><span id="ProjectiveObject-630"><a href="#ProjectiveObject-630"><span class="linenos">630</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;unit_ndims&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject-631"><a href="#ProjectiveObject-631"><span class="linenos">631</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;aux_ndims&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject-632"><a href="#ProjectiveObject-632"><span class="linenos">632</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;dual_ndims&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject-633"><a href="#ProjectiveObject-633"><span class="linenos">633</span></a>
</span><span id="ProjectiveObject-634"><a href="#ProjectiveObject-634"><span class="linenos">634</span></a>        <span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unit_ndims</span>
</span><span id="ProjectiveObject-635"><a href="#ProjectiveObject-635"><span class="linenos">635</span></a>        <span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">aux_ndims</span>
</span><span id="ProjectiveObject-636"><a href="#ProjectiveObject-636"><span class="linenos">636</span></a>        <span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dual_ndims</span>
</span><span id="ProjectiveObject-637"><a href="#ProjectiveObject-637"><span class="linenos">637</span></a>
</span><span id="ProjectiveObject-638"><a href="#ProjectiveObject-638"><span class="linenos">638</span></a>        <span class="n">flattened_objs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ProjectiveObject-639"><a href="#ProjectiveObject-639"><span class="linenos">639</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">()</span>
</span><span id="ProjectiveObject-640"><a href="#ProjectiveObject-640"><span class="linenos">640</span></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_combine</span>
</span><span id="ProjectiveObject-641"><a href="#ProjectiveObject-641"><span class="linenos">641</span></a>        <span class="p">]</span>
</span><span id="ProjectiveObject-642"><a href="#ProjectiveObject-642"><span class="linenos">642</span></a>
</span><span id="ProjectiveObject-643"><a href="#ProjectiveObject-643"><span class="linenos">643</span></a>        <span class="c1"># first make a generic ProjectiveObject</span>
</span><span id="ProjectiveObject-644"><a href="#ProjectiveObject-644"><span class="linenos">644</span></a>        <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="ProjectiveObject-645"><a href="#ProjectiveObject-645"><span class="linenos">645</span></a>            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">proj_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="ProjectiveObject-646"><a href="#ProjectiveObject-646"><span class="linenos">646</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">unit_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ProjectiveObject-647"><a href="#ProjectiveObject-647"><span class="linenos">647</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject-648"><a href="#ProjectiveObject-648"><span class="linenos">648</span></a>        <span class="n">new_aux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-649"><a href="#ProjectiveObject-649"><span class="linenos">649</span></a>        <span class="n">new_dual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject-650"><a href="#ProjectiveObject-650"><span class="linenos">650</span></a>
</span><span id="ProjectiveObject-651"><a href="#ProjectiveObject-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="n">aux_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-652"><a href="#ProjectiveObject-652"><span class="linenos">652</span></a>            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="ProjectiveObject-653"><a href="#ProjectiveObject-653"><span class="linenos">653</span></a>                <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">aux_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="ProjectiveObject-654"><a href="#ProjectiveObject-654"><span class="linenos">654</span></a>                <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">aux_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ProjectiveObject-655"><a href="#ProjectiveObject-655"><span class="linenos">655</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-656"><a href="#ProjectiveObject-656"><span class="linenos">656</span></a>            <span class="n">new_aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">flat_self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">flat_other</span><span class="o">.</span><span class="n">aux_data</span><span class="p">],</span>
</span><span id="ProjectiveObject-657"><a href="#ProjectiveObject-657"><span class="linenos">657</span></a>                                     <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="ProjectiveObject-658"><a href="#ProjectiveObject-658"><span class="linenos">658</span></a>        <span class="k">if</span> <span class="n">dual_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject-659"><a href="#ProjectiveObject-659"><span class="linenos">659</span></a>            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="ProjectiveObject-660"><a href="#ProjectiveObject-660"><span class="linenos">660</span></a>                <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">dual_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="ProjectiveObject-661"><a href="#ProjectiveObject-661"><span class="linenos">661</span></a>                <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">dual_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ProjectiveObject-662"><a href="#ProjectiveObject-662"><span class="linenos">662</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject-663"><a href="#ProjectiveObject-663"><span class="linenos">663</span></a>
</span><span id="ProjectiveObject-664"><a href="#ProjectiveObject-664"><span class="linenos">664</span></a>        <span class="n">newObj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">new_aux</span><span class="p">,</span> <span class="n">new_dual</span><span class="p">,</span>
</span><span id="ProjectiveObject-665"><a href="#ProjectiveObject-665"><span class="linenos">665</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-666"><a href="#ProjectiveObject-666"><span class="linenos">666</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject-667"><a href="#ProjectiveObject-667"><span class="linenos">667</span></a>                                  <span class="n">dual_ndims</span><span class="o">=</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject-668"><a href="#ProjectiveObject-668"><span class="linenos">668</span></a>
</span><span id="ProjectiveObject-669"><a href="#ProjectiveObject-669"><span class="linenos">669</span></a>        <span class="c1"># construct an object with the correct type from this underlying data</span>
</span><span id="ProjectiveObject-670"><a href="#ProjectiveObject-670"><span class="linenos">670</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">newObj</span><span class="p">)</span>
</span><span id="ProjectiveObject-671"><a href="#ProjectiveObject-671"><span class="linenos">671</span></a>
</span><span id="ProjectiveObject-672"><a href="#ProjectiveObject-672"><span class="linenos">672</span></a>    <span class="k">def</span> <span class="nf">set_ndims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ProjectiveObject-673"><a href="#ProjectiveObject-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="n">unit_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-674"><a href="#ProjectiveObject-674"><span class="linenos">674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="ProjectiveObject-675"><a href="#ProjectiveObject-675"><span class="linenos">675</span></a>
</span><span id="ProjectiveObject-676"><a href="#ProjectiveObject-676"><span class="linenos">676</span></a>        <span class="k">if</span> <span class="n">aux_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-677"><a href="#ProjectiveObject-677"><span class="linenos">677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">aux_ndims</span>
</span><span id="ProjectiveObject-678"><a href="#ProjectiveObject-678"><span class="linenos">678</span></a>
</span><span id="ProjectiveObject-679"><a href="#ProjectiveObject-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="n">dual_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject-680"><a href="#ProjectiveObject-680"><span class="linenos">680</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">dual_ndims</span>
</span></pre></div>


            <div class="docstring"><p>Represent some object in projective geometry (possibly a composite
object).</p>

<p>The underlying data of a projective object is stored as a numpy
ndarray. The last <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code> ndims of this array describe a
<em>single</em> instance of this type of object.</p>

<p>For example, a <code><a href="#Polygon">Polygon</a></code> object has <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code> equal to 2, since
a single <code><a href="#Polygon">Polygon</a></code> is represented by an array of shape <code>(n,d)</code>,
where <code>n</code> is the number of vertices and <code>d</code> is the dimension of
the underlying vector space. So, a <code><a href="#Polygon">Polygon</a></code> object whose
underlying array has shape <code>(5, 6, 4, 3)</code> represents a 5x6 array
of quadrilaterals in RP^2 (i.e. the projectivization of R^3).</p>
</div>


                            <div id="ProjectiveObject.__init__" class="classattr">
                                        <input id="ProjectiveObject.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ProjectiveObject</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">proj_data</span>,</span><span class="param">	<span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">unit_ndims</span><span class="o">=</span><span class="mi">1</span>,</span><span class="param">	<span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="ProjectiveObject.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.__init__-140"><a href="#ProjectiveObject.__init__-140"><span class="linenos">140</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ProjectiveObject.__init__-141"><a href="#ProjectiveObject.__init__-141"><span class="linenos">141</span></a>                 <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject.__init__-142"><a href="#ProjectiveObject.__init__-142"><span class="linenos">142</span></a>        <span class="sd">&quot;&quot;&quot;Parameters</span>
</span><span id="ProjectiveObject.__init__-143"><a href="#ProjectiveObject.__init__-143"><span class="linenos">143</span></a><span class="sd">        -----------</span>
</span><span id="ProjectiveObject.__init__-144"><a href="#ProjectiveObject.__init__-144"><span class="linenos">144</span></a>
</span><span id="ProjectiveObject.__init__-145"><a href="#ProjectiveObject.__init__-145"><span class="linenos">145</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="ProjectiveObject.__init__-146"><a href="#ProjectiveObject.__init__-146"><span class="linenos">146</span></a><span class="sd">            underyling data describing this projective object</span>
</span><span id="ProjectiveObject.__init__-147"><a href="#ProjectiveObject.__init__-147"><span class="linenos">147</span></a>
</span><span id="ProjectiveObject.__init__-148"><a href="#ProjectiveObject.__init__-148"><span class="linenos">148</span></a><span class="sd">        aux_data : ndarray</span>
</span><span id="ProjectiveObject.__init__-149"><a href="#ProjectiveObject.__init__-149"><span class="linenos">149</span></a><span class="sd">            auxiliary data describing this projective</span>
</span><span id="ProjectiveObject.__init__-150"><a href="#ProjectiveObject.__init__-150"><span class="linenos">150</span></a><span class="sd">            object. Auxiliary data is any data which is in principle</span>
</span><span id="ProjectiveObject.__init__-151"><a href="#ProjectiveObject.__init__-151"><span class="linenos">151</span></a><span class="sd">            computable from `proj_data`, but is convenient to keep as</span>
</span><span id="ProjectiveObject.__init__-152"><a href="#ProjectiveObject.__init__-152"><span class="linenos">152</span></a><span class="sd">            part of the object definition for transformation purposes.</span>
</span><span id="ProjectiveObject.__init__-153"><a href="#ProjectiveObject.__init__-153"><span class="linenos">153</span></a>
</span><span id="ProjectiveObject.__init__-154"><a href="#ProjectiveObject.__init__-154"><span class="linenos">154</span></a><span class="sd">        dual_data : ndarray</span>
</span><span id="ProjectiveObject.__init__-155"><a href="#ProjectiveObject.__init__-155"><span class="linenos">155</span></a><span class="sd">            data describing this projective object which transforms</span>
</span><span id="ProjectiveObject.__init__-156"><a href="#ProjectiveObject.__init__-156"><span class="linenos">156</span></a><span class="sd">            covariantly, i.e. as a dual vector in projective space.</span>
</span><span id="ProjectiveObject.__init__-157"><a href="#ProjectiveObject.__init__-157"><span class="linenos">157</span></a>
</span><span id="ProjectiveObject.__init__-158"><a href="#ProjectiveObject.__init__-158"><span class="linenos">158</span></a><span class="sd">        unit_ndims : int</span>
</span><span id="ProjectiveObject.__init__-159"><a href="#ProjectiveObject.__init__-159"><span class="linenos">159</span></a><span class="sd">            number of ndims of an array representing a &quot;unit&quot; version</span>
</span><span id="ProjectiveObject.__init__-160"><a href="#ProjectiveObject.__init__-160"><span class="linenos">160</span></a><span class="sd">            of this object. For example, an object representing a</span>
</span><span id="ProjectiveObject.__init__-161"><a href="#ProjectiveObject.__init__-161"><span class="linenos">161</span></a><span class="sd">            single point in hyperbolic space has `unit_ndims` 1, while</span>
</span><span id="ProjectiveObject.__init__-162"><a href="#ProjectiveObject.__init__-162"><span class="linenos">162</span></a><span class="sd">            an object representing a line segment has `unit_ndims`</span>
</span><span id="ProjectiveObject.__init__-163"><a href="#ProjectiveObject.__init__-163"><span class="linenos">163</span></a><span class="sd">            equal to 2.</span>
</span><span id="ProjectiveObject.__init__-164"><a href="#ProjectiveObject.__init__-164"><span class="linenos">164</span></a>
</span><span id="ProjectiveObject.__init__-165"><a href="#ProjectiveObject.__init__-165"><span class="linenos">165</span></a><span class="sd">        aux_ndims : int</span>
</span><span id="ProjectiveObject.__init__-166"><a href="#ProjectiveObject.__init__-166"><span class="linenos">166</span></a><span class="sd">            like `unit_ndims`, but for auxiliary data.</span>
</span><span id="ProjectiveObject.__init__-167"><a href="#ProjectiveObject.__init__-167"><span class="linenos">167</span></a>
</span><span id="ProjectiveObject.__init__-168"><a href="#ProjectiveObject.__init__-168"><span class="linenos">168</span></a><span class="sd">        dual_ndims : int</span>
</span><span id="ProjectiveObject.__init__-169"><a href="#ProjectiveObject.__init__-169"><span class="linenos">169</span></a><span class="sd">            like `unit_ndims`, but for covariant (dual) data.</span>
</span><span id="ProjectiveObject.__init__-170"><a href="#ProjectiveObject.__init__-170"><span class="linenos">170</span></a>
</span><span id="ProjectiveObject.__init__-171"><a href="#ProjectiveObject.__init__-171"><span class="linenos">171</span></a><span class="sd">        base_ring : object</span>
</span><span id="ProjectiveObject.__init__-172"><a href="#ProjectiveObject.__init__-172"><span class="linenos">172</span></a><span class="sd">            *(requires sage).* Base ring for matrix entries of the</span>
</span><span id="ProjectiveObject.__init__-173"><a href="#ProjectiveObject.__init__-173"><span class="linenos">173</span></a><span class="sd">             underlying data for this object. This allows for exact</span>
</span><span id="ProjectiveObject.__init__-174"><a href="#ProjectiveObject.__init__-174"><span class="linenos">174</span></a><span class="sd">             computations in projective space (at the cost of</span>
</span><span id="ProjectiveObject.__init__-175"><a href="#ProjectiveObject.__init__-175"><span class="linenos">175</span></a><span class="sd">             performance) by supplying a ring that supports exact</span>
</span><span id="ProjectiveObject.__init__-176"><a href="#ProjectiveObject.__init__-176"><span class="linenos">176</span></a><span class="sd">             computations. The dtype of the underlying data is</span>
</span><span id="ProjectiveObject.__init__-177"><a href="#ProjectiveObject.__init__-177"><span class="linenos">177</span></a><span class="sd">             automatically converted to &quot;object&quot; if this is specified.</span>
</span><span id="ProjectiveObject.__init__-178"><a href="#ProjectiveObject.__init__-178"><span class="linenos">178</span></a>
</span><span id="ProjectiveObject.__init__-179"><a href="#ProjectiveObject.__init__-179"><span class="linenos">179</span></a><span class="sd">        rational_approx : bool</span>
</span><span id="ProjectiveObject.__init__-180"><a href="#ProjectiveObject.__init__-180"><span class="linenos">180</span></a><span class="sd">            *(requires sage).* If base_ring is specified, coerce</span>
</span><span id="ProjectiveObject.__init__-181"><a href="#ProjectiveObject.__init__-181"><span class="linenos">181</span></a><span class="sd">             floating-point data to a rational approximation before</span>
</span><span id="ProjectiveObject.__init__-182"><a href="#ProjectiveObject.__init__-182"><span class="linenos">182</span></a><span class="sd">             converting to the specified ring. This is useful for</span>
</span><span id="ProjectiveObject.__init__-183"><a href="#ProjectiveObject.__init__-183"><span class="linenos">183</span></a><span class="sd">             combining computations with floating-point values with</span>
</span><span id="ProjectiveObject.__init__-184"><a href="#ProjectiveObject.__init__-184"><span class="linenos">184</span></a><span class="sd">             computations in algebraic number fields.</span>
</span><span id="ProjectiveObject.__init__-185"><a href="#ProjectiveObject.__init__-185"><span class="linenos">185</span></a>
</span><span id="ProjectiveObject.__init__-186"><a href="#ProjectiveObject.__init__-186"><span class="linenos">186</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.__init__-187"><a href="#ProjectiveObject.__init__-187"><span class="linenos">187</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="ProjectiveObject.__init__-188"><a href="#ProjectiveObject.__init__-188"><span class="linenos">188</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">aux_ndims</span>
</span><span id="ProjectiveObject.__init__-189"><a href="#ProjectiveObject.__init__-189"><span class="linenos">189</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">dual_ndims</span>
</span><span id="ProjectiveObject.__init__-190"><a href="#ProjectiveObject.__init__-190"><span class="linenos">190</span></a>
</span><span id="ProjectiveObject.__init__-191"><a href="#ProjectiveObject.__init__-191"><span class="linenos">191</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="ProjectiveObject.__init__-192"><a href="#ProjectiveObject.__init__-192"><span class="linenos">192</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject.__init__-193"><a href="#ProjectiveObject.__init__-193"><span class="linenos">193</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="ProjectiveObject.__init__-194"><a href="#ProjectiveObject.__init__-194"><span class="linenos">194</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ndarray):
underyling data describing this projective object</li>
<li><strong>aux_data</strong> (ndarray):
auxiliary data describing this projective
object. Auxiliary data is any data which is in principle
computable from <code>proj_data</code>, but is convenient to keep as
part of the object definition for transformation purposes.</li>
<li><strong>dual_data</strong> (ndarray):
data describing this projective object which transforms
covariantly, i.e. as a dual vector in projective space.</li>
<li><strong>unit_ndims</strong> (int):
number of ndims of an array representing a "unit" version
of this object. For example, an object representing a
single point in hyperbolic space has <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code> 1, while
an object representing a line segment has <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code>
equal to 2.</li>
<li><strong>aux_ndims</strong> (int):
like <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code>, but for auxiliary data.</li>
<li><strong>dual_ndims</strong> (int):
like <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code>, but for covariant (dual) data.</li>
<li><strong>base_ring</strong> (object):
<em>(requires sage).</em> Base ring for matrix entries of the
 underlying data for this object. This allows for exact
 computations in projective space (at the cost of
 performance) by supplying a ring that supports exact
 computations. The dtype of the underlying data is
 automatically converted to "object" if this is specified.</li>
<li><strong>rational_approx</strong> (bool):
<em>(requires sage).</em> If base_ring is specified, coerce
 floating-point data to a rational approximation before
 converting to the specified ring. This is useful for
 combining computations with floating-point values with
 computations in algebraic number fields.</li>
</ul>
</div>


                            </div>
                            <div id="ProjectiveObject.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#ProjectiveObject.unit_ndims"></a>
    
    

                            </div>
                            <div id="ProjectiveObject.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#ProjectiveObject.aux_ndims"></a>
    
    

                            </div>
                            <div id="ProjectiveObject.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#ProjectiveObject.dual_ndims"></a>
    
    

                            </div>
                            <div id="ProjectiveObject.dimension" class="classattr">
                                        <input id="ProjectiveObject.dimension-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">dimension</span>

                <label class="view-source-button" for="ProjectiveObject.dimension-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.dimension"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.dimension-196"><a href="#ProjectiveObject.dimension-196"><span class="linenos">196</span></a>    <span class="nd">@property</span>
</span><span id="ProjectiveObject.dimension-197"><a href="#ProjectiveObject.dimension-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject.dimension-198"><a href="#ProjectiveObject.dimension-198"><span class="linenos">198</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveObject.shape" class="classattr">
                                        <input id="ProjectiveObject.shape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">shape</span>

                <label class="view-source-button" for="ProjectiveObject.shape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.shape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.shape-311"><a href="#ProjectiveObject.shape-311"><span class="linenos">311</span></a>    <span class="nd">@property</span>
</span><span id="ProjectiveObject.shape-312"><a href="#ProjectiveObject.shape-312"><span class="linenos">312</span></a>    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject.shape-313"><a href="#ProjectiveObject.shape-313"><span class="linenos">313</span></a>        <span class="sd">&quot;&quot;&quot;Get the shape of the ndarray of &quot;unit objects&quot; this</span>
</span><span id="ProjectiveObject.shape-314"><a href="#ProjectiveObject.shape-314"><span class="linenos">314</span></a><span class="sd">        ProjectiveObject represents.</span>
</span><span id="ProjectiveObject.shape-315"><a href="#ProjectiveObject.shape-315"><span class="linenos">315</span></a>
</span><span id="ProjectiveObject.shape-316"><a href="#ProjectiveObject.shape-316"><span class="linenos">316</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveObject.shape-317"><a href="#ProjectiveObject.shape-317"><span class="linenos">317</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveObject.shape-318"><a href="#ProjectiveObject.shape-318"><span class="linenos">318</span></a><span class="sd">        tuple</span>
</span><span id="ProjectiveObject.shape-319"><a href="#ProjectiveObject.shape-319"><span class="linenos">319</span></a>
</span><span id="ProjectiveObject.shape-320"><a href="#ProjectiveObject.shape-320"><span class="linenos">320</span></a>
</span><span id="ProjectiveObject.shape-321"><a href="#ProjectiveObject.shape-321"><span class="linenos">321</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.shape-322"><a href="#ProjectiveObject.shape-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Get the shape of the ndarray of "unit objects" this
ProjectiveObject represents.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong></li>
</ul>
</div>


                            </div>
                            <div id="ProjectiveObject.reshape" class="classattr">
                                        <input id="ProjectiveObject.reshape-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reshape</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">shape</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.reshape-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.reshape"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.reshape-324"><a href="#ProjectiveObject.reshape-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">reshape</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">):</span>
</span><span id="ProjectiveObject.reshape-325"><a href="#ProjectiveObject.reshape-325"><span class="linenos">325</span></a>        <span class="n">old_proj_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject.reshape-326"><a href="#ProjectiveObject.reshape-326"><span class="linenos">326</span></a>        <span class="n">proj_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="ProjectiveObject.reshape-327"><a href="#ProjectiveObject.reshape-327"><span class="linenos">327</span></a>            <span class="n">shape</span> <span class="o">+</span> <span class="n">old_proj_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">:]</span>
</span><span id="ProjectiveObject.reshape-328"><a href="#ProjectiveObject.reshape-328"><span class="linenos">328</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject.reshape-329"><a href="#ProjectiveObject.reshape-329"><span class="linenos">329</span></a>
</span><span id="ProjectiveObject.reshape-330"><a href="#ProjectiveObject.reshape-330"><span class="linenos">330</span></a>        <span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.reshape-331"><a href="#ProjectiveObject.reshape-331"><span class="linenos">331</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.reshape-332"><a href="#ProjectiveObject.reshape-332"><span class="linenos">332</span></a>            <span class="n">old_aux_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject.reshape-333"><a href="#ProjectiveObject.reshape-333"><span class="linenos">333</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="ProjectiveObject.reshape-334"><a href="#ProjectiveObject.reshape-334"><span class="linenos">334</span></a>                <span class="n">shape</span> <span class="o">+</span> <span class="n">old_aux_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">:]</span>
</span><span id="ProjectiveObject.reshape-335"><a href="#ProjectiveObject.reshape-335"><span class="linenos">335</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject.reshape-336"><a href="#ProjectiveObject.reshape-336"><span class="linenos">336</span></a>
</span><span id="ProjectiveObject.reshape-337"><a href="#ProjectiveObject.reshape-337"><span class="linenos">337</span></a>        <span class="n">dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.reshape-338"><a href="#ProjectiveObject.reshape-338"><span class="linenos">338</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.reshape-339"><a href="#ProjectiveObject.reshape-339"><span class="linenos">339</span></a>            <span class="n">old_dual_shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span>
</span><span id="ProjectiveObject.reshape-340"><a href="#ProjectiveObject.reshape-340"><span class="linenos">340</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
</span><span id="ProjectiveObject.reshape-341"><a href="#ProjectiveObject.reshape-341"><span class="linenos">341</span></a>                <span class="n">shape</span> <span class="o">+</span> <span class="n">old_dual_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">:]</span>
</span><span id="ProjectiveObject.reshape-342"><a href="#ProjectiveObject.reshape-342"><span class="linenos">342</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject.reshape-343"><a href="#ProjectiveObject.reshape-343"><span class="linenos">343</span></a>
</span><span id="ProjectiveObject.reshape-344"><a href="#ProjectiveObject.reshape-344"><span class="linenos">344</span></a>        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="ProjectiveObject.reshape-345"><a href="#ProjectiveObject.reshape-345"><span class="linenos">345</span></a>                                   <span class="n">aux_data</span><span class="p">,</span>
</span><span id="ProjectiveObject.reshape-346"><a href="#ProjectiveObject.reshape-346"><span class="linenos">346</span></a>                                   <span class="n">dual_data</span><span class="p">,</span>
</span><span id="ProjectiveObject.reshape-347"><a href="#ProjectiveObject.reshape-347"><span class="linenos">347</span></a>                                   <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.reshape-348"><a href="#ProjectiveObject.reshape-348"><span class="linenos">348</span></a>                                   <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.reshape-349"><a href="#ProjectiveObject.reshape-349"><span class="linenos">349</span></a>                                   <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject.reshape-350"><a href="#ProjectiveObject.reshape-350"><span class="linenos">350</span></a>
</span><span id="ProjectiveObject.reshape-351"><a href="#ProjectiveObject.reshape-351"><span class="linenos">351</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">new_obj</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveObject.set" class="classattr">
                                        <input id="ProjectiveObject.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.set-355"><a href="#ProjectiveObject.set-355"><span class="linenos">355</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="ProjectiveObject.set-356"><a href="#ProjectiveObject.set-356"><span class="linenos">356</span></a>            <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject.set-357"><a href="#ProjectiveObject.set-357"><span class="linenos">357</span></a>        <span class="sd">&quot;&quot;&quot;set the underlying data of the hyperbolic object.</span>
</span><span id="ProjectiveObject.set-358"><a href="#ProjectiveObject.set-358"><span class="linenos">358</span></a>
</span><span id="ProjectiveObject.set-359"><a href="#ProjectiveObject.set-359"><span class="linenos">359</span></a><span class="sd">        Subclasses may override this method to give special names to</span>
</span><span id="ProjectiveObject.set-360"><a href="#ProjectiveObject.set-360"><span class="linenos">360</span></a><span class="sd">        portions of the underlying data.</span>
</span><span id="ProjectiveObject.set-361"><a href="#ProjectiveObject.set-361"><span class="linenos">361</span></a>
</span><span id="ProjectiveObject.set-362"><a href="#ProjectiveObject.set-362"><span class="linenos">362</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject.set-363"><a href="#ProjectiveObject.set-363"><span class="linenos">363</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject.set-364"><a href="#ProjectiveObject.set-364"><span class="linenos">364</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="ProjectiveObject.set-365"><a href="#ProjectiveObject.set-365"><span class="linenos">365</span></a><span class="sd">            underyling data representing this projective object.</span>
</span><span id="ProjectiveObject.set-366"><a href="#ProjectiveObject.set-366"><span class="linenos">366</span></a>
</span><span id="ProjectiveObject.set-367"><a href="#ProjectiveObject.set-367"><span class="linenos">367</span></a><span class="sd">        aux_data : ndarray</span>
</span><span id="ProjectiveObject.set-368"><a href="#ProjectiveObject.set-368"><span class="linenos">368</span></a><span class="sd">            underyling auxiliary data for this projective object.</span>
</span><span id="ProjectiveObject.set-369"><a href="#ProjectiveObject.set-369"><span class="linenos">369</span></a>
</span><span id="ProjectiveObject.set-370"><a href="#ProjectiveObject.set-370"><span class="linenos">370</span></a><span class="sd">        dual_data : ndarray</span>
</span><span id="ProjectiveObject.set-371"><a href="#ProjectiveObject.set-371"><span class="linenos">371</span></a><span class="sd">            underlying dual data for this projective object.</span>
</span><span id="ProjectiveObject.set-372"><a href="#ProjectiveObject.set-372"><span class="linenos">372</span></a>
</span><span id="ProjectiveObject.set-373"><a href="#ProjectiveObject.set-373"><span class="linenos">373</span></a><span class="sd">        base_ring : object</span>
</span><span id="ProjectiveObject.set-374"><a href="#ProjectiveObject.set-374"><span class="linenos">374</span></a><span class="sd">            *(requires sage).* Base ring for matrix entries of the</span>
</span><span id="ProjectiveObject.set-375"><a href="#ProjectiveObject.set-375"><span class="linenos">375</span></a><span class="sd">             underlying data for this object. This allows for exact</span>
</span><span id="ProjectiveObject.set-376"><a href="#ProjectiveObject.set-376"><span class="linenos">376</span></a><span class="sd">             computations in projective space (at the cost of</span>
</span><span id="ProjectiveObject.set-377"><a href="#ProjectiveObject.set-377"><span class="linenos">377</span></a><span class="sd">             performance) by supplying a ring that supports exact</span>
</span><span id="ProjectiveObject.set-378"><a href="#ProjectiveObject.set-378"><span class="linenos">378</span></a><span class="sd">             computations. The dtype of the underlying data is</span>
</span><span id="ProjectiveObject.set-379"><a href="#ProjectiveObject.set-379"><span class="linenos">379</span></a><span class="sd">             automatically converted to &quot;object&quot; if this is specified.</span>
</span><span id="ProjectiveObject.set-380"><a href="#ProjectiveObject.set-380"><span class="linenos">380</span></a>
</span><span id="ProjectiveObject.set-381"><a href="#ProjectiveObject.set-381"><span class="linenos">381</span></a><span class="sd">        rational_approx : bool</span>
</span><span id="ProjectiveObject.set-382"><a href="#ProjectiveObject.set-382"><span class="linenos">382</span></a><span class="sd">            *(requires sage).* If base_ring is specified, coerce</span>
</span><span id="ProjectiveObject.set-383"><a href="#ProjectiveObject.set-383"><span class="linenos">383</span></a><span class="sd">             floating-point data to a rational approximation before</span>
</span><span id="ProjectiveObject.set-384"><a href="#ProjectiveObject.set-384"><span class="linenos">384</span></a><span class="sd">             converting to the specified ring. This is useful for</span>
</span><span id="ProjectiveObject.set-385"><a href="#ProjectiveObject.set-385"><span class="linenos">385</span></a><span class="sd">             combining computations with floating-point values with</span>
</span><span id="ProjectiveObject.set-386"><a href="#ProjectiveObject.set-386"><span class="linenos">386</span></a><span class="sd">             computations in algebraic number fields.</span>
</span><span id="ProjectiveObject.set-387"><a href="#ProjectiveObject.set-387"><span class="linenos">387</span></a>
</span><span id="ProjectiveObject.set-388"><a href="#ProjectiveObject.set-388"><span class="linenos">388</span></a><span class="sd">        Raises</span>
</span><span id="ProjectiveObject.set-389"><a href="#ProjectiveObject.set-389"><span class="linenos">389</span></a><span class="sd">        ------</span>
</span><span id="ProjectiveObject.set-390"><a href="#ProjectiveObject.set-390"><span class="linenos">390</span></a><span class="sd">        EnvironmentError</span>
</span><span id="ProjectiveObject.set-391"><a href="#ProjectiveObject.set-391"><span class="linenos">391</span></a><span class="sd">            Raised if base_ring is specified but sage is not available</span>
</span><span id="ProjectiveObject.set-392"><a href="#ProjectiveObject.set-392"><span class="linenos">392</span></a><span class="sd">            for import.</span>
</span><span id="ProjectiveObject.set-393"><a href="#ProjectiveObject.set-393"><span class="linenos">393</span></a>
</span><span id="ProjectiveObject.set-394"><a href="#ProjectiveObject.set-394"><span class="linenos">394</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.set-395"><a href="#ProjectiveObject.set-395"><span class="linenos">395</span></a>
</span><span id="ProjectiveObject.set-396"><a href="#ProjectiveObject.set-396"><span class="linenos">396</span></a>        <span class="c1">#TODO: add &quot;like&quot; and &quot;dtype&quot; to kwargs</span>
</span><span id="ProjectiveObject.set-397"><a href="#ProjectiveObject.set-397"><span class="linenos">397</span></a>
</span><span id="ProjectiveObject.set-398"><a href="#ProjectiveObject.set-398"><span class="linenos">398</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-399"><a href="#ProjectiveObject.set-399"><span class="linenos">399</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.set-400"><a href="#ProjectiveObject.set-400"><span class="linenos">400</span></a>
</span><span id="ProjectiveObject.set-401"><a href="#ProjectiveObject.set-401"><span class="linenos">401</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.set-402"><a href="#ProjectiveObject.set-402"><span class="linenos">402</span></a>
</span><span id="ProjectiveObject.set-403"><a href="#ProjectiveObject.set-403"><span class="linenos">403</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-404"><a href="#ProjectiveObject.set-404"><span class="linenos">404</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.set-405"><a href="#ProjectiveObject.set-405"><span class="linenos">405</span></a>
</span><span id="ProjectiveObject.set-406"><a href="#ProjectiveObject.set-406"><span class="linenos">406</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_dual_valid</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.set-407"><a href="#ProjectiveObject.set-407"><span class="linenos">407</span></a>
</span><span id="ProjectiveObject.set-408"><a href="#ProjectiveObject.set-408"><span class="linenos">408</span></a>        <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-409"><a href="#ProjectiveObject.set-409"><span class="linenos">409</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_aux_data</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.set-410"><a href="#ProjectiveObject.set-410"><span class="linenos">410</span></a>
</span><span id="ProjectiveObject.set-411"><a href="#ProjectiveObject.set-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_assert_aux_valid</span><span class="p">(</span><span class="n">aux_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.set-412"><a href="#ProjectiveObject.set-412"><span class="linenos">412</span></a>
</span><span id="ProjectiveObject.set-413"><a href="#ProjectiveObject.set-413"><span class="linenos">413</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="n">proj_data</span>
</span><span id="ProjectiveObject.set-414"><a href="#ProjectiveObject.set-414"><span class="linenos">414</span></a>
</span><span id="ProjectiveObject.set-415"><a href="#ProjectiveObject.set-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-416"><a href="#ProjectiveObject.set-416"><span class="linenos">416</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="n">aux_data</span>
</span><span id="ProjectiveObject.set-417"><a href="#ProjectiveObject.set-417"><span class="linenos">417</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-418"><a href="#ProjectiveObject.set-418"><span class="linenos">418</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.set-419"><a href="#ProjectiveObject.set-419"><span class="linenos">419</span></a>
</span><span id="ProjectiveObject.set-420"><a href="#ProjectiveObject.set-420"><span class="linenos">420</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-421"><a href="#ProjectiveObject.set-421"><span class="linenos">421</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">dual_data</span>
</span><span id="ProjectiveObject.set-422"><a href="#ProjectiveObject.set-422"><span class="linenos">422</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="ProjectiveObject.set-423"><a href="#ProjectiveObject.set-423"><span class="linenos">423</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.set-424"><a href="#ProjectiveObject.set-424"><span class="linenos">424</span></a>
</span><span id="ProjectiveObject.set-425"><a href="#ProjectiveObject.set-425"><span class="linenos">425</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_optional</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>set the underlying data of the hyperbolic object.</p>

<p>Subclasses may override this method to give special names to
portions of the underlying data.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ndarray):
underyling data representing this projective object.</li>
<li><strong>aux_data</strong> (ndarray):
underyling auxiliary data for this projective object.</li>
<li><strong>dual_data</strong> (ndarray):
underlying dual data for this projective object.</li>
<li><strong>base_ring</strong> (object):
<em>(requires sage).</em> Base ring for matrix entries of the
 underlying data for this object. This allows for exact
 computations in projective space (at the cost of
 performance) by supplying a ring that supports exact
 computations. The dtype of the underlying data is
 automatically converted to "object" if this is specified.</li>
<li><strong>rational_approx</strong> (bool):
<em>(requires sage).</em> If base_ring is specified, coerce
 floating-point data to a rational approximation before
 converting to the specified ring. This is useful for
 combining computations with floating-point values with
 computations in algebraic number fields.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>EnvironmentError</strong>: Raised if base_ring is specified but sage is not available
for import.</li>
</ul>
</div>


                            </div>
                            <div id="ProjectiveObject.flatten_to_unit" class="classattr">
                                        <input id="ProjectiveObject.flatten_to_unit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flatten_to_unit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">unit</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.flatten_to_unit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.flatten_to_unit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.flatten_to_unit-437"><a href="#ProjectiveObject.flatten_to_unit-437"><span class="linenos">437</span></a>    <span class="k">def</span> <span class="nf">flatten_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ProjectiveObject.flatten_to_unit-438"><a href="#ProjectiveObject.flatten_to_unit-438"><span class="linenos">438</span></a>        <span class="sd">&quot;&quot;&quot;Get a flattened version of the projective object.</span>
</span><span id="ProjectiveObject.flatten_to_unit-439"><a href="#ProjectiveObject.flatten_to_unit-439"><span class="linenos">439</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-440"><a href="#ProjectiveObject.flatten_to_unit-440"><span class="linenos">440</span></a><span class="sd">        This method reshapes the underlying data of the projective</span>
</span><span id="ProjectiveObject.flatten_to_unit-441"><a href="#ProjectiveObject.flatten_to_unit-441"><span class="linenos">441</span></a><span class="sd">        object to get a &quot;flat&quot; composite list of objects. For example,</span>
</span><span id="ProjectiveObject.flatten_to_unit-442"><a href="#ProjectiveObject.flatten_to_unit-442"><span class="linenos">442</span></a><span class="sd">        if called on a Segment object whose underlying array has shape</span>
</span><span id="ProjectiveObject.flatten_to_unit-443"><a href="#ProjectiveObject.flatten_to_unit-443"><span class="linenos">443</span></a><span class="sd">        (4, 5, 2, 3), this method uses the `unit_ndims` data member to</span>
</span><span id="ProjectiveObject.flatten_to_unit-444"><a href="#ProjectiveObject.flatten_to_unit-444"><span class="linenos">444</span></a><span class="sd">        interprets this array as an array of segments with shape</span>
</span><span id="ProjectiveObject.flatten_to_unit-445"><a href="#ProjectiveObject.flatten_to_unit-445"><span class="linenos">445</span></a><span class="sd">        (4,5), and returns a Segment object whose underlying array has</span>
</span><span id="ProjectiveObject.flatten_to_unit-446"><a href="#ProjectiveObject.flatten_to_unit-446"><span class="linenos">446</span></a><span class="sd">        shape (20, 2, 3).</span>
</span><span id="ProjectiveObject.flatten_to_unit-447"><a href="#ProjectiveObject.flatten_to_unit-447"><span class="linenos">447</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-448"><a href="#ProjectiveObject.flatten_to_unit-448"><span class="linenos">448</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject.flatten_to_unit-449"><a href="#ProjectiveObject.flatten_to_unit-449"><span class="linenos">449</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject.flatten_to_unit-450"><a href="#ProjectiveObject.flatten_to_unit-450"><span class="linenos">450</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-451"><a href="#ProjectiveObject.flatten_to_unit-451"><span class="linenos">451</span></a><span class="sd">        unit : int</span>
</span><span id="ProjectiveObject.flatten_to_unit-452"><a href="#ProjectiveObject.flatten_to_unit-452"><span class="linenos">452</span></a><span class="sd">            the number of ndims to treat as a &quot;unit&quot; when flattening</span>
</span><span id="ProjectiveObject.flatten_to_unit-453"><a href="#ProjectiveObject.flatten_to_unit-453"><span class="linenos">453</span></a><span class="sd">            this object into units.</span>
</span><span id="ProjectiveObject.flatten_to_unit-454"><a href="#ProjectiveObject.flatten_to_unit-454"><span class="linenos">454</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-455"><a href="#ProjectiveObject.flatten_to_unit-455"><span class="linenos">455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.flatten_to_unit-456"><a href="#ProjectiveObject.flatten_to_unit-456"><span class="linenos">456</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-457"><a href="#ProjectiveObject.flatten_to_unit-457"><span class="linenos">457</span></a>        <span class="n">aux_unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="ProjectiveObject.flatten_to_unit-458"><a href="#ProjectiveObject.flatten_to_unit-458"><span class="linenos">458</span></a>        <span class="n">dual_unit</span> <span class="o">=</span> <span class="n">unit</span>
</span><span id="ProjectiveObject.flatten_to_unit-459"><a href="#ProjectiveObject.flatten_to_unit-459"><span class="linenos">459</span></a>        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.flatten_to_unit-460"><a href="#ProjectiveObject.flatten_to_unit-460"><span class="linenos">460</span></a>            <span class="n">unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span>
</span><span id="ProjectiveObject.flatten_to_unit-461"><a href="#ProjectiveObject.flatten_to_unit-461"><span class="linenos">461</span></a>            <span class="n">aux_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span>
</span><span id="ProjectiveObject.flatten_to_unit-462"><a href="#ProjectiveObject.flatten_to_unit-462"><span class="linenos">462</span></a>            <span class="n">dual_unit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span>
</span><span id="ProjectiveObject.flatten_to_unit-463"><a href="#ProjectiveObject.flatten_to_unit-463"><span class="linenos">463</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-464"><a href="#ProjectiveObject.flatten_to_unit-464"><span class="linenos">464</span></a>        <span class="n">flattened</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span><span id="ProjectiveObject.flatten_to_unit-465"><a href="#ProjectiveObject.flatten_to_unit-465"><span class="linenos">465</span></a>        <span class="n">new_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">unit</span><span class="p">:]</span>
</span><span id="ProjectiveObject.flatten_to_unit-466"><a href="#ProjectiveObject.flatten_to_unit-466"><span class="linenos">466</span></a>        <span class="n">new_proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">new_shape</span><span class="p">)</span>
</span><span id="ProjectiveObject.flatten_to_unit-467"><a href="#ProjectiveObject.flatten_to_unit-467"><span class="linenos">467</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-468"><a href="#ProjectiveObject.flatten_to_unit-468"><span class="linenos">468</span></a>        <span class="n">new_aux_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.flatten_to_unit-469"><a href="#ProjectiveObject.flatten_to_unit-469"><span class="linenos">469</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.flatten_to_unit-470"><a href="#ProjectiveObject.flatten_to_unit-470"><span class="linenos">470</span></a>            <span class="n">new_aux_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">aux_unit</span><span class="p">:]</span>
</span><span id="ProjectiveObject.flatten_to_unit-471"><a href="#ProjectiveObject.flatten_to_unit-471"><span class="linenos">471</span></a>            <span class="n">new_aux_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">new_aux_shape</span><span class="p">)</span>
</span><span id="ProjectiveObject.flatten_to_unit-472"><a href="#ProjectiveObject.flatten_to_unit-472"><span class="linenos">472</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-473"><a href="#ProjectiveObject.flatten_to_unit-473"><span class="linenos">473</span></a>        <span class="n">new_dual_data</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.flatten_to_unit-474"><a href="#ProjectiveObject.flatten_to_unit-474"><span class="linenos">474</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.flatten_to_unit-475"><a href="#ProjectiveObject.flatten_to_unit-475"><span class="linenos">475</span></a>            <span class="n">new_dual_shape</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">dual_unit</span><span class="p">:]</span>
</span><span id="ProjectiveObject.flatten_to_unit-476"><a href="#ProjectiveObject.flatten_to_unit-476"><span class="linenos">476</span></a>            <span class="n">new_dual_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">new_dual_shape</span><span class="p">)</span>
</span><span id="ProjectiveObject.flatten_to_unit-477"><a href="#ProjectiveObject.flatten_to_unit-477"><span class="linenos">477</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-478"><a href="#ProjectiveObject.flatten_to_unit-478"><span class="linenos">478</span></a>        <span class="n">flattened</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">new_proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">new_aux_data</span><span class="p">,</span>
</span><span id="ProjectiveObject.flatten_to_unit-479"><a href="#ProjectiveObject.flatten_to_unit-479"><span class="linenos">479</span></a>                      <span class="n">dual_data</span><span class="o">=</span><span class="n">new_dual_data</span><span class="p">)</span>
</span><span id="ProjectiveObject.flatten_to_unit-480"><a href="#ProjectiveObject.flatten_to_unit-480"><span class="linenos">480</span></a>
</span><span id="ProjectiveObject.flatten_to_unit-481"><a href="#ProjectiveObject.flatten_to_unit-481"><span class="linenos">481</span></a>        <span class="k">return</span> <span class="n">flattened</span>
</span></pre></div>


            <div class="docstring"><p>Get a flattened version of the projective object.</p>

<p>This method reshapes the underlying data of the projective
object to get a "flat" composite list of objects. For example,
if called on a Segment object whose underlying array has shape
(4, 5, 2, 3), this method uses the <code><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></code> data member to
interprets this array as an array of segments with shape
(4,5), and returns a Segment object whose underlying array has
shape (20, 2, 3).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>unit</strong> (int):
the number of ndims to treat as a "unit" when flattening
this object into units.</li>
</ul>
</div>


                            </div>
                            <div id="ProjectiveObject.flatten_to_aux" class="classattr">
                                        <input id="ProjectiveObject.flatten_to_aux-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flatten_to_aux</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.flatten_to_aux-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.flatten_to_aux"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.flatten_to_aux-483"><a href="#ProjectiveObject.flatten_to_aux-483"><span class="linenos">483</span></a>    <span class="k">def</span> <span class="nf">flatten_to_aux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ProjectiveObject.flatten_to_aux-484"><a href="#ProjectiveObject.flatten_to_aux-484"><span class="linenos">484</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveObject.astype" class="classattr">
                                        <input id="ProjectiveObject.astype-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">astype</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">dtype</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.astype-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.astype"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.astype-509"><a href="#ProjectiveObject.astype-509"><span class="linenos">509</span></a>    <span class="k">def</span> <span class="nf">astype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">):</span>
</span><span id="ProjectiveObject.astype-510"><a href="#ProjectiveObject.astype-510"><span class="linenos">510</span></a>        <span class="n">new_proj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ProjectiveObject.astype-511"><a href="#ProjectiveObject.astype-511"><span class="linenos">511</span></a>        <span class="n">new_aux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.astype-512"><a href="#ProjectiveObject.astype-512"><span class="linenos">512</span></a>        <span class="n">new_dual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.astype-513"><a href="#ProjectiveObject.astype-513"><span class="linenos">513</span></a>
</span><span id="ProjectiveObject.astype-514"><a href="#ProjectiveObject.astype-514"><span class="linenos">514</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.astype-515"><a href="#ProjectiveObject.astype-515"><span class="linenos">515</span></a>            <span class="n">new_aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ProjectiveObject.astype-516"><a href="#ProjectiveObject.astype-516"><span class="linenos">516</span></a>
</span><span id="ProjectiveObject.astype-517"><a href="#ProjectiveObject.astype-517"><span class="linenos">517</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.astype-518"><a href="#ProjectiveObject.astype-518"><span class="linenos">518</span></a>            <span class="n">new_dual</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">dtype</span><span class="p">)</span>
</span><span id="ProjectiveObject.astype-519"><a href="#ProjectiveObject.astype-519"><span class="linenos">519</span></a>
</span><span id="ProjectiveObject.astype-520"><a href="#ProjectiveObject.astype-520"><span class="linenos">520</span></a>
</span><span id="ProjectiveObject.astype-521"><a href="#ProjectiveObject.astype-521"><span class="linenos">521</span></a>        <span class="n">newobj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">new_proj</span><span class="p">,</span> <span class="n">new_aux</span><span class="p">,</span> <span class="n">new_dual</span><span class="p">,</span>
</span><span id="ProjectiveObject.astype-522"><a href="#ProjectiveObject.astype-522"><span class="linenos">522</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.astype-523"><a href="#ProjectiveObject.astype-523"><span class="linenos">523</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.astype-524"><a href="#ProjectiveObject.astype-524"><span class="linenos">524</span></a>                                  <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject.astype-525"><a href="#ProjectiveObject.astype-525"><span class="linenos">525</span></a>
</span><span id="ProjectiveObject.astype-526"><a href="#ProjectiveObject.astype-526"><span class="linenos">526</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newobj</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveObject.change_base_ring" class="classattr">
                                        <input id="ProjectiveObject.change_base_ring-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">change_base_ring</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">base_ring</span>, </span><span class="param"><span class="n">inplace</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.change_base_ring-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.change_base_ring"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.change_base_ring-528"><a href="#ProjectiveObject.change_base_ring-528"><span class="linenos">528</span></a>    <span class="k">def</span> <span class="nf">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject.change_base_ring-529"><a href="#ProjectiveObject.change_base_ring-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="ProjectiveObject.change_base_ring-530"><a href="#ProjectiveObject.change_base_ring-530"><span class="linenos">530</span></a>            <span class="k">raise</span> <span class="ne">EnvironmentError</span><span class="p">(</span>
</span><span id="ProjectiveObject.change_base_ring-531"><a href="#ProjectiveObject.change_base_ring-531"><span class="linenos">531</span></a>                <span class="s2">&quot;Cannot change base ring unless sage is available&quot;</span>
</span><span id="ProjectiveObject.change_base_ring-532"><a href="#ProjectiveObject.change_base_ring-532"><span class="linenos">532</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject.change_base_ring-533"><a href="#ProjectiveObject.change_base_ring-533"><span class="linenos">533</span></a>
</span><span id="ProjectiveObject.change_base_ring-534"><a href="#ProjectiveObject.change_base_ring-534"><span class="linenos">534</span></a>        <span class="n">newproj</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="ProjectiveObject.change_base_ring-535"><a href="#ProjectiveObject.change_base_ring-535"><span class="linenos">535</span></a>                                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject.change_base_ring-536"><a href="#ProjectiveObject.change_base_ring-536"><span class="linenos">536</span></a>
</span><span id="ProjectiveObject.change_base_ring-537"><a href="#ProjectiveObject.change_base_ring-537"><span class="linenos">537</span></a>        <span class="n">newaux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.change_base_ring-538"><a href="#ProjectiveObject.change_base_ring-538"><span class="linenos">538</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.change_base_ring-539"><a href="#ProjectiveObject.change_base_ring-539"><span class="linenos">539</span></a>            <span class="n">newaux</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="ProjectiveObject.change_base_ring-540"><a href="#ProjectiveObject.change_base_ring-540"><span class="linenos">540</span></a>                                               <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject.change_base_ring-541"><a href="#ProjectiveObject.change_base_ring-541"><span class="linenos">541</span></a>
</span><span id="ProjectiveObject.change_base_ring-542"><a href="#ProjectiveObject.change_base_ring-542"><span class="linenos">542</span></a>        <span class="n">newdual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.change_base_ring-543"><a href="#ProjectiveObject.change_base_ring-543"><span class="linenos">543</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.change_base_ring-544"><a href="#ProjectiveObject.change_base_ring-544"><span class="linenos">544</span></a>            <span class="n">newdual</span> <span class="o">=</span> <span class="n">sagewrap</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">base_ring</span><span class="p">,</span>
</span><span id="ProjectiveObject.change_base_ring-545"><a href="#ProjectiveObject.change_base_ring-545"><span class="linenos">545</span></a>                                                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject.change_base_ring-546"><a href="#ProjectiveObject.change_base_ring-546"><span class="linenos">546</span></a>
</span><span id="ProjectiveObject.change_base_ring-547"><a href="#ProjectiveObject.change_base_ring-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">inplace</span><span class="p">:</span>
</span><span id="ProjectiveObject.change_base_ring-548"><a href="#ProjectiveObject.change_base_ring-548"><span class="linenos">548</span></a>            <span class="n">newobj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">newproj</span><span class="p">,</span> <span class="n">newaux</span><span class="p">,</span> <span class="n">newdual</span><span class="p">,</span>
</span><span id="ProjectiveObject.change_base_ring-549"><a href="#ProjectiveObject.change_base_ring-549"><span class="linenos">549</span></a>                                      <span class="n">unit_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.change_base_ring-550"><a href="#ProjectiveObject.change_base_ring-550"><span class="linenos">550</span></a>                                      <span class="n">aux_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.change_base_ring-551"><a href="#ProjectiveObject.change_base_ring-551"><span class="linenos">551</span></a>                                      <span class="n">dual_ndims</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject.change_base_ring-552"><a href="#ProjectiveObject.change_base_ring-552"><span class="linenos">552</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">newobj</span><span class="p">)</span>
</span><span id="ProjectiveObject.change_base_ring-553"><a href="#ProjectiveObject.change_base_ring-553"><span class="linenos">553</span></a>
</span><span id="ProjectiveObject.change_base_ring-554"><a href="#ProjectiveObject.change_base_ring-554"><span class="linenos">554</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="n">newproj</span>
</span><span id="ProjectiveObject.change_base_ring-555"><a href="#ProjectiveObject.change_base_ring-555"><span class="linenos">555</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="n">newaux</span>
</span><span id="ProjectiveObject.change_base_ring-556"><a href="#ProjectiveObject.change_base_ring-556"><span class="linenos">556</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">newdual</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveObject.projective_coords" class="classattr">
                                        <input id="ProjectiveObject.projective_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">projective_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.projective_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.projective_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.projective_coords-558"><a href="#ProjectiveObject.projective_coords-558"><span class="linenos">558</span></a>    <span class="k">def</span> <span class="nf">projective_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject.projective_coords-559"><a href="#ProjectiveObject.projective_coords-559"><span class="linenos">559</span></a>        <span class="sd">&quot;&quot;&quot;Wrapper for ProjectiveObject.set, since underlying coordinates are</span>
</span><span id="ProjectiveObject.projective_coords-560"><a href="#ProjectiveObject.projective_coords-560"><span class="linenos">560</span></a><span class="sd">        projective.&quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.projective_coords-561"><a href="#ProjectiveObject.projective_coords-561"><span class="linenos">561</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.projective_coords-562"><a href="#ProjectiveObject.projective_coords-562"><span class="linenos">562</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject.projective_coords-563"><a href="#ProjectiveObject.projective_coords-563"><span class="linenos">563</span></a>
</span><span id="ProjectiveObject.projective_coords-564"><a href="#ProjectiveObject.projective_coords-564"><span class="linenos">564</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span></pre></div>


            <div class="docstring"><p>Wrapper for <a href="#ProjectiveObject.set">ProjectiveObject.set</a>, since underlying coordinates are
projective.</p>
</div>


                            </div>
                            <div id="ProjectiveObject.affine_coords" class="classattr">
                                        <input id="ProjectiveObject.affine_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">affine_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.affine_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.affine_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.affine_coords-566"><a href="#ProjectiveObject.affine_coords-566"><span class="linenos">566</span></a>    <span class="k">def</span> <span class="nf">affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ProjectiveObject.affine_coords-567"><a href="#ProjectiveObject.affine_coords-567"><span class="linenos">567</span></a>        <span class="sd">&quot;&quot;&quot;Get or set affine coordinates for this object.</span>
</span><span id="ProjectiveObject.affine_coords-568"><a href="#ProjectiveObject.affine_coords-568"><span class="linenos">568</span></a>
</span><span id="ProjectiveObject.affine_coords-569"><a href="#ProjectiveObject.affine_coords-569"><span class="linenos">569</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject.affine_coords-570"><a href="#ProjectiveObject.affine_coords-570"><span class="linenos">570</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject.affine_coords-571"><a href="#ProjectiveObject.affine_coords-571"><span class="linenos">571</span></a><span class="sd">        aff_data : ndarray</span>
</span><span id="ProjectiveObject.affine_coords-572"><a href="#ProjectiveObject.affine_coords-572"><span class="linenos">572</span></a><span class="sd">            if not `None`, coordinate data for this point in an affine</span>
</span><span id="ProjectiveObject.affine_coords-573"><a href="#ProjectiveObject.affine_coords-573"><span class="linenos">573</span></a><span class="sd">            chart.</span>
</span><span id="ProjectiveObject.affine_coords-574"><a href="#ProjectiveObject.affine_coords-574"><span class="linenos">574</span></a>
</span><span id="ProjectiveObject.affine_coords-575"><a href="#ProjectiveObject.affine_coords-575"><span class="linenos">575</span></a><span class="sd">        chart_index : int</span>
</span><span id="ProjectiveObject.affine_coords-576"><a href="#ProjectiveObject.affine_coords-576"><span class="linenos">576</span></a><span class="sd">            index of standard affine chart to get/set coordinates in</span>
</span><span id="ProjectiveObject.affine_coords-577"><a href="#ProjectiveObject.affine_coords-577"><span class="linenos">577</span></a>
</span><span id="ProjectiveObject.affine_coords-578"><a href="#ProjectiveObject.affine_coords-578"><span class="linenos">578</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveObject.affine_coords-579"><a href="#ProjectiveObject.affine_coords-579"><span class="linenos">579</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveObject.affine_coords-580"><a href="#ProjectiveObject.affine_coords-580"><span class="linenos">580</span></a><span class="sd">        ndarray</span>
</span><span id="ProjectiveObject.affine_coords-581"><a href="#ProjectiveObject.affine_coords-581"><span class="linenos">581</span></a><span class="sd">            affine coordinates of this Point, in the specified</span>
</span><span id="ProjectiveObject.affine_coords-582"><a href="#ProjectiveObject.affine_coords-582"><span class="linenos">582</span></a><span class="sd">            standard affine chart.</span>
</span><span id="ProjectiveObject.affine_coords-583"><a href="#ProjectiveObject.affine_coords-583"><span class="linenos">583</span></a>
</span><span id="ProjectiveObject.affine_coords-584"><a href="#ProjectiveObject.affine_coords-584"><span class="linenos">584</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.affine_coords-585"><a href="#ProjectiveObject.affine_coords-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="n">aff_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.affine_coords-586"><a href="#ProjectiveObject.affine_coords-586"><span class="linenos">586</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">aff_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">),</span>
</span><span id="ProjectiveObject.affine_coords-587"><a href="#ProjectiveObject.affine_coords-587"><span class="linenos">587</span></a>                     <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ProjectiveObject.affine_coords-588"><a href="#ProjectiveObject.affine_coords-588"><span class="linenos">588</span></a>
</span><span id="ProjectiveObject.affine_coords-589"><a href="#ProjectiveObject.affine_coords-589"><span class="linenos">589</span></a>        <span class="k">return</span> <span class="n">affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">,</span>
</span><span id="ProjectiveObject.affine_coords-590"><a href="#ProjectiveObject.affine_coords-590"><span class="linenos">590</span></a>                             <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get or set affine coordinates for this object.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>aff_data</strong> (ndarray):
if not <code>None</code>, coordinate data for this point in an affine
chart.</li>
<li><strong>chart_index</strong> (int):
index of standard affine chart to get/set coordinates in</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: affine coordinates of this Point, in the specified
standard affine chart.</li>
</ul>
</div>


                            </div>
                            <div id="ProjectiveObject.combine" class="classattr">
                                        <input id="ProjectiveObject.combine-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@classmethod</div>

        <span class="def">def</span>
        <span class="name">combine</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">cls</span>, </span><span class="param"><span class="n">to_combine</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.combine-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.combine"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.combine-607"><a href="#ProjectiveObject.combine-607"><span class="linenos">607</span></a>    <span class="nd">@classmethod</span>
</span><span id="ProjectiveObject.combine-608"><a href="#ProjectiveObject.combine-608"><span class="linenos">608</span></a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">to_combine</span><span class="p">):</span>
</span><span id="ProjectiveObject.combine-609"><a href="#ProjectiveObject.combine-609"><span class="linenos">609</span></a>        <span class="sd">&quot;&quot;&quot;Construct a new ProjectiveObject of combining the</span>
</span><span id="ProjectiveObject.combine-610"><a href="#ProjectiveObject.combine-610"><span class="linenos">610</span></a><span class="sd">        data of an array of objects.</span>
</span><span id="ProjectiveObject.combine-611"><a href="#ProjectiveObject.combine-611"><span class="linenos">611</span></a>
</span><span id="ProjectiveObject.combine-612"><a href="#ProjectiveObject.combine-612"><span class="linenos">612</span></a><span class="sd">        All of the objects in the given array will be flattened to</span>
</span><span id="ProjectiveObject.combine-613"><a href="#ProjectiveObject.combine-613"><span class="linenos">613</span></a><span class="sd">        unit dimensions before combining. If dimensions of the</span>
</span><span id="ProjectiveObject.combine-614"><a href="#ProjectiveObject.combine-614"><span class="linenos">614</span></a><span class="sd">        underlying data do not match, this will raise an error.</span>
</span><span id="ProjectiveObject.combine-615"><a href="#ProjectiveObject.combine-615"><span class="linenos">615</span></a>
</span><span id="ProjectiveObject.combine-616"><a href="#ProjectiveObject.combine-616"><span class="linenos">616</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveObject.combine-617"><a href="#ProjectiveObject.combine-617"><span class="linenos">617</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveObject.combine-618"><a href="#ProjectiveObject.combine-618"><span class="linenos">618</span></a><span class="sd">        to_combine : array of ProjectiveObjects with a common type</span>
</span><span id="ProjectiveObject.combine-619"><a href="#ProjectiveObject.combine-619"><span class="linenos">619</span></a>
</span><span id="ProjectiveObject.combine-620"><a href="#ProjectiveObject.combine-620"><span class="linenos">620</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveObject.combine-621"><a href="#ProjectiveObject.combine-621"><span class="linenos">621</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveObject.combine-622"><a href="#ProjectiveObject.combine-622"><span class="linenos">622</span></a><span class="sd">        ProjectiveObject</span>
</span><span id="ProjectiveObject.combine-623"><a href="#ProjectiveObject.combine-623"><span class="linenos">623</span></a><span class="sd">            Object of the appropriate type containing (flattened)</span>
</span><span id="ProjectiveObject.combine-624"><a href="#ProjectiveObject.combine-624"><span class="linenos">624</span></a><span class="sd">            combined data.</span>
</span><span id="ProjectiveObject.combine-625"><a href="#ProjectiveObject.combine-625"><span class="linenos">625</span></a>
</span><span id="ProjectiveObject.combine-626"><a href="#ProjectiveObject.combine-626"><span class="linenos">626</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveObject.combine-627"><a href="#ProjectiveObject.combine-627"><span class="linenos">627</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_combine</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject.combine-628"><a href="#ProjectiveObject.combine-628"><span class="linenos">628</span></a>            <span class="k">return</span>
</span><span id="ProjectiveObject.combine-629"><a href="#ProjectiveObject.combine-629"><span class="linenos">629</span></a>
</span><span id="ProjectiveObject.combine-630"><a href="#ProjectiveObject.combine-630"><span class="linenos">630</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;unit_ndims&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-631"><a href="#ProjectiveObject.combine-631"><span class="linenos">631</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;aux_ndims&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-632"><a href="#ProjectiveObject.combine-632"><span class="linenos">632</span></a>        <span class="bp">cls</span><span class="o">.</span><span class="n">_assert_prop_equal</span><span class="p">(</span><span class="n">to_combine</span><span class="p">,</span> <span class="s2">&quot;dual_ndims&quot;</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-633"><a href="#ProjectiveObject.combine-633"><span class="linenos">633</span></a>
</span><span id="ProjectiveObject.combine-634"><a href="#ProjectiveObject.combine-634"><span class="linenos">634</span></a>        <span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">unit_ndims</span>
</span><span id="ProjectiveObject.combine-635"><a href="#ProjectiveObject.combine-635"><span class="linenos">635</span></a>        <span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">aux_ndims</span>
</span><span id="ProjectiveObject.combine-636"><a href="#ProjectiveObject.combine-636"><span class="linenos">636</span></a>        <span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">to_combine</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dual_ndims</span>
</span><span id="ProjectiveObject.combine-637"><a href="#ProjectiveObject.combine-637"><span class="linenos">637</span></a>
</span><span id="ProjectiveObject.combine-638"><a href="#ProjectiveObject.combine-638"><span class="linenos">638</span></a>        <span class="n">flattened_objs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="ProjectiveObject.combine-639"><a href="#ProjectiveObject.combine-639"><span class="linenos">639</span></a>            <span class="n">obj</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">()</span>
</span><span id="ProjectiveObject.combine-640"><a href="#ProjectiveObject.combine-640"><span class="linenos">640</span></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">to_combine</span>
</span><span id="ProjectiveObject.combine-641"><a href="#ProjectiveObject.combine-641"><span class="linenos">641</span></a>        <span class="p">]</span>
</span><span id="ProjectiveObject.combine-642"><a href="#ProjectiveObject.combine-642"><span class="linenos">642</span></a>
</span><span id="ProjectiveObject.combine-643"><a href="#ProjectiveObject.combine-643"><span class="linenos">643</span></a>        <span class="c1"># first make a generic ProjectiveObject</span>
</span><span id="ProjectiveObject.combine-644"><a href="#ProjectiveObject.combine-644"><span class="linenos">644</span></a>        <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="ProjectiveObject.combine-645"><a href="#ProjectiveObject.combine-645"><span class="linenos">645</span></a>            <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">proj_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="ProjectiveObject.combine-646"><a href="#ProjectiveObject.combine-646"><span class="linenos">646</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">unit_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-647"><a href="#ProjectiveObject.combine-647"><span class="linenos">647</span></a>        <span class="p">)</span>
</span><span id="ProjectiveObject.combine-648"><a href="#ProjectiveObject.combine-648"><span class="linenos">648</span></a>        <span class="n">new_aux</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.combine-649"><a href="#ProjectiveObject.combine-649"><span class="linenos">649</span></a>        <span class="n">new_dual</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="ProjectiveObject.combine-650"><a href="#ProjectiveObject.combine-650"><span class="linenos">650</span></a>
</span><span id="ProjectiveObject.combine-651"><a href="#ProjectiveObject.combine-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="n">aux_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject.combine-652"><a href="#ProjectiveObject.combine-652"><span class="linenos">652</span></a>            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="ProjectiveObject.combine-653"><a href="#ProjectiveObject.combine-653"><span class="linenos">653</span></a>                <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">aux_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="ProjectiveObject.combine-654"><a href="#ProjectiveObject.combine-654"><span class="linenos">654</span></a>                <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">aux_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-655"><a href="#ProjectiveObject.combine-655"><span class="linenos">655</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject.combine-656"><a href="#ProjectiveObject.combine-656"><span class="linenos">656</span></a>            <span class="n">new_aux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">flat_self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">flat_other</span><span class="o">.</span><span class="n">aux_data</span><span class="p">],</span>
</span><span id="ProjectiveObject.combine-657"><a href="#ProjectiveObject.combine-657"><span class="linenos">657</span></a>                                     <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
</span><span id="ProjectiveObject.combine-658"><a href="#ProjectiveObject.combine-658"><span class="linenos">658</span></a>        <span class="k">if</span> <span class="n">dual_ndims</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="ProjectiveObject.combine-659"><a href="#ProjectiveObject.combine-659"><span class="linenos">659</span></a>            <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="ProjectiveObject.combine-660"><a href="#ProjectiveObject.combine-660"><span class="linenos">660</span></a>                <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">dual_data</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">flattened_objs</span><span class="p">],</span>
</span><span id="ProjectiveObject.combine-661"><a href="#ProjectiveObject.combine-661"><span class="linenos">661</span></a>                <span class="n">axis</span><span class="o">=-</span><span class="p">(</span><span class="n">dual_ndims</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-662"><a href="#ProjectiveObject.combine-662"><span class="linenos">662</span></a>            <span class="p">)</span>
</span><span id="ProjectiveObject.combine-663"><a href="#ProjectiveObject.combine-663"><span class="linenos">663</span></a>
</span><span id="ProjectiveObject.combine-664"><a href="#ProjectiveObject.combine-664"><span class="linenos">664</span></a>        <span class="n">newObj</span> <span class="o">=</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">new_data</span><span class="p">,</span> <span class="n">new_aux</span><span class="p">,</span> <span class="n">new_dual</span><span class="p">,</span>
</span><span id="ProjectiveObject.combine-665"><a href="#ProjectiveObject.combine-665"><span class="linenos">665</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.combine-666"><a href="#ProjectiveObject.combine-666"><span class="linenos">666</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="ProjectiveObject.combine-667"><a href="#ProjectiveObject.combine-667"><span class="linenos">667</span></a>                                  <span class="n">dual_ndims</span><span class="o">=</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="ProjectiveObject.combine-668"><a href="#ProjectiveObject.combine-668"><span class="linenos">668</span></a>
</span><span id="ProjectiveObject.combine-669"><a href="#ProjectiveObject.combine-669"><span class="linenos">669</span></a>        <span class="c1"># construct an object with the correct type from this underlying data</span>
</span><span id="ProjectiveObject.combine-670"><a href="#ProjectiveObject.combine-670"><span class="linenos">670</span></a>        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">newObj</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Construct a new ProjectiveObject of combining the
data of an array of objects.</p>

<p>All of the objects in the given array will be flattened to
unit dimensions before combining. If dimensions of the
underlying data do not match, this will raise an error.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>to_combine</strong> (array of ProjectiveObjects with a common type):</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ProjectiveObject</strong>: Object of the appropriate type containing (flattened)
combined data.</li>
</ul>
</div>


                            </div>
                            <div id="ProjectiveObject.set_ndims" class="classattr">
                                        <input id="ProjectiveObject.set_ndims-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_ndims</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">unit_ndims</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">aux_ndims</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dual_ndims</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveObject.set_ndims-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveObject.set_ndims"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveObject.set_ndims-672"><a href="#ProjectiveObject.set_ndims-672"><span class="linenos">672</span></a>    <span class="k">def</span> <span class="nf">set_ndims</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="ProjectiveObject.set_ndims-673"><a href="#ProjectiveObject.set_ndims-673"><span class="linenos">673</span></a>        <span class="k">if</span> <span class="n">unit_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.set_ndims-674"><a href="#ProjectiveObject.set_ndims-674"><span class="linenos">674</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span><span id="ProjectiveObject.set_ndims-675"><a href="#ProjectiveObject.set_ndims-675"><span class="linenos">675</span></a>
</span><span id="ProjectiveObject.set_ndims-676"><a href="#ProjectiveObject.set_ndims-676"><span class="linenos">676</span></a>        <span class="k">if</span> <span class="n">aux_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.set_ndims-677"><a href="#ProjectiveObject.set_ndims-677"><span class="linenos">677</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="n">aux_ndims</span>
</span><span id="ProjectiveObject.set_ndims-678"><a href="#ProjectiveObject.set_ndims-678"><span class="linenos">678</span></a>
</span><span id="ProjectiveObject.set_ndims-679"><a href="#ProjectiveObject.set_ndims-679"><span class="linenos">679</span></a>        <span class="k">if</span> <span class="n">dual_ndims</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ProjectiveObject.set_ndims-680"><a href="#ProjectiveObject.set_ndims-680"><span class="linenos">680</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="n">dual_ndims</span>
</span></pre></div>


    

                            </div>
                </section>
                <section id="Point">
                            <input id="Point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Point</span><wbr>(<span class="base"><a href="#ProjectiveObject">ProjectiveObject</a></span>):

                <label class="view-source-button" for="Point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point-683"><a href="#Point-683"><span class="linenos">683</span></a><span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="Point-684"><a href="#Point-684"><span class="linenos">684</span></a>    <span class="sd">&quot;&quot;&quot;A point (or collection of points) in projective space.</span>
</span><span id="Point-685"><a href="#Point-685"><span class="linenos">685</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Point-686"><a href="#Point-686"><span class="linenos">686</span></a>
</span><span id="Point-687"><a href="#Point-687"><span class="linenos">687</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-688"><a href="#Point-688"><span class="linenos">688</span></a>        <span class="sd">&quot;&quot;&quot;Parameters</span>
</span><span id="Point-689"><a href="#Point-689"><span class="linenos">689</span></a><span class="sd">        ----------</span>
</span><span id="Point-690"><a href="#Point-690"><span class="linenos">690</span></a><span class="sd">        point : ndarray or ProjectiveObject or iterable</span>
</span><span id="Point-691"><a href="#Point-691"><span class="linenos">691</span></a><span class="sd">            Data to use to construct a Point object. If `point` is an</span>
</span><span id="Point-692"><a href="#Point-692"><span class="linenos">692</span></a><span class="sd">            `ndarray`, then it is interpreted as data in either</span>
</span><span id="Point-693"><a href="#Point-693"><span class="linenos">693</span></a><span class="sd">            projective or affine coordinates, depending on whether</span>
</span><span id="Point-694"><a href="#Point-694"><span class="linenos">694</span></a><span class="sd">            `chart_index` is specified. If `point` is a</span>
</span><span id="Point-695"><a href="#Point-695"><span class="linenos">695</span></a><span class="sd">            `ProjectiveObject`, then construct a `Point` from the</span>
</span><span id="Point-696"><a href="#Point-696"><span class="linenos">696</span></a><span class="sd">            underlying data of that object.</span>
</span><span id="Point-697"><a href="#Point-697"><span class="linenos">697</span></a><span class="sd">        chart_index : int</span>
</span><span id="Point-698"><a href="#Point-698"><span class="linenos">698</span></a><span class="sd">            if `None` (default), then assume that `point` is data in</span>
</span><span id="Point-699"><a href="#Point-699"><span class="linenos">699</span></a><span class="sd">            projective coordinates, or a ProjectiveObject. Otherwise,</span>
</span><span id="Point-700"><a href="#Point-700"><span class="linenos">700</span></a><span class="sd">            interpret `point` as data in affine coordinates, and use</span>
</span><span id="Point-701"><a href="#Point-701"><span class="linenos">701</span></a><span class="sd">            `chart_index` as the index of the standard affine chart</span>
</span><span id="Point-702"><a href="#Point-702"><span class="linenos">702</span></a><span class="sd">            those coordinates are in.</span>
</span><span id="Point-703"><a href="#Point-703"><span class="linenos">703</span></a>
</span><span id="Point-704"><a href="#Point-704"><span class="linenos">704</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-705"><a href="#Point-705"><span class="linenos">705</span></a>
</span><span id="Point-706"><a href="#Point-706"><span class="linenos">706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Point-707"><a href="#Point-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point-708"><a href="#Point-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point-709"><a href="#Point-709"><span class="linenos">709</span></a>
</span><span id="Point-710"><a href="#Point-710"><span class="linenos">710</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Point-711"><a href="#Point-711"><span class="linenos">711</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-712"><a href="#Point-712"><span class="linenos">712</span></a>            <span class="k">return</span>
</span><span id="Point-713"><a href="#Point-713"><span class="linenos">713</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Point-714"><a href="#Point-714"><span class="linenos">714</span></a>            <span class="k">pass</span>
</span><span id="Point-715"><a href="#Point-715"><span class="linenos">715</span></a>
</span><span id="Point-716"><a href="#Point-716"><span class="linenos">716</span></a>        <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point-717"><a href="#Point-717"><span class="linenos">717</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-718"><a href="#Point-718"><span class="linenos">718</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Point-719"><a href="#Point-719"><span class="linenos">719</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-720"><a href="#Point-720"><span class="linenos">720</span></a>
</span><span id="Point-721"><a href="#Point-721"><span class="linenos">721</span></a>    <span class="k">def</span> <span class="nf">in_affine_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="Point-722"><a href="#Point-722"><span class="linenos">722</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
</span></pre></div>


            <div class="docstring"><p>A point (or collection of points) in projective space.</p>
</div>


                            <div id="Point.__init__" class="classattr">
                                        <input id="Point.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Point.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.__init__-687"><a href="#Point.__init__-687"><span class="linenos">687</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.__init__-688"><a href="#Point.__init__-688"><span class="linenos">688</span></a>        <span class="sd">&quot;&quot;&quot;Parameters</span>
</span><span id="Point.__init__-689"><a href="#Point.__init__-689"><span class="linenos">689</span></a><span class="sd">        ----------</span>
</span><span id="Point.__init__-690"><a href="#Point.__init__-690"><span class="linenos">690</span></a><span class="sd">        point : ndarray or ProjectiveObject or iterable</span>
</span><span id="Point.__init__-691"><a href="#Point.__init__-691"><span class="linenos">691</span></a><span class="sd">            Data to use to construct a Point object. If `point` is an</span>
</span><span id="Point.__init__-692"><a href="#Point.__init__-692"><span class="linenos">692</span></a><span class="sd">            `ndarray`, then it is interpreted as data in either</span>
</span><span id="Point.__init__-693"><a href="#Point.__init__-693"><span class="linenos">693</span></a><span class="sd">            projective or affine coordinates, depending on whether</span>
</span><span id="Point.__init__-694"><a href="#Point.__init__-694"><span class="linenos">694</span></a><span class="sd">            `chart_index` is specified. If `point` is a</span>
</span><span id="Point.__init__-695"><a href="#Point.__init__-695"><span class="linenos">695</span></a><span class="sd">            `ProjectiveObject`, then construct a `Point` from the</span>
</span><span id="Point.__init__-696"><a href="#Point.__init__-696"><span class="linenos">696</span></a><span class="sd">            underlying data of that object.</span>
</span><span id="Point.__init__-697"><a href="#Point.__init__-697"><span class="linenos">697</span></a><span class="sd">        chart_index : int</span>
</span><span id="Point.__init__-698"><a href="#Point.__init__-698"><span class="linenos">698</span></a><span class="sd">            if `None` (default), then assume that `point` is data in</span>
</span><span id="Point.__init__-699"><a href="#Point.__init__-699"><span class="linenos">699</span></a><span class="sd">            projective coordinates, or a ProjectiveObject. Otherwise,</span>
</span><span id="Point.__init__-700"><a href="#Point.__init__-700"><span class="linenos">700</span></a><span class="sd">            interpret `point` as data in affine coordinates, and use</span>
</span><span id="Point.__init__-701"><a href="#Point.__init__-701"><span class="linenos">701</span></a><span class="sd">            `chart_index` as the index of the standard affine chart</span>
</span><span id="Point.__init__-702"><a href="#Point.__init__-702"><span class="linenos">702</span></a><span class="sd">            those coordinates are in.</span>
</span><span id="Point.__init__-703"><a href="#Point.__init__-703"><span class="linenos">703</span></a>
</span><span id="Point.__init__-704"><a href="#Point.__init__-704"><span class="linenos">704</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.__init__-705"><a href="#Point.__init__-705"><span class="linenos">705</span></a>
</span><span id="Point.__init__-706"><a href="#Point.__init__-706"><span class="linenos">706</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Point.__init__-707"><a href="#Point.__init__-707"><span class="linenos">707</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point.__init__-708"><a href="#Point.__init__-708"><span class="linenos">708</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point.__init__-709"><a href="#Point.__init__-709"><span class="linenos">709</span></a>
</span><span id="Point.__init__-710"><a href="#Point.__init__-710"><span class="linenos">710</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Point.__init__-711"><a href="#Point.__init__-711"><span class="linenos">711</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.__init__-712"><a href="#Point.__init__-712"><span class="linenos">712</span></a>            <span class="k">return</span>
</span><span id="Point.__init__-713"><a href="#Point.__init__-713"><span class="linenos">713</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Point.__init__-714"><a href="#Point.__init__-714"><span class="linenos">714</span></a>            <span class="k">pass</span>
</span><span id="Point.__init__-715"><a href="#Point.__init__-715"><span class="linenos">715</span></a>
</span><span id="Point.__init__-716"><a href="#Point.__init__-716"><span class="linenos">716</span></a>        <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point.__init__-717"><a href="#Point.__init__-717"><span class="linenos">717</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.__init__-718"><a href="#Point.__init__-718"><span class="linenos">718</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Point.__init__-719"><a href="#Point.__init__-719"><span class="linenos">719</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>point</strong> (ndarray or ProjectiveObject or iterable):
Data to use to construct a Point object. If <code>point</code> is an
<code>ndarray</code>, then it is interpreted as data in either
projective or affine coordinates, depending on whether
<code>chart_index</code> is specified. If <code>point</code> is a
<code><a href="#ProjectiveObject">ProjectiveObject</a></code>, then construct a <code><a href="#Point">Point</a></code> from the
underlying data of that object.</li>
<li><strong>chart_index</strong> (int):
if <code>None</code> (default), then assume that <code>point</code> is data in
projective coordinates, or a ProjectiveObject. Otherwise,
interpret <code>point</code> as data in affine coordinates, and use
<code>chart_index</code> as the index of the standard affine chart
those coordinates are in.</li>
</ul>
</div>


                            </div>
                            <div id="Point.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#Point.unit_ndims"></a>
    
    

                            </div>
                            <div id="Point.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#Point.aux_ndims"></a>
    
    

                            </div>
                            <div id="Point.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#Point.dual_ndims"></a>
    
    

                            </div>
                            <div id="Point.in_affine_chart" class="classattr">
                                        <input id="Point.in_affine_chart-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">in_affine_chart</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">index</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.in_affine_chart-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.in_affine_chart"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.in_affine_chart-721"><a href="#Point.in_affine_chart-721"><span class="linenos">721</span></a>    <span class="k">def</span> <span class="nf">in_affine_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="Point.in_affine_chart-722"><a href="#Point.in_affine_chart-722"><span class="linenos">722</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="Point.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Point.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="Point.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Point.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="Point.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Point.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Point.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="Point.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Point.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Point.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Point.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="Point.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PointCollection">
                            <input id="PointCollection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PointCollection</span><wbr>(<span class="base"><a href="#Point">Point</a></span>):

                <label class="view-source-button" for="PointCollection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointCollection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointCollection-724"><a href="#PointCollection-724"><span class="linenos">724</span></a><span class="k">class</span> <span class="nc">PointCollection</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="PointCollection-725"><a href="#PointCollection-725"><span class="linenos">725</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointCollection-726"><a href="#PointCollection-726"><span class="linenos">726</span></a>        <span class="n">Point</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointCollection-727"><a href="#PointCollection-727"><span class="linenos">727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span></pre></div>


            <div class="docstring"><p>A point (or collection of points) in projective space.</p>
</div>


                            <div id="PointCollection.__init__" class="classattr">
                                        <input id="PointCollection.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PointCollection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="o">*</span><span class="n">args</span>, </span><span class="param"><span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="PointCollection.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointCollection.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointCollection.__init__-725"><a href="#PointCollection.__init__-725"><span class="linenos">725</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointCollection.__init__-726"><a href="#PointCollection.__init__-726"><span class="linenos">726</span></a>        <span class="n">Point</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointCollection.__init__-727"><a href="#PointCollection.__init__-727"><span class="linenos">727</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="n">unit_ndims</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>point</strong> (ndarray or ProjectiveObject or iterable):
Data to use to construct a Point object. If <code>point</code> is an
<code>ndarray</code>, then it is interpreted as data in either
projective or affine coordinates, depending on whether
<code>chart_index</code> is specified. If <code>point</code> is a
<code><a href="#ProjectiveObject">ProjectiveObject</a></code>, then construct a <code><a href="#Point">Point</a></code> from the
underlying data of that object.</li>
<li><strong>chart_index</strong> (int):
if <code>None</code> (default), then assume that <code>point</code> is data in
projective coordinates, or a ProjectiveObject. Otherwise,
interpret <code>point</code> as data in affine coordinates, and use
<code>chart_index</code> as the index of the standard affine chart
those coordinates are in.</li>
</ul>
</div>


                            </div>
                            <div id="PointCollection.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#PointCollection.unit_ndims"></a>
    
    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="PointCollection.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="PointCollection.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="PointCollection.in_affine_chart" class="function"><a href="#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="PointCollection.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="PointCollection.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="PointCollection.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="PointCollection.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="PointCollection.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="PointCollection.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="PointCollection.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="PointCollection.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="PointCollection.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="PointCollection.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="PointCollection.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="PointCollection.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PointPair">
                            <input id="PointPair-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PointPair</span><wbr>(<span class="base"><a href="#Point">Point</a></span>):

                <label class="view-source-button" for="PointPair-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair-729"><a href="#PointPair-729"><span class="linenos">729</span></a><span class="k">class</span> <span class="nc">PointPair</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="PointPair-730"><a href="#PointPair-730"><span class="linenos">730</span></a>    <span class="sd">&quot;&quot;&quot;A pair of points (or a composite object consisting of a collection</span>
</span><span id="PointPair-731"><a href="#PointPair-731"><span class="linenos">731</span></a><span class="sd">    of pairs of points) in projective space.</span>
</span><span id="PointPair-732"><a href="#PointPair-732"><span class="linenos">732</span></a>
</span><span id="PointPair-733"><a href="#PointPair-733"><span class="linenos">733</span></a><span class="sd">    This is mostly useful as an interface for subclasses which provide</span>
</span><span id="PointPair-734"><a href="#PointPair-734"><span class="linenos">734</span></a><span class="sd">    more involved functionality.</span>
</span><span id="PointPair-735"><a href="#PointPair-735"><span class="linenos">735</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PointPair-736"><a href="#PointPair-736"><span class="linenos">736</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="PointPair-737"><a href="#PointPair-737"><span class="linenos">737</span></a>                 <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointPair-738"><a href="#PointPair-738"><span class="linenos">738</span></a>        <span class="sd">&quot;&quot;&quot;If `endpoint2` is `None`, interpret `endpoint1` as either an</span>
</span><span id="PointPair-739"><a href="#PointPair-739"><span class="linenos">739</span></a><span class="sd">        `ndarray` of shape (2, ..., n) (where n is the dimension of</span>
</span><span id="PointPair-740"><a href="#PointPair-740"><span class="linenos">740</span></a><span class="sd">        the underlying vector space), or else a composite `Point`</span>
</span><span id="PointPair-741"><a href="#PointPair-741"><span class="linenos">741</span></a><span class="sd">        object which can be unpacked into two Points (which may</span>
</span><span id="PointPair-742"><a href="#PointPair-742"><span class="linenos">742</span></a><span class="sd">        themselves be composite).</span>
</span><span id="PointPair-743"><a href="#PointPair-743"><span class="linenos">743</span></a>
</span><span id="PointPair-744"><a href="#PointPair-744"><span class="linenos">744</span></a><span class="sd">        If `endpoint2` is given, then both `endpoint1` and `endpoint2`</span>
</span><span id="PointPair-745"><a href="#PointPair-745"><span class="linenos">745</span></a><span class="sd">        can be used to construct `Point` objects, which serve as the</span>
</span><span id="PointPair-746"><a href="#PointPair-746"><span class="linenos">746</span></a><span class="sd">        endpoints for this pair of points.</span>
</span><span id="PointPair-747"><a href="#PointPair-747"><span class="linenos">747</span></a>
</span><span id="PointPair-748"><a href="#PointPair-748"><span class="linenos">748</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair-749"><a href="#PointPair-749"><span class="linenos">749</span></a><span class="sd">        ----------</span>
</span><span id="PointPair-750"><a href="#PointPair-750"><span class="linenos">750</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="PointPair-751"><a href="#PointPair-751"><span class="linenos">751</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="PointPair-752"><a href="#PointPair-752"><span class="linenos">752</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="PointPair-753"><a href="#PointPair-753"><span class="linenos">753</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="PointPair-754"><a href="#PointPair-754"><span class="linenos">754</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="PointPair-755"><a href="#PointPair-755"><span class="linenos">755</span></a>
</span><span id="PointPair-756"><a href="#PointPair-756"><span class="linenos">756</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-757"><a href="#PointPair-757"><span class="linenos">757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_ndims</span><span class="p">(</span><span class="n">unit_ndims</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="PointPair-758"><a href="#PointPair-758"><span class="linenos">758</span></a>
</span><span id="PointPair-759"><a href="#PointPair-759"><span class="linenos">759</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PointPair-760"><a href="#PointPair-760"><span class="linenos">760</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PointPair-761"><a href="#PointPair-761"><span class="linenos">761</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair-762"><a href="#PointPair-762"><span class="linenos">762</span></a>                <span class="k">return</span>
</span><span id="PointPair-763"><a href="#PointPair-763"><span class="linenos">763</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="PointPair-764"><a href="#PointPair-764"><span class="linenos">764</span></a>                <span class="k">pass</span>
</span><span id="PointPair-765"><a href="#PointPair-765"><span class="linenos">765</span></a>
</span><span id="PointPair-766"><a href="#PointPair-766"><span class="linenos">766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_endpoints</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair-767"><a href="#PointPair-767"><span class="linenos">767</span></a>
</span><span id="PointPair-768"><a href="#PointPair-768"><span class="linenos">768</span></a>    <span class="nd">@property</span>
</span><span id="PointPair-769"><a href="#PointPair-769"><span class="linenos">769</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair-770"><a href="#PointPair-770"><span class="linenos">770</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="PointPair-771"><a href="#PointPair-771"><span class="linenos">771</span></a>
</span><span id="PointPair-772"><a href="#PointPair-772"><span class="linenos">772</span></a>    <span class="k">def</span> <span class="nf">set_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointPair-773"><a href="#PointPair-773"><span class="linenos">773</span></a>        <span class="sd">&quot;&quot;&quot;Set the endpoints of a segment.</span>
</span><span id="PointPair-774"><a href="#PointPair-774"><span class="linenos">774</span></a>
</span><span id="PointPair-775"><a href="#PointPair-775"><span class="linenos">775</span></a><span class="sd">        If `endpoint2` is `None`, expect `endpoint1` to be an array of</span>
</span><span id="PointPair-776"><a href="#PointPair-776"><span class="linenos">776</span></a><span class="sd">        points with shape `(..., 2, n)`. Otherwise, expect `endpoint1`</span>
</span><span id="PointPair-777"><a href="#PointPair-777"><span class="linenos">777</span></a><span class="sd">        and `endpoint2` to be arrays of points with the same shape.</span>
</span><span id="PointPair-778"><a href="#PointPair-778"><span class="linenos">778</span></a>
</span><span id="PointPair-779"><a href="#PointPair-779"><span class="linenos">779</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair-780"><a href="#PointPair-780"><span class="linenos">780</span></a><span class="sd">        ----------</span>
</span><span id="PointPair-781"><a href="#PointPair-781"><span class="linenos">781</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="PointPair-782"><a href="#PointPair-782"><span class="linenos">782</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="PointPair-783"><a href="#PointPair-783"><span class="linenos">783</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="PointPair-784"><a href="#PointPair-784"><span class="linenos">784</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="PointPair-785"><a href="#PointPair-785"><span class="linenos">785</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="PointPair-786"><a href="#PointPair-786"><span class="linenos">786</span></a>
</span><span id="PointPair-787"><a href="#PointPair-787"><span class="linenos">787</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-788"><a href="#PointPair-788"><span class="linenos">788</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PointPair-789"><a href="#PointPair-789"><span class="linenos">789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair-790"><a href="#PointPair-790"><span class="linenos">790</span></a>            <span class="k">return</span>
</span><span id="PointPair-791"><a href="#PointPair-791"><span class="linenos">791</span></a>
</span><span id="PointPair-792"><a href="#PointPair-792"><span class="linenos">792</span></a>        <span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span>
</span><span id="PointPair-793"><a href="#PointPair-793"><span class="linenos">793</span></a>        <span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint2</span><span class="p">)</span>
</span><span id="PointPair-794"><a href="#PointPair-794"><span class="linenos">794</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pt1</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">pt2</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair-795"><a href="#PointPair-795"><span class="linenos">795</span></a>
</span><span id="PointPair-796"><a href="#PointPair-796"><span class="linenos">796</span></a>    <span class="k">def</span> <span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair-797"><a href="#PointPair-797"><span class="linenos">797</span></a>        <span class="sd">&quot;&quot;&quot;Get a Point representing the endpoints of this pair</span>
</span><span id="PointPair-798"><a href="#PointPair-798"><span class="linenos">798</span></a>
</span><span id="PointPair-799"><a href="#PointPair-799"><span class="linenos">799</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-800"><a href="#PointPair-800"><span class="linenos">800</span></a><span class="sd">        -------</span>
</span><span id="PointPair-801"><a href="#PointPair-801"><span class="linenos">801</span></a><span class="sd">        Point</span>
</span><span id="PointPair-802"><a href="#PointPair-802"><span class="linenos">802</span></a><span class="sd">            A composite Point object representing the endpoints of</span>
</span><span id="PointPair-803"><a href="#PointPair-803"><span class="linenos">803</span></a><span class="sd">            this (possibly composite) PointPair</span>
</span><span id="PointPair-804"><a href="#PointPair-804"><span class="linenos">804</span></a>
</span><span id="PointPair-805"><a href="#PointPair-805"><span class="linenos">805</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-806"><a href="#PointPair-806"><span class="linenos">806</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">)</span>
</span><span id="PointPair-807"><a href="#PointPair-807"><span class="linenos">807</span></a>
</span><span id="PointPair-808"><a href="#PointPair-808"><span class="linenos">808</span></a>    <span class="k">def</span> <span class="nf">get_end_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair-809"><a href="#PointPair-809"><span class="linenos">809</span></a>        <span class="sd">&quot;&quot;&quot;Return a pair of point objects, one for each endpoint</span>
</span><span id="PointPair-810"><a href="#PointPair-810"><span class="linenos">810</span></a>
</span><span id="PointPair-811"><a href="#PointPair-811"><span class="linenos">811</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-812"><a href="#PointPair-812"><span class="linenos">812</span></a><span class="sd">        -------</span>
</span><span id="PointPair-813"><a href="#PointPair-813"><span class="linenos">813</span></a><span class="sd">        tuple</span>
</span><span id="PointPair-814"><a href="#PointPair-814"><span class="linenos">814</span></a><span class="sd">            Tuple of the form `(endpoint1, endpoint2)`, where</span>
</span><span id="PointPair-815"><a href="#PointPair-815"><span class="linenos">815</span></a><span class="sd">            `endpoint1` and `endpoint2` are (possibly composite)</span>
</span><span id="PointPair-816"><a href="#PointPair-816"><span class="linenos">816</span></a><span class="sd">            `Point` objects representing the endpoints of this pair</span>
</span><span id="PointPair-817"><a href="#PointPair-817"><span class="linenos">817</span></a>
</span><span id="PointPair-818"><a href="#PointPair-818"><span class="linenos">818</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-819"><a href="#PointPair-819"><span class="linenos">819</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span>
</span><span id="PointPair-820"><a href="#PointPair-820"><span class="linenos">820</span></a>                <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
</span><span id="PointPair-821"><a href="#PointPair-821"><span class="linenos">821</span></a>
</span><span id="PointPair-822"><a href="#PointPair-822"><span class="linenos">822</span></a>    <span class="k">def</span> <span class="nf">endpoint_affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="PointPair-823"><a href="#PointPair-823"><span class="linenos">823</span></a>        <span class="sd">&quot;&quot;&quot;Get endpoints of this segment in affine coordinates</span>
</span><span id="PointPair-824"><a href="#PointPair-824"><span class="linenos">824</span></a>
</span><span id="PointPair-825"><a href="#PointPair-825"><span class="linenos">825</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair-826"><a href="#PointPair-826"><span class="linenos">826</span></a><span class="sd">        ----------</span>
</span><span id="PointPair-827"><a href="#PointPair-827"><span class="linenos">827</span></a><span class="sd">        chart_index : int</span>
</span><span id="PointPair-828"><a href="#PointPair-828"><span class="linenos">828</span></a><span class="sd">            Index of the standard affine chart to take coordinates in</span>
</span><span id="PointPair-829"><a href="#PointPair-829"><span class="linenos">829</span></a>
</span><span id="PointPair-830"><a href="#PointPair-830"><span class="linenos">830</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-831"><a href="#PointPair-831"><span class="linenos">831</span></a><span class="sd">        -------</span>
</span><span id="PointPair-832"><a href="#PointPair-832"><span class="linenos">832</span></a><span class="sd">        ndarray</span>
</span><span id="PointPair-833"><a href="#PointPair-833"><span class="linenos">833</span></a><span class="sd">            Affine coordinates of the endpoints of this pair of</span>
</span><span id="PointPair-834"><a href="#PointPair-834"><span class="linenos">834</span></a><span class="sd">            points.</span>
</span><span id="PointPair-835"><a href="#PointPair-835"><span class="linenos">835</span></a>
</span><span id="PointPair-836"><a href="#PointPair-836"><span class="linenos">836</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-837"><a href="#PointPair-837"><span class="linenos">837</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">)</span>
</span><span id="PointPair-838"><a href="#PointPair-838"><span class="linenos">838</span></a>
</span><span id="PointPair-839"><a href="#PointPair-839"><span class="linenos">839</span></a>    <span class="k">def</span> <span class="nf">endpoint_projective_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair-840"><a href="#PointPair-840"><span class="linenos">840</span></a>        <span class="sd">&quot;&quot;&quot;Get endpoints of this segment in projective coordinates.</span>
</span><span id="PointPair-841"><a href="#PointPair-841"><span class="linenos">841</span></a>
</span><span id="PointPair-842"><a href="#PointPair-842"><span class="linenos">842</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-843"><a href="#PointPair-843"><span class="linenos">843</span></a><span class="sd">        -------</span>
</span><span id="PointPair-844"><a href="#PointPair-844"><span class="linenos">844</span></a><span class="sd">        ndarray</span>
</span><span id="PointPair-845"><a href="#PointPair-845"><span class="linenos">845</span></a><span class="sd">            Projective coordinates of the endpoints of this pair of</span>
</span><span id="PointPair-846"><a href="#PointPair-846"><span class="linenos">846</span></a><span class="sd">            points.</span>
</span><span id="PointPair-847"><a href="#PointPair-847"><span class="linenos">847</span></a>
</span><span id="PointPair-848"><a href="#PointPair-848"><span class="linenos">848</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-849"><a href="#PointPair-849"><span class="linenos">849</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>A pair of points (or a composite object consisting of a collection
of pairs of points) in projective space.</p>

<p>This is mostly useful as an interface for subclasses which provide
more involved functionality.</p>
</div>


                            <div id="PointPair.__init__" class="classattr">
                                        <input id="PointPair.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PointPair</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">endpoint1</span>,</span><span class="param">	<span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="PointPair.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.__init__-736"><a href="#PointPair.__init__-736"><span class="linenos">736</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="PointPair.__init__-737"><a href="#PointPair.__init__-737"><span class="linenos">737</span></a>                 <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointPair.__init__-738"><a href="#PointPair.__init__-738"><span class="linenos">738</span></a>        <span class="sd">&quot;&quot;&quot;If `endpoint2` is `None`, interpret `endpoint1` as either an</span>
</span><span id="PointPair.__init__-739"><a href="#PointPair.__init__-739"><span class="linenos">739</span></a><span class="sd">        `ndarray` of shape (2, ..., n) (where n is the dimension of</span>
</span><span id="PointPair.__init__-740"><a href="#PointPair.__init__-740"><span class="linenos">740</span></a><span class="sd">        the underlying vector space), or else a composite `Point`</span>
</span><span id="PointPair.__init__-741"><a href="#PointPair.__init__-741"><span class="linenos">741</span></a><span class="sd">        object which can be unpacked into two Points (which may</span>
</span><span id="PointPair.__init__-742"><a href="#PointPair.__init__-742"><span class="linenos">742</span></a><span class="sd">        themselves be composite).</span>
</span><span id="PointPair.__init__-743"><a href="#PointPair.__init__-743"><span class="linenos">743</span></a>
</span><span id="PointPair.__init__-744"><a href="#PointPair.__init__-744"><span class="linenos">744</span></a><span class="sd">        If `endpoint2` is given, then both `endpoint1` and `endpoint2`</span>
</span><span id="PointPair.__init__-745"><a href="#PointPair.__init__-745"><span class="linenos">745</span></a><span class="sd">        can be used to construct `Point` objects, which serve as the</span>
</span><span id="PointPair.__init__-746"><a href="#PointPair.__init__-746"><span class="linenos">746</span></a><span class="sd">        endpoints for this pair of points.</span>
</span><span id="PointPair.__init__-747"><a href="#PointPair.__init__-747"><span class="linenos">747</span></a>
</span><span id="PointPair.__init__-748"><a href="#PointPair.__init__-748"><span class="linenos">748</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair.__init__-749"><a href="#PointPair.__init__-749"><span class="linenos">749</span></a><span class="sd">        ----------</span>
</span><span id="PointPair.__init__-750"><a href="#PointPair.__init__-750"><span class="linenos">750</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="PointPair.__init__-751"><a href="#PointPair.__init__-751"><span class="linenos">751</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="PointPair.__init__-752"><a href="#PointPair.__init__-752"><span class="linenos">752</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="PointPair.__init__-753"><a href="#PointPair.__init__-753"><span class="linenos">753</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="PointPair.__init__-754"><a href="#PointPair.__init__-754"><span class="linenos">754</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="PointPair.__init__-755"><a href="#PointPair.__init__-755"><span class="linenos">755</span></a>
</span><span id="PointPair.__init__-756"><a href="#PointPair.__init__-756"><span class="linenos">756</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.__init__-757"><a href="#PointPair.__init__-757"><span class="linenos">757</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_ndims</span><span class="p">(</span><span class="n">unit_ndims</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="PointPair.__init__-758"><a href="#PointPair.__init__-758"><span class="linenos">758</span></a>
</span><span id="PointPair.__init__-759"><a href="#PointPair.__init__-759"><span class="linenos">759</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PointPair.__init__-760"><a href="#PointPair.__init__-760"><span class="linenos">760</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PointPair.__init__-761"><a href="#PointPair.__init__-761"><span class="linenos">761</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair.__init__-762"><a href="#PointPair.__init__-762"><span class="linenos">762</span></a>                <span class="k">return</span>
</span><span id="PointPair.__init__-763"><a href="#PointPair.__init__-763"><span class="linenos">763</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="PointPair.__init__-764"><a href="#PointPair.__init__-764"><span class="linenos">764</span></a>                <span class="k">pass</span>
</span><span id="PointPair.__init__-765"><a href="#PointPair.__init__-765"><span class="linenos">765</span></a>
</span><span id="PointPair.__init__-766"><a href="#PointPair.__init__-766"><span class="linenos">766</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_endpoints</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If <code>endpoint2</code> is <code>None</code>, interpret <code>endpoint1</code> as either an
<code>ndarray</code> of shape (2, ..., n) (where n is the dimension of
the underlying vector space), or else a composite <code><a href="#Point">Point</a></code>
object which can be unpacked into two Points (which may
themselves be composite).</p>

<p>If <code>endpoint2</code> is given, then both <code>endpoint1</code> and <code>endpoint2</code>
can be used to construct <code><a href="#Point">Point</a></code> objects, which serve as the
endpoints for this pair of points.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>endpoint1</strong> (Point or ndarray):
One (or both) endpoints of the point pair</li>
<li><strong>endpoint2</strong> (Point or ndarray):
The other endpoint of the point pair. If <code>None</code>,
<code>endpoint1</code> contains the data for both points in the pair.</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.endpoints" class="classattr">
                                        <input id="PointPair.endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">endpoints</span>

                <label class="view-source-button" for="PointPair.endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.endpoints-768"><a href="#PointPair.endpoints-768"><span class="linenos">768</span></a>    <span class="nd">@property</span>
</span><span id="PointPair.endpoints-769"><a href="#PointPair.endpoints-769"><span class="linenos">769</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair.endpoints-770"><a href="#PointPair.endpoints-770"><span class="linenos">770</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="PointPair.set_endpoints" class="classattr">
                                        <input id="PointPair.set_endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_endpoints</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">endpoint1</span>, </span><span class="param"><span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.set_endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.set_endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.set_endpoints-772"><a href="#PointPair.set_endpoints-772"><span class="linenos">772</span></a>    <span class="k">def</span> <span class="nf">set_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointPair.set_endpoints-773"><a href="#PointPair.set_endpoints-773"><span class="linenos">773</span></a>        <span class="sd">&quot;&quot;&quot;Set the endpoints of a segment.</span>
</span><span id="PointPair.set_endpoints-774"><a href="#PointPair.set_endpoints-774"><span class="linenos">774</span></a>
</span><span id="PointPair.set_endpoints-775"><a href="#PointPair.set_endpoints-775"><span class="linenos">775</span></a><span class="sd">        If `endpoint2` is `None`, expect `endpoint1` to be an array of</span>
</span><span id="PointPair.set_endpoints-776"><a href="#PointPair.set_endpoints-776"><span class="linenos">776</span></a><span class="sd">        points with shape `(..., 2, n)`. Otherwise, expect `endpoint1`</span>
</span><span id="PointPair.set_endpoints-777"><a href="#PointPair.set_endpoints-777"><span class="linenos">777</span></a><span class="sd">        and `endpoint2` to be arrays of points with the same shape.</span>
</span><span id="PointPair.set_endpoints-778"><a href="#PointPair.set_endpoints-778"><span class="linenos">778</span></a>
</span><span id="PointPair.set_endpoints-779"><a href="#PointPair.set_endpoints-779"><span class="linenos">779</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair.set_endpoints-780"><a href="#PointPair.set_endpoints-780"><span class="linenos">780</span></a><span class="sd">        ----------</span>
</span><span id="PointPair.set_endpoints-781"><a href="#PointPair.set_endpoints-781"><span class="linenos">781</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="PointPair.set_endpoints-782"><a href="#PointPair.set_endpoints-782"><span class="linenos">782</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="PointPair.set_endpoints-783"><a href="#PointPair.set_endpoints-783"><span class="linenos">783</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="PointPair.set_endpoints-784"><a href="#PointPair.set_endpoints-784"><span class="linenos">784</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="PointPair.set_endpoints-785"><a href="#PointPair.set_endpoints-785"><span class="linenos">785</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="PointPair.set_endpoints-786"><a href="#PointPair.set_endpoints-786"><span class="linenos">786</span></a>
</span><span id="PointPair.set_endpoints-787"><a href="#PointPair.set_endpoints-787"><span class="linenos">787</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.set_endpoints-788"><a href="#PointPair.set_endpoints-788"><span class="linenos">788</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PointPair.set_endpoints-789"><a href="#PointPair.set_endpoints-789"><span class="linenos">789</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair.set_endpoints-790"><a href="#PointPair.set_endpoints-790"><span class="linenos">790</span></a>            <span class="k">return</span>
</span><span id="PointPair.set_endpoints-791"><a href="#PointPair.set_endpoints-791"><span class="linenos">791</span></a>
</span><span id="PointPair.set_endpoints-792"><a href="#PointPair.set_endpoints-792"><span class="linenos">792</span></a>        <span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span>
</span><span id="PointPair.set_endpoints-793"><a href="#PointPair.set_endpoints-793"><span class="linenos">793</span></a>        <span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint2</span><span class="p">)</span>
</span><span id="PointPair.set_endpoints-794"><a href="#PointPair.set_endpoints-794"><span class="linenos">794</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">pt1</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">pt2</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set the endpoints of a segment.</p>

<p>If <code>endpoint2</code> is <code>None</code>, expect <code>endpoint1</code> to be an array of
points with shape <code>(..., 2, n)</code>. Otherwise, expect <code>endpoint1</code>
and <code>endpoint2</code> to be arrays of points with the same shape.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>endpoint1</strong> (Point or ndarray):
One (or both) endpoints of the point pair</li>
<li><strong>endpoint2</strong> (Point or ndarray):
The other endpoint of the point pair. If <code>None</code>,
<code>endpoint1</code> contains the data for both points in the pair.</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.get_endpoints" class="classattr">
                                        <input id="PointPair.get_endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_endpoints</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.get_endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.get_endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.get_endpoints-796"><a href="#PointPair.get_endpoints-796"><span class="linenos">796</span></a>    <span class="k">def</span> <span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair.get_endpoints-797"><a href="#PointPair.get_endpoints-797"><span class="linenos">797</span></a>        <span class="sd">&quot;&quot;&quot;Get a Point representing the endpoints of this pair</span>
</span><span id="PointPair.get_endpoints-798"><a href="#PointPair.get_endpoints-798"><span class="linenos">798</span></a>
</span><span id="PointPair.get_endpoints-799"><a href="#PointPair.get_endpoints-799"><span class="linenos">799</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.get_endpoints-800"><a href="#PointPair.get_endpoints-800"><span class="linenos">800</span></a><span class="sd">        -------</span>
</span><span id="PointPair.get_endpoints-801"><a href="#PointPair.get_endpoints-801"><span class="linenos">801</span></a><span class="sd">        Point</span>
</span><span id="PointPair.get_endpoints-802"><a href="#PointPair.get_endpoints-802"><span class="linenos">802</span></a><span class="sd">            A composite Point object representing the endpoints of</span>
</span><span id="PointPair.get_endpoints-803"><a href="#PointPair.get_endpoints-803"><span class="linenos">803</span></a><span class="sd">            this (possibly composite) PointPair</span>
</span><span id="PointPair.get_endpoints-804"><a href="#PointPair.get_endpoints-804"><span class="linenos">804</span></a>
</span><span id="PointPair.get_endpoints-805"><a href="#PointPair.get_endpoints-805"><span class="linenos">805</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.get_endpoints-806"><a href="#PointPair.get_endpoints-806"><span class="linenos">806</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a Point representing the endpoints of this pair</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: A composite Point object representing the endpoints of
this (possibly composite) PointPair</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.get_end_pair" class="classattr">
                                        <input id="PointPair.get_end_pair-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_end_pair</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.get_end_pair-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.get_end_pair"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.get_end_pair-808"><a href="#PointPair.get_end_pair-808"><span class="linenos">808</span></a>    <span class="k">def</span> <span class="nf">get_end_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair.get_end_pair-809"><a href="#PointPair.get_end_pair-809"><span class="linenos">809</span></a>        <span class="sd">&quot;&quot;&quot;Return a pair of point objects, one for each endpoint</span>
</span><span id="PointPair.get_end_pair-810"><a href="#PointPair.get_end_pair-810"><span class="linenos">810</span></a>
</span><span id="PointPair.get_end_pair-811"><a href="#PointPair.get_end_pair-811"><span class="linenos">811</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.get_end_pair-812"><a href="#PointPair.get_end_pair-812"><span class="linenos">812</span></a><span class="sd">        -------</span>
</span><span id="PointPair.get_end_pair-813"><a href="#PointPair.get_end_pair-813"><span class="linenos">813</span></a><span class="sd">        tuple</span>
</span><span id="PointPair.get_end_pair-814"><a href="#PointPair.get_end_pair-814"><span class="linenos">814</span></a><span class="sd">            Tuple of the form `(endpoint1, endpoint2)`, where</span>
</span><span id="PointPair.get_end_pair-815"><a href="#PointPair.get_end_pair-815"><span class="linenos">815</span></a><span class="sd">            `endpoint1` and `endpoint2` are (possibly composite)</span>
</span><span id="PointPair.get_end_pair-816"><a href="#PointPair.get_end_pair-816"><span class="linenos">816</span></a><span class="sd">            `Point` objects representing the endpoints of this pair</span>
</span><span id="PointPair.get_end_pair-817"><a href="#PointPair.get_end_pair-817"><span class="linenos">817</span></a>
</span><span id="PointPair.get_end_pair-818"><a href="#PointPair.get_end_pair-818"><span class="linenos">818</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.get_end_pair-819"><a href="#PointPair.get_end_pair-819"><span class="linenos">819</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]),</span>
</span><span id="PointPair.get_end_pair-820"><a href="#PointPair.get_end_pair-820"><span class="linenos">820</span></a>                <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]))</span>
</span></pre></div>


            <div class="docstring"><p>Return a pair of point objects, one for each endpoint</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: Tuple of the form <code>(endpoint1, endpoint2)</code>, where
<code>endpoint1</code> and <code>endpoint2</code> are (possibly composite)
<code><a href="#Point">Point</a></code> objects representing the endpoints of this pair</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.endpoint_affine_coords" class="classattr">
                                        <input id="PointPair.endpoint_affine_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">endpoint_affine_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.endpoint_affine_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.endpoint_affine_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.endpoint_affine_coords-822"><a href="#PointPair.endpoint_affine_coords-822"><span class="linenos">822</span></a>    <span class="k">def</span> <span class="nf">endpoint_affine_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="PointPair.endpoint_affine_coords-823"><a href="#PointPair.endpoint_affine_coords-823"><span class="linenos">823</span></a>        <span class="sd">&quot;&quot;&quot;Get endpoints of this segment in affine coordinates</span>
</span><span id="PointPair.endpoint_affine_coords-824"><a href="#PointPair.endpoint_affine_coords-824"><span class="linenos">824</span></a>
</span><span id="PointPair.endpoint_affine_coords-825"><a href="#PointPair.endpoint_affine_coords-825"><span class="linenos">825</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair.endpoint_affine_coords-826"><a href="#PointPair.endpoint_affine_coords-826"><span class="linenos">826</span></a><span class="sd">        ----------</span>
</span><span id="PointPair.endpoint_affine_coords-827"><a href="#PointPair.endpoint_affine_coords-827"><span class="linenos">827</span></a><span class="sd">        chart_index : int</span>
</span><span id="PointPair.endpoint_affine_coords-828"><a href="#PointPair.endpoint_affine_coords-828"><span class="linenos">828</span></a><span class="sd">            Index of the standard affine chart to take coordinates in</span>
</span><span id="PointPair.endpoint_affine_coords-829"><a href="#PointPair.endpoint_affine_coords-829"><span class="linenos">829</span></a>
</span><span id="PointPair.endpoint_affine_coords-830"><a href="#PointPair.endpoint_affine_coords-830"><span class="linenos">830</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.endpoint_affine_coords-831"><a href="#PointPair.endpoint_affine_coords-831"><span class="linenos">831</span></a><span class="sd">        -------</span>
</span><span id="PointPair.endpoint_affine_coords-832"><a href="#PointPair.endpoint_affine_coords-832"><span class="linenos">832</span></a><span class="sd">        ndarray</span>
</span><span id="PointPair.endpoint_affine_coords-833"><a href="#PointPair.endpoint_affine_coords-833"><span class="linenos">833</span></a><span class="sd">            Affine coordinates of the endpoints of this pair of</span>
</span><span id="PointPair.endpoint_affine_coords-834"><a href="#PointPair.endpoint_affine_coords-834"><span class="linenos">834</span></a><span class="sd">            points.</span>
</span><span id="PointPair.endpoint_affine_coords-835"><a href="#PointPair.endpoint_affine_coords-835"><span class="linenos">835</span></a>
</span><span id="PointPair.endpoint_affine_coords-836"><a href="#PointPair.endpoint_affine_coords-836"><span class="linenos">836</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.endpoint_affine_coords-837"><a href="#PointPair.endpoint_affine_coords-837"><span class="linenos">837</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">chart_index</span><span class="o">=</span><span class="n">chart_index</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get endpoints of this segment in affine coordinates</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>chart_index</strong> (int):
Index of the standard affine chart to take coordinates in</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Affine coordinates of the endpoints of this pair of
points.</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.endpoint_projective_coords" class="classattr">
                                        <input id="PointPair.endpoint_projective_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">endpoint_projective_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.endpoint_projective_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.endpoint_projective_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.endpoint_projective_coords-839"><a href="#PointPair.endpoint_projective_coords-839"><span class="linenos">839</span></a>    <span class="k">def</span> <span class="nf">endpoint_projective_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair.endpoint_projective_coords-840"><a href="#PointPair.endpoint_projective_coords-840"><span class="linenos">840</span></a>        <span class="sd">&quot;&quot;&quot;Get endpoints of this segment in projective coordinates.</span>
</span><span id="PointPair.endpoint_projective_coords-841"><a href="#PointPair.endpoint_projective_coords-841"><span class="linenos">841</span></a>
</span><span id="PointPair.endpoint_projective_coords-842"><a href="#PointPair.endpoint_projective_coords-842"><span class="linenos">842</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.endpoint_projective_coords-843"><a href="#PointPair.endpoint_projective_coords-843"><span class="linenos">843</span></a><span class="sd">        -------</span>
</span><span id="PointPair.endpoint_projective_coords-844"><a href="#PointPair.endpoint_projective_coords-844"><span class="linenos">844</span></a><span class="sd">        ndarray</span>
</span><span id="PointPair.endpoint_projective_coords-845"><a href="#PointPair.endpoint_projective_coords-845"><span class="linenos">845</span></a><span class="sd">            Projective coordinates of the endpoints of this pair of</span>
</span><span id="PointPair.endpoint_projective_coords-846"><a href="#PointPair.endpoint_projective_coords-846"><span class="linenos">846</span></a><span class="sd">            points.</span>
</span><span id="PointPair.endpoint_projective_coords-847"><a href="#PointPair.endpoint_projective_coords-847"><span class="linenos">847</span></a>
</span><span id="PointPair.endpoint_projective_coords-848"><a href="#PointPair.endpoint_projective_coords-848"><span class="linenos">848</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.endpoint_projective_coords-849"><a href="#PointPair.endpoint_projective_coords-849"><span class="linenos">849</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get endpoints of this segment in projective coordinates.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Projective coordinates of the endpoints of this pair of
points.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="PointPair.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="PointPair.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="PointPair.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="PointPair.in_affine_chart" class="function"><a href="#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="PointPair.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="PointPair.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="PointPair.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="PointPair.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="PointPair.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="PointPair.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="PointPair.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="PointPair.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="PointPair.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="PointPair.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="PointPair.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="PointPair.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Polygon">
                            <input id="Polygon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Polygon</span><wbr>(<span class="base"><a href="#Point">Point</a></span>):

                <label class="view-source-button" for="Polygon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon-851"><a href="#Polygon-851"><span class="linenos">851</span></a><span class="k">class</span> <span class="nc">Polygon</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="Polygon-852"><a href="#Polygon-852"><span class="linenos">852</span></a>    <span class="sd">&quot;&quot;&quot;A finite-sided polygon in projective space.</span>
</span><span id="Polygon-853"><a href="#Polygon-853"><span class="linenos">853</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Polygon-854"><a href="#Polygon-854"><span class="linenos">854</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon-855"><a href="#Polygon-855"><span class="linenos">855</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Polygon-856"><a href="#Polygon-856"><span class="linenos">856</span></a><span class="sd">        Parameters</span>
</span><span id="Polygon-857"><a href="#Polygon-857"><span class="linenos">857</span></a><span class="sd">        ----------</span>
</span><span id="Polygon-858"><a href="#Polygon-858"><span class="linenos">858</span></a><span class="sd">        vertices : Point or ndarray or iterable</span>
</span><span id="Polygon-859"><a href="#Polygon-859"><span class="linenos">859</span></a><span class="sd">            vertices of the polygon, as either an ndarray or a</span>
</span><span id="Polygon-860"><a href="#Polygon-860"><span class="linenos">860</span></a><span class="sd">            composite Point object (provided in the proper order for</span>
</span><span id="Polygon-861"><a href="#Polygon-861"><span class="linenos">861</span></a><span class="sd">            this polygon).</span>
</span><span id="Polygon-862"><a href="#Polygon-862"><span class="linenos">862</span></a>
</span><span id="Polygon-863"><a href="#Polygon-863"><span class="linenos">863</span></a><span class="sd">        aux_data : PointPair or ndarray</span>
</span><span id="Polygon-864"><a href="#Polygon-864"><span class="linenos">864</span></a><span class="sd">            Data to use to construct the edges of the polygon. If</span>
</span><span id="Polygon-865"><a href="#Polygon-865"><span class="linenos">865</span></a><span class="sd">            `None`, use the vertex data to compute the edge data.</span>
</span><span id="Polygon-866"><a href="#Polygon-866"><span class="linenos">866</span></a>
</span><span id="Polygon-867"><a href="#Polygon-867"><span class="linenos">867</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon-868"><a href="#Polygon-868"><span class="linenos">868</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span>
</span><span id="Polygon-869"><a href="#Polygon-869"><span class="linenos">869</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="Polygon-870"><a href="#Polygon-870"><span class="linenos">870</span></a>                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon-871"><a href="#Polygon-871"><span class="linenos">871</span></a>
</span><span id="Polygon-872"><a href="#Polygon-872"><span class="linenos">872</span></a>    <span class="k">def</span> <span class="nf">in_standard_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-873"><a href="#Polygon-873"><span class="linenos">873</span></a>        <span class="n">coord_signs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">()[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Polygon-874"><a href="#Polygon-874"><span class="linenos">874</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">coord_signs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">coord_signs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Polygon-875"><a href="#Polygon-875"><span class="linenos">875</span></a>
</span><span id="Polygon-876"><a href="#Polygon-876"><span class="linenos">876</span></a>    <span class="nd">@property</span>
</span><span id="Polygon-877"><a href="#Polygon-877"><span class="linenos">877</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-878"><a href="#Polygon-878"><span class="linenos">878</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Polygon-879"><a href="#Polygon-879"><span class="linenos">879</span></a>
</span><span id="Polygon-880"><a href="#Polygon-880"><span class="linenos">880</span></a>    <span class="nd">@property</span>
</span><span id="Polygon-881"><a href="#Polygon-881"><span class="linenos">881</span></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-882"><a href="#Polygon-882"><span class="linenos">882</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="Polygon-883"><a href="#Polygon-883"><span class="linenos">883</span></a>
</span><span id="Polygon-884"><a href="#Polygon-884"><span class="linenos">884</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="Polygon-885"><a href="#Polygon-885"><span class="linenos">885</span></a>        <span class="n">segments</span> <span class="o">=</span> <span class="n">PointPair</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Polygon-886"><a href="#Polygon-886"><span class="linenos">886</span></a>        <span class="k">return</span> <span class="n">segments</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Polygon-887"><a href="#Polygon-887"><span class="linenos">887</span></a>
</span><span id="Polygon-888"><a href="#Polygon-888"><span class="linenos">888</span></a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-889"><a href="#Polygon-889"><span class="linenos">889</span></a>        <span class="sd">&quot;&quot;&quot;Get the edges of this polygon</span>
</span><span id="Polygon-890"><a href="#Polygon-890"><span class="linenos">890</span></a>
</span><span id="Polygon-891"><a href="#Polygon-891"><span class="linenos">891</span></a><span class="sd">        Returns</span>
</span><span id="Polygon-892"><a href="#Polygon-892"><span class="linenos">892</span></a><span class="sd">        -------</span>
</span><span id="Polygon-893"><a href="#Polygon-893"><span class="linenos">893</span></a><span class="sd">        PointPair</span>
</span><span id="Polygon-894"><a href="#Polygon-894"><span class="linenos">894</span></a><span class="sd">            Edges of this polygon, as a composite PointPair object.</span>
</span><span id="Polygon-895"><a href="#Polygon-895"><span class="linenos">895</span></a>
</span><span id="Polygon-896"><a href="#Polygon-896"><span class="linenos">896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon-897"><a href="#Polygon-897"><span class="linenos">897</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span><span id="Polygon-898"><a href="#Polygon-898"><span class="linenos">898</span></a>
</span><span id="Polygon-899"><a href="#Polygon-899"><span class="linenos">899</span></a>    <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-900"><a href="#Polygon-900"><span class="linenos">900</span></a>        <span class="sd">&quot;&quot;&quot;Get the vertices of the polygon.</span>
</span><span id="Polygon-901"><a href="#Polygon-901"><span class="linenos">901</span></a>
</span><span id="Polygon-902"><a href="#Polygon-902"><span class="linenos">902</span></a><span class="sd">        Returns</span>
</span><span id="Polygon-903"><a href="#Polygon-903"><span class="linenos">903</span></a><span class="sd">        -------</span>
</span><span id="Polygon-904"><a href="#Polygon-904"><span class="linenos">904</span></a><span class="sd">        Point</span>
</span><span id="Polygon-905"><a href="#Polygon-905"><span class="linenos">905</span></a><span class="sd">            Vertices of this polygon, as a composite Point object.</span>
</span><span id="Polygon-906"><a href="#Polygon-906"><span class="linenos">906</span></a>
</span><span id="Polygon-907"><a href="#Polygon-907"><span class="linenos">907</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon-908"><a href="#Polygon-908"><span class="linenos">908</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A finite-sided polygon in projective space.</p>
</div>


                            <div id="Polygon.__init__" class="classattr">
                                        <input id="Polygon.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Polygon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vertices</span>, </span><span class="param"><span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Polygon.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.__init__-854"><a href="#Polygon.__init__-854"><span class="linenos">854</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon.__init__-855"><a href="#Polygon.__init__-855"><span class="linenos">855</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Polygon.__init__-856"><a href="#Polygon.__init__-856"><span class="linenos">856</span></a><span class="sd">        Parameters</span>
</span><span id="Polygon.__init__-857"><a href="#Polygon.__init__-857"><span class="linenos">857</span></a><span class="sd">        ----------</span>
</span><span id="Polygon.__init__-858"><a href="#Polygon.__init__-858"><span class="linenos">858</span></a><span class="sd">        vertices : Point or ndarray or iterable</span>
</span><span id="Polygon.__init__-859"><a href="#Polygon.__init__-859"><span class="linenos">859</span></a><span class="sd">            vertices of the polygon, as either an ndarray or a</span>
</span><span id="Polygon.__init__-860"><a href="#Polygon.__init__-860"><span class="linenos">860</span></a><span class="sd">            composite Point object (provided in the proper order for</span>
</span><span id="Polygon.__init__-861"><a href="#Polygon.__init__-861"><span class="linenos">861</span></a><span class="sd">            this polygon).</span>
</span><span id="Polygon.__init__-862"><a href="#Polygon.__init__-862"><span class="linenos">862</span></a>
</span><span id="Polygon.__init__-863"><a href="#Polygon.__init__-863"><span class="linenos">863</span></a><span class="sd">        aux_data : PointPair or ndarray</span>
</span><span id="Polygon.__init__-864"><a href="#Polygon.__init__-864"><span class="linenos">864</span></a><span class="sd">            Data to use to construct the edges of the polygon. If</span>
</span><span id="Polygon.__init__-865"><a href="#Polygon.__init__-865"><span class="linenos">865</span></a><span class="sd">            `None`, use the vertex data to compute the edge data.</span>
</span><span id="Polygon.__init__-866"><a href="#Polygon.__init__-866"><span class="linenos">866</span></a>
</span><span id="Polygon.__init__-867"><a href="#Polygon.__init__-867"><span class="linenos">867</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon.__init__-868"><a href="#Polygon.__init__-868"><span class="linenos">868</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span>
</span><span id="Polygon.__init__-869"><a href="#Polygon.__init__-869"><span class="linenos">869</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="Polygon.__init__-870"><a href="#Polygon.__init__-870"><span class="linenos">870</span></a>                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>vertices</strong> (Point or ndarray or iterable):
vertices of the polygon, as either an ndarray or a
composite Point object (provided in the proper order for
this polygon).</li>
<li><strong>aux_data</strong> (PointPair or ndarray):
Data to use to construct the edges of the polygon. If
<code>None</code>, use the vertex data to compute the edge data.</li>
</ul>
</div>


                            </div>
                            <div id="Polygon.in_standard_chart" class="classattr">
                                        <input id="Polygon.in_standard_chart-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">in_standard_chart</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.in_standard_chart-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.in_standard_chart"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.in_standard_chart-872"><a href="#Polygon.in_standard_chart-872"><span class="linenos">872</span></a>    <span class="k">def</span> <span class="nf">in_standard_chart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.in_standard_chart-873"><a href="#Polygon.in_standard_chart-873"><span class="linenos">873</span></a>        <span class="n">coord_signs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">()[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</span><span id="Polygon.in_standard_chart-874"><a href="#Polygon.in_standard_chart-874"><span class="linenos">874</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">coord_signs</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">coord_signs</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Polygon.vertices" class="classattr">
                                        <input id="Polygon.vertices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">vertices</span>

                <label class="view-source-button" for="Polygon.vertices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.vertices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.vertices-876"><a href="#Polygon.vertices-876"><span class="linenos">876</span></a>    <span class="nd">@property</span>
</span><span id="Polygon.vertices-877"><a href="#Polygon.vertices-877"><span class="linenos">877</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.vertices-878"><a href="#Polygon.vertices-878"><span class="linenos">878</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span></pre></div>


    

                            </div>
                            <div id="Polygon.edges" class="classattr">
                                        <input id="Polygon.edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">edges</span>

                <label class="view-source-button" for="Polygon.edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.edges-880"><a href="#Polygon.edges-880"><span class="linenos">880</span></a>    <span class="nd">@property</span>
</span><span id="Polygon.edges-881"><a href="#Polygon.edges-881"><span class="linenos">881</span></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.edges-882"><a href="#Polygon.edges-882"><span class="linenos">882</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span>
</span></pre></div>


    

                            </div>
                            <div id="Polygon.get_edges" class="classattr">
                                        <input id="Polygon.get_edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.get_edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.get_edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.get_edges-888"><a href="#Polygon.get_edges-888"><span class="linenos">888</span></a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.get_edges-889"><a href="#Polygon.get_edges-889"><span class="linenos">889</span></a>        <span class="sd">&quot;&quot;&quot;Get the edges of this polygon</span>
</span><span id="Polygon.get_edges-890"><a href="#Polygon.get_edges-890"><span class="linenos">890</span></a>
</span><span id="Polygon.get_edges-891"><a href="#Polygon.get_edges-891"><span class="linenos">891</span></a><span class="sd">        Returns</span>
</span><span id="Polygon.get_edges-892"><a href="#Polygon.get_edges-892"><span class="linenos">892</span></a><span class="sd">        -------</span>
</span><span id="Polygon.get_edges-893"><a href="#Polygon.get_edges-893"><span class="linenos">893</span></a><span class="sd">        PointPair</span>
</span><span id="Polygon.get_edges-894"><a href="#Polygon.get_edges-894"><span class="linenos">894</span></a><span class="sd">            Edges of this polygon, as a composite PointPair object.</span>
</span><span id="Polygon.get_edges-895"><a href="#Polygon.get_edges-895"><span class="linenos">895</span></a>
</span><span id="Polygon.get_edges-896"><a href="#Polygon.get_edges-896"><span class="linenos">896</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon.get_edges-897"><a href="#Polygon.get_edges-897"><span class="linenos">897</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the edges of this polygon</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>PointPair</strong>: Edges of this polygon, as a composite PointPair object.</li>
</ul>
</div>


                            </div>
                            <div id="Polygon.get_vertices" class="classattr">
                                        <input id="Polygon.get_vertices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_vertices</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.get_vertices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.get_vertices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.get_vertices-899"><a href="#Polygon.get_vertices-899"><span class="linenos">899</span></a>    <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.get_vertices-900"><a href="#Polygon.get_vertices-900"><span class="linenos">900</span></a>        <span class="sd">&quot;&quot;&quot;Get the vertices of the polygon.</span>
</span><span id="Polygon.get_vertices-901"><a href="#Polygon.get_vertices-901"><span class="linenos">901</span></a>
</span><span id="Polygon.get_vertices-902"><a href="#Polygon.get_vertices-902"><span class="linenos">902</span></a><span class="sd">        Returns</span>
</span><span id="Polygon.get_vertices-903"><a href="#Polygon.get_vertices-903"><span class="linenos">903</span></a><span class="sd">        -------</span>
</span><span id="Polygon.get_vertices-904"><a href="#Polygon.get_vertices-904"><span class="linenos">904</span></a><span class="sd">        Point</span>
</span><span id="Polygon.get_vertices-905"><a href="#Polygon.get_vertices-905"><span class="linenos">905</span></a><span class="sd">            Vertices of this polygon, as a composite Point object.</span>
</span><span id="Polygon.get_vertices-906"><a href="#Polygon.get_vertices-906"><span class="linenos">906</span></a>
</span><span id="Polygon.get_vertices-907"><a href="#Polygon.get_vertices-907"><span class="linenos">907</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon.get_vertices-908"><a href="#Polygon.get_vertices-908"><span class="linenos">908</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the vertices of the polygon.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Vertices of this polygon, as a composite Point object.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Polygon.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="Polygon.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="Polygon.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="Polygon.in_affine_chart" class="function"><a href="#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="Polygon.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Polygon.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="Polygon.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Polygon.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="Polygon.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Polygon.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Polygon.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="Polygon.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Polygon.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Polygon.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Polygon.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="Polygon.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Simplex">
                            <input id="Simplex-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Simplex</span><wbr>(<span class="base"><a href="#Point">Point</a></span>):

                <label class="view-source-button" for="Simplex-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex-910"><a href="#Simplex-910"><span class="linenos">910</span></a><span class="k">class</span> <span class="nc">Simplex</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="Simplex-911"><a href="#Simplex-911"><span class="linenos">911</span></a>    <span class="sd">&quot;&quot;&quot;An n-simplex in projective space.</span>
</span><span id="Simplex-912"><a href="#Simplex-912"><span class="linenos">912</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Simplex-913"><a href="#Simplex-913"><span class="linenos">913</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Simplex-914"><a href="#Simplex-914"><span class="linenos">914</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simplex-915"><a href="#Simplex-915"><span class="linenos">915</span></a><span class="sd">        Parameters</span>
</span><span id="Simplex-916"><a href="#Simplex-916"><span class="linenos">916</span></a><span class="sd">        ----------</span>
</span><span id="Simplex-917"><a href="#Simplex-917"><span class="linenos">917</span></a><span class="sd">        vertices : ProjectiveObject or ndarray</span>
</span><span id="Simplex-918"><a href="#Simplex-918"><span class="linenos">918</span></a><span class="sd">            Data giving the vertices of the simplex (or a composite of</span>
</span><span id="Simplex-919"><a href="#Simplex-919"><span class="linenos">919</span></a><span class="sd">            several simplices)</span>
</span><span id="Simplex-920"><a href="#Simplex-920"><span class="linenos">920</span></a>
</span><span id="Simplex-921"><a href="#Simplex-921"><span class="linenos">921</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex-922"><a href="#Simplex-922"><span class="linenos">922</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Simplex-923"><a href="#Simplex-923"><span class="linenos">923</span></a>
</span><span id="Simplex-924"><a href="#Simplex-924"><span class="linenos">924</span></a>    <span class="nd">@property</span>
</span><span id="Simplex-925"><a href="#Simplex-925"><span class="linenos">925</span></a>    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex-926"><a href="#Simplex-926"><span class="linenos">926</span></a>        <span class="sd">&quot;&quot;&quot;Number of vertices in the simplex.</span>
</span><span id="Simplex-927"><a href="#Simplex-927"><span class="linenos">927</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex-928"><a href="#Simplex-928"><span class="linenos">928</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Simplex-929"><a href="#Simplex-929"><span class="linenos">929</span></a>
</span><span id="Simplex-930"><a href="#Simplex-930"><span class="linenos">930</span></a>    <span class="k">def</span> <span class="nf">skeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="Simplex-931"><a href="#Simplex-931"><span class="linenos">931</span></a>        <span class="sd">&quot;&quot;&quot;Get the k-skeleton of this simplex, as a composite Simplex.</span>
</span><span id="Simplex-932"><a href="#Simplex-932"><span class="linenos">932</span></a>
</span><span id="Simplex-933"><a href="#Simplex-933"><span class="linenos">933</span></a><span class="sd">        Parameters</span>
</span><span id="Simplex-934"><a href="#Simplex-934"><span class="linenos">934</span></a><span class="sd">        ----------</span>
</span><span id="Simplex-935"><a href="#Simplex-935"><span class="linenos">935</span></a><span class="sd">        k : int</span>
</span><span id="Simplex-936"><a href="#Simplex-936"><span class="linenos">936</span></a><span class="sd">            Dimension of the skeleton to get</span>
</span><span id="Simplex-937"><a href="#Simplex-937"><span class="linenos">937</span></a>
</span><span id="Simplex-938"><a href="#Simplex-938"><span class="linenos">938</span></a><span class="sd">        Returns</span>
</span><span id="Simplex-939"><a href="#Simplex-939"><span class="linenos">939</span></a><span class="sd">        -------</span>
</span><span id="Simplex-940"><a href="#Simplex-940"><span class="linenos">940</span></a><span class="sd">        Simplex</span>
</span><span id="Simplex-941"><a href="#Simplex-941"><span class="linenos">941</span></a><span class="sd">            Composite Simplex object, with one subobject for each</span>
</span><span id="Simplex-942"><a href="#Simplex-942"><span class="linenos">942</span></a><span class="sd">            k-dimensional face of this simplex.</span>
</span><span id="Simplex-943"><a href="#Simplex-943"><span class="linenos">943</span></a>
</span><span id="Simplex-944"><a href="#Simplex-944"><span class="linenos">944</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex-945"><a href="#Simplex-945"><span class="linenos">945</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">k</span><span class="p">))</span>
</span><span id="Simplex-946"><a href="#Simplex-946"><span class="linenos">946</span></a>        <span class="k">return</span> <span class="n">Simplex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Simplex-947"><a href="#Simplex-947"><span class="linenos">947</span></a>
</span><span id="Simplex-948"><a href="#Simplex-948"><span class="linenos">948</span></a>    <span class="k">def</span> <span class="nf">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex-949"><a href="#Simplex-949"><span class="linenos">949</span></a>        <span class="sd">&quot;&quot;&quot;Get the codimension-1 faces of the simplex.</span>
</span><span id="Simplex-950"><a href="#Simplex-950"><span class="linenos">950</span></a>
</span><span id="Simplex-951"><a href="#Simplex-951"><span class="linenos">951</span></a><span class="sd">        Alias for self.skeleton(n - 1), where n is the number of</span>
</span><span id="Simplex-952"><a href="#Simplex-952"><span class="linenos">952</span></a><span class="sd">        vertices in this simplex.</span>
</span><span id="Simplex-953"><a href="#Simplex-953"><span class="linenos">953</span></a>
</span><span id="Simplex-954"><a href="#Simplex-954"><span class="linenos">954</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex-955"><a href="#Simplex-955"><span class="linenos">955</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Simplex-956"><a href="#Simplex-956"><span class="linenos">956</span></a>
</span><span id="Simplex-957"><a href="#Simplex-957"><span class="linenos">957</span></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex-958"><a href="#Simplex-958"><span class="linenos">958</span></a>        <span class="sd">&quot;&quot;&quot;Get the edges of the simplex.</span>
</span><span id="Simplex-959"><a href="#Simplex-959"><span class="linenos">959</span></a>
</span><span id="Simplex-960"><a href="#Simplex-960"><span class="linenos">960</span></a><span class="sd">        Alias for PointPair(self.skeleton(2)).&quot;&quot;&quot;</span>
</span><span id="Simplex-961"><a href="#Simplex-961"><span class="linenos">961</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Simplex-962"><a href="#Simplex-962"><span class="linenos">962</span></a>
</span><span id="Simplex-963"><a href="#Simplex-963"><span class="linenos">963</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex-964"><a href="#Simplex-964"><span class="linenos">964</span></a>        <span class="sd">&quot;&quot;&quot;Get the vertices of this simplex as a Point object.</span>
</span><span id="Simplex-965"><a href="#Simplex-965"><span class="linenos">965</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex-966"><a href="#Simplex-966"><span class="linenos">966</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>An n-simplex in projective space.</p>
</div>


                            <div id="Simplex.__init__" class="classattr">
                                        <input id="Simplex.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Simplex</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vertices</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Simplex.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex.__init__-913"><a href="#Simplex.__init__-913"><span class="linenos">913</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Simplex.__init__-914"><a href="#Simplex.__init__-914"><span class="linenos">914</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simplex.__init__-915"><a href="#Simplex.__init__-915"><span class="linenos">915</span></a><span class="sd">        Parameters</span>
</span><span id="Simplex.__init__-916"><a href="#Simplex.__init__-916"><span class="linenos">916</span></a><span class="sd">        ----------</span>
</span><span id="Simplex.__init__-917"><a href="#Simplex.__init__-917"><span class="linenos">917</span></a><span class="sd">        vertices : ProjectiveObject or ndarray</span>
</span><span id="Simplex.__init__-918"><a href="#Simplex.__init__-918"><span class="linenos">918</span></a><span class="sd">            Data giving the vertices of the simplex (or a composite of</span>
</span><span id="Simplex.__init__-919"><a href="#Simplex.__init__-919"><span class="linenos">919</span></a><span class="sd">            several simplices)</span>
</span><span id="Simplex.__init__-920"><a href="#Simplex.__init__-920"><span class="linenos">920</span></a>
</span><span id="Simplex.__init__-921"><a href="#Simplex.__init__-921"><span class="linenos">921</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex.__init__-922"><a href="#Simplex.__init__-922"><span class="linenos">922</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>vertices</strong> (ProjectiveObject or ndarray):
Data giving the vertices of the simplex (or a composite of
several simplices)</li>
</ul>
</div>


                            </div>
                            <div id="Simplex.n" class="classattr">
                                        <input id="Simplex.n-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n</span>

                <label class="view-source-button" for="Simplex.n-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex.n"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex.n-924"><a href="#Simplex.n-924"><span class="linenos">924</span></a>    <span class="nd">@property</span>
</span><span id="Simplex.n-925"><a href="#Simplex.n-925"><span class="linenos">925</span></a>    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex.n-926"><a href="#Simplex.n-926"><span class="linenos">926</span></a>        <span class="sd">&quot;&quot;&quot;Number of vertices in the simplex.</span>
</span><span id="Simplex.n-927"><a href="#Simplex.n-927"><span class="linenos">927</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex.n-928"><a href="#Simplex.n-928"><span class="linenos">928</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Number of vertices in the simplex.</p>
</div>


                            </div>
                            <div id="Simplex.skeleton" class="classattr">
                                        <input id="Simplex.skeleton-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">skeleton</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">k</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simplex.skeleton-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex.skeleton"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex.skeleton-930"><a href="#Simplex.skeleton-930"><span class="linenos">930</span></a>    <span class="k">def</span> <span class="nf">skeleton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
</span><span id="Simplex.skeleton-931"><a href="#Simplex.skeleton-931"><span class="linenos">931</span></a>        <span class="sd">&quot;&quot;&quot;Get the k-skeleton of this simplex, as a composite Simplex.</span>
</span><span id="Simplex.skeleton-932"><a href="#Simplex.skeleton-932"><span class="linenos">932</span></a>
</span><span id="Simplex.skeleton-933"><a href="#Simplex.skeleton-933"><span class="linenos">933</span></a><span class="sd">        Parameters</span>
</span><span id="Simplex.skeleton-934"><a href="#Simplex.skeleton-934"><span class="linenos">934</span></a><span class="sd">        ----------</span>
</span><span id="Simplex.skeleton-935"><a href="#Simplex.skeleton-935"><span class="linenos">935</span></a><span class="sd">        k : int</span>
</span><span id="Simplex.skeleton-936"><a href="#Simplex.skeleton-936"><span class="linenos">936</span></a><span class="sd">            Dimension of the skeleton to get</span>
</span><span id="Simplex.skeleton-937"><a href="#Simplex.skeleton-937"><span class="linenos">937</span></a>
</span><span id="Simplex.skeleton-938"><a href="#Simplex.skeleton-938"><span class="linenos">938</span></a><span class="sd">        Returns</span>
</span><span id="Simplex.skeleton-939"><a href="#Simplex.skeleton-939"><span class="linenos">939</span></a><span class="sd">        -------</span>
</span><span id="Simplex.skeleton-940"><a href="#Simplex.skeleton-940"><span class="linenos">940</span></a><span class="sd">        Simplex</span>
</span><span id="Simplex.skeleton-941"><a href="#Simplex.skeleton-941"><span class="linenos">941</span></a><span class="sd">            Composite Simplex object, with one subobject for each</span>
</span><span id="Simplex.skeleton-942"><a href="#Simplex.skeleton-942"><span class="linenos">942</span></a><span class="sd">            k-dimensional face of this simplex.</span>
</span><span id="Simplex.skeleton-943"><a href="#Simplex.skeleton-943"><span class="linenos">943</span></a>
</span><span id="Simplex.skeleton-944"><a href="#Simplex.skeleton-944"><span class="linenos">944</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex.skeleton-945"><a href="#Simplex.skeleton-945"><span class="linenos">945</span></a>        <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">),</span> <span class="n">k</span><span class="p">))</span>
</span><span id="Simplex.skeleton-946"><a href="#Simplex.skeleton-946"><span class="linenos">946</span></a>        <span class="k">return</span> <span class="n">Simplex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Get the k-skeleton of this simplex, as a composite Simplex.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>k</strong> (int):
Dimension of the skeleton to get</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Simplex</strong>: Composite Simplex object, with one subobject for each
k-dimensional face of this simplex.</li>
</ul>
</div>


                            </div>
                            <div id="Simplex.faces" class="classattr">
                                        <input id="Simplex.faces-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">faces</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simplex.faces-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex.faces"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex.faces-948"><a href="#Simplex.faces-948"><span class="linenos">948</span></a>    <span class="k">def</span> <span class="nf">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex.faces-949"><a href="#Simplex.faces-949"><span class="linenos">949</span></a>        <span class="sd">&quot;&quot;&quot;Get the codimension-1 faces of the simplex.</span>
</span><span id="Simplex.faces-950"><a href="#Simplex.faces-950"><span class="linenos">950</span></a>
</span><span id="Simplex.faces-951"><a href="#Simplex.faces-951"><span class="linenos">951</span></a><span class="sd">        Alias for self.skeleton(n - 1), where n is the number of</span>
</span><span id="Simplex.faces-952"><a href="#Simplex.faces-952"><span class="linenos">952</span></a><span class="sd">        vertices in this simplex.</span>
</span><span id="Simplex.faces-953"><a href="#Simplex.faces-953"><span class="linenos">953</span></a>
</span><span id="Simplex.faces-954"><a href="#Simplex.faces-954"><span class="linenos">954</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex.faces-955"><a href="#Simplex.faces-955"><span class="linenos">955</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the codimension-1 faces of the simplex.</p>

<p>Alias for self.skeleton(n - 1), where n is the number of
vertices in this simplex.</p>
</div>


                            </div>
                            <div id="Simplex.edges" class="classattr">
                                        <input id="Simplex.edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">edges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simplex.edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex.edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex.edges-957"><a href="#Simplex.edges-957"><span class="linenos">957</span></a>    <span class="k">def</span> <span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex.edges-958"><a href="#Simplex.edges-958"><span class="linenos">958</span></a>        <span class="sd">&quot;&quot;&quot;Get the edges of the simplex.</span>
</span><span id="Simplex.edges-959"><a href="#Simplex.edges-959"><span class="linenos">959</span></a>
</span><span id="Simplex.edges-960"><a href="#Simplex.edges-960"><span class="linenos">960</span></a><span class="sd">        Alias for PointPair(self.skeleton(2)).&quot;&quot;&quot;</span>
</span><span id="Simplex.edges-961"><a href="#Simplex.edges-961"><span class="linenos">961</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">skeleton</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get the edges of the simplex.</p>

<p>Alias for PointPair(self.skeleton(2)).</p>
</div>


                            </div>
                            <div id="Simplex.vertices" class="classattr">
                                        <input id="Simplex.vertices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">vertices</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simplex.vertices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simplex.vertices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simplex.vertices-963"><a href="#Simplex.vertices-963"><span class="linenos">963</span></a>    <span class="k">def</span> <span class="nf">vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simplex.vertices-964"><a href="#Simplex.vertices-964"><span class="linenos">964</span></a>        <span class="sd">&quot;&quot;&quot;Get the vertices of this simplex as a Point object.</span>
</span><span id="Simplex.vertices-965"><a href="#Simplex.vertices-965"><span class="linenos">965</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simplex.vertices-966"><a href="#Simplex.vertices-966"><span class="linenos">966</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the vertices of this simplex as a Point object.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Simplex.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="Simplex.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="Simplex.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="Simplex.in_affine_chart" class="function"><a href="#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="Simplex.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Simplex.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="Simplex.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Simplex.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="Simplex.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Simplex.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Simplex.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="Simplex.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Simplex.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Simplex.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Simplex.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="Simplex.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Subspace">
                            <input id="Subspace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Subspace</span><wbr>(<span class="base"><a href="#ProjectiveObject">ProjectiveObject</a></span>):

                <label class="view-source-button" for="Subspace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace-968"><a href="#Subspace-968"><span class="linenos"> 968</span></a><span class="k">class</span> <span class="nc">Subspace</span><span class="p">(</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="Subspace-969"><a href="#Subspace-969"><span class="linenos"> 969</span></a>    <span class="sd">&quot;&quot;&quot;A projective subspace (or composite object consisting of projective</span>
</span><span id="Subspace-970"><a href="#Subspace-970"><span class="linenos"> 970</span></a><span class="sd">    subspaces with the same dimension)</span>
</span><span id="Subspace-971"><a href="#Subspace-971"><span class="linenos"> 971</span></a>
</span><span id="Subspace-972"><a href="#Subspace-972"><span class="linenos"> 972</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Subspace-973"><a href="#Subspace-973"><span class="linenos"> 973</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Subspace-974"><a href="#Subspace-974"><span class="linenos"> 974</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Subspace-975"><a href="#Subspace-975"><span class="linenos"> 975</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace-976"><a href="#Subspace-976"><span class="linenos"> 976</span></a><span class="sd">        ----------</span>
</span><span id="Subspace-977"><a href="#Subspace-977"><span class="linenos"> 977</span></a><span class="sd">        proj_data : ProjectiveObject or ndarray</span>
</span><span id="Subspace-978"><a href="#Subspace-978"><span class="linenos"> 978</span></a><span class="sd">            data specifying a spanning set for this projective</span>
</span><span id="Subspace-979"><a href="#Subspace-979"><span class="linenos"> 979</span></a><span class="sd">            subspace. These are presumed to be a set of linearly</span>
</span><span id="Subspace-980"><a href="#Subspace-980"><span class="linenos"> 980</span></a><span class="sd">            independent vectors.</span>
</span><span id="Subspace-981"><a href="#Subspace-981"><span class="linenos"> 981</span></a>
</span><span id="Subspace-982"><a href="#Subspace-982"><span class="linenos"> 982</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-983"><a href="#Subspace-983"><span class="linenos"> 983</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Subspace-984"><a href="#Subspace-984"><span class="linenos"> 984</span></a>
</span><span id="Subspace-985"><a href="#Subspace-985"><span class="linenos"> 985</span></a>    <span class="nd">@property</span>
</span><span id="Subspace-986"><a href="#Subspace-986"><span class="linenos"> 986</span></a>    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace-987"><a href="#Subspace-987"><span class="linenos"> 987</span></a>        <span class="sd">&quot;&quot;&quot;Dimension of the vector space underlying this subspace.</span>
</span><span id="Subspace-988"><a href="#Subspace-988"><span class="linenos"> 988</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-989"><a href="#Subspace-989"><span class="linenos"> 989</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Subspace-990"><a href="#Subspace-990"><span class="linenos"> 990</span></a>
</span><span id="Subspace-991"><a href="#Subspace-991"><span class="linenos"> 991</span></a>    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">):</span>
</span><span id="Subspace-992"><a href="#Subspace-992"><span class="linenos"> 992</span></a>        <span class="sd">&quot;&quot;&quot;Get a subspace giving the intersection of self with other.</span>
</span><span id="Subspace-993"><a href="#Subspace-993"><span class="linenos"> 993</span></a>
</span><span id="Subspace-994"><a href="#Subspace-994"><span class="linenos"> 994</span></a><span class="sd">        All intersections are presumed to be transverse. So, the</span>
</span><span id="Subspace-995"><a href="#Subspace-995"><span class="linenos"> 995</span></a><span class="sd">        dimension of the underlying vector space of the returned</span>
</span><span id="Subspace-996"><a href="#Subspace-996"><span class="linenos"> 996</span></a><span class="sd">        subspace is always: (dimension of self) + (dimension of other)</span>
</span><span id="Subspace-997"><a href="#Subspace-997"><span class="linenos"> 997</span></a><span class="sd">        - (dimension of ambient vector space).</span>
</span><span id="Subspace-998"><a href="#Subspace-998"><span class="linenos"> 998</span></a>
</span><span id="Subspace-999"><a href="#Subspace-999"><span class="linenos"> 999</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace-1000"><a href="#Subspace-1000"><span class="linenos">1000</span></a><span class="sd">        ----------</span>
</span><span id="Subspace-1001"><a href="#Subspace-1001"><span class="linenos">1001</span></a><span class="sd">        other : Subspace or ndarray</span>
</span><span id="Subspace-1002"><a href="#Subspace-1002"><span class="linenos">1002</span></a><span class="sd">            Subspace to intersect with.</span>
</span><span id="Subspace-1003"><a href="#Subspace-1003"><span class="linenos">1003</span></a>
</span><span id="Subspace-1004"><a href="#Subspace-1004"><span class="linenos">1004</span></a><span class="sd">        broadcast : {&quot;elementwise&quot;, &quot;pairwise&quot;}</span>
</span><span id="Subspace-1005"><a href="#Subspace-1005"><span class="linenos">1005</span></a><span class="sd">            If &quot;elementwise&quot; (the default), and self/other are</span>
</span><span id="Subspace-1006"><a href="#Subspace-1006"><span class="linenos">1006</span></a><span class="sd">            composite objects, then compute the element-by-element</span>
</span><span id="Subspace-1007"><a href="#Subspace-1007"><span class="linenos">1007</span></a><span class="sd">            intersection. For this to work properly, self and other</span>
</span><span id="Subspace-1008"><a href="#Subspace-1008"><span class="linenos">1008</span></a><span class="sd">            must have the same shape (as composite objects).</span>
</span><span id="Subspace-1009"><a href="#Subspace-1009"><span class="linenos">1009</span></a>
</span><span id="Subspace-1010"><a href="#Subspace-1010"><span class="linenos">1010</span></a><span class="sd">            If &quot;pairwise&quot;, compute intersections between every</span>
</span><span id="Subspace-1011"><a href="#Subspace-1011"><span class="linenos">1011</span></a><span class="sd">            subspace in self and every subspace in other. If self has</span>
</span><span id="Subspace-1012"><a href="#Subspace-1012"><span class="linenos">1012</span></a><span class="sd">            a (composite) shape (N1, N2, ... Ni) and other has</span>
</span><span id="Subspace-1013"><a href="#Subspace-1013"><span class="linenos">1013</span></a><span class="sd">            composite shape (M1, M2, ..., Mj), then the returned</span>
</span><span id="Subspace-1014"><a href="#Subspace-1014"><span class="linenos">1014</span></a><span class="sd">            object has composite shape (N1, N2, ... Ni, M1, M2, ...,</span>
</span><span id="Subspace-1015"><a href="#Subspace-1015"><span class="linenos">1015</span></a><span class="sd">            Mj).</span>
</span><span id="Subspace-1016"><a href="#Subspace-1016"><span class="linenos">1016</span></a>
</span><span id="Subspace-1017"><a href="#Subspace-1017"><span class="linenos">1017</span></a><span class="sd">        Returns</span>
</span><span id="Subspace-1018"><a href="#Subspace-1018"><span class="linenos">1018</span></a><span class="sd">        -------</span>
</span><span id="Subspace-1019"><a href="#Subspace-1019"><span class="linenos">1019</span></a><span class="sd">        Subspace</span>
</span><span id="Subspace-1020"><a href="#Subspace-1020"><span class="linenos">1020</span></a><span class="sd">            Intersection of self and other.</span>
</span><span id="Subspace-1021"><a href="#Subspace-1021"><span class="linenos">1021</span></a>
</span><span id="Subspace-1022"><a href="#Subspace-1022"><span class="linenos">1022</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-1023"><a href="#Subspace-1023"><span class="linenos">1023</span></a>
</span><span id="Subspace-1024"><a href="#Subspace-1024"><span class="linenos">1024</span></a>        <span class="n">other_obj</span> <span class="o">=</span> <span class="n">Subspace</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Subspace-1025"><a href="#Subspace-1025"><span class="linenos">1025</span></a>
</span><span id="Subspace-1026"><a href="#Subspace-1026"><span class="linenos">1026</span></a>        <span class="k">if</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;elementwise&quot;</span><span class="p">:</span>
</span><span id="Subspace-1027"><a href="#Subspace-1027"><span class="linenos">1027</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">other_obj</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Subspace-1028"><a href="#Subspace-1028"><span class="linenos">1028</span></a>        <span class="k">elif</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
</span><span id="Subspace-1029"><a href="#Subspace-1029"><span class="linenos">1029</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">broadcast_match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="Subspace-1030"><a href="#Subspace-1030"><span class="linenos">1030</span></a>                                          <span class="n">other_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace-1031"><a href="#Subspace-1031"><span class="linenos">1031</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Subspace-1032"><a href="#Subspace-1032"><span class="linenos">1032</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized broadcast rule: &#39;</span><span class="si">{</span><span class="n">broadcast</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="Subspace-1033"><a href="#Subspace-1033"><span class="linenos">1033</span></a>
</span><span id="Subspace-1034"><a href="#Subspace-1034"><span class="linenos">1034</span></a>        <span class="n">spans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace-1035"><a href="#Subspace-1035"><span class="linenos">1035</span></a>
</span><span id="Subspace-1036"><a href="#Subspace-1036"><span class="linenos">1036</span></a>        <span class="n">kernel_coeffs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Subspace-1037"><a href="#Subspace-1037"><span class="linenos">1037</span></a>        <span class="n">subspace_coeffs</span> <span class="o">=</span> <span class="n">kernel_coeffs</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace-1038"><a href="#Subspace-1038"><span class="linenos">1038</span></a>
</span><span id="Subspace-1039"><a href="#Subspace-1039"><span class="linenos">1039</span></a>        <span class="k">return</span> <span class="n">Subspace</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">matrix_product</span><span class="p">(</span><span class="n">subspace_coeffs</span><span class="p">,</span> <span class="n">p1</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>A projective subspace (or composite object consisting of projective
subspaces with the same dimension)</p>
</div>


                            <div id="Subspace.__init__" class="classattr">
                                        <input id="Subspace.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Subspace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">proj_data</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Subspace.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.__init__-973"><a href="#Subspace.__init__-973"><span class="linenos">973</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Subspace.__init__-974"><a href="#Subspace.__init__-974"><span class="linenos">974</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Subspace.__init__-975"><a href="#Subspace.__init__-975"><span class="linenos">975</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace.__init__-976"><a href="#Subspace.__init__-976"><span class="linenos">976</span></a><span class="sd">        ----------</span>
</span><span id="Subspace.__init__-977"><a href="#Subspace.__init__-977"><span class="linenos">977</span></a><span class="sd">        proj_data : ProjectiveObject or ndarray</span>
</span><span id="Subspace.__init__-978"><a href="#Subspace.__init__-978"><span class="linenos">978</span></a><span class="sd">            data specifying a spanning set for this projective</span>
</span><span id="Subspace.__init__-979"><a href="#Subspace.__init__-979"><span class="linenos">979</span></a><span class="sd">            subspace. These are presumed to be a set of linearly</span>
</span><span id="Subspace.__init__-980"><a href="#Subspace.__init__-980"><span class="linenos">980</span></a><span class="sd">            independent vectors.</span>
</span><span id="Subspace.__init__-981"><a href="#Subspace.__init__-981"><span class="linenos">981</span></a>
</span><span id="Subspace.__init__-982"><a href="#Subspace.__init__-982"><span class="linenos">982</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.__init__-983"><a href="#Subspace.__init__-983"><span class="linenos">983</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ProjectiveObject or ndarray):
data specifying a spanning set for this projective
subspace. These are presumed to be a set of linearly
independent vectors.</li>
</ul>
</div>


                            </div>
                            <div id="Subspace.n" class="classattr">
                                        <input id="Subspace.n-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">n</span>

                <label class="view-source-button" for="Subspace.n-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.n"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.n-985"><a href="#Subspace.n-985"><span class="linenos">985</span></a>    <span class="nd">@property</span>
</span><span id="Subspace.n-986"><a href="#Subspace.n-986"><span class="linenos">986</span></a>    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace.n-987"><a href="#Subspace.n-987"><span class="linenos">987</span></a>        <span class="sd">&quot;&quot;&quot;Dimension of the vector space underlying this subspace.</span>
</span><span id="Subspace.n-988"><a href="#Subspace.n-988"><span class="linenos">988</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.n-989"><a href="#Subspace.n-989"><span class="linenos">989</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Dimension of the vector space underlying this subspace.</p>
</div>


                            </div>
                            <div id="Subspace.intersect" class="classattr">
                                        <input id="Subspace.intersect-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersect</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span>, </span><span class="param"><span class="n">broadcast</span><span class="o">=</span><span class="s1">&#39;elementwise&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Subspace.intersect-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.intersect"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.intersect-991"><a href="#Subspace.intersect-991"><span class="linenos"> 991</span></a>    <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">):</span>
</span><span id="Subspace.intersect-992"><a href="#Subspace.intersect-992"><span class="linenos"> 992</span></a>        <span class="sd">&quot;&quot;&quot;Get a subspace giving the intersection of self with other.</span>
</span><span id="Subspace.intersect-993"><a href="#Subspace.intersect-993"><span class="linenos"> 993</span></a>
</span><span id="Subspace.intersect-994"><a href="#Subspace.intersect-994"><span class="linenos"> 994</span></a><span class="sd">        All intersections are presumed to be transverse. So, the</span>
</span><span id="Subspace.intersect-995"><a href="#Subspace.intersect-995"><span class="linenos"> 995</span></a><span class="sd">        dimension of the underlying vector space of the returned</span>
</span><span id="Subspace.intersect-996"><a href="#Subspace.intersect-996"><span class="linenos"> 996</span></a><span class="sd">        subspace is always: (dimension of self) + (dimension of other)</span>
</span><span id="Subspace.intersect-997"><a href="#Subspace.intersect-997"><span class="linenos"> 997</span></a><span class="sd">        - (dimension of ambient vector space).</span>
</span><span id="Subspace.intersect-998"><a href="#Subspace.intersect-998"><span class="linenos"> 998</span></a>
</span><span id="Subspace.intersect-999"><a href="#Subspace.intersect-999"><span class="linenos"> 999</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace.intersect-1000"><a href="#Subspace.intersect-1000"><span class="linenos">1000</span></a><span class="sd">        ----------</span>
</span><span id="Subspace.intersect-1001"><a href="#Subspace.intersect-1001"><span class="linenos">1001</span></a><span class="sd">        other : Subspace or ndarray</span>
</span><span id="Subspace.intersect-1002"><a href="#Subspace.intersect-1002"><span class="linenos">1002</span></a><span class="sd">            Subspace to intersect with.</span>
</span><span id="Subspace.intersect-1003"><a href="#Subspace.intersect-1003"><span class="linenos">1003</span></a>
</span><span id="Subspace.intersect-1004"><a href="#Subspace.intersect-1004"><span class="linenos">1004</span></a><span class="sd">        broadcast : {&quot;elementwise&quot;, &quot;pairwise&quot;}</span>
</span><span id="Subspace.intersect-1005"><a href="#Subspace.intersect-1005"><span class="linenos">1005</span></a><span class="sd">            If &quot;elementwise&quot; (the default), and self/other are</span>
</span><span id="Subspace.intersect-1006"><a href="#Subspace.intersect-1006"><span class="linenos">1006</span></a><span class="sd">            composite objects, then compute the element-by-element</span>
</span><span id="Subspace.intersect-1007"><a href="#Subspace.intersect-1007"><span class="linenos">1007</span></a><span class="sd">            intersection. For this to work properly, self and other</span>
</span><span id="Subspace.intersect-1008"><a href="#Subspace.intersect-1008"><span class="linenos">1008</span></a><span class="sd">            must have the same shape (as composite objects).</span>
</span><span id="Subspace.intersect-1009"><a href="#Subspace.intersect-1009"><span class="linenos">1009</span></a>
</span><span id="Subspace.intersect-1010"><a href="#Subspace.intersect-1010"><span class="linenos">1010</span></a><span class="sd">            If &quot;pairwise&quot;, compute intersections between every</span>
</span><span id="Subspace.intersect-1011"><a href="#Subspace.intersect-1011"><span class="linenos">1011</span></a><span class="sd">            subspace in self and every subspace in other. If self has</span>
</span><span id="Subspace.intersect-1012"><a href="#Subspace.intersect-1012"><span class="linenos">1012</span></a><span class="sd">            a (composite) shape (N1, N2, ... Ni) and other has</span>
</span><span id="Subspace.intersect-1013"><a href="#Subspace.intersect-1013"><span class="linenos">1013</span></a><span class="sd">            composite shape (M1, M2, ..., Mj), then the returned</span>
</span><span id="Subspace.intersect-1014"><a href="#Subspace.intersect-1014"><span class="linenos">1014</span></a><span class="sd">            object has composite shape (N1, N2, ... Ni, M1, M2, ...,</span>
</span><span id="Subspace.intersect-1015"><a href="#Subspace.intersect-1015"><span class="linenos">1015</span></a><span class="sd">            Mj).</span>
</span><span id="Subspace.intersect-1016"><a href="#Subspace.intersect-1016"><span class="linenos">1016</span></a>
</span><span id="Subspace.intersect-1017"><a href="#Subspace.intersect-1017"><span class="linenos">1017</span></a><span class="sd">        Returns</span>
</span><span id="Subspace.intersect-1018"><a href="#Subspace.intersect-1018"><span class="linenos">1018</span></a><span class="sd">        -------</span>
</span><span id="Subspace.intersect-1019"><a href="#Subspace.intersect-1019"><span class="linenos">1019</span></a><span class="sd">        Subspace</span>
</span><span id="Subspace.intersect-1020"><a href="#Subspace.intersect-1020"><span class="linenos">1020</span></a><span class="sd">            Intersection of self and other.</span>
</span><span id="Subspace.intersect-1021"><a href="#Subspace.intersect-1021"><span class="linenos">1021</span></a>
</span><span id="Subspace.intersect-1022"><a href="#Subspace.intersect-1022"><span class="linenos">1022</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.intersect-1023"><a href="#Subspace.intersect-1023"><span class="linenos">1023</span></a>
</span><span id="Subspace.intersect-1024"><a href="#Subspace.intersect-1024"><span class="linenos">1024</span></a>        <span class="n">other_obj</span> <span class="o">=</span> <span class="n">Subspace</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span><span id="Subspace.intersect-1025"><a href="#Subspace.intersect-1025"><span class="linenos">1025</span></a>
</span><span id="Subspace.intersect-1026"><a href="#Subspace.intersect-1026"><span class="linenos">1026</span></a>        <span class="k">if</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;elementwise&quot;</span><span class="p">:</span>
</span><span id="Subspace.intersect-1027"><a href="#Subspace.intersect-1027"><span class="linenos">1027</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">other_obj</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Subspace.intersect-1028"><a href="#Subspace.intersect-1028"><span class="linenos">1028</span></a>        <span class="k">elif</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
</span><span id="Subspace.intersect-1029"><a href="#Subspace.intersect-1029"><span class="linenos">1029</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">broadcast_match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="Subspace.intersect-1030"><a href="#Subspace.intersect-1030"><span class="linenos">1030</span></a>                                          <span class="n">other_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace.intersect-1031"><a href="#Subspace.intersect-1031"><span class="linenos">1031</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Subspace.intersect-1032"><a href="#Subspace.intersect-1032"><span class="linenos">1032</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized broadcast rule: &#39;</span><span class="si">{</span><span class="n">broadcast</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="Subspace.intersect-1033"><a href="#Subspace.intersect-1033"><span class="linenos">1033</span></a>
</span><span id="Subspace.intersect-1034"><a href="#Subspace.intersect-1034"><span class="linenos">1034</span></a>        <span class="n">spans</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace.intersect-1035"><a href="#Subspace.intersect-1035"><span class="linenos">1035</span></a>
</span><span id="Subspace.intersect-1036"><a href="#Subspace.intersect-1036"><span class="linenos">1036</span></a>        <span class="n">kernel_coeffs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">spans</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Subspace.intersect-1037"><a href="#Subspace.intersect-1037"><span class="linenos">1037</span></a>        <span class="n">subspace_coeffs</span> <span class="o">=</span> <span class="n">kernel_coeffs</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace.intersect-1038"><a href="#Subspace.intersect-1038"><span class="linenos">1038</span></a>
</span><span id="Subspace.intersect-1039"><a href="#Subspace.intersect-1039"><span class="linenos">1039</span></a>        <span class="k">return</span> <span class="n">Subspace</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">matrix_product</span><span class="p">(</span><span class="n">subspace_coeffs</span><span class="p">,</span> <span class="n">p1</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get a subspace giving the intersection of self with other.</p>

<p>All intersections are presumed to be transverse. So, the
dimension of the underlying vector space of the returned
subspace is always: (dimension of self) + (dimension of other)</p>

<ul>
<li>(dimension of ambient vector space).</li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong> (Subspace or ndarray):
Subspace to intersect with.</li>
<li><p><strong>broadcast</strong> ({"elementwise", "pairwise"}):
If "elementwise" (the default), and self/other are
composite objects, then compute the element-by-element
intersection. For this to work properly, self and other
must have the same shape (as composite objects).</p>

<p>If "pairwise", compute intersections between every
subspace in self and every subspace in other. If self has
a (composite) shape (N1, N2, ... Ni) and other has
composite shape (M1, M2, ..., Mj), then the returned
object has composite shape (N1, N2, ... Ni, M1, M2, ...,
Mj).</p></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Subspace</strong>: Intersection of self and other.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="Subspace.unit_ndims" class="variable"><a href="#ProjectiveObject.unit_ndims">unit_ndims</a></dd>
                <dd id="Subspace.aux_ndims" class="variable"><a href="#ProjectiveObject.aux_ndims">aux_ndims</a></dd>
                <dd id="Subspace.dual_ndims" class="variable"><a href="#ProjectiveObject.dual_ndims">dual_ndims</a></dd>
                <dd id="Subspace.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Subspace.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="Subspace.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Subspace.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="Subspace.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Subspace.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Subspace.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="Subspace.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Subspace.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Subspace.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Subspace.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="Subspace.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ConvexPolygon">
                            <input id="ConvexPolygon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ConvexPolygon</span><wbr>(<span class="base"><a href="#Polygon">Polygon</a></span>):

                <label class="view-source-button" for="ConvexPolygon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConvexPolygon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConvexPolygon-1041"><a href="#ConvexPolygon-1041"><span class="linenos">1041</span></a><span class="k">class</span> <span class="nc">ConvexPolygon</span><span class="p">(</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="ConvexPolygon-1042"><a href="#ConvexPolygon-1042"><span class="linenos">1042</span></a>    <span class="sd">&quot;&quot;&quot;A finite-sided convex polygon in projective space.</span>
</span><span id="ConvexPolygon-1043"><a href="#ConvexPolygon-1043"><span class="linenos">1043</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ConvexPolygon-1044"><a href="#ConvexPolygon-1044"><span class="linenos">1044</span></a>
</span><span id="ConvexPolygon-1045"><a href="#ConvexPolygon-1045"><span class="linenos">1045</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ConvexPolygon-1046"><a href="#ConvexPolygon-1046"><span class="linenos">1046</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;When providing point data for this polygon, non-extreme points</span>
</span><span id="ConvexPolygon-1047"><a href="#ConvexPolygon-1047"><span class="linenos">1047</span></a><span class="sd">        (i.e. points in the interior of the convex hull) are</span>
</span><span id="ConvexPolygon-1048"><a href="#ConvexPolygon-1048"><span class="linenos">1048</span></a><span class="sd">        discarded. To determine which points lie in the interior of</span>
</span><span id="ConvexPolygon-1049"><a href="#ConvexPolygon-1049"><span class="linenos">1049</span></a><span class="sd">        the convex hull, the constructor either:</span>
</span><span id="ConvexPolygon-1050"><a href="#ConvexPolygon-1050"><span class="linenos">1050</span></a>
</span><span id="ConvexPolygon-1051"><a href="#ConvexPolygon-1051"><span class="linenos">1051</span></a><span class="sd">        - uses the provided `dual_data` to determine an affine</span>
</span><span id="ConvexPolygon-1052"><a href="#ConvexPolygon-1052"><span class="linenos">1052</span></a><span class="sd">          chart in which the convex polygon lies (this chart is</span>
</span><span id="ConvexPolygon-1053"><a href="#ConvexPolygon-1053"><span class="linenos">1053</span></a><span class="sd">          the complement of the hyperplane specified in</span>
</span><span id="ConvexPolygon-1054"><a href="#ConvexPolygon-1054"><span class="linenos">1054</span></a><span class="sd">          `dual_data`), or</span>
</span><span id="ConvexPolygon-1055"><a href="#ConvexPolygon-1055"><span class="linenos">1055</span></a>
</span><span id="ConvexPolygon-1056"><a href="#ConvexPolygon-1056"><span class="linenos">1056</span></a><span class="sd">        - interprets the projective coordinates of the provided points</span>
</span><span id="ConvexPolygon-1057"><a href="#ConvexPolygon-1057"><span class="linenos">1057</span></a><span class="sd">          as preferred lifts of those points in $\mathbb{R}^n$, and</span>
</span><span id="ConvexPolygon-1058"><a href="#ConvexPolygon-1058"><span class="linenos">1058</span></a><span class="sd">          computes an affine chart containing the projectivization of</span>
</span><span id="ConvexPolygon-1059"><a href="#ConvexPolygon-1059"><span class="linenos">1059</span></a><span class="sd">          the convex hull of those lifts.</span>
</span><span id="ConvexPolygon-1060"><a href="#ConvexPolygon-1060"><span class="linenos">1060</span></a>
</span><span id="ConvexPolygon-1061"><a href="#ConvexPolygon-1061"><span class="linenos">1061</span></a><span class="sd">        Parameters</span>
</span><span id="ConvexPolygon-1062"><a href="#ConvexPolygon-1062"><span class="linenos">1062</span></a><span class="sd">        ----------</span>
</span><span id="ConvexPolygon-1063"><a href="#ConvexPolygon-1063"><span class="linenos">1063</span></a><span class="sd">        vertices : Point or ndarray</span>
</span><span id="ConvexPolygon-1064"><a href="#ConvexPolygon-1064"><span class="linenos">1064</span></a><span class="sd">            points contained in this polygon</span>
</span><span id="ConvexPolygon-1065"><a href="#ConvexPolygon-1065"><span class="linenos">1065</span></a><span class="sd">        aux_data : PointPair or None</span>
</span><span id="ConvexPolygon-1066"><a href="#ConvexPolygon-1066"><span class="linenos">1066</span></a><span class="sd">            Data to construct the edges of this polygon. If `None`,</span>
</span><span id="ConvexPolygon-1067"><a href="#ConvexPolygon-1067"><span class="linenos">1067</span></a><span class="sd">            use vertex data to construct edge data.</span>
</span><span id="ConvexPolygon-1068"><a href="#ConvexPolygon-1068"><span class="linenos">1068</span></a><span class="sd">        dual_data : ProjectiveObject</span>
</span><span id="ConvexPolygon-1069"><a href="#ConvexPolygon-1069"><span class="linenos">1069</span></a><span class="sd">            Dual vector specifying an affine chart containing every</span>
</span><span id="ConvexPolygon-1070"><a href="#ConvexPolygon-1070"><span class="linenos">1070</span></a><span class="sd">            point in this convex polygon. If `None`, then compute a</span>
</span><span id="ConvexPolygon-1071"><a href="#ConvexPolygon-1071"><span class="linenos">1071</span></a><span class="sd">            dual vector using lifts of the vertex data.</span>
</span><span id="ConvexPolygon-1072"><a href="#ConvexPolygon-1072"><span class="linenos">1072</span></a>
</span><span id="ConvexPolygon-1073"><a href="#ConvexPolygon-1073"><span class="linenos">1073</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ConvexPolygon-1074"><a href="#ConvexPolygon-1074"><span class="linenos">1074</span></a>
</span><span id="ConvexPolygon-1075"><a href="#ConvexPolygon-1075"><span class="linenos">1075</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_data</span><span class="p">,</span>
</span><span id="ConvexPolygon-1076"><a href="#ConvexPolygon-1076"><span class="linenos">1076</span></a>                                  <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="ConvexPolygon-1077"><a href="#ConvexPolygon-1077"><span class="linenos">1077</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ConvexPolygon-1078"><a href="#ConvexPolygon-1078"><span class="linenos">1078</span></a>    <span class="k">def</span> <span class="nf">add_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="ConvexPolygon-1079"><a href="#ConvexPolygon-1079"><span class="linenos">1079</span></a>        <span class="sd">&quot;&quot;&quot;Add points to an existing convex polygon.</span>
</span><span id="ConvexPolygon-1080"><a href="#ConvexPolygon-1080"><span class="linenos">1080</span></a>
</span><span id="ConvexPolygon-1081"><a href="#ConvexPolygon-1081"><span class="linenos">1081</span></a><span class="sd">        Parameters</span>
</span><span id="ConvexPolygon-1082"><a href="#ConvexPolygon-1082"><span class="linenos">1082</span></a><span class="sd">        ----------</span>
</span><span id="ConvexPolygon-1083"><a href="#ConvexPolygon-1083"><span class="linenos">1083</span></a><span class="sd">        points : Point or ndarray</span>
</span><span id="ConvexPolygon-1084"><a href="#ConvexPolygon-1084"><span class="linenos">1084</span></a><span class="sd">            Points to add to the convex polygon. Redundant points</span>
</span><span id="ConvexPolygon-1085"><a href="#ConvexPolygon-1085"><span class="linenos">1085</span></a><span class="sd">            (lying in the interior of the convex hull) will be</span>
</span><span id="ConvexPolygon-1086"><a href="#ConvexPolygon-1086"><span class="linenos">1086</span></a><span class="sd">            discarded.</span>
</span><span id="ConvexPolygon-1087"><a href="#ConvexPolygon-1087"><span class="linenos">1087</span></a><span class="sd">        in_place : bool</span>
</span><span id="ConvexPolygon-1088"><a href="#ConvexPolygon-1088"><span class="linenos">1088</span></a><span class="sd">            if `True`, modify this convex polygon object in-place</span>
</span><span id="ConvexPolygon-1089"><a href="#ConvexPolygon-1089"><span class="linenos">1089</span></a><span class="sd">            instead of returning a new one.</span>
</span><span id="ConvexPolygon-1090"><a href="#ConvexPolygon-1090"><span class="linenos">1090</span></a>
</span><span id="ConvexPolygon-1091"><a href="#ConvexPolygon-1091"><span class="linenos">1091</span></a><span class="sd">        Raises</span>
</span><span id="ConvexPolygon-1092"><a href="#ConvexPolygon-1092"><span class="linenos">1092</span></a><span class="sd">        ------</span>
</span><span id="ConvexPolygon-1093"><a href="#ConvexPolygon-1093"><span class="linenos">1093</span></a><span class="sd">        GeometryError</span>
</span><span id="ConvexPolygon-1094"><a href="#ConvexPolygon-1094"><span class="linenos">1094</span></a><span class="sd">            Raised if points are added to a composite ConvexPolygon</span>
</span><span id="ConvexPolygon-1095"><a href="#ConvexPolygon-1095"><span class="linenos">1095</span></a><span class="sd">            (currently unsupported)</span>
</span><span id="ConvexPolygon-1096"><a href="#ConvexPolygon-1096"><span class="linenos">1096</span></a>
</span><span id="ConvexPolygon-1097"><a href="#ConvexPolygon-1097"><span class="linenos">1097</span></a><span class="sd">        Returns</span>
</span><span id="ConvexPolygon-1098"><a href="#ConvexPolygon-1098"><span class="linenos">1098</span></a><span class="sd">        -------</span>
</span><span id="ConvexPolygon-1099"><a href="#ConvexPolygon-1099"><span class="linenos">1099</span></a><span class="sd">        ConvexPolygon</span>
</span><span id="ConvexPolygon-1100"><a href="#ConvexPolygon-1100"><span class="linenos">1100</span></a><span class="sd">            if `in_place` is `False`, return a modified ConvexPolygon</span>
</span><span id="ConvexPolygon-1101"><a href="#ConvexPolygon-1101"><span class="linenos">1101</span></a><span class="sd">            object with the new points added.</span>
</span><span id="ConvexPolygon-1102"><a href="#ConvexPolygon-1102"><span class="linenos">1102</span></a>
</span><span id="ConvexPolygon-1103"><a href="#ConvexPolygon-1103"><span class="linenos">1103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ConvexPolygon-1104"><a href="#ConvexPolygon-1104"><span class="linenos">1104</span></a>
</span><span id="ConvexPolygon-1105"><a href="#ConvexPolygon-1105"><span class="linenos">1105</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ConvexPolygon-1106"><a href="#ConvexPolygon-1106"><span class="linenos">1106</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="ConvexPolygon-1107"><a href="#ConvexPolygon-1107"><span class="linenos">1107</span></a>                <span class="s2">&quot;Adding new points to a composite ConvexPolygon object is currently&quot;</span>
</span><span id="ConvexPolygon-1108"><a href="#ConvexPolygon-1108"><span class="linenos">1108</span></a>                <span class="s2">&quot; unsupported.&quot;</span>
</span><span id="ConvexPolygon-1109"><a href="#ConvexPolygon-1109"><span class="linenos">1109</span></a>            <span class="p">)</span>
</span><span id="ConvexPolygon-1110"><a href="#ConvexPolygon-1110"><span class="linenos">1110</span></a>
</span><span id="ConvexPolygon-1111"><a href="#ConvexPolygon-1111"><span class="linenos">1111</span></a>        <span class="n">to_add</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="ConvexPolygon-1112"><a href="#ConvexPolygon-1112"><span class="linenos">1112</span></a>        <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">to_add</span><span class="o">.</span><span class="n">proj_data</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="ConvexPolygon-1113"><a href="#ConvexPolygon-1113"><span class="linenos">1113</span></a>
</span><span id="ConvexPolygon-1114"><a href="#ConvexPolygon-1114"><span class="linenos">1114</span></a>        <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
</span><span id="ConvexPolygon-1115"><a href="#ConvexPolygon-1115"><span class="linenos">1115</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="ConvexPolygon-1116"><a href="#ConvexPolygon-1116"><span class="linenos">1116</span></a>            <span class="k">return</span>
</span><span id="ConvexPolygon-1117"><a href="#ConvexPolygon-1117"><span class="linenos">1117</span></a>
</span><span id="ConvexPolygon-1118"><a href="#ConvexPolygon-1118"><span class="linenos">1118</span></a>        <span class="n">new_poly</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="ConvexPolygon-1119"><a href="#ConvexPolygon-1119"><span class="linenos">1119</span></a>        <span class="k">return</span> <span class="n">new_poly</span>
</span><span id="ConvexPolygon-1120"><a href="#ConvexPolygon-1120"><span class="linenos">1120</span></a>
</span><span id="ConvexPolygon-1121"><a href="#ConvexPolygon-1121"><span class="linenos">1121</span></a>    <span class="k">def</span> <span class="nf">_convexify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="ConvexPolygon-1122"><a href="#ConvexPolygon-1122"><span class="linenos">1122</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ConvexPolygon-1123"><a href="#ConvexPolygon-1123"><span class="linenos">1123</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="ConvexPolygon-1124"><a href="#ConvexPolygon-1124"><span class="linenos">1124</span></a>                <span class="s2">&quot;Cannot auto-convexify a composite ConvexPolygon object.&quot;</span>
</span><span id="ConvexPolygon-1125"><a href="#ConvexPolygon-1125"><span class="linenos">1125</span></a>            <span class="p">)</span>
</span><span id="ConvexPolygon-1126"><a href="#ConvexPolygon-1126"><span class="linenos">1126</span></a>
</span><span id="ConvexPolygon-1127"><a href="#ConvexPolygon-1127"><span class="linenos">1127</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="ConvexPolygon-1128"><a href="#ConvexPolygon-1128"><span class="linenos">1128</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_positive_functional</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ConvexPolygon-1129"><a href="#ConvexPolygon-1129"><span class="linenos">1129</span></a>
</span><span id="ConvexPolygon-1130"><a href="#ConvexPolygon-1130"><span class="linenos">1130</span></a>        <span class="n">to_std_aff</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span>
</span><span id="ConvexPolygon-1131"><a href="#ConvexPolygon-1131"><span class="linenos">1131</span></a>                                                       <span class="bp">self</span><span class="o">.</span><span class="n">dual_data</span><span class="p">))</span>
</span><span id="ConvexPolygon-1132"><a href="#ConvexPolygon-1132"><span class="linenos">1132</span></a>
</span><span id="ConvexPolygon-1133"><a href="#ConvexPolygon-1133"><span class="linenos">1133</span></a>        <span class="n">standardized_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span>
</span><span id="ConvexPolygon-1134"><a href="#ConvexPolygon-1134"><span class="linenos">1134</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">@</span> <span class="n">to_std_aff</span>
</span><span id="ConvexPolygon-1135"><a href="#ConvexPolygon-1135"><span class="linenos">1135</span></a>        <span class="p">)</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="ConvexPolygon-1136"><a href="#ConvexPolygon-1136"><span class="linenos">1136</span></a>
</span><span id="ConvexPolygon-1137"><a href="#ConvexPolygon-1137"><span class="linenos">1137</span></a>        <span class="n">vertex_indices</span> <span class="o">=</span> <span class="n">ConvexHull</span><span class="p">(</span><span class="n">standardized_coords</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span>
</span><span id="ConvexPolygon-1138"><a href="#ConvexPolygon-1138"><span class="linenos">1138</span></a>
</span><span id="ConvexPolygon-1139"><a href="#ConvexPolygon-1139"><span class="linenos">1139</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="n">vertex_indices</span><span class="p">]</span>
</span><span id="ConvexPolygon-1140"><a href="#ConvexPolygon-1140"><span class="linenos">1140</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="ConvexPolygon-1141"><a href="#ConvexPolygon-1141"><span class="linenos">1141</span></a>
</span><span id="ConvexPolygon-1142"><a href="#ConvexPolygon-1142"><span class="linenos">1142</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ConvexPolygon-1143"><a href="#ConvexPolygon-1143"><span class="linenos">1143</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ConvexPolygon-1144"><a href="#ConvexPolygon-1144"><span class="linenos">1144</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ConvexPolygon-1145"><a href="#ConvexPolygon-1145"><span class="linenos">1145</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_convexify</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>A finite-sided convex polygon in projective space.</p>
</div>


                            <div id="ConvexPolygon.__init__" class="classattr">
                                        <input id="ConvexPolygon.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">ConvexPolygon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vertices</span>, </span><span class="param"><span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="ConvexPolygon.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConvexPolygon.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConvexPolygon.__init__-1045"><a href="#ConvexPolygon.__init__-1045"><span class="linenos">1045</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ConvexPolygon.__init__-1046"><a href="#ConvexPolygon.__init__-1046"><span class="linenos">1046</span></a>        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;When providing point data for this polygon, non-extreme points</span>
</span><span id="ConvexPolygon.__init__-1047"><a href="#ConvexPolygon.__init__-1047"><span class="linenos">1047</span></a><span class="sd">        (i.e. points in the interior of the convex hull) are</span>
</span><span id="ConvexPolygon.__init__-1048"><a href="#ConvexPolygon.__init__-1048"><span class="linenos">1048</span></a><span class="sd">        discarded. To determine which points lie in the interior of</span>
</span><span id="ConvexPolygon.__init__-1049"><a href="#ConvexPolygon.__init__-1049"><span class="linenos">1049</span></a><span class="sd">        the convex hull, the constructor either:</span>
</span><span id="ConvexPolygon.__init__-1050"><a href="#ConvexPolygon.__init__-1050"><span class="linenos">1050</span></a>
</span><span id="ConvexPolygon.__init__-1051"><a href="#ConvexPolygon.__init__-1051"><span class="linenos">1051</span></a><span class="sd">        - uses the provided `dual_data` to determine an affine</span>
</span><span id="ConvexPolygon.__init__-1052"><a href="#ConvexPolygon.__init__-1052"><span class="linenos">1052</span></a><span class="sd">          chart in which the convex polygon lies (this chart is</span>
</span><span id="ConvexPolygon.__init__-1053"><a href="#ConvexPolygon.__init__-1053"><span class="linenos">1053</span></a><span class="sd">          the complement of the hyperplane specified in</span>
</span><span id="ConvexPolygon.__init__-1054"><a href="#ConvexPolygon.__init__-1054"><span class="linenos">1054</span></a><span class="sd">          `dual_data`), or</span>
</span><span id="ConvexPolygon.__init__-1055"><a href="#ConvexPolygon.__init__-1055"><span class="linenos">1055</span></a>
</span><span id="ConvexPolygon.__init__-1056"><a href="#ConvexPolygon.__init__-1056"><span class="linenos">1056</span></a><span class="sd">        - interprets the projective coordinates of the provided points</span>
</span><span id="ConvexPolygon.__init__-1057"><a href="#ConvexPolygon.__init__-1057"><span class="linenos">1057</span></a><span class="sd">          as preferred lifts of those points in $\mathbb{R}^n$, and</span>
</span><span id="ConvexPolygon.__init__-1058"><a href="#ConvexPolygon.__init__-1058"><span class="linenos">1058</span></a><span class="sd">          computes an affine chart containing the projectivization of</span>
</span><span id="ConvexPolygon.__init__-1059"><a href="#ConvexPolygon.__init__-1059"><span class="linenos">1059</span></a><span class="sd">          the convex hull of those lifts.</span>
</span><span id="ConvexPolygon.__init__-1060"><a href="#ConvexPolygon.__init__-1060"><span class="linenos">1060</span></a>
</span><span id="ConvexPolygon.__init__-1061"><a href="#ConvexPolygon.__init__-1061"><span class="linenos">1061</span></a><span class="sd">        Parameters</span>
</span><span id="ConvexPolygon.__init__-1062"><a href="#ConvexPolygon.__init__-1062"><span class="linenos">1062</span></a><span class="sd">        ----------</span>
</span><span id="ConvexPolygon.__init__-1063"><a href="#ConvexPolygon.__init__-1063"><span class="linenos">1063</span></a><span class="sd">        vertices : Point or ndarray</span>
</span><span id="ConvexPolygon.__init__-1064"><a href="#ConvexPolygon.__init__-1064"><span class="linenos">1064</span></a><span class="sd">            points contained in this polygon</span>
</span><span id="ConvexPolygon.__init__-1065"><a href="#ConvexPolygon.__init__-1065"><span class="linenos">1065</span></a><span class="sd">        aux_data : PointPair or None</span>
</span><span id="ConvexPolygon.__init__-1066"><a href="#ConvexPolygon.__init__-1066"><span class="linenos">1066</span></a><span class="sd">            Data to construct the edges of this polygon. If `None`,</span>
</span><span id="ConvexPolygon.__init__-1067"><a href="#ConvexPolygon.__init__-1067"><span class="linenos">1067</span></a><span class="sd">            use vertex data to construct edge data.</span>
</span><span id="ConvexPolygon.__init__-1068"><a href="#ConvexPolygon.__init__-1068"><span class="linenos">1068</span></a><span class="sd">        dual_data : ProjectiveObject</span>
</span><span id="ConvexPolygon.__init__-1069"><a href="#ConvexPolygon.__init__-1069"><span class="linenos">1069</span></a><span class="sd">            Dual vector specifying an affine chart containing every</span>
</span><span id="ConvexPolygon.__init__-1070"><a href="#ConvexPolygon.__init__-1070"><span class="linenos">1070</span></a><span class="sd">            point in this convex polygon. If `None`, then compute a</span>
</span><span id="ConvexPolygon.__init__-1071"><a href="#ConvexPolygon.__init__-1071"><span class="linenos">1071</span></a><span class="sd">            dual vector using lifts of the vertex data.</span>
</span><span id="ConvexPolygon.__init__-1072"><a href="#ConvexPolygon.__init__-1072"><span class="linenos">1072</span></a>
</span><span id="ConvexPolygon.__init__-1073"><a href="#ConvexPolygon.__init__-1073"><span class="linenos">1073</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ConvexPolygon.__init__-1074"><a href="#ConvexPolygon.__init__-1074"><span class="linenos">1074</span></a>
</span><span id="ConvexPolygon.__init__-1075"><a href="#ConvexPolygon.__init__-1075"><span class="linenos">1075</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_data</span><span class="p">,</span>
</span><span id="ConvexPolygon.__init__-1076"><a href="#ConvexPolygon.__init__-1076"><span class="linenos">1076</span></a>                                  <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="ConvexPolygon.__init__-1077"><a href="#ConvexPolygon.__init__-1077"><span class="linenos">1077</span></a>                                  <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>When providing point data for this polygon, non-extreme points
(i.e. points in the interior of the convex hull) are
discarded. To determine which points lie in the interior of
the convex hull, the constructor either:</p>

<ul>
<li><p>uses the provided <code>dual_data</code> to determine an affine
chart in which the convex polygon lies (this chart is
the complement of the hyperplane specified in
<code>dual_data</code>), or</p></li>
<li><p>interprets the projective coordinates of the provided points
as preferred lifts of those points in $\mathbb{R}^n$, and
computes an affine chart containing the projectivization of
the convex hull of those lifts.</p></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>vertices</strong> (Point or ndarray):
points contained in this polygon</li>
<li><strong>aux_data</strong> (PointPair or None):
Data to construct the edges of this polygon. If <code>None</code>,
use vertex data to construct edge data.</li>
<li><strong>dual_data</strong> (ProjectiveObject):
Dual vector specifying an affine chart containing every
point in this convex polygon. If <code>None</code>, then compute a
dual vector using lifts of the vertex data.</li>
</ul>
</div>


                            </div>
                            <div id="ConvexPolygon.add_points" class="classattr">
                                        <input id="ConvexPolygon.add_points-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">add_points</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">in_place</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ConvexPolygon.add_points-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConvexPolygon.add_points"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConvexPolygon.add_points-1078"><a href="#ConvexPolygon.add_points-1078"><span class="linenos">1078</span></a>    <span class="k">def</span> <span class="nf">add_points</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="ConvexPolygon.add_points-1079"><a href="#ConvexPolygon.add_points-1079"><span class="linenos">1079</span></a>        <span class="sd">&quot;&quot;&quot;Add points to an existing convex polygon.</span>
</span><span id="ConvexPolygon.add_points-1080"><a href="#ConvexPolygon.add_points-1080"><span class="linenos">1080</span></a>
</span><span id="ConvexPolygon.add_points-1081"><a href="#ConvexPolygon.add_points-1081"><span class="linenos">1081</span></a><span class="sd">        Parameters</span>
</span><span id="ConvexPolygon.add_points-1082"><a href="#ConvexPolygon.add_points-1082"><span class="linenos">1082</span></a><span class="sd">        ----------</span>
</span><span id="ConvexPolygon.add_points-1083"><a href="#ConvexPolygon.add_points-1083"><span class="linenos">1083</span></a><span class="sd">        points : Point or ndarray</span>
</span><span id="ConvexPolygon.add_points-1084"><a href="#ConvexPolygon.add_points-1084"><span class="linenos">1084</span></a><span class="sd">            Points to add to the convex polygon. Redundant points</span>
</span><span id="ConvexPolygon.add_points-1085"><a href="#ConvexPolygon.add_points-1085"><span class="linenos">1085</span></a><span class="sd">            (lying in the interior of the convex hull) will be</span>
</span><span id="ConvexPolygon.add_points-1086"><a href="#ConvexPolygon.add_points-1086"><span class="linenos">1086</span></a><span class="sd">            discarded.</span>
</span><span id="ConvexPolygon.add_points-1087"><a href="#ConvexPolygon.add_points-1087"><span class="linenos">1087</span></a><span class="sd">        in_place : bool</span>
</span><span id="ConvexPolygon.add_points-1088"><a href="#ConvexPolygon.add_points-1088"><span class="linenos">1088</span></a><span class="sd">            if `True`, modify this convex polygon object in-place</span>
</span><span id="ConvexPolygon.add_points-1089"><a href="#ConvexPolygon.add_points-1089"><span class="linenos">1089</span></a><span class="sd">            instead of returning a new one.</span>
</span><span id="ConvexPolygon.add_points-1090"><a href="#ConvexPolygon.add_points-1090"><span class="linenos">1090</span></a>
</span><span id="ConvexPolygon.add_points-1091"><a href="#ConvexPolygon.add_points-1091"><span class="linenos">1091</span></a><span class="sd">        Raises</span>
</span><span id="ConvexPolygon.add_points-1092"><a href="#ConvexPolygon.add_points-1092"><span class="linenos">1092</span></a><span class="sd">        ------</span>
</span><span id="ConvexPolygon.add_points-1093"><a href="#ConvexPolygon.add_points-1093"><span class="linenos">1093</span></a><span class="sd">        GeometryError</span>
</span><span id="ConvexPolygon.add_points-1094"><a href="#ConvexPolygon.add_points-1094"><span class="linenos">1094</span></a><span class="sd">            Raised if points are added to a composite ConvexPolygon</span>
</span><span id="ConvexPolygon.add_points-1095"><a href="#ConvexPolygon.add_points-1095"><span class="linenos">1095</span></a><span class="sd">            (currently unsupported)</span>
</span><span id="ConvexPolygon.add_points-1096"><a href="#ConvexPolygon.add_points-1096"><span class="linenos">1096</span></a>
</span><span id="ConvexPolygon.add_points-1097"><a href="#ConvexPolygon.add_points-1097"><span class="linenos">1097</span></a><span class="sd">        Returns</span>
</span><span id="ConvexPolygon.add_points-1098"><a href="#ConvexPolygon.add_points-1098"><span class="linenos">1098</span></a><span class="sd">        -------</span>
</span><span id="ConvexPolygon.add_points-1099"><a href="#ConvexPolygon.add_points-1099"><span class="linenos">1099</span></a><span class="sd">        ConvexPolygon</span>
</span><span id="ConvexPolygon.add_points-1100"><a href="#ConvexPolygon.add_points-1100"><span class="linenos">1100</span></a><span class="sd">            if `in_place` is `False`, return a modified ConvexPolygon</span>
</span><span id="ConvexPolygon.add_points-1101"><a href="#ConvexPolygon.add_points-1101"><span class="linenos">1101</span></a><span class="sd">            object with the new points added.</span>
</span><span id="ConvexPolygon.add_points-1102"><a href="#ConvexPolygon.add_points-1102"><span class="linenos">1102</span></a>
</span><span id="ConvexPolygon.add_points-1103"><a href="#ConvexPolygon.add_points-1103"><span class="linenos">1103</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ConvexPolygon.add_points-1104"><a href="#ConvexPolygon.add_points-1104"><span class="linenos">1104</span></a>
</span><span id="ConvexPolygon.add_points-1105"><a href="#ConvexPolygon.add_points-1105"><span class="linenos">1105</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="ConvexPolygon.add_points-1106"><a href="#ConvexPolygon.add_points-1106"><span class="linenos">1106</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="ConvexPolygon.add_points-1107"><a href="#ConvexPolygon.add_points-1107"><span class="linenos">1107</span></a>                <span class="s2">&quot;Adding new points to a composite ConvexPolygon object is currently&quot;</span>
</span><span id="ConvexPolygon.add_points-1108"><a href="#ConvexPolygon.add_points-1108"><span class="linenos">1108</span></a>                <span class="s2">&quot; unsupported.&quot;</span>
</span><span id="ConvexPolygon.add_points-1109"><a href="#ConvexPolygon.add_points-1109"><span class="linenos">1109</span></a>            <span class="p">)</span>
</span><span id="ConvexPolygon.add_points-1110"><a href="#ConvexPolygon.add_points-1110"><span class="linenos">1110</span></a>
</span><span id="ConvexPolygon.add_points-1111"><a href="#ConvexPolygon.add_points-1111"><span class="linenos">1111</span></a>        <span class="n">to_add</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="ConvexPolygon.add_points-1112"><a href="#ConvexPolygon.add_points-1112"><span class="linenos">1112</span></a>        <span class="n">new_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">to_add</span><span class="o">.</span><span class="n">proj_data</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="ConvexPolygon.add_points-1113"><a href="#ConvexPolygon.add_points-1113"><span class="linenos">1113</span></a>
</span><span id="ConvexPolygon.add_points-1114"><a href="#ConvexPolygon.add_points-1114"><span class="linenos">1114</span></a>        <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
</span><span id="ConvexPolygon.add_points-1115"><a href="#ConvexPolygon.add_points-1115"><span class="linenos">1115</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="ConvexPolygon.add_points-1116"><a href="#ConvexPolygon.add_points-1116"><span class="linenos">1116</span></a>            <span class="k">return</span>
</span><span id="ConvexPolygon.add_points-1117"><a href="#ConvexPolygon.add_points-1117"><span class="linenos">1117</span></a>
</span><span id="ConvexPolygon.add_points-1118"><a href="#ConvexPolygon.add_points-1118"><span class="linenos">1118</span></a>        <span class="n">new_poly</span> <span class="o">=</span> <span class="n">ConvexPolygon</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>
</span><span id="ConvexPolygon.add_points-1119"><a href="#ConvexPolygon.add_points-1119"><span class="linenos">1119</span></a>        <span class="k">return</span> <span class="n">new_poly</span>
</span></pre></div>


            <div class="docstring"><p>Add points to an existing convex polygon.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>points</strong> (Point or ndarray):
Points to add to the convex polygon. Redundant points
(lying in the interior of the convex hull) will be
discarded.</li>
<li><strong>in_place</strong> (bool):
if <code>True</code>, modify this convex polygon object in-place
instead of returning a new one.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>GeometryError</strong>: Raised if points are added to a composite ConvexPolygon
(currently unsupported)</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ConvexPolygon</strong>: if <code>in_place</code> is <code>False</code>, return a modified ConvexPolygon
object with the new points added.</li>
</ul>
</div>


                            </div>
                            <div id="ConvexPolygon.set" class="classattr">
                                        <input id="ConvexPolygon.set-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_data</span>, </span><span class="param"><span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ConvexPolygon.set-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ConvexPolygon.set"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ConvexPolygon.set-1142"><a href="#ConvexPolygon.set-1142"><span class="linenos">1142</span></a>    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dual_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="ConvexPolygon.set-1143"><a href="#ConvexPolygon.set-1143"><span class="linenos">1143</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">dual_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="ConvexPolygon.set-1144"><a href="#ConvexPolygon.set-1144"><span class="linenos">1144</span></a>        <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="ConvexPolygon.set-1145"><a href="#ConvexPolygon.set-1145"><span class="linenos">1145</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_convexify</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>set the underlying data of the hyperbolic object.</p>

<p>Subclasses may override this method to give special names to
portions of the underlying data.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ndarray):
underyling data representing this projective object.</li>
<li><strong>aux_data</strong> (ndarray):
underyling auxiliary data for this projective object.</li>
<li><strong>dual_data</strong> (ndarray):
underlying dual data for this projective object.</li>
<li><strong>base_ring</strong> (object):
<em>(requires sage).</em> Base ring for matrix entries of the
 underlying data for this object. This allows for exact
 computations in projective space (at the cost of
 performance) by supplying a ring that supports exact
 computations. The dtype of the underlying data is
 automatically converted to "object" if this is specified.</li>
<li><strong>rational_approx</strong> (bool):
<em>(requires sage).</em> If base_ring is specified, coerce
 floating-point data to a rational approximation before
 converting to the specified ring. This is useful for
 combining computations with floating-point values with
 computations in algebraic number fields.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>EnvironmentError</strong>: Raised if base_ring is specified but sage is not available
for import.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Polygon">Polygon</a></dt>
                                <dd id="ConvexPolygon.in_standard_chart" class="function"><a href="#Polygon.in_standard_chart">in_standard_chart</a></dd>
                <dd id="ConvexPolygon.vertices" class="variable"><a href="#Polygon.vertices">vertices</a></dd>
                <dd id="ConvexPolygon.edges" class="variable"><a href="#Polygon.edges">edges</a></dd>
                <dd id="ConvexPolygon.get_edges" class="function"><a href="#Polygon.get_edges">get_edges</a></dd>
                <dd id="ConvexPolygon.get_vertices" class="function"><a href="#Polygon.get_vertices">get_vertices</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="ConvexPolygon.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="ConvexPolygon.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="ConvexPolygon.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="ConvexPolygon.in_affine_chart" class="function"><a href="#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="ConvexPolygon.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="ConvexPolygon.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="ConvexPolygon.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="ConvexPolygon.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="ConvexPolygon.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="ConvexPolygon.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="ConvexPolygon.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="ConvexPolygon.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="ConvexPolygon.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="ConvexPolygon.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="ConvexPolygon.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Transformation">
                            <input id="Transformation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Transformation</span><wbr>(<span class="base"><a href="#ProjectiveObject">ProjectiveObject</a></span>):

                <label class="view-source-button" for="Transformation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation-1147"><a href="#Transformation-1147"><span class="linenos">1147</span></a><span class="k">class</span> <span class="nc">Transformation</span><span class="p">(</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="Transformation-1148"><a href="#Transformation-1148"><span class="linenos">1148</span></a>    <span class="sd">&quot;&quot;&quot;A projective transformation (or a composite object consisting of a</span>
</span><span id="Transformation-1149"><a href="#Transformation-1149"><span class="linenos">1149</span></a><span class="sd">    collection of projective transformations).</span>
</span><span id="Transformation-1150"><a href="#Transformation-1150"><span class="linenos">1150</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Transformation-1151"><a href="#Transformation-1151"><span class="linenos">1151</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Transformation-1152"><a href="#Transformation-1152"><span class="linenos">1152</span></a>        <span class="sd">&quot;&quot;&quot;By default, the underlying data for a projective</span>
</span><span id="Transformation-1153"><a href="#Transformation-1153"><span class="linenos">1153</span></a><span class="sd">        transformation is a *row matrix* (or an ndarray of row</span>
</span><span id="Transformation-1154"><a href="#Transformation-1154"><span class="linenos">1154</span></a><span class="sd">        matrices), acting on vectors on the *right*.</span>
</span><span id="Transformation-1155"><a href="#Transformation-1155"><span class="linenos">1155</span></a>
</span><span id="Transformation-1156"><a href="#Transformation-1156"><span class="linenos">1156</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation-1157"><a href="#Transformation-1157"><span class="linenos">1157</span></a><span class="sd">        ----------</span>
</span><span id="Transformation-1158"><a href="#Transformation-1158"><span class="linenos">1158</span></a><span class="sd">        proj_data : ProjectiveObject or ndarray</span>
</span><span id="Transformation-1159"><a href="#Transformation-1159"><span class="linenos">1159</span></a><span class="sd">            Data to use to construct a projective transformation (or</span>
</span><span id="Transformation-1160"><a href="#Transformation-1160"><span class="linenos">1160</span></a><span class="sd">            array of projective transformations).</span>
</span><span id="Transformation-1161"><a href="#Transformation-1161"><span class="linenos">1161</span></a><span class="sd">        column_vectors : bool</span>
</span><span id="Transformation-1162"><a href="#Transformation-1162"><span class="linenos">1162</span></a><span class="sd">            If `True`, interpret proj_data as a *column matrix* acting</span>
</span><span id="Transformation-1163"><a href="#Transformation-1163"><span class="linenos">1163</span></a><span class="sd">            on the left. Otherwise proj_data gives a *row matrix*.</span>
</span><span id="Transformation-1164"><a href="#Transformation-1164"><span class="linenos">1164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation-1165"><a href="#Transformation-1165"><span class="linenos">1165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Transformation-1166"><a href="#Transformation-1166"><span class="linenos">1166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Transformation-1167"><a href="#Transformation-1167"><span class="linenos">1167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Transformation-1168"><a href="#Transformation-1168"><span class="linenos">1168</span></a>
</span><span id="Transformation-1169"><a href="#Transformation-1169"><span class="linenos">1169</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Transformation-1170"><a href="#Transformation-1170"><span class="linenos">1170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation-1171"><a href="#Transformation-1171"><span class="linenos">1171</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Transformation-1172"><a href="#Transformation-1172"><span class="linenos">1172</span></a>            <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="Transformation-1173"><a href="#Transformation-1173"><span class="linenos">1173</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation-1174"><a href="#Transformation-1174"><span class="linenos">1174</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Transformation-1175"><a href="#Transformation-1175"><span class="linenos">1175</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation-1176"><a href="#Transformation-1176"><span class="linenos">1176</span></a>
</span><span id="Transformation-1177"><a href="#Transformation-1177"><span class="linenos">1177</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="Transformation-1178"><a href="#Transformation-1178"><span class="linenos">1178</span></a>        <span class="n">ProjectiveObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="Transformation-1179"><a href="#Transformation-1179"><span class="linenos">1179</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span>
</span><span id="Transformation-1180"><a href="#Transformation-1180"><span class="linenos">1180</span></a>            <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Transformation-1181"><a href="#Transformation-1181"><span class="linenos">1181</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Transformation-1182"><a href="#Transformation-1182"><span class="linenos">1182</span></a>                <span class="p">(</span><span class="s2">&quot;Projective transformation must be ndarray of n x n&quot;</span>
</span><span id="Transformation-1183"><a href="#Transformation-1183"><span class="linenos">1183</span></a>                 <span class="s2">&quot; matrices, got array with shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Transformation-1184"><a href="#Transformation-1184"><span class="linenos">1184</span></a>                     <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Transformation-1185"><a href="#Transformation-1185"><span class="linenos">1185</span></a>
</span><span id="Transformation-1186"><a href="#Transformation-1186"><span class="linenos">1186</span></a>    <span class="nd">@property</span>
</span><span id="Transformation-1187"><a href="#Transformation-1187"><span class="linenos">1187</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Transformation-1188"><a href="#Transformation-1188"><span class="linenos">1188</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Transformation-1189"><a href="#Transformation-1189"><span class="linenos">1189</span></a>
</span><span id="Transformation-1190"><a href="#Transformation-1190"><span class="linenos">1190</span></a>    <span class="k">def</span> <span class="nf">_apply_to_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dual</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Transformation-1191"><a href="#Transformation-1191"><span class="linenos">1191</span></a>        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix</span>
</span><span id="Transformation-1192"><a href="#Transformation-1192"><span class="linenos">1192</span></a>        <span class="k">if</span> <span class="n">dual</span><span class="p">:</span>
</span><span id="Transformation-1193"><a href="#Transformation-1193"><span class="linenos">1193</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Transformation-1194"><a href="#Transformation-1194"><span class="linenos">1194</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">matrix_product</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="Transformation-1195"><a href="#Transformation-1195"><span class="linenos">1195</span></a>                                    <span class="n">matrix</span><span class="p">,</span>
</span><span id="Transformation-1196"><a href="#Transformation-1196"><span class="linenos">1196</span></a>                                    <span class="n">unit_ndims</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="Transformation-1197"><a href="#Transformation-1197"><span class="linenos">1197</span></a>                                    <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">)</span>
</span><span id="Transformation-1198"><a href="#Transformation-1198"><span class="linenos">1198</span></a>
</span><span id="Transformation-1199"><a href="#Transformation-1199"><span class="linenos">1199</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">):</span>
</span><span id="Transformation-1200"><a href="#Transformation-1200"><span class="linenos">1200</span></a>        <span class="sd">&quot;&quot;&quot;Apply this transformation to another object in projective space.</span>
</span><span id="Transformation-1201"><a href="#Transformation-1201"><span class="linenos">1201</span></a>
</span><span id="Transformation-1202"><a href="#Transformation-1202"><span class="linenos">1202</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation-1203"><a href="#Transformation-1203"><span class="linenos">1203</span></a><span class="sd">        ----------</span>
</span><span id="Transformation-1204"><a href="#Transformation-1204"><span class="linenos">1204</span></a><span class="sd">        proj_obj : ProjectiveObject or ndarray</span>
</span><span id="Transformation-1205"><a href="#Transformation-1205"><span class="linenos">1205</span></a><span class="sd">            Projective object to apply this transformation to. This object</span>
</span><span id="Transformation-1206"><a href="#Transformation-1206"><span class="linenos">1206</span></a><span class="sd">            may be composite.</span>
</span><span id="Transformation-1207"><a href="#Transformation-1207"><span class="linenos">1207</span></a><span class="sd">        broadcast : string</span>
</span><span id="Transformation-1208"><a href="#Transformation-1208"><span class="linenos">1208</span></a><span class="sd">            Broadcasting behavior for applying composite</span>
</span><span id="Transformation-1209"><a href="#Transformation-1209"><span class="linenos">1209</span></a><span class="sd">            transformation objects. If &quot;elementwise&quot;, then the shape</span>
</span><span id="Transformation-1210"><a href="#Transformation-1210"><span class="linenos">1210</span></a><span class="sd">            of this (composite) transformation object and the shape of</span>
</span><span id="Transformation-1211"><a href="#Transformation-1211"><span class="linenos">1211</span></a><span class="sd">            the (composite) object to apply transformations to need to</span>
</span><span id="Transformation-1212"><a href="#Transformation-1212"><span class="linenos">1212</span></a><span class="sd">            be broadcastable. If &quot;pairwise&quot;, then apply every element</span>
</span><span id="Transformation-1213"><a href="#Transformation-1213"><span class="linenos">1213</span></a><span class="sd">            of this (composite) transformation object to every element</span>
</span><span id="Transformation-1214"><a href="#Transformation-1214"><span class="linenos">1214</span></a><span class="sd">            of the target object (i.e. take an outer product).</span>
</span><span id="Transformation-1215"><a href="#Transformation-1215"><span class="linenos">1215</span></a>
</span><span id="Transformation-1216"><a href="#Transformation-1216"><span class="linenos">1216</span></a><span class="sd">        Returns</span>
</span><span id="Transformation-1217"><a href="#Transformation-1217"><span class="linenos">1217</span></a><span class="sd">        -------</span>
</span><span id="Transformation-1218"><a href="#Transformation-1218"><span class="linenos">1218</span></a><span class="sd">        ProjectiveObject</span>
</span><span id="Transformation-1219"><a href="#Transformation-1219"><span class="linenos">1219</span></a><span class="sd">            Transformed (possibly composite) projective object. The</span>
</span><span id="Transformation-1220"><a href="#Transformation-1220"><span class="linenos">1220</span></a><span class="sd">            type of this object is the same type as the original</span>
</span><span id="Transformation-1221"><a href="#Transformation-1221"><span class="linenos">1221</span></a><span class="sd">            (untransformed) object. If the original object was</span>
</span><span id="Transformation-1222"><a href="#Transformation-1222"><span class="linenos">1222</span></a><span class="sd">            provided as an ndarray, then the returned object has type</span>
</span><span id="Transformation-1223"><a href="#Transformation-1223"><span class="linenos">1223</span></a><span class="sd">            ProjectiveObject.</span>
</span><span id="Transformation-1224"><a href="#Transformation-1224"><span class="linenos">1224</span></a>
</span><span id="Transformation-1225"><a href="#Transformation-1225"><span class="linenos">1225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation-1226"><a href="#Transformation-1226"><span class="linenos">1226</span></a>        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">proj_obj</span><span class="p">)</span>
</span><span id="Transformation-1227"><a href="#Transformation-1227"><span class="linenos">1227</span></a>
</span><span id="Transformation-1228"><a href="#Transformation-1228"><span class="linenos">1228</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Transformation-1229"><a href="#Transformation-1229"><span class="linenos">1229</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Transformation-1230"><a href="#Transformation-1230"><span class="linenos">1230</span></a>            <span class="n">proj_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Transformation-1231"><a href="#Transformation-1231"><span class="linenos">1231</span></a>            <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation-1232"><a href="#Transformation-1232"><span class="linenos">1232</span></a>                <span class="n">proj_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="Transformation-1233"><a href="#Transformation-1233"><span class="linenos">1233</span></a>                                                   <span class="n">new_obj</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">)</span>
</span><span id="Transformation-1234"><a href="#Transformation-1234"><span class="linenos">1234</span></a>
</span><span id="Transformation-1235"><a href="#Transformation-1235"><span class="linenos">1235</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="Transformation-1236"><a href="#Transformation-1236"><span class="linenos">1236</span></a>            <span class="n">aux_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Transformation-1237"><a href="#Transformation-1237"><span class="linenos">1237</span></a>            <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation-1238"><a href="#Transformation-1238"><span class="linenos">1238</span></a>                <span class="n">aux_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="Transformation-1239"><a href="#Transformation-1239"><span class="linenos">1239</span></a>                                                  <span class="n">new_obj</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">)</span>
</span><span id="Transformation-1240"><a href="#Transformation-1240"><span class="linenos">1240</span></a>
</span><span id="Transformation-1241"><a href="#Transformation-1241"><span class="linenos">1241</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">dual_data</span>
</span><span id="Transformation-1242"><a href="#Transformation-1242"><span class="linenos">1242</span></a>            <span class="n">dual_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Transformation-1243"><a href="#Transformation-1243"><span class="linenos">1243</span></a>            <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation-1244"><a href="#Transformation-1244"><span class="linenos">1244</span></a>                <span class="n">dual_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="Transformation-1245"><a href="#Transformation-1245"><span class="linenos">1245</span></a>                                                   <span class="n">new_obj</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="Transformation-1246"><a href="#Transformation-1246"><span class="linenos">1246</span></a>
</span><span id="Transformation-1247"><a href="#Transformation-1247"><span class="linenos">1247</span></a>            <span class="n">new_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="o">=</span><span class="n">proj_product</span><span class="p">,</span>
</span><span id="Transformation-1248"><a href="#Transformation-1248"><span class="linenos">1248</span></a>                        <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_product</span><span class="p">,</span>
</span><span id="Transformation-1249"><a href="#Transformation-1249"><span class="linenos">1249</span></a>                        <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_product</span><span class="p">)</span>
</span><span id="Transformation-1250"><a href="#Transformation-1250"><span class="linenos">1250</span></a>
</span><span id="Transformation-1251"><a href="#Transformation-1251"><span class="linenos">1251</span></a>            <span class="k">return</span> <span class="n">new_obj</span>
</span><span id="Transformation-1252"><a href="#Transformation-1252"><span class="linenos">1252</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="Transformation-1253"><a href="#Transformation-1253"><span class="linenos">1253</span></a>            <span class="k">pass</span>
</span><span id="Transformation-1254"><a href="#Transformation-1254"><span class="linenos">1254</span></a>
</span><span id="Transformation-1255"><a href="#Transformation-1255"><span class="linenos">1255</span></a>        <span class="c1">#otherwise, it&#39;s an array of vectors which we&#39;ll interpret as</span>
</span><span id="Transformation-1256"><a href="#Transformation-1256"><span class="linenos">1256</span></a>        <span class="c1">#some kind of hyperbolic object</span>
</span><span id="Transformation-1257"><a href="#Transformation-1257"><span class="linenos">1257</span></a>        <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">proj_obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">)</span>
</span><span id="Transformation-1258"><a href="#Transformation-1258"><span class="linenos">1258</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_to_object</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span><span id="Transformation-1259"><a href="#Transformation-1259"><span class="linenos">1259</span></a>
</span><span id="Transformation-1260"><a href="#Transformation-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="nf">eigenvector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Transformation-1261"><a href="#Transformation-1261"><span class="linenos">1261</span></a>        <span class="sd">&quot;&quot;&quot;Get a point corresponding to an eigenvector with the given</span>
</span><span id="Transformation-1262"><a href="#Transformation-1262"><span class="linenos">1262</span></a><span class="sd">        eigenvalue.</span>
</span><span id="Transformation-1263"><a href="#Transformation-1263"><span class="linenos">1263</span></a>
</span><span id="Transformation-1264"><a href="#Transformation-1264"><span class="linenos">1264</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation-1265"><a href="#Transformation-1265"><span class="linenos">1265</span></a><span class="sd">        ----------</span>
</span><span id="Transformation-1266"><a href="#Transformation-1266"><span class="linenos">1266</span></a><span class="sd">        eigenvalue : float</span>
</span><span id="Transformation-1267"><a href="#Transformation-1267"><span class="linenos">1267</span></a><span class="sd">            Eigenvalue for the returned eigenvector. If None, return</span>
</span><span id="Transformation-1268"><a href="#Transformation-1268"><span class="linenos">1268</span></a><span class="sd">            an arbitrary eigenvector.</span>
</span><span id="Transformation-1269"><a href="#Transformation-1269"><span class="linenos">1269</span></a>
</span><span id="Transformation-1270"><a href="#Transformation-1270"><span class="linenos">1270</span></a><span class="sd">        Returns</span>
</span><span id="Transformation-1271"><a href="#Transformation-1271"><span class="linenos">1271</span></a><span class="sd">        -------</span>
</span><span id="Transformation-1272"><a href="#Transformation-1272"><span class="linenos">1272</span></a><span class="sd">        Point</span>
</span><span id="Transformation-1273"><a href="#Transformation-1273"><span class="linenos">1273</span></a><span class="sd">            Point object in projective space giving an eigenvector for</span>
</span><span id="Transformation-1274"><a href="#Transformation-1274"><span class="linenos">1274</span></a><span class="sd">            the given eigenvalue. The projective coordinates of this</span>
</span><span id="Transformation-1275"><a href="#Transformation-1275"><span class="linenos">1275</span></a><span class="sd">            point will be degenerate (i.e. zero) if no nonzero</span>
</span><span id="Transformation-1276"><a href="#Transformation-1276"><span class="linenos">1276</span></a><span class="sd">            eigenvector with this eigenvalue exists.</span>
</span><span id="Transformation-1277"><a href="#Transformation-1277"><span class="linenos">1277</span></a>
</span><span id="Transformation-1278"><a href="#Transformation-1278"><span class="linenos">1278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation-1279"><a href="#Transformation-1279"><span class="linenos">1279</span></a>        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Transformation-1280"><a href="#Transformation-1280"><span class="linenos">1280</span></a>        <span class="n">eigvec_coords</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Transformation-1281"><a href="#Transformation-1281"><span class="linenos">1281</span></a>
</span><span id="Transformation-1282"><a href="#Transformation-1282"><span class="linenos">1282</span></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span>
</span><span id="Transformation-1283"><a href="#Transformation-1283"><span class="linenos">1283</span></a>        <span class="k">if</span> <span class="n">eigenvalue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation-1284"><a href="#Transformation-1284"><span class="linenos">1284</span></a>            <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">eigvals</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="p">)</span>
</span><span id="Transformation-1285"><a href="#Transformation-1285"><span class="linenos">1285</span></a>
</span><span id="Transformation-1286"><a href="#Transformation-1286"><span class="linenos">1286</span></a>        <span class="n">where_ic</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
</span><span id="Transformation-1287"><a href="#Transformation-1287"><span class="linenos">1287</span></a>
</span><span id="Transformation-1288"><a href="#Transformation-1288"><span class="linenos">1288</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">where_ic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Transformation-1289"><a href="#Transformation-1289"><span class="linenos">1289</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">where_ic</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Transformation-1290"><a href="#Transformation-1290"><span class="linenos">1290</span></a>                <span class="n">eigvec_coords</span> <span class="o">=</span> <span class="p">(</span><span class="n">eigvecs</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="n">where_ic</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Transformation-1291"><a href="#Transformation-1291"><span class="linenos">1291</span></a>                <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">eigvec_coords</span><span class="p">)</span>
</span><span id="Transformation-1292"><a href="#Transformation-1292"><span class="linenos">1292</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Transformation-1293"><a href="#Transformation-1293"><span class="linenos">1293</span></a>                <span class="p">(</span><span class="s2">&quot;Transformation does not have </span><span class="si">{}</span><span class="s2"> as an approximate eigenvalue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Transformation-1294"><a href="#Transformation-1294"><span class="linenos">1294</span></a>                    <span class="n">eigenvalue</span><span class="p">)</span>
</span><span id="Transformation-1295"><a href="#Transformation-1295"><span class="linenos">1295</span></a>            <span class="p">)</span>
</span><span id="Transformation-1296"><a href="#Transformation-1296"><span class="linenos">1296</span></a>
</span><span id="Transformation-1297"><a href="#Transformation-1297"><span class="linenos">1297</span></a>        <span class="n">unind</span><span class="p">,</span> <span class="n">indind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">where_ic</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="Transformation-1298"><a href="#Transformation-1298"><span class="linenos">1298</span></a>                                  <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Transformation-1299"><a href="#Transformation-1299"><span class="linenos">1299</span></a>
</span><span id="Transformation-1300"><a href="#Transformation-1300"><span class="linenos">1300</span></a>        <span class="n">eigvec_coords</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="n">unind</span><span class="o">.</span><span class="n">T</span><span class="p">])]</span> <span class="o">=</span> <span class="n">eigvecs</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)[</span>
</span><span id="Transformation-1301"><a href="#Transformation-1301"><span class="linenos">1301</span></a>            <span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">where_ic</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="n">indind</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
</span><span id="Transformation-1302"><a href="#Transformation-1302"><span class="linenos">1302</span></a>        <span class="p">]</span>
</span><span id="Transformation-1303"><a href="#Transformation-1303"><span class="linenos">1303</span></a>
</span><span id="Transformation-1304"><a href="#Transformation-1304"><span class="linenos">1304</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">eigvec_coords</span><span class="p">)</span>
</span><span id="Transformation-1305"><a href="#Transformation-1305"><span class="linenos">1305</span></a>
</span><span id="Transformation-1306"><a href="#Transformation-1306"><span class="linenos">1306</span></a>    <span class="k">def</span> <span class="nf">commute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
</span><span id="Transformation-1307"><a href="#Transformation-1307"><span class="linenos">1307</span></a>
</span><span id="Transformation-1308"><a href="#Transformation-1308"><span class="linenos">1308</span></a>        <span class="n">s_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Transformation-1309"><a href="#Transformation-1309"><span class="linenos">1309</span></a>        <span class="n">o_inv</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Transformation-1310"><a href="#Transformation-1310"><span class="linenos">1310</span></a>
</span><span id="Transformation-1311"><a href="#Transformation-1311"><span class="linenos">1311</span></a>        <span class="k">if</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
</span><span id="Transformation-1312"><a href="#Transformation-1312"><span class="linenos">1312</span></a>            <span class="n">slen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Transformation-1313"><a href="#Transformation-1313"><span class="linenos">1313</span></a>            <span class="n">olen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">o_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Transformation-1314"><a href="#Transformation-1314"><span class="linenos">1314</span></a>            <span class="n">s_inv</span> <span class="o">=</span> <span class="n">s_inv</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s_inv</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">olen</span><span class="p">)</span>
</span><span id="Transformation-1315"><a href="#Transformation-1315"><span class="linenos">1315</span></a>            <span class="n">o_inv</span> <span class="o">=</span> <span class="n">o_inv</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">slen</span> <span class="o">+</span> <span class="n">o_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Transformation-1316"><a href="#Transformation-1316"><span class="linenos">1316</span></a>
</span><span id="Transformation-1317"><a href="#Transformation-1317"><span class="linenos">1317</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">)</span>
</span><span id="Transformation-1318"><a href="#Transformation-1318"><span class="linenos">1318</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="n">commutator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">s_inv</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="Transformation-1319"><a href="#Transformation-1319"><span class="linenos">1319</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="n">commutator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">o_inv</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="Transformation-1320"><a href="#Transformation-1320"><span class="linenos">1320</span></a>
</span><span id="Transformation-1321"><a href="#Transformation-1321"><span class="linenos">1321</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
</span><span id="Transformation-1322"><a href="#Transformation-1322"><span class="linenos">1322</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">commutator</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="Transformation-1323"><a href="#Transformation-1323"><span class="linenos">1323</span></a>                       <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="Transformation-1324"><a href="#Transformation-1324"><span class="linenos">1324</span></a>                       <span class="n">atol</span><span class="o">=</span><span class="n">tol</span><span class="p">),</span>
</span><span id="Transformation-1325"><a href="#Transformation-1325"><span class="linenos">1325</span></a>            <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Transformation-1326"><a href="#Transformation-1326"><span class="linenos">1326</span></a>        <span class="p">)</span>
</span><span id="Transformation-1327"><a href="#Transformation-1327"><span class="linenos">1327</span></a>
</span><span id="Transformation-1328"><a href="#Transformation-1328"><span class="linenos">1328</span></a>
</span><span id="Transformation-1329"><a href="#Transformation-1329"><span class="linenos">1329</span></a>
</span><span id="Transformation-1330"><a href="#Transformation-1330"><span class="linenos">1330</span></a>    <span class="k">def</span> <span class="nf">diagonalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_inv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Transformation-1331"><a href="#Transformation-1331"><span class="linenos">1331</span></a>        <span class="sd">&quot;&quot;&quot;Get a matrix diagonalizing this projective transformation.</span>
</span><span id="Transformation-1332"><a href="#Transformation-1332"><span class="linenos">1332</span></a>
</span><span id="Transformation-1333"><a href="#Transformation-1333"><span class="linenos">1333</span></a><span class="sd">        If self is a diagonalizable transformation, this function</span>
</span><span id="Transformation-1334"><a href="#Transformation-1334"><span class="linenos">1334</span></a><span class="sd">        returns a Transformation object representing a projective</span>
</span><span id="Transformation-1335"><a href="#Transformation-1335"><span class="linenos">1335</span></a><span class="sd">        transformation M such that M.inv() @ (self) @ M is diagonal.</span>
</span><span id="Transformation-1336"><a href="#Transformation-1336"><span class="linenos">1336</span></a>
</span><span id="Transformation-1337"><a href="#Transformation-1337"><span class="linenos">1337</span></a><span class="sd">        No claims are made about the behavior of this function if M is</span>
</span><span id="Transformation-1338"><a href="#Transformation-1338"><span class="linenos">1338</span></a><span class="sd">        not diagonalizable. The function may throw an error, or it may</span>
</span><span id="Transformation-1339"><a href="#Transformation-1339"><span class="linenos">1339</span></a><span class="sd">        return nonsense - no effort has been made on this front.</span>
</span><span id="Transformation-1340"><a href="#Transformation-1340"><span class="linenos">1340</span></a>
</span><span id="Transformation-1341"><a href="#Transformation-1341"><span class="linenos">1341</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation-1342"><a href="#Transformation-1342"><span class="linenos">1342</span></a><span class="sd">        ----------</span>
</span><span id="Transformation-1343"><a href="#Transformation-1343"><span class="linenos">1343</span></a><span class="sd">        return_inv : bool</span>
</span><span id="Transformation-1344"><a href="#Transformation-1344"><span class="linenos">1344</span></a><span class="sd">            If True, return a pair of Transformations, giving M and</span>
</span><span id="Transformation-1345"><a href="#Transformation-1345"><span class="linenos">1345</span></a><span class="sd">            M.inv(). Otherwise, just return M.</span>
</span><span id="Transformation-1346"><a href="#Transformation-1346"><span class="linenos">1346</span></a>
</span><span id="Transformation-1347"><a href="#Transformation-1347"><span class="linenos">1347</span></a><span class="sd">        Returns</span>
</span><span id="Transformation-1348"><a href="#Transformation-1348"><span class="linenos">1348</span></a><span class="sd">        -------</span>
</span><span id="Transformation-1349"><a href="#Transformation-1349"><span class="linenos">1349</span></a><span class="sd">        Transformation</span>
</span><span id="Transformation-1350"><a href="#Transformation-1350"><span class="linenos">1350</span></a><span class="sd">            Projective transformation M diagonalizing this</span>
</span><span id="Transformation-1351"><a href="#Transformation-1351"><span class="linenos">1351</span></a><span class="sd">            transformation.</span>
</span><span id="Transformation-1352"><a href="#Transformation-1352"><span class="linenos">1352</span></a>
</span><span id="Transformation-1353"><a href="#Transformation-1353"><span class="linenos">1353</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation-1354"><a href="#Transformation-1354"><span class="linenos">1354</span></a>
</span><span id="Transformation-1355"><a href="#Transformation-1355"><span class="linenos">1355</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">conj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="Transformation-1356"><a href="#Transformation-1356"><span class="linenos">1356</span></a>                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation-1357"><a href="#Transformation-1357"><span class="linenos">1357</span></a>
</span><span id="Transformation-1358"><a href="#Transformation-1358"><span class="linenos">1358</span></a>        <span class="n">conj_transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">conj</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Transformation-1359"><a href="#Transformation-1359"><span class="linenos">1359</span></a>
</span><span id="Transformation-1360"><a href="#Transformation-1360"><span class="linenos">1360</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_inv</span><span class="p">:</span>
</span><span id="Transformation-1361"><a href="#Transformation-1361"><span class="linenos">1361</span></a>            <span class="k">return</span> <span class="n">conj_transform</span>
</span><span id="Transformation-1362"><a href="#Transformation-1362"><span class="linenos">1362</span></a>
</span><span id="Transformation-1363"><a href="#Transformation-1363"><span class="linenos">1363</span></a>        <span class="k">return</span> <span class="n">conj_transform</span><span class="p">,</span> <span class="n">conj_transform</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Transformation-1364"><a href="#Transformation-1364"><span class="linenos">1364</span></a>
</span><span id="Transformation-1365"><a href="#Transformation-1365"><span class="linenos">1365</span></a>    <span class="k">def</span> <span class="nf">_data_to_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Transformation-1366"><a href="#Transformation-1366"><span class="linenos">1366</span></a>        <span class="k">return</span> <span class="n">ProjectiveObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Transformation-1367"><a href="#Transformation-1367"><span class="linenos">1367</span></a>
</span><span id="Transformation-1368"><a href="#Transformation-1368"><span class="linenos">1368</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Transformation-1369"><a href="#Transformation-1369"><span class="linenos">1369</span></a>        <span class="sd">&quot;&quot;&quot;Get the inverse of this transformation.</span>
</span><span id="Transformation-1370"><a href="#Transformation-1370"><span class="linenos">1370</span></a>
</span><span id="Transformation-1371"><a href="#Transformation-1371"><span class="linenos">1371</span></a><span class="sd">        Returns</span>
</span><span id="Transformation-1372"><a href="#Transformation-1372"><span class="linenos">1372</span></a><span class="sd">        -------</span>
</span><span id="Transformation-1373"><a href="#Transformation-1373"><span class="linenos">1373</span></a><span class="sd">        ProjectiveTransformation</span>
</span><span id="Transformation-1374"><a href="#Transformation-1374"><span class="linenos">1374</span></a><span class="sd">            Inverse of this transformation.</span>
</span><span id="Transformation-1375"><a href="#Transformation-1375"><span class="linenos">1375</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation-1376"><a href="#Transformation-1376"><span class="linenos">1376</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">))</span>
</span><span id="Transformation-1377"><a href="#Transformation-1377"><span class="linenos">1377</span></a>
</span><span id="Transformation-1378"><a href="#Transformation-1378"><span class="linenos">1378</span></a>    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Transformation-1379"><a href="#Transformation-1379"><span class="linenos">1379</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A projective transformation (or a composite object consisting of a
collection of projective transformations).</p>
</div>


                            <div id="Transformation.__init__" class="classattr">
                                        <input id="Transformation.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Transformation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">proj_data</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Transformation.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.__init__-1151"><a href="#Transformation.__init__-1151"><span class="linenos">1151</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Transformation.__init__-1152"><a href="#Transformation.__init__-1152"><span class="linenos">1152</span></a>        <span class="sd">&quot;&quot;&quot;By default, the underlying data for a projective</span>
</span><span id="Transformation.__init__-1153"><a href="#Transformation.__init__-1153"><span class="linenos">1153</span></a><span class="sd">        transformation is a *row matrix* (or an ndarray of row</span>
</span><span id="Transformation.__init__-1154"><a href="#Transformation.__init__-1154"><span class="linenos">1154</span></a><span class="sd">        matrices), acting on vectors on the *right*.</span>
</span><span id="Transformation.__init__-1155"><a href="#Transformation.__init__-1155"><span class="linenos">1155</span></a>
</span><span id="Transformation.__init__-1156"><a href="#Transformation.__init__-1156"><span class="linenos">1156</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation.__init__-1157"><a href="#Transformation.__init__-1157"><span class="linenos">1157</span></a><span class="sd">        ----------</span>
</span><span id="Transformation.__init__-1158"><a href="#Transformation.__init__-1158"><span class="linenos">1158</span></a><span class="sd">        proj_data : ProjectiveObject or ndarray</span>
</span><span id="Transformation.__init__-1159"><a href="#Transformation.__init__-1159"><span class="linenos">1159</span></a><span class="sd">            Data to use to construct a projective transformation (or</span>
</span><span id="Transformation.__init__-1160"><a href="#Transformation.__init__-1160"><span class="linenos">1160</span></a><span class="sd">            array of projective transformations).</span>
</span><span id="Transformation.__init__-1161"><a href="#Transformation.__init__-1161"><span class="linenos">1161</span></a><span class="sd">        column_vectors : bool</span>
</span><span id="Transformation.__init__-1162"><a href="#Transformation.__init__-1162"><span class="linenos">1162</span></a><span class="sd">            If `True`, interpret proj_data as a *column matrix* acting</span>
</span><span id="Transformation.__init__-1163"><a href="#Transformation.__init__-1163"><span class="linenos">1163</span></a><span class="sd">            on the left. Otherwise proj_data gives a *row matrix*.</span>
</span><span id="Transformation.__init__-1164"><a href="#Transformation.__init__-1164"><span class="linenos">1164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation.__init__-1165"><a href="#Transformation.__init__-1165"><span class="linenos">1165</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Transformation.__init__-1166"><a href="#Transformation.__init__-1166"><span class="linenos">1166</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Transformation.__init__-1167"><a href="#Transformation.__init__-1167"><span class="linenos">1167</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Transformation.__init__-1168"><a href="#Transformation.__init__-1168"><span class="linenos">1168</span></a>
</span><span id="Transformation.__init__-1169"><a href="#Transformation.__init__-1169"><span class="linenos">1169</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Transformation.__init__-1170"><a href="#Transformation.__init__-1170"><span class="linenos">1170</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation.__init__-1171"><a href="#Transformation.__init__-1171"><span class="linenos">1171</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Transformation.__init__-1172"><a href="#Transformation.__init__-1172"><span class="linenos">1172</span></a>            <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="Transformation.__init__-1173"><a href="#Transformation.__init__-1173"><span class="linenos">1173</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation.__init__-1174"><a href="#Transformation.__init__-1174"><span class="linenos">1174</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Transformation.__init__-1175"><a href="#Transformation.__init__-1175"><span class="linenos">1175</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>By default, the underlying data for a projective
transformation is a <em>row matrix</em> (or an ndarray of row
matrices), acting on vectors on the <em>right</em>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ProjectiveObject or ndarray):
Data to use to construct a projective transformation (or
array of projective transformations).</li>
<li><strong>column_vectors</strong> (bool):
If <code>True</code>, interpret proj_data as a <em>column matrix</em> acting
on the left. Otherwise proj_data gives a <em>row matrix</em>.</li>
</ul>
</div>


                            </div>
                            <div id="Transformation.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#Transformation.unit_ndims"></a>
    
    

                            </div>
                            <div id="Transformation.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#Transformation.aux_ndims"></a>
    
    

                            </div>
                            <div id="Transformation.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#Transformation.dual_ndims"></a>
    
    

                            </div>
                            <div id="Transformation.matrix" class="classattr">
                                        <input id="Transformation.matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">matrix</span>

                <label class="view-source-button" for="Transformation.matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.matrix-1186"><a href="#Transformation.matrix-1186"><span class="linenos">1186</span></a>    <span class="nd">@property</span>
</span><span id="Transformation.matrix-1187"><a href="#Transformation.matrix-1187"><span class="linenos">1187</span></a>    <span class="k">def</span> <span class="nf">matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Transformation.matrix-1188"><a href="#Transformation.matrix-1188"><span class="linenos">1188</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span></pre></div>


    

                            </div>
                            <div id="Transformation.apply" class="classattr">
                                        <input id="Transformation.apply-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">apply</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_obj</span>, </span><span class="param"><span class="n">broadcast</span><span class="o">=</span><span class="s1">&#39;elementwise&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Transformation.apply-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.apply"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.apply-1199"><a href="#Transformation.apply-1199"><span class="linenos">1199</span></a>    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">):</span>
</span><span id="Transformation.apply-1200"><a href="#Transformation.apply-1200"><span class="linenos">1200</span></a>        <span class="sd">&quot;&quot;&quot;Apply this transformation to another object in projective space.</span>
</span><span id="Transformation.apply-1201"><a href="#Transformation.apply-1201"><span class="linenos">1201</span></a>
</span><span id="Transformation.apply-1202"><a href="#Transformation.apply-1202"><span class="linenos">1202</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation.apply-1203"><a href="#Transformation.apply-1203"><span class="linenos">1203</span></a><span class="sd">        ----------</span>
</span><span id="Transformation.apply-1204"><a href="#Transformation.apply-1204"><span class="linenos">1204</span></a><span class="sd">        proj_obj : ProjectiveObject or ndarray</span>
</span><span id="Transformation.apply-1205"><a href="#Transformation.apply-1205"><span class="linenos">1205</span></a><span class="sd">            Projective object to apply this transformation to. This object</span>
</span><span id="Transformation.apply-1206"><a href="#Transformation.apply-1206"><span class="linenos">1206</span></a><span class="sd">            may be composite.</span>
</span><span id="Transformation.apply-1207"><a href="#Transformation.apply-1207"><span class="linenos">1207</span></a><span class="sd">        broadcast : string</span>
</span><span id="Transformation.apply-1208"><a href="#Transformation.apply-1208"><span class="linenos">1208</span></a><span class="sd">            Broadcasting behavior for applying composite</span>
</span><span id="Transformation.apply-1209"><a href="#Transformation.apply-1209"><span class="linenos">1209</span></a><span class="sd">            transformation objects. If &quot;elementwise&quot;, then the shape</span>
</span><span id="Transformation.apply-1210"><a href="#Transformation.apply-1210"><span class="linenos">1210</span></a><span class="sd">            of this (composite) transformation object and the shape of</span>
</span><span id="Transformation.apply-1211"><a href="#Transformation.apply-1211"><span class="linenos">1211</span></a><span class="sd">            the (composite) object to apply transformations to need to</span>
</span><span id="Transformation.apply-1212"><a href="#Transformation.apply-1212"><span class="linenos">1212</span></a><span class="sd">            be broadcastable. If &quot;pairwise&quot;, then apply every element</span>
</span><span id="Transformation.apply-1213"><a href="#Transformation.apply-1213"><span class="linenos">1213</span></a><span class="sd">            of this (composite) transformation object to every element</span>
</span><span id="Transformation.apply-1214"><a href="#Transformation.apply-1214"><span class="linenos">1214</span></a><span class="sd">            of the target object (i.e. take an outer product).</span>
</span><span id="Transformation.apply-1215"><a href="#Transformation.apply-1215"><span class="linenos">1215</span></a>
</span><span id="Transformation.apply-1216"><a href="#Transformation.apply-1216"><span class="linenos">1216</span></a><span class="sd">        Returns</span>
</span><span id="Transformation.apply-1217"><a href="#Transformation.apply-1217"><span class="linenos">1217</span></a><span class="sd">        -------</span>
</span><span id="Transformation.apply-1218"><a href="#Transformation.apply-1218"><span class="linenos">1218</span></a><span class="sd">        ProjectiveObject</span>
</span><span id="Transformation.apply-1219"><a href="#Transformation.apply-1219"><span class="linenos">1219</span></a><span class="sd">            Transformed (possibly composite) projective object. The</span>
</span><span id="Transformation.apply-1220"><a href="#Transformation.apply-1220"><span class="linenos">1220</span></a><span class="sd">            type of this object is the same type as the original</span>
</span><span id="Transformation.apply-1221"><a href="#Transformation.apply-1221"><span class="linenos">1221</span></a><span class="sd">            (untransformed) object. If the original object was</span>
</span><span id="Transformation.apply-1222"><a href="#Transformation.apply-1222"><span class="linenos">1222</span></a><span class="sd">            provided as an ndarray, then the returned object has type</span>
</span><span id="Transformation.apply-1223"><a href="#Transformation.apply-1223"><span class="linenos">1223</span></a><span class="sd">            ProjectiveObject.</span>
</span><span id="Transformation.apply-1224"><a href="#Transformation.apply-1224"><span class="linenos">1224</span></a>
</span><span id="Transformation.apply-1225"><a href="#Transformation.apply-1225"><span class="linenos">1225</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation.apply-1226"><a href="#Transformation.apply-1226"><span class="linenos">1226</span></a>        <span class="n">new_obj</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">proj_obj</span><span class="p">)</span>
</span><span id="Transformation.apply-1227"><a href="#Transformation.apply-1227"><span class="linenos">1227</span></a>
</span><span id="Transformation.apply-1228"><a href="#Transformation.apply-1228"><span class="linenos">1228</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Transformation.apply-1229"><a href="#Transformation.apply-1229"><span class="linenos">1229</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Transformation.apply-1230"><a href="#Transformation.apply-1230"><span class="linenos">1230</span></a>            <span class="n">proj_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Transformation.apply-1231"><a href="#Transformation.apply-1231"><span class="linenos">1231</span></a>            <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation.apply-1232"><a href="#Transformation.apply-1232"><span class="linenos">1232</span></a>                <span class="n">proj_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="Transformation.apply-1233"><a href="#Transformation.apply-1233"><span class="linenos">1233</span></a>                                                   <span class="n">new_obj</span><span class="o">.</span><span class="n">unit_ndims</span><span class="p">)</span>
</span><span id="Transformation.apply-1234"><a href="#Transformation.apply-1234"><span class="linenos">1234</span></a>
</span><span id="Transformation.apply-1235"><a href="#Transformation.apply-1235"><span class="linenos">1235</span></a>            <span class="n">aux_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="Transformation.apply-1236"><a href="#Transformation.apply-1236"><span class="linenos">1236</span></a>            <span class="n">aux_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Transformation.apply-1237"><a href="#Transformation.apply-1237"><span class="linenos">1237</span></a>            <span class="k">if</span> <span class="n">aux_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation.apply-1238"><a href="#Transformation.apply-1238"><span class="linenos">1238</span></a>                <span class="n">aux_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="Transformation.apply-1239"><a href="#Transformation.apply-1239"><span class="linenos">1239</span></a>                                                  <span class="n">new_obj</span><span class="o">.</span><span class="n">aux_ndims</span><span class="p">)</span>
</span><span id="Transformation.apply-1240"><a href="#Transformation.apply-1240"><span class="linenos">1240</span></a>
</span><span id="Transformation.apply-1241"><a href="#Transformation.apply-1241"><span class="linenos">1241</span></a>            <span class="n">dual_data</span> <span class="o">=</span> <span class="n">new_obj</span><span class="o">.</span><span class="n">dual_data</span>
</span><span id="Transformation.apply-1242"><a href="#Transformation.apply-1242"><span class="linenos">1242</span></a>            <span class="n">dual_product</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Transformation.apply-1243"><a href="#Transformation.apply-1243"><span class="linenos">1243</span></a>            <span class="k">if</span> <span class="n">dual_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation.apply-1244"><a href="#Transformation.apply-1244"><span class="linenos">1244</span></a>                <span class="n">dual_product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">new_obj</span><span class="o">.</span><span class="n">dual_data</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">,</span>
</span><span id="Transformation.apply-1245"><a href="#Transformation.apply-1245"><span class="linenos">1245</span></a>                                                   <span class="n">new_obj</span><span class="o">.</span><span class="n">dual_ndims</span><span class="p">)</span>
</span><span id="Transformation.apply-1246"><a href="#Transformation.apply-1246"><span class="linenos">1246</span></a>
</span><span id="Transformation.apply-1247"><a href="#Transformation.apply-1247"><span class="linenos">1247</span></a>            <span class="n">new_obj</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="o">=</span><span class="n">proj_product</span><span class="p">,</span>
</span><span id="Transformation.apply-1248"><a href="#Transformation.apply-1248"><span class="linenos">1248</span></a>                        <span class="n">aux_data</span><span class="o">=</span><span class="n">aux_product</span><span class="p">,</span>
</span><span id="Transformation.apply-1249"><a href="#Transformation.apply-1249"><span class="linenos">1249</span></a>                        <span class="n">dual_data</span><span class="o">=</span><span class="n">dual_product</span><span class="p">)</span>
</span><span id="Transformation.apply-1250"><a href="#Transformation.apply-1250"><span class="linenos">1250</span></a>
</span><span id="Transformation.apply-1251"><a href="#Transformation.apply-1251"><span class="linenos">1251</span></a>            <span class="k">return</span> <span class="n">new_obj</span>
</span><span id="Transformation.apply-1252"><a href="#Transformation.apply-1252"><span class="linenos">1252</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="Transformation.apply-1253"><a href="#Transformation.apply-1253"><span class="linenos">1253</span></a>            <span class="k">pass</span>
</span><span id="Transformation.apply-1254"><a href="#Transformation.apply-1254"><span class="linenos">1254</span></a>
</span><span id="Transformation.apply-1255"><a href="#Transformation.apply-1255"><span class="linenos">1255</span></a>        <span class="c1">#otherwise, it&#39;s an array of vectors which we&#39;ll interpret as</span>
</span><span id="Transformation.apply-1256"><a href="#Transformation.apply-1256"><span class="linenos">1256</span></a>        <span class="c1">#some kind of hyperbolic object</span>
</span><span id="Transformation.apply-1257"><a href="#Transformation.apply-1257"><span class="linenos">1257</span></a>        <span class="n">product</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_to_data</span><span class="p">(</span><span class="n">proj_obj</span><span class="p">,</span> <span class="n">broadcast</span><span class="p">)</span>
</span><span id="Transformation.apply-1258"><a href="#Transformation.apply-1258"><span class="linenos">1258</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_to_object</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Apply this transformation to another object in projective space.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_obj</strong> (ProjectiveObject or ndarray):
Projective object to apply this transformation to. This object
may be composite.</li>
<li><strong>broadcast</strong> (string):
Broadcasting behavior for applying composite
transformation objects. If "elementwise", then the shape
of this (composite) transformation object and the shape of
the (composite) object to apply transformations to need to
be broadcastable. If "pairwise", then apply every element
of this (composite) transformation object to every element
of the target object (i.e. take an outer product).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ProjectiveObject</strong>: Transformed (possibly composite) projective object. The
type of this object is the same type as the original
(untransformed) object. If the original object was
provided as an ndarray, then the returned object has type
ProjectiveObject.</li>
</ul>
</div>


                            </div>
                            <div id="Transformation.eigenvector" class="classattr">
                                        <input id="Transformation.eigenvector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">eigenvector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">eigenvalue</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Transformation.eigenvector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.eigenvector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.eigenvector-1260"><a href="#Transformation.eigenvector-1260"><span class="linenos">1260</span></a>    <span class="k">def</span> <span class="nf">eigenvector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Transformation.eigenvector-1261"><a href="#Transformation.eigenvector-1261"><span class="linenos">1261</span></a>        <span class="sd">&quot;&quot;&quot;Get a point corresponding to an eigenvector with the given</span>
</span><span id="Transformation.eigenvector-1262"><a href="#Transformation.eigenvector-1262"><span class="linenos">1262</span></a><span class="sd">        eigenvalue.</span>
</span><span id="Transformation.eigenvector-1263"><a href="#Transformation.eigenvector-1263"><span class="linenos">1263</span></a>
</span><span id="Transformation.eigenvector-1264"><a href="#Transformation.eigenvector-1264"><span class="linenos">1264</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation.eigenvector-1265"><a href="#Transformation.eigenvector-1265"><span class="linenos">1265</span></a><span class="sd">        ----------</span>
</span><span id="Transformation.eigenvector-1266"><a href="#Transformation.eigenvector-1266"><span class="linenos">1266</span></a><span class="sd">        eigenvalue : float</span>
</span><span id="Transformation.eigenvector-1267"><a href="#Transformation.eigenvector-1267"><span class="linenos">1267</span></a><span class="sd">            Eigenvalue for the returned eigenvector. If None, return</span>
</span><span id="Transformation.eigenvector-1268"><a href="#Transformation.eigenvector-1268"><span class="linenos">1268</span></a><span class="sd">            an arbitrary eigenvector.</span>
</span><span id="Transformation.eigenvector-1269"><a href="#Transformation.eigenvector-1269"><span class="linenos">1269</span></a>
</span><span id="Transformation.eigenvector-1270"><a href="#Transformation.eigenvector-1270"><span class="linenos">1270</span></a><span class="sd">        Returns</span>
</span><span id="Transformation.eigenvector-1271"><a href="#Transformation.eigenvector-1271"><span class="linenos">1271</span></a><span class="sd">        -------</span>
</span><span id="Transformation.eigenvector-1272"><a href="#Transformation.eigenvector-1272"><span class="linenos">1272</span></a><span class="sd">        Point</span>
</span><span id="Transformation.eigenvector-1273"><a href="#Transformation.eigenvector-1273"><span class="linenos">1273</span></a><span class="sd">            Point object in projective space giving an eigenvector for</span>
</span><span id="Transformation.eigenvector-1274"><a href="#Transformation.eigenvector-1274"><span class="linenos">1274</span></a><span class="sd">            the given eigenvalue. The projective coordinates of this</span>
</span><span id="Transformation.eigenvector-1275"><a href="#Transformation.eigenvector-1275"><span class="linenos">1275</span></a><span class="sd">            point will be degenerate (i.e. zero) if no nonzero</span>
</span><span id="Transformation.eigenvector-1276"><a href="#Transformation.eigenvector-1276"><span class="linenos">1276</span></a><span class="sd">            eigenvector with this eigenvalue exists.</span>
</span><span id="Transformation.eigenvector-1277"><a href="#Transformation.eigenvector-1277"><span class="linenos">1277</span></a>
</span><span id="Transformation.eigenvector-1278"><a href="#Transformation.eigenvector-1278"><span class="linenos">1278</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation.eigenvector-1279"><a href="#Transformation.eigenvector-1279"><span class="linenos">1279</span></a>        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Transformation.eigenvector-1280"><a href="#Transformation.eigenvector-1280"><span class="linenos">1280</span></a>        <span class="n">eigvec_coords</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Transformation.eigenvector-1281"><a href="#Transformation.eigenvector-1281"><span class="linenos">1281</span></a>
</span><span id="Transformation.eigenvector-1282"><a href="#Transformation.eigenvector-1282"><span class="linenos">1282</span></a>        <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)</span>
</span><span id="Transformation.eigenvector-1283"><a href="#Transformation.eigenvector-1283"><span class="linenos">1283</span></a>        <span class="k">if</span> <span class="n">eigenvalue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Transformation.eigenvector-1284"><a href="#Transformation.eigenvector-1284"><span class="linenos">1284</span></a>            <span class="n">ic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">eigvals</span><span class="p">,</span> <span class="n">eigenvalue</span><span class="p">)</span>
</span><span id="Transformation.eigenvector-1285"><a href="#Transformation.eigenvector-1285"><span class="linenos">1285</span></a>
</span><span id="Transformation.eigenvector-1286"><a href="#Transformation.eigenvector-1286"><span class="linenos">1286</span></a>        <span class="n">where_ic</span> <span class="o">=</span> <span class="n">ic</span><span class="o">.</span><span class="n">nonzero</span><span class="p">()</span>
</span><span id="Transformation.eigenvector-1287"><a href="#Transformation.eigenvector-1287"><span class="linenos">1287</span></a>
</span><span id="Transformation.eigenvector-1288"><a href="#Transformation.eigenvector-1288"><span class="linenos">1288</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">where_ic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="Transformation.eigenvector-1289"><a href="#Transformation.eigenvector-1289"><span class="linenos">1289</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">where_ic</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Transformation.eigenvector-1290"><a href="#Transformation.eigenvector-1290"><span class="linenos">1290</span></a>                <span class="n">eigvec_coords</span> <span class="o">=</span> <span class="p">(</span><span class="n">eigvecs</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="n">where_ic</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="Transformation.eigenvector-1291"><a href="#Transformation.eigenvector-1291"><span class="linenos">1291</span></a>                <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">eigvec_coords</span><span class="p">)</span>
</span><span id="Transformation.eigenvector-1292"><a href="#Transformation.eigenvector-1292"><span class="linenos">1292</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Transformation.eigenvector-1293"><a href="#Transformation.eigenvector-1293"><span class="linenos">1293</span></a>                <span class="p">(</span><span class="s2">&quot;Transformation does not have </span><span class="si">{}</span><span class="s2"> as an approximate eigenvalue&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="Transformation.eigenvector-1294"><a href="#Transformation.eigenvector-1294"><span class="linenos">1294</span></a>                    <span class="n">eigenvalue</span><span class="p">)</span>
</span><span id="Transformation.eigenvector-1295"><a href="#Transformation.eigenvector-1295"><span class="linenos">1295</span></a>            <span class="p">)</span>
</span><span id="Transformation.eigenvector-1296"><a href="#Transformation.eigenvector-1296"><span class="linenos">1296</span></a>
</span><span id="Transformation.eigenvector-1297"><a href="#Transformation.eigenvector-1297"><span class="linenos">1297</span></a>        <span class="n">unind</span><span class="p">,</span> <span class="n">indind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">where_ic</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="Transformation.eigenvector-1298"><a href="#Transformation.eigenvector-1298"><span class="linenos">1298</span></a>                                  <span class="n">return_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Transformation.eigenvector-1299"><a href="#Transformation.eigenvector-1299"><span class="linenos">1299</span></a>
</span><span id="Transformation.eigenvector-1300"><a href="#Transformation.eigenvector-1300"><span class="linenos">1300</span></a>        <span class="n">eigvec_coords</span><span class="p">[</span><span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="n">unind</span><span class="o">.</span><span class="n">T</span><span class="p">])]</span> <span class="o">=</span> <span class="n">eigvecs</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)[</span>
</span><span id="Transformation.eigenvector-1301"><a href="#Transformation.eigenvector-1301"><span class="linenos">1301</span></a>            <span class="nb">tuple</span><span class="p">([</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">where_ic</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="n">indind</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">])</span>
</span><span id="Transformation.eigenvector-1302"><a href="#Transformation.eigenvector-1302"><span class="linenos">1302</span></a>        <span class="p">]</span>
</span><span id="Transformation.eigenvector-1303"><a href="#Transformation.eigenvector-1303"><span class="linenos">1303</span></a>
</span><span id="Transformation.eigenvector-1304"><a href="#Transformation.eigenvector-1304"><span class="linenos">1304</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">eigvec_coords</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a point corresponding to an eigenvector with the given
eigenvalue.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>eigenvalue</strong> (float):
Eigenvalue for the returned eigenvector. If None, return
an arbitrary eigenvector.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Point object in projective space giving an eigenvector for
the given eigenvalue. The projective coordinates of this
point will be degenerate (i.e. zero) if no nonzero
eigenvector with this eigenvalue exists.</li>
</ul>
</div>


                            </div>
                            <div id="Transformation.commute" class="classattr">
                                        <input id="Transformation.commute-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">commute</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span>, </span><span class="param"><span class="n">broadcast</span><span class="o">=</span><span class="s1">&#39;elementwise&#39;</span>, </span><span class="param"><span class="n">tol</span><span class="o">=</span><span class="mf">1e-08</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Transformation.commute-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.commute"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.commute-1306"><a href="#Transformation.commute-1306"><span class="linenos">1306</span></a>    <span class="k">def</span> <span class="nf">commute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">):</span>
</span><span id="Transformation.commute-1307"><a href="#Transformation.commute-1307"><span class="linenos">1307</span></a>
</span><span id="Transformation.commute-1308"><a href="#Transformation.commute-1308"><span class="linenos">1308</span></a>        <span class="n">s_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Transformation.commute-1309"><a href="#Transformation.commute-1309"><span class="linenos">1309</span></a>        <span class="n">o_inv</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Transformation.commute-1310"><a href="#Transformation.commute-1310"><span class="linenos">1310</span></a>
</span><span id="Transformation.commute-1311"><a href="#Transformation.commute-1311"><span class="linenos">1311</span></a>        <span class="k">if</span> <span class="n">broadcast</span> <span class="o">==</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">:</span>
</span><span id="Transformation.commute-1312"><a href="#Transformation.commute-1312"><span class="linenos">1312</span></a>            <span class="n">slen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Transformation.commute-1313"><a href="#Transformation.commute-1313"><span class="linenos">1313</span></a>            <span class="n">olen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">o_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Transformation.commute-1314"><a href="#Transformation.commute-1314"><span class="linenos">1314</span></a>            <span class="n">s_inv</span> <span class="o">=</span> <span class="n">s_inv</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">s_inv</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">olen</span><span class="p">)</span>
</span><span id="Transformation.commute-1315"><a href="#Transformation.commute-1315"><span class="linenos">1315</span></a>            <span class="n">o_inv</span> <span class="o">=</span> <span class="n">o_inv</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,)</span><span class="o">*</span><span class="n">slen</span> <span class="o">+</span> <span class="n">o_inv</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="Transformation.commute-1316"><a href="#Transformation.commute-1316"><span class="linenos">1316</span></a>
</span><span id="Transformation.commute-1317"><a href="#Transformation.commute-1317"><span class="linenos">1317</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="n">broadcast</span><span class="p">)</span>
</span><span id="Transformation.commute-1318"><a href="#Transformation.commute-1318"><span class="linenos">1318</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="n">commutator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">s_inv</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="Transformation.commute-1319"><a href="#Transformation.commute-1319"><span class="linenos">1319</span></a>        <span class="n">commutator</span> <span class="o">=</span> <span class="n">commutator</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">o_inv</span><span class="p">,</span> <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="Transformation.commute-1320"><a href="#Transformation.commute-1320"><span class="linenos">1320</span></a>
</span><span id="Transformation.commute-1321"><a href="#Transformation.commute-1321"><span class="linenos">1321</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span>
</span><span id="Transformation.commute-1322"><a href="#Transformation.commute-1322"><span class="linenos">1322</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">commutator</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span>
</span><span id="Transformation.commute-1323"><a href="#Transformation.commute-1323"><span class="linenos">1323</span></a>                       <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="Transformation.commute-1324"><a href="#Transformation.commute-1324"><span class="linenos">1324</span></a>                       <span class="n">atol</span><span class="o">=</span><span class="n">tol</span><span class="p">),</span>
</span><span id="Transformation.commute-1325"><a href="#Transformation.commute-1325"><span class="linenos">1325</span></a>            <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Transformation.commute-1326"><a href="#Transformation.commute-1326"><span class="linenos">1326</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Transformation.diagonalize" class="classattr">
                                        <input id="Transformation.diagonalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">diagonalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">return_inv</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Transformation.diagonalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.diagonalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.diagonalize-1330"><a href="#Transformation.diagonalize-1330"><span class="linenos">1330</span></a>    <span class="k">def</span> <span class="nf">diagonalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_inv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Transformation.diagonalize-1331"><a href="#Transformation.diagonalize-1331"><span class="linenos">1331</span></a>        <span class="sd">&quot;&quot;&quot;Get a matrix diagonalizing this projective transformation.</span>
</span><span id="Transformation.diagonalize-1332"><a href="#Transformation.diagonalize-1332"><span class="linenos">1332</span></a>
</span><span id="Transformation.diagonalize-1333"><a href="#Transformation.diagonalize-1333"><span class="linenos">1333</span></a><span class="sd">        If self is a diagonalizable transformation, this function</span>
</span><span id="Transformation.diagonalize-1334"><a href="#Transformation.diagonalize-1334"><span class="linenos">1334</span></a><span class="sd">        returns a Transformation object representing a projective</span>
</span><span id="Transformation.diagonalize-1335"><a href="#Transformation.diagonalize-1335"><span class="linenos">1335</span></a><span class="sd">        transformation M such that M.inv() @ (self) @ M is diagonal.</span>
</span><span id="Transformation.diagonalize-1336"><a href="#Transformation.diagonalize-1336"><span class="linenos">1336</span></a>
</span><span id="Transformation.diagonalize-1337"><a href="#Transformation.diagonalize-1337"><span class="linenos">1337</span></a><span class="sd">        No claims are made about the behavior of this function if M is</span>
</span><span id="Transformation.diagonalize-1338"><a href="#Transformation.diagonalize-1338"><span class="linenos">1338</span></a><span class="sd">        not diagonalizable. The function may throw an error, or it may</span>
</span><span id="Transformation.diagonalize-1339"><a href="#Transformation.diagonalize-1339"><span class="linenos">1339</span></a><span class="sd">        return nonsense - no effort has been made on this front.</span>
</span><span id="Transformation.diagonalize-1340"><a href="#Transformation.diagonalize-1340"><span class="linenos">1340</span></a>
</span><span id="Transformation.diagonalize-1341"><a href="#Transformation.diagonalize-1341"><span class="linenos">1341</span></a><span class="sd">        Parameters</span>
</span><span id="Transformation.diagonalize-1342"><a href="#Transformation.diagonalize-1342"><span class="linenos">1342</span></a><span class="sd">        ----------</span>
</span><span id="Transformation.diagonalize-1343"><a href="#Transformation.diagonalize-1343"><span class="linenos">1343</span></a><span class="sd">        return_inv : bool</span>
</span><span id="Transformation.diagonalize-1344"><a href="#Transformation.diagonalize-1344"><span class="linenos">1344</span></a><span class="sd">            If True, return a pair of Transformations, giving M and</span>
</span><span id="Transformation.diagonalize-1345"><a href="#Transformation.diagonalize-1345"><span class="linenos">1345</span></a><span class="sd">            M.inv(). Otherwise, just return M.</span>
</span><span id="Transformation.diagonalize-1346"><a href="#Transformation.diagonalize-1346"><span class="linenos">1346</span></a>
</span><span id="Transformation.diagonalize-1347"><a href="#Transformation.diagonalize-1347"><span class="linenos">1347</span></a><span class="sd">        Returns</span>
</span><span id="Transformation.diagonalize-1348"><a href="#Transformation.diagonalize-1348"><span class="linenos">1348</span></a><span class="sd">        -------</span>
</span><span id="Transformation.diagonalize-1349"><a href="#Transformation.diagonalize-1349"><span class="linenos">1349</span></a><span class="sd">        Transformation</span>
</span><span id="Transformation.diagonalize-1350"><a href="#Transformation.diagonalize-1350"><span class="linenos">1350</span></a><span class="sd">            Projective transformation M diagonalizing this</span>
</span><span id="Transformation.diagonalize-1351"><a href="#Transformation.diagonalize-1351"><span class="linenos">1351</span></a><span class="sd">            transformation.</span>
</span><span id="Transformation.diagonalize-1352"><a href="#Transformation.diagonalize-1352"><span class="linenos">1352</span></a>
</span><span id="Transformation.diagonalize-1353"><a href="#Transformation.diagonalize-1353"><span class="linenos">1353</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation.diagonalize-1354"><a href="#Transformation.diagonalize-1354"><span class="linenos">1354</span></a>
</span><span id="Transformation.diagonalize-1355"><a href="#Transformation.diagonalize-1355"><span class="linenos">1355</span></a>        <span class="n">_</span><span class="p">,</span> <span class="n">conj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="Transformation.diagonalize-1356"><a href="#Transformation.diagonalize-1356"><span class="linenos">1356</span></a>                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Transformation.diagonalize-1357"><a href="#Transformation.diagonalize-1357"><span class="linenos">1357</span></a>
</span><span id="Transformation.diagonalize-1358"><a href="#Transformation.diagonalize-1358"><span class="linenos">1358</span></a>        <span class="n">conj_transform</span> <span class="o">=</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">conj</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Transformation.diagonalize-1359"><a href="#Transformation.diagonalize-1359"><span class="linenos">1359</span></a>
</span><span id="Transformation.diagonalize-1360"><a href="#Transformation.diagonalize-1360"><span class="linenos">1360</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_inv</span><span class="p">:</span>
</span><span id="Transformation.diagonalize-1361"><a href="#Transformation.diagonalize-1361"><span class="linenos">1361</span></a>            <span class="k">return</span> <span class="n">conj_transform</span>
</span><span id="Transformation.diagonalize-1362"><a href="#Transformation.diagonalize-1362"><span class="linenos">1362</span></a>
</span><span id="Transformation.diagonalize-1363"><a href="#Transformation.diagonalize-1363"><span class="linenos">1363</span></a>        <span class="k">return</span> <span class="n">conj_transform</span><span class="p">,</span> <span class="n">conj_transform</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get a matrix diagonalizing this projective transformation.</p>

<p>If self is a diagonalizable transformation, this function
returns a Transformation object representing a projective
transformation M such that M.inv() @ (self) @ M is diagonal.</p>

<p>No claims are made about the behavior of this function if M is
not diagonalizable. The function may throw an error, or it may
return nonsense - no effort has been made on this front.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>return_inv</strong> (bool):
If True, return a pair of Transformations, giving M and
M.inv(). Otherwise, just return M.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Transformation</strong>: Projective transformation M diagonalizing this
transformation.</li>
</ul>
</div>


                            </div>
                            <div id="Transformation.inv" class="classattr">
                                        <input id="Transformation.inv-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">inv</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Transformation.inv-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Transformation.inv"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Transformation.inv-1368"><a href="#Transformation.inv-1368"><span class="linenos">1368</span></a>    <span class="k">def</span> <span class="nf">inv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Transformation.inv-1369"><a href="#Transformation.inv-1369"><span class="linenos">1369</span></a>        <span class="sd">&quot;&quot;&quot;Get the inverse of this transformation.</span>
</span><span id="Transformation.inv-1370"><a href="#Transformation.inv-1370"><span class="linenos">1370</span></a>
</span><span id="Transformation.inv-1371"><a href="#Transformation.inv-1371"><span class="linenos">1371</span></a><span class="sd">        Returns</span>
</span><span id="Transformation.inv-1372"><a href="#Transformation.inv-1372"><span class="linenos">1372</span></a><span class="sd">        -------</span>
</span><span id="Transformation.inv-1373"><a href="#Transformation.inv-1373"><span class="linenos">1373</span></a><span class="sd">        ProjectiveTransformation</span>
</span><span id="Transformation.inv-1374"><a href="#Transformation.inv-1374"><span class="linenos">1374</span></a><span class="sd">            Inverse of this transformation.</span>
</span><span id="Transformation.inv-1375"><a href="#Transformation.inv-1375"><span class="linenos">1375</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Transformation.inv-1376"><a href="#Transformation.inv-1376"><span class="linenos">1376</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get the inverse of this transformation.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ProjectiveTransformation</strong>: Inverse of this transformation.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#ProjectiveObject">ProjectiveObject</a></dt>
                                <dd id="Transformation.dimension" class="variable"><a href="#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Transformation.shape" class="variable"><a href="#ProjectiveObject.shape">shape</a></dd>
                <dd id="Transformation.reshape" class="function"><a href="#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Transformation.set" class="function"><a href="#ProjectiveObject.set">set</a></dd>
                <dd id="Transformation.flatten_to_unit" class="function"><a href="#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Transformation.flatten_to_aux" class="function"><a href="#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Transformation.astype" class="function"><a href="#ProjectiveObject.astype">astype</a></dd>
                <dd id="Transformation.change_base_ring" class="function"><a href="#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Transformation.projective_coords" class="function"><a href="#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Transformation.affine_coords" class="function"><a href="#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Transformation.combine" class="function"><a href="#ProjectiveObject.combine">combine</a></dd>
                <dd id="Transformation.set_ndims" class="function"><a href="#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="ProjectiveRepresentation">
                            <input id="ProjectiveRepresentation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">ProjectiveRepresentation</span><wbr>(<span class="base"><a href="representation.html#Representation">geometry_tools.representation.Representation</a></span>):

                <label class="view-source-button" for="ProjectiveRepresentation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveRepresentation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveRepresentation-1381"><a href="#ProjectiveRepresentation-1381"><span class="linenos">1381</span></a><span class="k">class</span> <span class="nc">ProjectiveRepresentation</span><span class="p">(</span><span class="n">representation</span><span class="o">.</span><span class="n">Representation</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation-1382"><a href="#ProjectiveRepresentation-1382"><span class="linenos">1382</span></a>    <span class="sd">&quot;&quot;&quot;A representation (of a free group) lying in PGL(V). Passing words</span>
</span><span id="ProjectiveRepresentation-1383"><a href="#ProjectiveRepresentation-1383"><span class="linenos">1383</span></a><span class="sd">    (in the generators) to this representation yields `Transformation`</span>
</span><span id="ProjectiveRepresentation-1384"><a href="#ProjectiveRepresentation-1384"><span class="linenos">1384</span></a><span class="sd">    objects.</span>
</span><span id="ProjectiveRepresentation-1385"><a href="#ProjectiveRepresentation-1385"><span class="linenos">1385</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ProjectiveRepresentation-1386"><a href="#ProjectiveRepresentation-1386"><span class="linenos">1386</span></a>
</span><span id="ProjectiveRepresentation-1387"><a href="#ProjectiveRepresentation-1387"><span class="linenos">1387</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveRepresentation-1388"><a href="#ProjectiveRepresentation-1388"><span class="linenos">1388</span></a>    <span class="k">def</span> <span class="nf">wrap_func</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation-1389"><a href="#ProjectiveRepresentation-1389"><span class="linenos">1389</span></a>        <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ProjectiveRepresentation-1390"><a href="#ProjectiveRepresentation-1390"><span class="linenos">1390</span></a>
</span><span id="ProjectiveRepresentation-1391"><a href="#ProjectiveRepresentation-1391"><span class="linenos">1391</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveRepresentation-1392"><a href="#ProjectiveRepresentation-1392"><span class="linenos">1392</span></a>    <span class="k">def</span> <span class="nf">unwrap_func</span><span class="p">(</span><span class="n">wrapped_matrix</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation-1393"><a href="#ProjectiveRepresentation-1393"><span class="linenos">1393</span></a>        <span class="k">return</span> <span class="n">wrapped_matrix</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
</span><span id="ProjectiveRepresentation-1394"><a href="#ProjectiveRepresentation-1394"><span class="linenos">1394</span></a>
</span><span id="ProjectiveRepresentation-1395"><a href="#ProjectiveRepresentation-1395"><span class="linenos">1395</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveRepresentation-1396"><a href="#ProjectiveRepresentation-1396"><span class="linenos">1396</span></a>    <span class="k">def</span> <span class="nf">array_wrap_func</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation-1397"><a href="#ProjectiveRepresentation-1397"><span class="linenos">1397</span></a>        <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="ProjectiveRepresentation-1398"><a href="#ProjectiveRepresentation-1398"><span class="linenos">1398</span></a>
</span><span id="ProjectiveRepresentation-1399"><a href="#ProjectiveRepresentation-1399"><span class="linenos">1399</span></a>    <span class="k">def</span> <span class="nf">transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation-1400"><a href="#ProjectiveRepresentation-1400"><span class="linenos">1400</span></a>        <span class="sd">&quot;&quot;&quot;Get a composite transformation, representing a sequence of words in</span>
</span><span id="ProjectiveRepresentation-1401"><a href="#ProjectiveRepresentation-1401"><span class="linenos">1401</span></a><span class="sd">        the generators for this representation.</span>
</span><span id="ProjectiveRepresentation-1402"><a href="#ProjectiveRepresentation-1402"><span class="linenos">1402</span></a>
</span><span id="ProjectiveRepresentation-1403"><a href="#ProjectiveRepresentation-1403"><span class="linenos">1403</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveRepresentation-1404"><a href="#ProjectiveRepresentation-1404"><span class="linenos">1404</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveRepresentation-1405"><a href="#ProjectiveRepresentation-1405"><span class="linenos">1405</span></a><span class="sd">        words : iterable of strings</span>
</span><span id="ProjectiveRepresentation-1406"><a href="#ProjectiveRepresentation-1406"><span class="linenos">1406</span></a><span class="sd">            Sequence of words to apply this representation to.</span>
</span><span id="ProjectiveRepresentation-1407"><a href="#ProjectiveRepresentation-1407"><span class="linenos">1407</span></a>
</span><span id="ProjectiveRepresentation-1408"><a href="#ProjectiveRepresentation-1408"><span class="linenos">1408</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveRepresentation-1409"><a href="#ProjectiveRepresentation-1409"><span class="linenos">1409</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveRepresentation-1410"><a href="#ProjectiveRepresentation-1410"><span class="linenos">1410</span></a><span class="sd">        Transformation</span>
</span><span id="ProjectiveRepresentation-1411"><a href="#ProjectiveRepresentation-1411"><span class="linenos">1411</span></a><span class="sd">            Composite transformation object containing one</span>
</span><span id="ProjectiveRepresentation-1412"><a href="#ProjectiveRepresentation-1412"><span class="linenos">1412</span></a><span class="sd">            transformation for each word in `words`.</span>
</span><span id="ProjectiveRepresentation-1413"><a href="#ProjectiveRepresentation-1413"><span class="linenos">1413</span></a>
</span><span id="ProjectiveRepresentation-1414"><a href="#ProjectiveRepresentation-1414"><span class="linenos">1414</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveRepresentation-1415"><a href="#ProjectiveRepresentation-1415"><span class="linenos">1415</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>A representation (of a free group) lying in PGL(V). Passing words
(in the generators) to this representation yields <code><a href="#Transformation">Transformation</a></code>
objects.</p>
</div>


                            <div id="ProjectiveRepresentation.wrap_func" class="classattr">
                                        <input id="ProjectiveRepresentation.wrap_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">wrap_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">numpy_matrix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveRepresentation.wrap_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveRepresentation.wrap_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveRepresentation.wrap_func-1387"><a href="#ProjectiveRepresentation.wrap_func-1387"><span class="linenos">1387</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveRepresentation.wrap_func-1388"><a href="#ProjectiveRepresentation.wrap_func-1388"><span class="linenos">1388</span></a>    <span class="k">def</span> <span class="nf">wrap_func</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation.wrap_func-1389"><a href="#ProjectiveRepresentation.wrap_func-1389"><span class="linenos">1389</span></a>        <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveRepresentation.unwrap_func" class="classattr">
                                        <input id="ProjectiveRepresentation.unwrap_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">unwrap_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">wrapped_matrix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveRepresentation.unwrap_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveRepresentation.unwrap_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveRepresentation.unwrap_func-1391"><a href="#ProjectiveRepresentation.unwrap_func-1391"><span class="linenos">1391</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveRepresentation.unwrap_func-1392"><a href="#ProjectiveRepresentation.unwrap_func-1392"><span class="linenos">1392</span></a>    <span class="k">def</span> <span class="nf">unwrap_func</span><span class="p">(</span><span class="n">wrapped_matrix</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation.unwrap_func-1393"><a href="#ProjectiveRepresentation.unwrap_func-1393"><span class="linenos">1393</span></a>        <span class="k">return</span> <span class="n">wrapped_matrix</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">T</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveRepresentation.array_wrap_func" class="classattr">
                                        <input id="ProjectiveRepresentation.array_wrap_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">array_wrap_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">numpy_array</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveRepresentation.array_wrap_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveRepresentation.array_wrap_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveRepresentation.array_wrap_func-1395"><a href="#ProjectiveRepresentation.array_wrap_func-1395"><span class="linenos">1395</span></a>    <span class="nd">@staticmethod</span>
</span><span id="ProjectiveRepresentation.array_wrap_func-1396"><a href="#ProjectiveRepresentation.array_wrap_func-1396"><span class="linenos">1396</span></a>    <span class="k">def</span> <span class="nf">array_wrap_func</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation.array_wrap_func-1397"><a href="#ProjectiveRepresentation.array_wrap_func-1397"><span class="linenos">1397</span></a>        <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="ProjectiveRepresentation.transformations" class="classattr">
                                        <input id="ProjectiveRepresentation.transformations-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">transformations</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">words</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="ProjectiveRepresentation.transformations-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ProjectiveRepresentation.transformations"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ProjectiveRepresentation.transformations-1399"><a href="#ProjectiveRepresentation.transformations-1399"><span class="linenos">1399</span></a>    <span class="k">def</span> <span class="nf">transformations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
</span><span id="ProjectiveRepresentation.transformations-1400"><a href="#ProjectiveRepresentation.transformations-1400"><span class="linenos">1400</span></a>        <span class="sd">&quot;&quot;&quot;Get a composite transformation, representing a sequence of words in</span>
</span><span id="ProjectiveRepresentation.transformations-1401"><a href="#ProjectiveRepresentation.transformations-1401"><span class="linenos">1401</span></a><span class="sd">        the generators for this representation.</span>
</span><span id="ProjectiveRepresentation.transformations-1402"><a href="#ProjectiveRepresentation.transformations-1402"><span class="linenos">1402</span></a>
</span><span id="ProjectiveRepresentation.transformations-1403"><a href="#ProjectiveRepresentation.transformations-1403"><span class="linenos">1403</span></a><span class="sd">        Parameters</span>
</span><span id="ProjectiveRepresentation.transformations-1404"><a href="#ProjectiveRepresentation.transformations-1404"><span class="linenos">1404</span></a><span class="sd">        ----------</span>
</span><span id="ProjectiveRepresentation.transformations-1405"><a href="#ProjectiveRepresentation.transformations-1405"><span class="linenos">1405</span></a><span class="sd">        words : iterable of strings</span>
</span><span id="ProjectiveRepresentation.transformations-1406"><a href="#ProjectiveRepresentation.transformations-1406"><span class="linenos">1406</span></a><span class="sd">            Sequence of words to apply this representation to.</span>
</span><span id="ProjectiveRepresentation.transformations-1407"><a href="#ProjectiveRepresentation.transformations-1407"><span class="linenos">1407</span></a>
</span><span id="ProjectiveRepresentation.transformations-1408"><a href="#ProjectiveRepresentation.transformations-1408"><span class="linenos">1408</span></a><span class="sd">        Returns</span>
</span><span id="ProjectiveRepresentation.transformations-1409"><a href="#ProjectiveRepresentation.transformations-1409"><span class="linenos">1409</span></a><span class="sd">        -------</span>
</span><span id="ProjectiveRepresentation.transformations-1410"><a href="#ProjectiveRepresentation.transformations-1410"><span class="linenos">1410</span></a><span class="sd">        Transformation</span>
</span><span id="ProjectiveRepresentation.transformations-1411"><a href="#ProjectiveRepresentation.transformations-1411"><span class="linenos">1411</span></a><span class="sd">            Composite transformation object containing one</span>
</span><span id="ProjectiveRepresentation.transformations-1412"><a href="#ProjectiveRepresentation.transformations-1412"><span class="linenos">1412</span></a><span class="sd">            transformation for each word in `words`.</span>
</span><span id="ProjectiveRepresentation.transformations-1413"><a href="#ProjectiveRepresentation.transformations-1413"><span class="linenos">1413</span></a>
</span><span id="ProjectiveRepresentation.transformations-1414"><a href="#ProjectiveRepresentation.transformations-1414"><span class="linenos">1414</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="ProjectiveRepresentation.transformations-1415"><a href="#ProjectiveRepresentation.transformations-1415"><span class="linenos">1415</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a composite transformation, representing a sequence of words in
the generators for this representation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>words</strong> (iterable of strings):
Sequence of words to apply this representation to.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Transformation</strong>: Composite transformation object containing one
transformation for each word in <code>words</code>.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="representation.html#Representation">geometry_tools.representation.Representation</a></dt>
                                <dd id="ProjectiveRepresentation.__init__" class="function"><a href="representation.html#Representation.__init__">Representation</a></dd>
                <dd id="ProjectiveRepresentation.dim" class="variable"><a href="representation.html#Representation.dim">dim</a></dd>
                <dd id="ProjectiveRepresentation.dtype" class="variable"><a href="representation.html#Representation.dtype">dtype</a></dd>
                <dd id="ProjectiveRepresentation.base_ring" class="variable"><a href="representation.html#Representation.base_ring">base_ring</a></dd>
                <dd id="ProjectiveRepresentation.parse_word" class="function"><a href="representation.html#Representation.parse_word">parse_word</a></dd>
                <dd id="ProjectiveRepresentation.element" class="function"><a href="representation.html#Representation.element">element</a></dd>
                <dd id="ProjectiveRepresentation.parse_simple" class="variable"><a href="representation.html#Representation.parse_simple">parse_simple</a></dd>
                <dd id="ProjectiveRepresentation.relations" class="variable"><a href="representation.html#Representation.relations">relations</a></dd>
                <dd id="ProjectiveRepresentation.freely_reduced_elements" class="function"><a href="representation.html#Representation.freely_reduced_elements">freely_reduced_elements</a></dd>
                <dd id="ProjectiveRepresentation.free_words_of_length" class="function"><a href="representation.html#Representation.free_words_of_length">free_words_of_length</a></dd>
                <dd id="ProjectiveRepresentation.free_words_less_than" class="function"><a href="representation.html#Representation.free_words_less_than">free_words_less_than</a></dd>
                <dd id="ProjectiveRepresentation.automaton_accepted" class="function"><a href="representation.html#Representation.automaton_accepted">automaton_accepted</a></dd>
                <dd id="ProjectiveRepresentation.elements" class="function"><a href="representation.html#Representation.elements">elements</a></dd>
                <dd id="ProjectiveRepresentation.asym_gens" class="function"><a href="representation.html#Representation.asym_gens">asym_gens</a></dd>
                <dd id="ProjectiveRepresentation.dual" class="function"><a href="representation.html#Representation.dual">dual</a></dd>
                <dd id="ProjectiveRepresentation.set_generator" class="function"><a href="representation.html#Representation.set_generator">set_generator</a></dd>
                <dd id="ProjectiveRepresentation.change_base_ring" class="function"><a href="representation.html#Representation.change_base_ring">change_base_ring</a></dd>
                <dd id="ProjectiveRepresentation.astype" class="function"><a href="representation.html#Representation.astype">astype</a></dd>
                <dd id="ProjectiveRepresentation.conjugate" class="function"><a href="representation.html#Representation.conjugate">conjugate</a></dd>
                <dd id="ProjectiveRepresentation.compose" class="function"><a href="representation.html#Representation.compose">compose</a></dd>
                <dd id="ProjectiveRepresentation.subgroup" class="function"><a href="representation.html#Representation.subgroup">subgroup</a></dd>
                <dd id="ProjectiveRepresentation.differential" class="function"><a href="representation.html#Representation.differential">differential</a></dd>
                <dd id="ProjectiveRepresentation.differentials" class="function"><a href="representation.html#Representation.differentials">differentials</a></dd>
                <dd id="ProjectiveRepresentation.cocycle_matrix" class="function"><a href="representation.html#Representation.cocycle_matrix">cocycle_matrix</a></dd>
                <dd id="ProjectiveRepresentation.coboundary_matrix" class="function"><a href="representation.html#Representation.coboundary_matrix">coboundary_matrix</a></dd>
                <dd id="ProjectiveRepresentation.gln_adjoint" class="function"><a href="representation.html#Representation.gln_adjoint">gln_adjoint</a></dd>
                <dd id="ProjectiveRepresentation.sln_adjoint" class="function"><a href="representation.html#Representation.sln_adjoint">sln_adjoint</a></dd>
                <dd id="ProjectiveRepresentation.tensor_product" class="function"><a href="representation.html#Representation.tensor_product">tensor_product</a></dd>
                <dd id="ProjectiveRepresentation.symmetric_square" class="function"><a href="representation.html#Representation.symmetric_square">symmetric_square</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="hyperplane_coordinate_transform">
                            <input id="hyperplane_coordinate_transform-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hyperplane_coordinate_transform</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">normal</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hyperplane_coordinate_transform-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hyperplane_coordinate_transform"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hyperplane_coordinate_transform-1417"><a href="#hyperplane_coordinate_transform-1417"><span class="linenos">1417</span></a><span class="k">def</span> <span class="nf">hyperplane_coordinate_transform</span><span class="p">(</span><span class="n">normal</span><span class="p">):</span>
</span><span id="hyperplane_coordinate_transform-1418"><a href="#hyperplane_coordinate_transform-1418"><span class="linenos">1418</span></a>    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;Find an orthogonal matrix taking the affine chart $\{\vec{x} :</span>
</span><span id="hyperplane_coordinate_transform-1419"><a href="#hyperplane_coordinate_transform-1419"><span class="linenos">1419</span></a><span class="sd">       \vec{x} \cdot \vec{n} \ne 0\}$ to the standard affine chart</span>
</span><span id="hyperplane_coordinate_transform-1420"><a href="#hyperplane_coordinate_transform-1420"><span class="linenos">1420</span></a><span class="sd">       $\{\vec{x} = (x_0, \ldots, x_n) : x_0 \ne 0\}$.</span>
</span><span id="hyperplane_coordinate_transform-1421"><a href="#hyperplane_coordinate_transform-1421"><span class="linenos">1421</span></a>
</span><span id="hyperplane_coordinate_transform-1422"><a href="#hyperplane_coordinate_transform-1422"><span class="linenos">1422</span></a><span class="sd">    Parameters</span>
</span><span id="hyperplane_coordinate_transform-1423"><a href="#hyperplane_coordinate_transform-1423"><span class="linenos">1423</span></a><span class="sd">    ----------</span>
</span><span id="hyperplane_coordinate_transform-1424"><a href="#hyperplane_coordinate_transform-1424"><span class="linenos">1424</span></a><span class="sd">    normal : array</span>
</span><span id="hyperplane_coordinate_transform-1425"><a href="#hyperplane_coordinate_transform-1425"><span class="linenos">1425</span></a><span class="sd">        The vector $\vec{n}$, normal to some hyperplane in R^n.</span>
</span><span id="hyperplane_coordinate_transform-1426"><a href="#hyperplane_coordinate_transform-1426"><span class="linenos">1426</span></a>
</span><span id="hyperplane_coordinate_transform-1427"><a href="#hyperplane_coordinate_transform-1427"><span class="linenos">1427</span></a><span class="sd">    Returns</span>
</span><span id="hyperplane_coordinate_transform-1428"><a href="#hyperplane_coordinate_transform-1428"><span class="linenos">1428</span></a><span class="sd">    -------</span>
</span><span id="hyperplane_coordinate_transform-1429"><a href="#hyperplane_coordinate_transform-1429"><span class="linenos">1429</span></a><span class="sd">    Transformation</span>
</span><span id="hyperplane_coordinate_transform-1430"><a href="#hyperplane_coordinate_transform-1430"><span class="linenos">1430</span></a><span class="sd">        Projective transformation (orthogonal in the standard inner</span>
</span><span id="hyperplane_coordinate_transform-1431"><a href="#hyperplane_coordinate_transform-1431"><span class="linenos">1431</span></a><span class="sd">        product on R^n) taking the desired affine chart to the</span>
</span><span id="hyperplane_coordinate_transform-1432"><a href="#hyperplane_coordinate_transform-1432"><span class="linenos">1432</span></a><span class="sd">        standard chart with index 0.</span>
</span><span id="hyperplane_coordinate_transform-1433"><a href="#hyperplane_coordinate_transform-1433"><span class="linenos">1433</span></a>
</span><span id="hyperplane_coordinate_transform-1434"><a href="#hyperplane_coordinate_transform-1434"><span class="linenos">1434</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="hyperplane_coordinate_transform-1435"><a href="#hyperplane_coordinate_transform-1435"><span class="linenos">1435</span></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_definite_isometry</span><span class="p">(</span><span class="n">normal</span><span class="p">)</span>
</span><span id="hyperplane_coordinate_transform-1436"><a href="#hyperplane_coordinate_transform-1436"><span class="linenos">1436</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Find an orthogonal matrix taking the affine chart ${\vec{x} :
   \vec{x} \cdot \vec{n} \ne 0}$ to the standard affine chart
   ${\vec{x} = (x_0, \ldots, x_n) : x_0 \ne 0}$.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>normal</strong> (array):
The vector $\vec{n}$, normal to some hyperplane in R^n.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Transformation</strong>: Projective transformation (orthogonal in the standard inner
product on R^n) taking the desired affine chart to the
standard chart with index 0.</li>
</ul>
</div>


                </section>
                <section id="affine_coords">
                            <input id="affine_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">affine_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="affine_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#affine_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="affine_coords-1438"><a href="#affine_coords-1438"><span class="linenos">1438</span></a><span class="k">def</span> <span class="nf">affine_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="affine_coords-1439"><a href="#affine_coords-1439"><span class="linenos">1439</span></a>    <span class="sd">&quot;&quot;&quot;Get affine coordinates for an array of points in projective space</span>
</span><span id="affine_coords-1440"><a href="#affine_coords-1440"><span class="linenos">1440</span></a><span class="sd">    in one of the standard affine charts.</span>
</span><span id="affine_coords-1441"><a href="#affine_coords-1441"><span class="linenos">1441</span></a>
</span><span id="affine_coords-1442"><a href="#affine_coords-1442"><span class="linenos">1442</span></a><span class="sd">    Parameters</span>
</span><span id="affine_coords-1443"><a href="#affine_coords-1443"><span class="linenos">1443</span></a><span class="sd">    ----------</span>
</span><span id="affine_coords-1444"><a href="#affine_coords-1444"><span class="linenos">1444</span></a><span class="sd">    points: ndarray</span>
</span><span id="affine_coords-1445"><a href="#affine_coords-1445"><span class="linenos">1445</span></a><span class="sd">        `ndarray` of points in projective space. the last dimension is</span>
</span><span id="affine_coords-1446"><a href="#affine_coords-1446"><span class="linenos">1446</span></a><span class="sd">        assumed to be the same as the dimension of the underlying</span>
</span><span id="affine_coords-1447"><a href="#affine_coords-1447"><span class="linenos">1447</span></a><span class="sd">        vector space.</span>
</span><span id="affine_coords-1448"><a href="#affine_coords-1448"><span class="linenos">1448</span></a>
</span><span id="affine_coords-1449"><a href="#affine_coords-1449"><span class="linenos">1449</span></a><span class="sd">    chart_index: int</span>
</span><span id="affine_coords-1450"><a href="#affine_coords-1450"><span class="linenos">1450</span></a><span class="sd">        which of the n affine charts to take coordinates in. If</span>
</span><span id="affine_coords-1451"><a href="#affine_coords-1451"><span class="linenos">1451</span></a><span class="sd">        `None`, determine the chart automatically.</span>
</span><span id="affine_coords-1452"><a href="#affine_coords-1452"><span class="linenos">1452</span></a>
</span><span id="affine_coords-1453"><a href="#affine_coords-1453"><span class="linenos">1453</span></a><span class="sd">    column_vectors: bool</span>
</span><span id="affine_coords-1454"><a href="#affine_coords-1454"><span class="linenos">1454</span></a><span class="sd">        if `True`, interpret the second-to-last index as the dimension</span>
</span><span id="affine_coords-1455"><a href="#affine_coords-1455"><span class="linenos">1455</span></a><span class="sd">        of the underlying vector space.</span>
</span><span id="affine_coords-1456"><a href="#affine_coords-1456"><span class="linenos">1456</span></a>
</span><span id="affine_coords-1457"><a href="#affine_coords-1457"><span class="linenos">1457</span></a><span class="sd">    Returns</span>
</span><span id="affine_coords-1458"><a href="#affine_coords-1458"><span class="linenos">1458</span></a><span class="sd">    -------</span>
</span><span id="affine_coords-1459"><a href="#affine_coords-1459"><span class="linenos">1459</span></a><span class="sd">    ndarray</span>
</span><span id="affine_coords-1460"><a href="#affine_coords-1460"><span class="linenos">1460</span></a><span class="sd">        If chart_index is specified, return an array of points in</span>
</span><span id="affine_coords-1461"><a href="#affine_coords-1461"><span class="linenos">1461</span></a><span class="sd">        affine coordinates in that chart. Otherwise, return a tuple</span>
</span><span id="affine_coords-1462"><a href="#affine_coords-1462"><span class="linenos">1462</span></a><span class="sd">        `(affine, chart_index)`, where `chart_index` is the affine</span>
</span><span id="affine_coords-1463"><a href="#affine_coords-1463"><span class="linenos">1463</span></a><span class="sd">        chart used.</span>
</span><span id="affine_coords-1464"><a href="#affine_coords-1464"><span class="linenos">1464</span></a>
</span><span id="affine_coords-1465"><a href="#affine_coords-1465"><span class="linenos">1465</span></a><span class="sd">        If `column_vectors` is `False` (the default), then the last</span>
</span><span id="affine_coords-1466"><a href="#affine_coords-1466"><span class="linenos">1466</span></a><span class="sd">        index of the returned array is the dimension of the affine</span>
</span><span id="affine_coords-1467"><a href="#affine_coords-1467"><span class="linenos">1467</span></a><span class="sd">        space. Otherwise, the second-to-last index is the dimension of</span>
</span><span id="affine_coords-1468"><a href="#affine_coords-1468"><span class="linenos">1468</span></a><span class="sd">        affine space.</span>
</span><span id="affine_coords-1469"><a href="#affine_coords-1469"><span class="linenos">1469</span></a>
</span><span id="affine_coords-1470"><a href="#affine_coords-1470"><span class="linenos">1470</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="affine_coords-1471"><a href="#affine_coords-1471"><span class="linenos">1471</span></a>    <span class="n">apoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="affine_coords-1472"><a href="#affine_coords-1472"><span class="linenos">1472</span></a>
</span><span id="affine_coords-1473"><a href="#affine_coords-1473"><span class="linenos">1473</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="affine_coords-1474"><a href="#affine_coords-1474"><span class="linenos">1474</span></a>        <span class="n">apoints</span> <span class="o">=</span> <span class="n">apoints</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="affine_coords-1475"><a href="#affine_coords-1475"><span class="linenos">1475</span></a>
</span><span id="affine_coords-1476"><a href="#affine_coords-1476"><span class="linenos">1476</span></a>    <span class="n">_chart_index</span> <span class="o">=</span> <span class="n">chart_index</span>
</span><span id="affine_coords-1477"><a href="#affine_coords-1477"><span class="linenos">1477</span></a>
</span><span id="affine_coords-1478"><a href="#affine_coords-1478"><span class="linenos">1478</span></a>    <span class="c1">#auto-determine chart</span>
</span><span id="affine_coords-1479"><a href="#affine_coords-1479"><span class="linenos">1479</span></a>    <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="affine_coords-1480"><a href="#affine_coords-1480"><span class="linenos">1480</span></a>        <span class="n">_chart_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span>
</span><span id="affine_coords-1481"><a href="#affine_coords-1481"><span class="linenos">1481</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">apoints</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">apoints</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="affine_coords-1482"><a href="#affine_coords-1482"><span class="linenos">1482</span></a>        <span class="p">)</span>
</span><span id="affine_coords-1483"><a href="#affine_coords-1483"><span class="linenos">1483</span></a>
</span><span id="affine_coords-1484"><a href="#affine_coords-1484"><span class="linenos">1484</span></a>    <span class="k">if</span> <span class="p">(</span><span class="n">apoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">_chart_index</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="affine_coords-1485"><a href="#affine_coords-1485"><span class="linenos">1485</span></a>        <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="affine_coords-1486"><a href="#affine_coords-1486"><span class="linenos">1486</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="affine_coords-1487"><a href="#affine_coords-1487"><span class="linenos">1487</span></a>                <span class="s2">&quot;points don&#39;t lie in the specified affine chart&quot;</span>
</span><span id="affine_coords-1488"><a href="#affine_coords-1488"><span class="linenos">1488</span></a>            <span class="p">)</span>
</span><span id="affine_coords-1489"><a href="#affine_coords-1489"><span class="linenos">1489</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="affine_coords-1490"><a href="#affine_coords-1490"><span class="linenos">1490</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="affine_coords-1491"><a href="#affine_coords-1491"><span class="linenos">1491</span></a>                <span class="s2">&quot;points don&#39;t lie in any standard affine chart&quot;</span>
</span><span id="affine_coords-1492"><a href="#affine_coords-1492"><span class="linenos">1492</span></a>            <span class="p">)</span>
</span><span id="affine_coords-1493"><a href="#affine_coords-1493"><span class="linenos">1493</span></a>
</span><span id="affine_coords-1494"><a href="#affine_coords-1494"><span class="linenos">1494</span></a>    <span class="n">affine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span>
</span><span id="affine_coords-1495"><a href="#affine_coords-1495"><span class="linenos">1495</span></a>        <span class="p">(</span><span class="n">apoints</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">apoints</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">_chart_index</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="affine_coords-1496"><a href="#affine_coords-1496"><span class="linenos">1496</span></a>        <span class="n">_chart_index</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="affine_coords-1497"><a href="#affine_coords-1497"><span class="linenos">1497</span></a>    <span class="p">)</span>
</span><span id="affine_coords-1498"><a href="#affine_coords-1498"><span class="linenos">1498</span></a>
</span><span id="affine_coords-1499"><a href="#affine_coords-1499"><span class="linenos">1499</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="affine_coords-1500"><a href="#affine_coords-1500"><span class="linenos">1500</span></a>        <span class="n">affine</span> <span class="o">=</span> <span class="n">affine</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="affine_coords-1501"><a href="#affine_coords-1501"><span class="linenos">1501</span></a>
</span><span id="affine_coords-1502"><a href="#affine_coords-1502"><span class="linenos">1502</span></a>    <span class="k">if</span> <span class="n">chart_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="affine_coords-1503"><a href="#affine_coords-1503"><span class="linenos">1503</span></a>        <span class="k">return</span> <span class="p">(</span><span class="n">affine</span><span class="p">,</span> <span class="n">_chart_index</span><span class="p">)</span>
</span><span id="affine_coords-1504"><a href="#affine_coords-1504"><span class="linenos">1504</span></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="affine_coords-1505"><a href="#affine_coords-1505"><span class="linenos">1505</span></a>        <span class="k">return</span> <span class="n">affine</span>
</span></pre></div>


            <div class="docstring"><p>Get affine coordinates for an array of points in projective space
in one of the standard affine charts.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>points</strong> (ndarray):
<code>ndarray</code> of points in projective space. the last dimension is
assumed to be the same as the dimension of the underlying
vector space.</li>
<li><strong>chart_index</strong> (int):
which of the n affine charts to take coordinates in. If
<code>None</code>, determine the chart automatically.</li>
<li><strong>column_vectors</strong> (bool):
if <code>True</code>, interpret the second-to-last index as the dimension
of the underlying vector space.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: If chart_index is specified, return an array of points in
affine coordinates in that chart. Otherwise, return a tuple
<code>(affine, chart_index)</code>, where <code>chart_index</code> is the affine
chart used.</li>
</ul>

<p>If <code>column_vectors</code> is <code>False</code> (the default), then the last
index of the returned array is the dimension of the affine
space. Otherwise, the second-to-last index is the dimension of
affine space.</p>
</div>


                </section>
                <section id="projective_coords">
                            <input id="projective_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">projective_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="projective_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#projective_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="projective_coords-1507"><a href="#projective_coords-1507"><span class="linenos">1507</span></a><span class="k">def</span> <span class="nf">projective_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="projective_coords-1508"><a href="#projective_coords-1508"><span class="linenos">1508</span></a>    <span class="sd">&quot;&quot;&quot;Get projective coordinates for points in affine space</span>
</span><span id="projective_coords-1509"><a href="#projective_coords-1509"><span class="linenos">1509</span></a>
</span><span id="projective_coords-1510"><a href="#projective_coords-1510"><span class="linenos">1510</span></a><span class="sd">    Parameters</span>
</span><span id="projective_coords-1511"><a href="#projective_coords-1511"><span class="linenos">1511</span></a><span class="sd">    ----------</span>
</span><span id="projective_coords-1512"><a href="#projective_coords-1512"><span class="linenos">1512</span></a><span class="sd">    points : ndarray or sequence</span>
</span><span id="projective_coords-1513"><a href="#projective_coords-1513"><span class="linenos">1513</span></a><span class="sd">        Points in affine coordinates. The last dimension of the array</span>
</span><span id="projective_coords-1514"><a href="#projective_coords-1514"><span class="linenos">1514</span></a><span class="sd">        is the dimension of affine space.</span>
</span><span id="projective_coords-1515"><a href="#projective_coords-1515"><span class="linenos">1515</span></a>
</span><span id="projective_coords-1516"><a href="#projective_coords-1516"><span class="linenos">1516</span></a><span class="sd">    chart_index: int</span>
</span><span id="projective_coords-1517"><a href="#projective_coords-1517"><span class="linenos">1517</span></a><span class="sd">        Index of the affine chart we assume these points are lying in</span>
</span><span id="projective_coords-1518"><a href="#projective_coords-1518"><span class="linenos">1518</span></a>
</span><span id="projective_coords-1519"><a href="#projective_coords-1519"><span class="linenos">1519</span></a><span class="sd">    column_vectors: bool</span>
</span><span id="projective_coords-1520"><a href="#projective_coords-1520"><span class="linenos">1520</span></a><span class="sd">        If `True`, interpret the second-to-last index as the dimension</span>
</span><span id="projective_coords-1521"><a href="#projective_coords-1521"><span class="linenos">1521</span></a><span class="sd">        of affine space.</span>
</span><span id="projective_coords-1522"><a href="#projective_coords-1522"><span class="linenos">1522</span></a>
</span><span id="projective_coords-1523"><a href="#projective_coords-1523"><span class="linenos">1523</span></a><span class="sd">    Returns</span>
</span><span id="projective_coords-1524"><a href="#projective_coords-1524"><span class="linenos">1524</span></a><span class="sd">    -------</span>
</span><span id="projective_coords-1525"><a href="#projective_coords-1525"><span class="linenos">1525</span></a><span class="sd">    ndarray</span>
</span><span id="projective_coords-1526"><a href="#projective_coords-1526"><span class="linenos">1526</span></a><span class="sd">        Projective coordinates of the given points. The last dimension</span>
</span><span id="projective_coords-1527"><a href="#projective_coords-1527"><span class="linenos">1527</span></a><span class="sd">        of the array is the dimension of the underlying vector space</span>
</span><span id="projective_coords-1528"><a href="#projective_coords-1528"><span class="linenos">1528</span></a><span class="sd">        (or the second-to-last dimension, if `column_vectors` is</span>
</span><span id="projective_coords-1529"><a href="#projective_coords-1529"><span class="linenos">1529</span></a><span class="sd">        `True`).</span>
</span><span id="projective_coords-1530"><a href="#projective_coords-1530"><span class="linenos">1530</span></a>
</span><span id="projective_coords-1531"><a href="#projective_coords-1531"><span class="linenos">1531</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="projective_coords-1532"><a href="#projective_coords-1532"><span class="linenos">1532</span></a>    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="projective_coords-1533"><a href="#projective_coords-1533"><span class="linenos">1533</span></a>
</span><span id="projective_coords-1534"><a href="#projective_coords-1534"><span class="linenos">1534</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="projective_coords-1535"><a href="#projective_coords-1535"><span class="linenos">1535</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="projective_coords-1536"><a href="#projective_coords-1536"><span class="linenos">1536</span></a>
</span><span id="projective_coords-1537"><a href="#projective_coords-1537"><span class="linenos">1537</span></a>    <span class="n">result</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span>
</span><span id="projective_coords-1538"><a href="#projective_coords-1538"><span class="linenos">1538</span></a>                         <span class="n">like</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</span><span id="projective_coords-1539"><a href="#projective_coords-1539"><span class="linenos">1539</span></a>
</span><span id="projective_coords-1540"><a href="#projective_coords-1540"><span class="linenos">1540</span></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="projective_coords-1541"><a href="#projective_coords-1541"><span class="linenos">1541</span></a>    <span class="n">indices</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="projective_coords-1542"><a href="#projective_coords-1542"><span class="linenos">1542</span></a>
</span><span id="projective_coords-1543"><a href="#projective_coords-1543"><span class="linenos">1543</span></a>    <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">coords</span>
</span><span id="projective_coords-1544"><a href="#projective_coords-1544"><span class="linenos">1544</span></a>
</span><span id="projective_coords-1545"><a href="#projective_coords-1545"><span class="linenos">1545</span></a>    <span class="c1"># wrap literal numerical 1 (for sage)</span>
</span><span id="projective_coords-1546"><a href="#projective_coords-1546"><span class="linenos">1546</span></a>    <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</span><span id="projective_coords-1547"><a href="#projective_coords-1547"><span class="linenos">1547</span></a>    <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="projective_coords-1548"><a href="#projective_coords-1548"><span class="linenos">1548</span></a>
</span><span id="projective_coords-1549"><a href="#projective_coords-1549"><span class="linenos">1549</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="projective_coords-1550"><a href="#projective_coords-1550"><span class="linenos">1550</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="projective_coords-1551"><a href="#projective_coords-1551"><span class="linenos">1551</span></a>
</span><span id="projective_coords-1552"><a href="#projective_coords-1552"><span class="linenos">1552</span></a>    <span class="k">return</span> <span class="n">result</span>
</span></pre></div>


            <div class="docstring"><p>Get projective coordinates for points in affine space</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>points</strong> (ndarray or sequence):
Points in affine coordinates. The last dimension of the array
is the dimension of affine space.</li>
<li><strong>chart_index</strong> (int):
Index of the affine chart we assume these points are lying in</li>
<li><strong>column_vectors</strong> (bool):
If <code>True</code>, interpret the second-to-last index as the dimension
of affine space.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Projective coordinates of the given points. The last dimension
of the array is the dimension of the underlying vector space
(or the second-to-last dimension, if <code>column_vectors</code> is
<code>True</code>).</li>
</ul>
</div>


                </section>
                <section id="identity">
                            <input id="identity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">identity</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="identity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#identity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="identity-1554"><a href="#identity-1554"><span class="linenos">1554</span></a><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="identity-1555"><a href="#identity-1555"><span class="linenos">1555</span></a>    <span class="sd">&quot;&quot;&quot;Get the identity projective transformation.</span>
</span><span id="identity-1556"><a href="#identity-1556"><span class="linenos">1556</span></a>
</span><span id="identity-1557"><a href="#identity-1557"><span class="linenos">1557</span></a><span class="sd">    Parameters</span>
</span><span id="identity-1558"><a href="#identity-1558"><span class="linenos">1558</span></a><span class="sd">    ----------</span>
</span><span id="identity-1559"><a href="#identity-1559"><span class="linenos">1559</span></a><span class="sd">    dimension : int</span>
</span><span id="identity-1560"><a href="#identity-1560"><span class="linenos">1560</span></a><span class="sd">        Dimension of the projective space to act on.</span>
</span><span id="identity-1561"><a href="#identity-1561"><span class="linenos">1561</span></a>
</span><span id="identity-1562"><a href="#identity-1562"><span class="linenos">1562</span></a><span class="sd">    Returns</span>
</span><span id="identity-1563"><a href="#identity-1563"><span class="linenos">1563</span></a><span class="sd">    -------</span>
</span><span id="identity-1564"><a href="#identity-1564"><span class="linenos">1564</span></a><span class="sd">    Transformation</span>
</span><span id="identity-1565"><a href="#identity-1565"><span class="linenos">1565</span></a><span class="sd">        The identity map on RP^n, where n = `dimension`.</span>
</span><span id="identity-1566"><a href="#identity-1566"><span class="linenos">1566</span></a>
</span><span id="identity-1567"><a href="#identity-1567"><span class="linenos">1567</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="identity-1568"><a href="#identity-1568"><span class="linenos">1568</span></a>
</span><span id="identity-1569"><a href="#identity-1569"><span class="linenos">1569</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get the identity projective transformation.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dimension</strong> (int):
Dimension of the projective space to act on.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Transformation</strong>: The identity map on RP^n, where n = <code>dimension</code>.</li>
</ul>
</div>


                </section>
                <section id="affine_linear_map">
                            <input id="affine_linear_map-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">affine_linear_map</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">linear_map</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="affine_linear_map-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#affine_linear_map"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="affine_linear_map-1571"><a href="#affine_linear_map-1571"><span class="linenos">1571</span></a><span class="k">def</span> <span class="nf">affine_linear_map</span><span class="p">(</span><span class="n">linear_map</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="affine_linear_map-1572"><a href="#affine_linear_map-1572"><span class="linenos">1572</span></a>    <span class="sd">&quot;&quot;&quot;Get a projective transformation restricting to a linear map on a</span>
</span><span id="affine_linear_map-1573"><a href="#affine_linear_map-1573"><span class="linenos">1573</span></a><span class="sd">       standard affine chart.</span>
</span><span id="affine_linear_map-1574"><a href="#affine_linear_map-1574"><span class="linenos">1574</span></a>
</span><span id="affine_linear_map-1575"><a href="#affine_linear_map-1575"><span class="linenos">1575</span></a><span class="sd">    Parameters</span>
</span><span id="affine_linear_map-1576"><a href="#affine_linear_map-1576"><span class="linenos">1576</span></a><span class="sd">    ----------</span>
</span><span id="affine_linear_map-1577"><a href="#affine_linear_map-1577"><span class="linenos">1577</span></a><span class="sd">    linear_map : ndarray</span>
</span><span id="affine_linear_map-1578"><a href="#affine_linear_map-1578"><span class="linenos">1578</span></a><span class="sd">        A linear map giving an affine transformation on a standard</span>
</span><span id="affine_linear_map-1579"><a href="#affine_linear_map-1579"><span class="linenos">1579</span></a><span class="sd">        affine chart</span>
</span><span id="affine_linear_map-1580"><a href="#affine_linear_map-1580"><span class="linenos">1580</span></a>
</span><span id="affine_linear_map-1581"><a href="#affine_linear_map-1581"><span class="linenos">1581</span></a><span class="sd">    chart_index : int</span>
</span><span id="affine_linear_map-1582"><a href="#affine_linear_map-1582"><span class="linenos">1582</span></a><span class="sd">        Index of the standard affine chart where this projective</span>
</span><span id="affine_linear_map-1583"><a href="#affine_linear_map-1583"><span class="linenos">1583</span></a><span class="sd">        transformation acts</span>
</span><span id="affine_linear_map-1584"><a href="#affine_linear_map-1584"><span class="linenos">1584</span></a>
</span><span id="affine_linear_map-1585"><a href="#affine_linear_map-1585"><span class="linenos">1585</span></a><span class="sd">    column_vectors :</span>
</span><span id="affine_linear_map-1586"><a href="#affine_linear_map-1586"><span class="linenos">1586</span></a><span class="sd">        It `True`, interpret `linear_map` as a matrix acting on column</span>
</span><span id="affine_linear_map-1587"><a href="#affine_linear_map-1587"><span class="linenos">1587</span></a><span class="sd">        vectors (on the left). Otherwise, `linear_map` acts on row</span>
</span><span id="affine_linear_map-1588"><a href="#affine_linear_map-1588"><span class="linenos">1588</span></a><span class="sd">        vectors (on the right).</span>
</span><span id="affine_linear_map-1589"><a href="#affine_linear_map-1589"><span class="linenos">1589</span></a>
</span><span id="affine_linear_map-1590"><a href="#affine_linear_map-1590"><span class="linenos">1590</span></a><span class="sd">    Returns</span>
</span><span id="affine_linear_map-1591"><a href="#affine_linear_map-1591"><span class="linenos">1591</span></a><span class="sd">    -------</span>
</span><span id="affine_linear_map-1592"><a href="#affine_linear_map-1592"><span class="linenos">1592</span></a><span class="sd">    Transformation</span>
</span><span id="affine_linear_map-1593"><a href="#affine_linear_map-1593"><span class="linenos">1593</span></a><span class="sd">        Projective transformation preserving a standard affine chart</span>
</span><span id="affine_linear_map-1594"><a href="#affine_linear_map-1594"><span class="linenos">1594</span></a><span class="sd">        and acting by a linear map on that affine space (i.e. fixing a</span>
</span><span id="affine_linear_map-1595"><a href="#affine_linear_map-1595"><span class="linenos">1595</span></a><span class="sd">        point in that affine space).</span>
</span><span id="affine_linear_map-1596"><a href="#affine_linear_map-1596"><span class="linenos">1596</span></a>
</span><span id="affine_linear_map-1597"><a href="#affine_linear_map-1597"><span class="linenos">1597</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="affine_linear_map-1598"><a href="#affine_linear_map-1598"><span class="linenos">1598</span></a>    <span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">linear_map</span><span class="o">.</span><span class="n">shape</span>
</span><span id="affine_linear_map-1599"><a href="#affine_linear_map-1599"><span class="linenos">1599</span></a>
</span><span id="affine_linear_map-1600"><a href="#affine_linear_map-1600"><span class="linenos">1600</span></a>    <span class="n">tf_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">(</span>
</span><span id="affine_linear_map-1601"><a href="#affine_linear_map-1601"><span class="linenos">1601</span></a>        <span class="p">[[</span><span class="n">linear_map</span><span class="p">[:</span><span class="n">chart_index</span><span class="p">,</span> <span class="p">:</span><span class="n">chart_index</span><span class="p">],</span>
</span><span id="affine_linear_map-1602"><a href="#affine_linear_map-1602"><span class="linenos">1602</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">chart_index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">linear_map</span><span class="p">[:</span><span class="n">chart_index</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">:]],</span>
</span><span id="affine_linear_map-1603"><a href="#affine_linear_map-1603"><span class="linenos">1603</span></a>         <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">chart_index</span><span class="p">)),</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span> <span class="o">-</span> <span class="n">chart_index</span><span class="p">))],</span>
</span><span id="affine_linear_map-1604"><a href="#affine_linear_map-1604"><span class="linenos">1604</span></a>         <span class="p">[</span><span class="n">linear_map</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:,</span> <span class="p">:</span><span class="n">chart_index</span><span class="p">],</span>
</span><span id="affine_linear_map-1605"><a href="#affine_linear_map-1605"><span class="linenos">1605</span></a>          <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">h</span> <span class="o">-</span> <span class="n">chart_index</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">linear_map</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:,</span> <span class="n">chart_index</span><span class="p">:]]])</span>
</span><span id="affine_linear_map-1606"><a href="#affine_linear_map-1606"><span class="linenos">1606</span></a>
</span><span id="affine_linear_map-1607"><a href="#affine_linear_map-1607"><span class="linenos">1607</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">tf_mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a projective transformation restricting to a linear map on a
   standard affine chart.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>linear_map</strong> (ndarray):
A linear map giving an affine transformation on a standard
affine chart</li>
<li><strong>chart_index</strong> (int):
Index of the standard affine chart where this projective
transformation acts</li>
<li><strong>column_vectors :</strong>: It <code>True</code>, interpret <code>linear_map</code> as a matrix acting on column
vectors (on the left). Otherwise, <code>linear_map</code> acts on row
vectors (on the right).</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Transformation</strong>: Projective transformation preserving a standard affine chart
and acting by a linear map on that affine space (i.e. fixing a
point in that affine space).</li>
</ul>
</div>


                </section>
                <section id="affine_translation">
                            <input id="affine_translation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">affine_translation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">translation</span>, </span><span class="param"><span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="affine_translation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#affine_translation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="affine_translation-1609"><a href="#affine_translation-1609"><span class="linenos">1609</span></a><span class="k">def</span> <span class="nf">affine_translation</span><span class="p">(</span><span class="n">translation</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
</span><span id="affine_translation-1610"><a href="#affine_translation-1610"><span class="linenos">1610</span></a>    <span class="sd">&quot;&quot;&quot;Get a translation in a standard affine chart.</span>
</span><span id="affine_translation-1611"><a href="#affine_translation-1611"><span class="linenos">1611</span></a>
</span><span id="affine_translation-1612"><a href="#affine_translation-1612"><span class="linenos">1612</span></a><span class="sd">    Parameters</span>
</span><span id="affine_translation-1613"><a href="#affine_translation-1613"><span class="linenos">1613</span></a><span class="sd">    ----------</span>
</span><span id="affine_translation-1614"><a href="#affine_translation-1614"><span class="linenos">1614</span></a><span class="sd">    translation : ndarray</span>
</span><span id="affine_translation-1615"><a href="#affine_translation-1615"><span class="linenos">1615</span></a><span class="sd">        vector to translate along in affine space</span>
</span><span id="affine_translation-1616"><a href="#affine_translation-1616"><span class="linenos">1616</span></a><span class="sd">    chart_index : int</span>
</span><span id="affine_translation-1617"><a href="#affine_translation-1617"><span class="linenos">1617</span></a><span class="sd">        index of the standard affine chart this translation acts on</span>
</span><span id="affine_translation-1618"><a href="#affine_translation-1618"><span class="linenos">1618</span></a>
</span><span id="affine_translation-1619"><a href="#affine_translation-1619"><span class="linenos">1619</span></a><span class="sd">    Returns</span>
</span><span id="affine_translation-1620"><a href="#affine_translation-1620"><span class="linenos">1620</span></a><span class="sd">    -------</span>
</span><span id="affine_translation-1621"><a href="#affine_translation-1621"><span class="linenos">1621</span></a><span class="sd">    Transformation</span>
</span><span id="affine_translation-1622"><a href="#affine_translation-1622"><span class="linenos">1622</span></a><span class="sd">        Projective transformation preserving a standard affine chart</span>
</span><span id="affine_translation-1623"><a href="#affine_translation-1623"><span class="linenos">1623</span></a><span class="sd">        and acting by an affine translation in that affine space.</span>
</span><span id="affine_translation-1624"><a href="#affine_translation-1624"><span class="linenos">1624</span></a>
</span><span id="affine_translation-1625"><a href="#affine_translation-1625"><span class="linenos">1625</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="affine_translation-1626"><a href="#affine_translation-1626"><span class="linenos">1626</span></a>    <span class="n">tf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">translation</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="affine_translation-1627"><a href="#affine_translation-1627"><span class="linenos">1627</span></a>    <span class="n">tf</span><span class="p">[</span><span class="n">chart_index</span><span class="p">,</span> <span class="p">:</span><span class="n">chart_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">translation</span><span class="p">[:</span><span class="n">chart_index</span><span class="p">]</span>
</span><span id="affine_translation-1628"><a href="#affine_translation-1628"><span class="linenos">1628</span></a>    <span class="n">tf</span><span class="p">[</span><span class="n">chart_index</span><span class="p">,</span> <span class="n">chart_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">translation</span><span class="p">[</span><span class="n">chart_index</span><span class="p">:]</span>
</span><span id="affine_translation-1629"><a href="#affine_translation-1629"><span class="linenos">1629</span></a>
</span><span id="affine_translation-1630"><a href="#affine_translation-1630"><span class="linenos">1630</span></a>    <span class="k">return</span> <span class="n">Transformation</span><span class="p">(</span><span class="n">tf</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a translation in a standard affine chart.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>translation</strong> (ndarray):
vector to translate along in affine space</li>
<li><strong>chart_index</strong> (int):
index of the standard affine chart this translation acts on</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Transformation</strong>: Projective transformation preserving a standard affine chart
and acting by an affine translation in that affine space.</li>
</ul>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>