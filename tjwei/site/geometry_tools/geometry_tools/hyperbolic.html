<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.3.0"/>
    <title>geometry_tools.hyperbolic API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../geometry_tools.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;geometry_tools</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="variable" href="#ERROR_THRESHOLD">ERROR_THRESHOLD</a>
            </li>
            <li>
                    <a class="variable" href="#BOUNDARY_THRESHOLD">BOUNDARY_THRESHOLD</a>
            </li>
            <li>
                    <a class="variable" href="#CHECK_LIGHT_CONE">CHECK_LIGHT_CONE</a>
            </li>
            <li>
                    <a class="class" href="#Model">Model</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Model.POINCARE">POINCARE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.KLEIN">KLEIN</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.KLEINIAN">KLEINIAN</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.AFFINE">AFFINE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.HALFSPACE">HALFSPACE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.HALFPLANE">HALFPLANE</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.HYPERBOLOID">HYPERBOLOID</a>
                        </li>
                        <li>
                                <a class="variable" href="#Model.PROJECTIVE">PROJECTIVE</a>
                        </li>
                        <li>
                                <a class="function" href="#Model.aliases">aliases</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HyperbolicObject">HyperbolicObject</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#HyperbolicObject.minkowski">minkowski</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicObject.coords">coords</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicObject.kleinian_coords">kleinian_coords</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Point">Point</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Point.__init__">Point</a>
                        </li>
                        <li>
                                <a class="variable" href="#Point.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Point.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Point.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.hyperboloid_coords">hyperboloid_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.poincare_coords">poincare_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.halfspace_coords">halfspace_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.coords">coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.distance">distance</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.origin_to">origin_to</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.unit_tangent_towards">unit_tangent_towards</a>
                        </li>
                        <li>
                                <a class="function" href="#Point.get_origin">get_origin</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#DualPoint">DualPoint</a>
                            <ul class="memberlist">
                </ul>

            </li>
            <li>
                    <a class="class" href="#IdealPoint">IdealPoint</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#IdealPoint.from_angle">from_angle</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Subspace">Subspace</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Subspace.__init__">Subspace</a>
                        </li>
                        <li>
                                <a class="variable" href="#Subspace.ideal_basis">ideal_basis</a>
                        </li>
                        <li>
                                <a class="function" href="#Subspace.ideal_basis_coords">ideal_basis_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Subspace.spacelike_complement">spacelike_complement</a>
                        </li>
                        <li>
                                <a class="function" href="#Subspace.sphere_parameters">sphere_parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#Subspace.reflection_across">reflection_across</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#PointPair">PointPair</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PointPair.__init__">PointPair</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.endpoint_coords">endpoint_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.get_endpoints">get_endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#PointPair.get_end_pair">get_end_pair</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Geodesic">Geodesic</a>
                            <ul class="memberlist">
                        <li>
                                <a class="variable" href="#Geodesic.endpoints">endpoints</a>
                        </li>
                        <li>
                                <a class="variable" href="#Geodesic.ideal_basis">ideal_basis</a>
                        </li>
                        <li>
                                <a class="function" href="#Geodesic.circle_parameters">circle_parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#Geodesic.from_reflection">from_reflection</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Segment">Segment</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Segment.__init__">Segment</a>
                        </li>
                        <li>
                                <a class="variable" href="#Segment.ideal_basis">ideal_basis</a>
                        </li>
                        <li>
                                <a class="function" href="#Segment.geodesic">geodesic</a>
                        </li>
                        <li>
                                <a class="function" href="#Segment.ideal_endpoint_coords">ideal_endpoint_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Segment.circle_parameters">circle_parameters</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Hyperplane">Hyperplane</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Hyperplane.__init__">Hyperplane</a>
                        </li>
                        <li>
                                <a class="variable" href="#Hyperplane.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Hyperplane.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Hyperplane.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Hyperplane.spacelike_vector">spacelike_vector</a>
                        </li>
                        <li>
                                <a class="variable" href="#Hyperplane.ideal_basis">ideal_basis</a>
                        </li>
                        <li>
                                <a class="function" href="#Hyperplane.from_reflection">from_reflection</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#TangentVector">TangentVector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#TangentVector.__init__">TangentVector</a>
                        </li>
                        <li>
                                <a class="variable" href="#TangentVector.point">point</a>
                        </li>
                        <li>
                                <a class="variable" href="#TangentVector.vector">vector</a>
                        </li>
                        <li>
                                <a class="function" href="#TangentVector.normalized">normalized</a>
                        </li>
                        <li>
                                <a class="function" href="#TangentVector.origin_to">origin_to</a>
                        </li>
                        <li>
                                <a class="function" href="#TangentVector.isometry_to">isometry_to</a>
                        </li>
                        <li>
                                <a class="function" href="#TangentVector.angle">angle</a>
                        </li>
                        <li>
                                <a class="function" href="#TangentVector.point_along">point_along</a>
                        </li>
                        <li>
                                <a class="function" href="#TangentVector.get_base_tangent">get_base_tangent</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Horosphere">Horosphere</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Horosphere.__init__">Horosphere</a>
                        </li>
                        <li>
                                <a class="variable" href="#Horosphere.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Horosphere.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Horosphere.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#Horosphere.center">center</a>
                        </li>
                        <li>
                                <a class="variable" href="#Horosphere.reference">reference</a>
                        </li>
                        <li>
                                <a class="function" href="#Horosphere.set_center_ref">set_center_ref</a>
                        </li>
                        <li>
                                <a class="function" href="#Horosphere.sphere_parameters">sphere_parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#Horosphere.center_coords">center_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Horosphere.ref_coords">ref_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#Horosphere.intersect_geodesic">intersect_geodesic</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HorosphereArc">HorosphereArc</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#HorosphereArc.__init__">HorosphereArc</a>
                        </li>
                        <li>
                                <a class="variable" href="#HorosphereArc.unit_ndims">unit_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#HorosphereArc.aux_ndims">aux_ndims</a>
                        </li>
                        <li>
                                <a class="variable" href="#HorosphereArc.dual_ndims">dual_ndims</a>
                        </li>
                        <li>
                                <a class="function" href="#HorosphereArc.set_center_endpoints">set_center_endpoints</a>
                        </li>
                        <li>
                                <a class="variable" href="#HorosphereArc.center">center</a>
                        </li>
                        <li>
                                <a class="variable" href="#HorosphereArc.reference">reference</a>
                        </li>
                        <li>
                                <a class="variable" href="#HorosphereArc.endpoints">endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#HorosphereArc.circle_parameters">circle_parameters</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#BoundaryArc">BoundaryArc</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BoundaryArc.__init__">BoundaryArc</a>
                        </li>
                        <li>
                                <a class="variable" href="#BoundaryArc.endpoints">endpoints</a>
                        </li>
                        <li>
                                <a class="variable" href="#BoundaryArc.orientation_pt">orientation_pt</a>
                        </li>
                        <li>
                                <a class="function" href="#BoundaryArc.set_endpoints">set_endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#BoundaryArc.orientation">orientation</a>
                        </li>
                        <li>
                                <a class="function" href="#BoundaryArc.flip_orientation">flip_orientation</a>
                        </li>
                        <li>
                                <a class="function" href="#BoundaryArc.endpoint_coords">endpoint_coords</a>
                        </li>
                        <li>
                                <a class="function" href="#BoundaryArc.circle_parameters">circle_parameters</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Polygon">Polygon</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Polygon.__init__">Polygon</a>
                        </li>
                        <li>
                                <a class="variable" href="#Polygon.segment_class">segment_class</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.get_vertices">get_vertices</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.get_edges">get_edges</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.circle_parameters">circle_parameters</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.regular_polygon">regular_polygon</a>
                        </li>
                        <li>
                                <a class="function" href="#Polygon.regular_surface_polygon">regular_surface_polygon</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#Isometry">Isometry</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Isometry.__init__">Isometry</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.axis">axis</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.isometry_type">isometry_type</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.fixed_point_pair">fixed_point_pair</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.fixed_point">fixed_point</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.elliptic">elliptic</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.standard_loxodromic">standard_loxodromic</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.standard_rotation">standard_rotation</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.from_sl2">from_sl2</a>
                        </li>
                        <li>
                                <a class="function" href="#Isometry.to_sl2">to_sl2</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#HyperbolicRepresentation">HyperbolicRepresentation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#HyperbolicRepresentation.wrap_func">wrap_func</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicRepresentation.array_wrap_func">array_wrap_func</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicRepresentation.normalize">normalize</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicRepresentation.isometries">isometries</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicRepresentation.compose">compose</a>
                        </li>
                        <li>
                                <a class="function" href="#HyperbolicRepresentation.gln_adjoint">gln_adjoint</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="function" href="#minkowski">minkowski</a>
            </li>
            <li>
                    <a class="function" href="#kleinian_coords">kleinian_coords</a>
            </li>
            <li>
                    <a class="function" href="#get_point">get_point</a>
            </li>
            <li>
                    <a class="function" href="#get_boundary_point">get_boundary_point</a>
            </li>
            <li>
                    <a class="function" href="#hyperboloid_coords">hyperboloid_coords</a>
            </li>
            <li>
                    <a class="function" href="#spacelike">spacelike</a>
            </li>
            <li>
                    <a class="function" href="#timelike">timelike</a>
            </li>
            <li>
                    <a class="function" href="#lightlike">lightlike</a>
            </li>
            <li>
                    <a class="function" href="#kleinian_to_poincare">kleinian_to_poincare</a>
            </li>
            <li>
                    <a class="function" href="#poincare_to_kleinian">poincare_to_kleinian</a>
            </li>
            <li>
                    <a class="function" href="#poincare_to_halfspace">poincare_to_halfspace</a>
            </li>
            <li>
                    <a class="function" href="#halfspace_to_poincare">halfspace_to_poincare</a>
            </li>
            <li>
                    <a class="function" href="#timelike_to">timelike_to</a>
            </li>
            <li>
                    <a class="function" href="#sl2_iso">sl2_iso</a>
            </li>
            <li>
                    <a class="function" href="#project_to_hyperboloid">project_to_hyperboloid</a>
            </li>
            <li>
                    <a class="function" href="#hyp_to_affine_dist">hyp_to_affine_dist</a>
            </li>
            <li>
                    <a class="function" href="#regular_polygon_radius">regular_polygon_radius</a>
            </li>
            <li>
                    <a class="function" href="#polygon_interior_angle">polygon_interior_angle</a>
            </li>
            <li>
                    <a class="function" href="#genus_g_surface_radius">genus_g_surface_radius</a>
            </li>
            <li>
                    <a class="function" href="#spacelike_to">spacelike_to</a>
            </li>
            <li>
                    <a class="function" href="#identity">identity</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../geometry_tools.html">geometry_tools</a><wbr>.hyperbolic    </h1>

                        <div class="docstring"><p>Model objects in hyperbolic space with numerical coordinates.</p>

<p>This module provides abstract versions of various objects in hyperbolic
geometry (points, line segments, polygons, isometries, etc.) and gives a
unified framework for <em>translating those objects by isometries</em> and <em>getting
their coordinates in various models of hyperbolic space.</em></p>

<p>For instance, to get a single point in the hyperbolic plane, use the <code><a href="#Point">Point</a></code>
class:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">geometry_tools</span> <span class="kn">import</span> <span class="n">hyperbolic</span>

<span class="c1"># get a point by providing kleinian coordinates</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">hyperbolic</span><span class="o">.</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
<span class="c1"># or equivalently:</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">get_point</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>

<span class="c1"># get the poincare coordinates of this point.</span>
<span class="n">point</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;poincare&quot;</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>array([0.05012563, 0.        ])
</code></pre>

<p>The <code><a href="#Isometry">Isometry</a></code> class models isometries of hyperbolic space. The easiest way to
obtain an isometry of the hyperbolic plane is to use the isomorphism from
$\mathrm{PSL}(2, \mathbb{R})$ to the (orientation-preserving) isometry group
 of $\mathbb{H}^2$.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">geometry_tools</span> <span class="kn">import</span> <span class="n">hyperbolic</span>

<span class="c1"># get a loxodromic isometry and a point in H^2</span>
<span class="n">hyp_iso</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">sl2_iso</span><span class="p">([[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="mi">2</span><span class="p">]])</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">get_point</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>

<span class="c1"># apply the isometry to the point</span>
<span class="p">(</span><span class="n">hyp_iso</span> <span class="o">@</span> <span class="n">point</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;halfplane&quot;</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>array([-0.  ,  0.25])
</code></pre>

<p>This module is built on top of the <code><a href="projective.html">geometry_tools.projective</a></code>
submodule, which means that it is possible to easily and efficiently
build <em>composite</em> hyperbolic objects out of arrays of subobjects, and
then translate the entire composite object at once. For instance, we
can build an array of points, and translate all of those points by an
isometry:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">geometry_tools</span> <span class="kn">import</span> <span class="n">hyperbolic</span>

<span class="c1"># make two points in Klein coordinates</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>
<span class="n">p2</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>

<span class="c1"># package these two points together into a single hyperbolic object</span>
<span class="c1"># (an array of points)</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">Point</span><span class="p">([</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">])</span>

<span class="c1"># get a parabolic isometry</span>
<span class="n">iso</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">sl2_iso</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>

<span class="p">(</span><span class="n">iso</span> <span class="o">@</span> <span class="n">pts</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>array([[-0.375     ,  0.6875    ],
       [-0.29032258,  0.70967742]])
</code></pre>

<p>The data is returned as a 2x2 numpy array, giving x,y Kleinian coordinates for
the translated points.</p>

<p>Working with composite objects can be nice because it's a convenient way to
handle <em>orbits</em> of hyperbolic objects under groups of isometries. To see
this, we can use the <code><a href="#HyperbolicRepresentation">HyperbolicRepresentation</a></code> class to make a representation of
a free group, and then translate a pair of points by some words in the group.</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="kn">from</span> <span class="nn">geometry_tools</span> <span class="kn">import</span> <span class="n">hyperbolic</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="c1"># make a free group representation by mapping the generators to loxodromic</span>
<span class="c1"># isometries with perpendicular axes</span>
<span class="n">free_rep</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">HyperbolicRepresentation</span><span class="p">()</span>
<span class="n">free_rep</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">sl2_iso</span><span class="p">([[</span><span class="mf">3.</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">]])</span>
<span class="n">rot</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">Isometry</span><span class="o">.</span><span class="n">standard_rotation</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">free_rep</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot</span> <span class="o">@</span> <span class="n">free_rep</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">@</span> <span class="n">rot</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>

<span class="c1"># make a pair of points in hyperbolic space</span>
<span class="n">pt</span> <span class="o">=</span> <span class="n">hyperbolic</span><span class="o">.</span><span class="n">Point</span><span class="p">([[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span>
                       <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]],</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>

<span class="c1"># get image of reduced words of length at most 3</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">free_rep</span><span class="o">.</span><span class="n">free_words_less_than</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">isos</span> <span class="o">=</span> <span class="n">free_rep</span><span class="o">.</span><span class="n">isometries</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>

<span class="c1"># get coordinates of points translated by these isometries.</span>
<span class="c1"># we have to specify &quot;pairwise&quot; argument because we want each</span>
<span class="c1"># isometry to apply to each point in our composite Point object.</span>
<span class="p">(</span><span class="n">isos</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="s2">&quot;pairwise&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>array([[[ 0.00000000e+00,  3.00000000e-01],
    [ 1.00000000e-01,  0.00000000e+00]],

   [[-9.75609756e-01,  6.58536585e-02],
    [-9.70270270e-01,  0.00000000e+00]],

   [[ 9.75609756e-01,  6.58536585e-02],
    [ 9.80000000e-01,  0.00000000e+00]],

   [[-6.41883840e-17, -9.55172414e-01],
    [ 2.19512195e-02, -9.75609756e-01]],

   [[ 5.73042276e-17,  9.86792453e-01],
    [ 2.19512195e-02,  9.75609756e-01]]])
</code></pre>

<p>The coordinate data is returned as a 5x2x2 numpy array, since there are 5
isometries being applied to 2 points, each of which has 2 coordinates. To
flatten the output to a 10x2 array (representing an array of 10 points), we
could use <code><a href="#HyperbolicObject.flatten_to_unit">HyperbolicObject.flatten_to_unit()</a></code>.</p>
</div>

                        <input id="mod-hyperbolic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-hyperbolic-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Model objects in hyperbolic space with numerical coordinates.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">This module provides abstract versions of various objects in hyperbolic</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">geometry (points, line segments, polygons, isometries, etc.) and gives a</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">unified framework for *translating those objects by isometries* and *getting</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">their coordinates in various models of hyperbolic space.*</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="sd">For instance, to get a single point in the hyperbolic plane, use the `Point`</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">class:</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="sd">```python</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="sd">from geometry_tools import hyperbolic</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="sd"># get a point by providing kleinian coordinates</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">point = hyperbolic.Point([0.1, 0.0], model=hyperbolic.Model.KLEIN)</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="sd"># or equivalently:</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="sd">point = hyperbolic.get_point([0.1, 0.0], model=&quot;klein&quot;)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="sd"># get the poincare coordinates of this point.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="sd">point.coords(model=&quot;poincare&quot;)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">```</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="sd">    array([0.05012563, 0.        ])</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">The `Isometry` class models isometries of hyperbolic space. The easiest way to</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a><span class="sd">obtain an isometry of the hyperbolic plane is to use the isomorphism from</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">$\mathrm{PSL}(2, \mathbb{R})$ to the (orientation-preserving) isometry group</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd"> of $\mathbb{H}^2$.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">```python</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">from geometry_tools import hyperbolic</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd"># get a loxodromic isometry and a point in H^2</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">hyp_iso = hyperbolic.sl2_iso([[2., 0.], [0., -1./2]])</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a><span class="sd">point = hyperbolic.get_point([0., 0.])</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd"># apply the isometry to the point</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a><span class="sd">(hyp_iso @ point).coords(model=&quot;halfplane&quot;)</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">```</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">    array([-0.  ,  0.25])</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">This module is built on top of the `geometry_tools.projective`</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">submodule, which means that it is possible to easily and efficiently</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">build *composite* hyperbolic objects out of arrays of subobjects, and</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">then translate the entire composite object at once. For instance, we</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a><span class="sd">can build an array of points, and translate all of those points by an</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">isometry:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">```python</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">from geometry_tools import hyperbolic</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a><span class="sd"># make two points in Klein coordinates</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">p1 = hyperbolic.Point([0., 0.1], model=&quot;klein&quot;)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">p2 = hyperbolic.Point([0.1, 0.], model=&quot;klein&quot;)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd"># package these two points together into a single hyperbolic object</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd"># (an array of points)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a><span class="sd">pts = hyperbolic.Point([p1, p2])</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd"># get a parabolic isometry</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a><span class="sd">iso = hyperbolic.sl2_iso([[1., 1.], [0., 1.]])</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">(iso @ pts).coords(model=&quot;klein&quot;)</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">```</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    array([[-0.375     ,  0.6875    ],</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">           [-0.29032258,  0.70967742]])</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">The data is returned as a 2x2 numpy array, giving x,y Kleinian coordinates for</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">the translated points.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">Working with composite objects can be nice because it&#39;s a convenient way to</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">handle *orbits* of hyperbolic objects under groups of isometries. To see</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a><span class="sd">this, we can use the `HyperbolicRepresentation` class to make a representation of</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">a free group, and then translate a pair of points by some words in the group.</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a><span class="sd">```python</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">from geometry_tools import hyperbolic</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">from numpy import pi</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd"># make a free group representation by mapping the generators to loxodromic</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd"># isometries with perpendicular axes</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="sd">free_rep = hyperbolic.HyperbolicRepresentation()</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">free_rep[&quot;a&quot;] = hyperbolic.sl2_iso([[3., 0], [0., 1./3]])</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">rot = hyperbolic.Isometry.standard_rotation(pi / 2)</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">free_rep[&quot;b&quot;] = rot @ free_rep[&quot;a&quot;] @ rot.inv()</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd"># make a pair of points in hyperbolic space</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">pt = hyperbolic.Point([[0., 0.3],</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">                       [0.1, 0.0]], model=&quot;klein&quot;)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a><span class="sd"># get image of reduced words of length at most 3</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">words = free_rep.free_words_less_than(2)</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">isos = free_rep.isometries(words)</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="sd"># get coordinates of points translated by these isometries.</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="sd"># we have to specify &quot;pairwise&quot; argument because we want each</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="sd"># isometry to apply to each point in our composite Point object.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="sd">(isos.apply(pt, &quot;pairwise&quot;)).coords(model=&quot;klein&quot;)</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="sd">```</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="sd">    array([[[ 0.00000000e+00,  3.00000000e-01],</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="sd">        [ 1.00000000e-01,  0.00000000e+00]],</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">       [[-9.75609756e-01,  6.58536585e-02],</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">        [-9.70270270e-01,  0.00000000e+00]],</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="sd">       [[ 9.75609756e-01,  6.58536585e-02],</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">        [ 9.80000000e-01,  0.00000000e+00]],</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">       [[-6.41883840e-17, -9.55172414e-01],</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">        [ 2.19512195e-02, -9.75609756e-01]],</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">       [[ 5.73042276e-17,  9.86792453e-01],</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">        [ 2.19512195e-02,  9.75609756e-01]]])</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">The coordinate data is returned as a 5x2x2 numpy array, since there are 5</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">isometries being applied to 2 points, each of which has 2 coordinates. To</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">flatten the output to a 10x2 array (representing an array of 10 points), we</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a><span class="sd">could use `HyperbolicObject.flatten_to_unit()`.</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">projective</span><span class="p">,</span> <span class="n">representation</span><span class="p">,</span> <span class="n">utils</span><span class="p">,</span> <span class="n">lie</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="kn">from</span> <span class="nn">.base</span> <span class="kn">import</span> <span class="n">GeometryError</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">SAGE_AVAILABLE</span><span class="p">:</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>    <span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">sagewrap</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="c1">#arbitrary</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="n">ERROR_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-8</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="n">BOUNDARY_THRESHOLD</span> <span class="o">=</span> <span class="mf">1e-5</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="n">CHECK_LIGHT_CONE</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>    <span class="sd">&quot;&quot;&quot;Enumerate implemented models of hyperbolic space.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">    Models can have different aliases, and can be compared to strings</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">    with the == operator, which returns `True` if the strings match</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">    any alias name (case insensitive).</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>    <span class="n">POINCARE</span> <span class="o">=</span> <span class="s2">&quot;poincare&quot;</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a>    <span class="n">KLEIN</span> <span class="o">=</span> <span class="s2">&quot;klein&quot;</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a>    <span class="n">KLEINIAN</span> <span class="o">=</span> <span class="s2">&quot;klein&quot;</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a>    <span class="n">AFFINE</span> <span class="o">=</span> <span class="s2">&quot;klein&quot;</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a>    <span class="n">HALFSPACE</span> <span class="o">=</span> <span class="s2">&quot;halfspace&quot;</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a>    <span class="n">HALFPLANE</span> <span class="o">=</span> <span class="s2">&quot;halfspace&quot;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>    <span class="n">HYPERBOLOID</span> <span class="o">=</span> <span class="s2">&quot;hyperboloid&quot;</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>    <span class="n">PROJECTIVE</span> <span class="o">=</span> <span class="s2">&quot;projective&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>    <span class="k">def</span> <span class="nf">aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>        <span class="sd">&quot;&quot;&quot;List all of the different accepted names for this hyperbolic model.&quot;&quot;&quot;</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">Model</span><span class="o">.</span><span class="n">__members__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>                <span class="k">if</span> <span class="n">member</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">]</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span><span class="p">:</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">():</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>            <span class="k">pass</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="k">class</span> <span class="nc">HyperbolicObject</span><span class="p">(</span><span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>    <span class="sd">&quot;&quot;&quot;Model for an abstract object in hyperbolic space.</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">    Subclasses of HyperbolicObject model more specific objects in</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">    hyperbolic geometry, e.g. points, geodesic segments, hyperplanes,</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">    ideal points.</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">    Every object in hyperbolic space H^n has the underlying data of an</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">    ndarray whose last dimension is n+1. This is interpreted as a</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">    collection of (row) vectors in R^(n+1), or more precisely R^(n,1),</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a><span class="sd">    which transforms via the action of the indefinite orthogonal group</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">    O(n,1).</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="sd">    The last `unit_ndims` dimensions of this underlying array represent</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a><span class="sd">    a single object in hyperbolic space, which transforms as a unit</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">    under the action of O(n,1). The remaining dimensions of the array</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">    are used to represent an array of such &quot;unit objects.&quot;</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>    <span class="nd">@property</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>    <span class="k">def</span> <span class="nf">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>            <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>            <span class="k">return</span> <span class="n">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a>            <span class="k">pass</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a>        <span class="k">return</span> <span class="n">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>        <span class="sd">&quot;&quot;&quot;Get or set a representation of this hyperbolic object in</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        coordinates.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        For the base `HyperbolicObject` class, the available models</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        are `Model.KLEIN` and `Model.PROJECTIVE`.</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">        Parameters</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">        ----------</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">        model : Model</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">            which model to take coordinates in</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">            data for this hyperbolic object, interpreted as</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">            coordinates with respect to `model`. If `None`, just</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">            return coordinates.</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">        Raises</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">        ------</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">        GeometryError</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">            Raised if an unsupported model is specified.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span><span class="p">:</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a>            <span class="s2">&quot;Unimplemented model for an object of type </span><span class="si">{}</span><span class="s2">: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>            <span class="p">))</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>    <span class="k">def</span> <span class="nf">kleinian_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">aff_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="n">HyperbolicObject</span><span class="p">,</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="sd">&quot;&quot;&quot;Model for a point (or ndarray of points) in the closure of</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">    hyperbolic space.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a><span class="sd">        Parameters</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a><span class="sd">        ----------</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a><span class="sd">        point : HyperbolicObject or iterable or ndarray</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a><span class="sd">            Data used to construct a point or an array of points. If</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a><span class="sd">            `point` is a `HyperbolicObject`, then use the underlying</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a><span class="sd">            coordinate data to build an array of points. If `point` is</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="sd">            an iterable of `HyperbolicObject`s, build a composite `Point`</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="sd">            object out of this array. If `point` is an `ndarray`, then</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a><span class="sd">            interpret this as coordinate data for an array of points</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a><span class="sd">            in some hyperbolic model.</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a><span class="sd">        model : Model</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a><span class="sd">            if `point` is numerical data, then what model of</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a><span class="sd">            hyperbolic space we should use to interpret `point` as</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="sd">            coordinates.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>            <span class="k">return</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>            <span class="k">pass</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>    <span class="k">def</span> <span class="nf">hyperboloid_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the hyperboloid model.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        Parameters</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">        ----------</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">            Data to set coordinates to, in the hyperboloid</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a><span class="sd">            model. The last dimension of the array is the</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a><span class="sd">            dimension of the vector space R^(n,1). If `None`, do not</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">            update coordinates.</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="sd">        Returns</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">        -------</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a><span class="sd">        ndarray</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="sd">            Hyperboloid coordinates for this point (or array of</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="sd">            points).</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>        <span class="k">return</span> <span class="n">hyperboloid_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>    <span class="k">def</span> <span class="nf">poincare_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the hyperboloid model.</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        Parameters</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">        ----------</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">            Data to set coordinates to, as points in projective space.</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">            The last dimension of the array is the dimension of the</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">            vector space R^(n,1). If `None`, do not update</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a><span class="sd">            coordinates.</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">        Returns</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a><span class="sd">        -------</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">        ndarray</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">            Projective coordinates for this point (or array of</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">            points).</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a>            <span class="n">klein</span> <span class="o">=</span> <span class="n">poincare_to_kleinian</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">))</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">(</span><span class="n">klein</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>        <span class="k">return</span> <span class="n">kleinian_to_poincare</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">())</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>    <span class="k">def</span> <span class="nf">halfspace_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the half-space model.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">        Parameters</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">        ----------</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">            Data to set coordinates to, as points in half-space.  The</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">            last dimension of the array is the dimension of hyperbolic</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">            space H^n. If `None`, do not update coordinates.</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">        Returns</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">        -------</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">        ndarray</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">            Half-space coordinates for this point (or array of</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">            points).</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a>        <span class="n">poincare</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a>            <span class="n">poincare</span> <span class="o">=</span> <span class="n">halfspace_to_poincare</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">))</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a>        <span class="n">poincare_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poincare_coords</span><span class="p">(</span><span class="n">poincare</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a>        <span class="k">return</span> <span class="n">poincare_to_halfspace</span><span class="p">(</span><span class="n">poincare_coords</span><span class="p">)</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>        <span class="sd">&quot;&quot;&quot;Get or set a representation of this hyperbolic object in</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">        coordinates.</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">        The available models are `Model.KLEIN`, `Model.PROJECTIVE`,</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        `Model.POINCARE`, `Model.HYPERBOLOID`, and `Model.HALFSPACE`.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">        Parameters</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        ----------</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">        model : Model</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">            which model to take coordinates in</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">            data for this hyperbolic object, interpreted as</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">            coordinates with respect to `model`. If `None`, just</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a><span class="sd">            return coordinates.</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">        Raises</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">        ------</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">        GeometryError</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">            Raised if an unsupported model is specified.</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a>            <span class="k">return</span> <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>        <span class="k">except</span> <span class="n">GeometryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">poincare_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HYPERBOLOID</span><span class="p">:</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">halfspace_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>    <span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="sd">&quot;&quot;&quot;Compute hyperbolic distances between pairs of points, or pairs of</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a><span class="sd">            arrays of points.</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">        Parameters</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">        ----------</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">        other : Point</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">            The point to compute distances to</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        Returns</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">        -------</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">        ndarray</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a><span class="sd">            distances in hyperbolic space between self and other</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a>        <span class="c1">#TODO: allow for pairwise distances</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a>        <span class="n">self_hyp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">()</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a>        <span class="n">other_hyp</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">()</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">self_hyp</span><span class="p">,</span> <span class="n">other_hyp</span><span class="p">,</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccosh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">products</span><span class="p">))</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a>    <span class="k">def</span> <span class="nf">origin_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking an &quot;origin&quot; point to this point</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        Returns</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">        -------</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">        Isometry :</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">            Some isometry taking the point with Kleinian/Poincare</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">            coordinates (0, 0, ...) to this point. This isometry is</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a><span class="sd">            not uniquely determined and is not guaranteed to be</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">            orientation-preserving.</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a>        <span class="n">normed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>            <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">),</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a>        <span class="p">)</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>        <span class="n">isom</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a>                                   <span class="n">force_oriented</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">isom</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a>    <span class="k">def</span> <span class="nf">unit_tangent_towards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a>        <span class="sd">&quot;&quot;&quot;Get a unit tangent vector with this basepoint, pointing at another point</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">        Parameters</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">        ----------</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">        other : Point</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">            another point in hyperbolic space where the unit tangent</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">            vector points</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">        Returns</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">        -------</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">        TangentVector</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">            A tangent vector with this point at its base and pointing</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">            towards `other`.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>    <span class="k">def</span> <span class="nf">get_origin</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>        <span class="sd">&quot;&quot;&quot;Get a point (or ndarray of points) at the &quot;origin&quot; of hyperbolic</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a><span class="sd">           space</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a><span class="sd">        Parameters</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">        ----------</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="sd">        dimension : int</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">            Dimension of hyperbolic space where this point lives</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="sd">        shape : tuple(int)</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a><span class="sd">            Shape of array of origin points to get</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="sd">        Returns</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a><span class="sd">        -------</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">        Point</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">            Point object with Kleinian/Poincare coords (0, 0, ...)</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">dimension</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>                     <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a><span class="k">class</span> <span class="nc">DualPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>    <span class="sd">&quot;&quot;&quot;Model for a &quot;dual point&quot; in hyperbolic space (a point in the</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a><span class="sd">    complement of the projectivization of the Minkowski light cone,</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a><span class="sd">    corresponding to a geodesic hyperplane in hyperbolic space).</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>        <span class="n">Point</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>            <span class="k">return</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">spacelike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Dual point data must consist of vectors&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a>                                <span class="s2">&quot; in the complement of the Minkowski light cone&quot;</span><span class="p">)</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="k">class</span> <span class="nc">IdealPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>    <span class="sd">&quot;&quot;&quot;Model for an ideal point in hyperbolic space (lying on the boundary</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">    of the projectivization of the Minkowski light cone)</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a>        <span class="n">Point</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a>            <span class="k">return</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lightlike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Ideal point data must consist of vectors&quot;</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>                                <span class="s2">&quot;in the boundary of the Minkowski light cone&quot;</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a>    <span class="k">def</span> <span class="nf">from_angle</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a>        <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a>                <span class="s2">&quot;Cannot use an angle to specify a point on the boundary of&quot;</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a>                <span class="s2">&quot; hyperbolic 1-space&quot;</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a>            <span class="p">)</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a>        <span class="c1"># INTENDED BEHAVIOR: if this function is passed a Sage</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>        <span class="c1"># integer, and no base_ring or dtype information is provided,</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a>        <span class="c1"># the returned result should have dtype(&#39;float64&#39;).</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a>        <span class="n">like</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>                             <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>        <span class="c1"># TODO: replace this with a utils function that accepts dtype</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>        <span class="c1"># and base_ring data, so that cos and sin have a sage type if</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>        <span class="c1"># theta does also.</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>        <span class="n">pt</span> <span class="o">=</span> <span class="n">IdealPoint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>            <span class="n">pt</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>        <span class="k">return</span> <span class="n">pt</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a><span class="k">class</span> <span class="nc">Subspace</span><span class="p">(</span><span class="n">IdealPoint</span><span class="p">):</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>    <span class="sd">&quot;&quot;&quot;Model for a geodesic subspace of hyperbolic space.</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="sd">        Parameters</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">        ----------</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">        proj_data : HyperbolicObject or ndarray</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="sd">            Data used to construct a subspace (or array of</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">            subspaces). If `proj_data` is a `HyperbolicObject`, then</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">            use underlying coordinate data to build an array of</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">            subspaces. If `proj_data` is an `ndarray`, then interpret</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">            this as coordinate data for an array of subspaces in the</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">            projective model.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a>    <span class="nd">@property</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a>    <span class="k">def</span> <span class="nf">ideal_basis_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a>        <span class="sd">&quot;&quot;&quot;Get coordinates for a basis of this subspace lying in the ideal</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">           boundary of hyperbolic space</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">        Parameters</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">        ----------</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">        model : Model</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">            Model of hyperbolic space in which to compute coordinates</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">        Returns</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">        -------</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">        ndarray</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">            Coordinates for k vectors in the ideal boundary of</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">            hyperbolic space, giving a basis for this subspace.</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="c1">#we don&#39;t return proj_data directly, since we want subclasses</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>        <span class="c1">#to be able to use this method even if the structure of the</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>        <span class="c1">#underlying data is different.</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>    <span class="k">def</span> <span class="nf">spacelike_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>        <span class="sd">&quot;&quot;&quot;Get a spacelike point in the orthogonal complement to this subspace</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">        Returns</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">        -------</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">        DualPoint</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">            A spacelike (i.e. Minkowski-positive) point which is</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a><span class="sd">            Minkowski-orthogonal to this subspace. This is not</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="sd">            uniquely determined (as a point in projective space)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a><span class="sd">            unless the subspace is a hyperplane.</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>        <span class="n">orthed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_with_dual</span><span class="p">()</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>        <span class="k">return</span> <span class="n">DualPoint</span><span class="p">(</span><span class="n">orthed</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a>    <span class="k">def</span> <span class="nf">_data_with_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="n">midpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>        <span class="n">poincare_ctr</span><span class="p">,</span> <span class="n">poincare_rad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>        <span class="n">spacelike_guess</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">poincare_ctr</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>        <span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>        <span class="n">to_orthogonalize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">midpoints</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">spacelike_guess</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)],</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="n">orthed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">indefinite_orthogonalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>                                                <span class="n">to_orthogonalize</span><span class="p">)</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">orthed</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>    <span class="k">def</span> <span class="nf">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a k-sphere corresponding to this subspace</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">        in the Poincare model.</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">        Parameters</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">        ----------</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a><span class="sd">        model : Model</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">            hyperbolic model to use. Acceptable values are</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">            `Model.POINCARE` and `Model.HALFSPACE`</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">        Returns</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">        -------</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">        tuple</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a><span class="sd">            Tuple of the form `(centers, radii)`, where `centers` and</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a><span class="sd">            `radii` are `ndarray`s respectively holding the centers</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="sd">            and radii of spheres corresponding to this subspace in the</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="sd">            given hyperbolic model.</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="sd">        Raises</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a><span class="sd">        ------</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a><span class="sd">        GeometryError</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>            <span class="n">klein_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a>            <span class="n">klein_midpoint</span> <span class="o">=</span> <span class="n">klein_basis</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">klein_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a>            <span class="n">poincare_midpoint</span> <span class="o">=</span> <span class="n">kleinian_to_poincare</span><span class="p">(</span><span class="n">klein_midpoint</span><span class="p">)</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>            <span class="n">poincare_extreme</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">sphere_inversion</span><span class="p">(</span><span class="n">poincare_midpoint</span><span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">poincare_midpoint</span> <span class="o">+</span> <span class="n">poincare_extreme</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">poincare_midpoint</span> <span class="o">-</span> <span class="n">poincare_extreme</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>            <span class="n">halfspace_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">)</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>            <span class="n">halfspace_midpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">halfspace_basis</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>                                  <span class="n">halfspace_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>            <span class="c1">#just use the first element of the basis</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">halfspace_midpoint</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a>                <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">halfspace_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">halfspace_midpoint</span><span class="p">)</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>            <span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute spherical parameters for an object of type </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>                 <span class="s2">&quot; in model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>            <span class="p">)</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>    <span class="k">def</span> <span class="nf">reflection_across</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>        <span class="sd">&quot;&quot;&quot;Get a hyperbolic isometry reflecting across this hyperplane.</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">        Returns</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        -------</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        Isometry</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">            Isometry reflecting across this hyperplane.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a>        <span class="n">dual_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_with_dual</span><span class="p">()</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute a reflection across a subspace of &quot;</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a>                 <span class="s2">&quot;dimension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a>            <span class="p">)</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a>        <span class="n">refdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span> <span class="o">@</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span> <span class="o">@</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>                   <span class="n">dual_data</span><span class="p">)</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">refdata</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="k">class</span> <span class="nc">PointPair</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">projective</span><span class="o">.</span><span class="n">PointPair</span><span class="p">):</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>    <span class="sd">&quot;&quot;&quot;Abstract model for a hyperbolic object whose underlying data is</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">    determined by a pair of points in R^(n,1)</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="sd">&quot;&quot;&quot;If `endpoint2` is `None`, interpret `endpoint1` as either a (2</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">        x...x n) `ndarray` (where n is the dimension of the underlying</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">        vector space), or else a composite `Point` object which can be</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a><span class="sd">        unpacked into two Points (which may themselves be composite).</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a><span class="sd">        If `endpoint2` is given, then both `endpoint1` and `endpoint2`</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a><span class="sd">        can be used to construct `Point` objects, which serve as the</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a><span class="sd">        endpoints for this pair of points.</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a><span class="sd">        Parameters</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">        ----------</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>        <span class="n">projective</span><span class="o">.</span><span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>    <span class="k">def</span> <span class="nf">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>        <span class="sd">&quot;&quot;&quot;Get coordinates for the endpoints of this point pair</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a><span class="sd">        Parameters</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a><span class="sd">        ----------</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a><span class="sd">        model : Model</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a><span class="sd">            model to compute coordinates in</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a><span class="sd">        Returns</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a><span class="sd">        -------</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a><span class="sd">        ndarray</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a><span class="sd">            Coordinates for the endpoints of this PointPair, as an</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a><span class="sd">            ndarray with shape `(2, ... n)` (where `n` is the</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="sd">            dimension of the hyperbolic space).</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a>    <span class="k">def</span> <span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>        <span class="sd">&quot;&quot;&quot;Convert this pair of points to a composite `Point` object</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">        Returns</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">        -------</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">        Point</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">            Composite `Point` object with the same underlying data as</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">            this point pair.</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">)</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a>    <span class="k">def</span> <span class="nf">get_end_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_points</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a>        <span class="sd">&quot;&quot;&quot;Get a pair of `Point` objects, one for each endpoint of this PointPair</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        Parameters</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">        ----------</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">        as_points : bool</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">            If `True`, return a pair of `Point` objects. Otherwise,</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">            return a pair of `ndarray`s with projective coordinates</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">            for these points.</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">        Returns</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a><span class="sd">        -------</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">        tuple</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="sd">            A tuple `(p1, p2)`, where `p1` and `p2` are either both</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a><span class="sd">            `Point`s or both `ndarrays`, representing the endpoints of</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">            this pair.</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a>        <span class="k">if</span> <span class="n">as_points</span><span class="p">:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_pair</span><span class="p">(</span><span class="n">as_points</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="k">class</span> <span class="nc">Geodesic</span><span class="p">(</span><span class="n">PointPair</span><span class="p">,</span> <span class="n">Subspace</span><span class="p">):</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a>    <span class="sd">&quot;&quot;&quot;Model for a bi-infinite gedoesic in hyperbolic space.</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a>    <span class="nd">@property</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>    <span class="nd">@property</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a circular arc corresponding to this</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a><span class="sd">        geodesic in the Poincare or halfspace models.</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a><span class="sd">        Parameters</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a><span class="sd">        ----------</span>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a><span class="sd">        degrees : bool</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="sd">            if `True`, return angles in degrees. Otherwise, return</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="sd">            angles in radians</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a><span class="sd">        model : Model</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="sd">            hyperbolic model to use for the computation</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">        Returns</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">        -------</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">        tuple</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a><span class="sd">            tuple `(centers, radii, thetas)`, where `centers`,</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="sd">            `radii`, and `thetas` are `ndarray`s representing the</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="sd">            centers, radii, and begin/end angles for the circle</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a><span class="sd">            corresponding to this arc in the given model of hyperbolic</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">            space. Angles are always specified in counterclockwise</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">            order.</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">short_arc</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a>    <span class="k">def</span> <span class="nf">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">):</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a>        <span class="sd">&quot;&quot;&quot;Construct a geodesic which is the fixpoint set of a reflection.</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">        Parameters</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">        ----------</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">        reflection : Isometry or ndarray</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">            The reflection to compute the fixed geodesic for</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">        Raises</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">        ------</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">        GeometryError :</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">            If the given isometry is not a reflection, or if the</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">            dimension of the underlying hyperbolic space is not 2.</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">        Returns</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">        -------</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a><span class="sd">        Geodesic</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a><span class="sd">            A `Geodesic` fixed by the given isometry.</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>        <span class="k">if</span> <span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Creating segment from reflection expects dimension 2, got dimension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span><span class="p">))</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>        <span class="n">hyperplane</span> <span class="o">=</span> <span class="n">Hyperplane</span><span class="o">.</span><span class="n">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">)</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="n">pt1</span> <span class="o">=</span> <span class="n">hyperplane</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>        <span class="n">pt2</span> <span class="o">=</span> <span class="n">hyperplane</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="k">class</span> <span class="nc">Segment</span><span class="p">(</span><span class="n">Geodesic</span><span class="p">):</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>    <span class="sd">&quot;&quot;&quot;Model a geodesic segment in hyperbolic space.&quot;&quot;&quot;</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>                           <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>        <span class="sd">&quot;&quot;&quot;self.unit_ndims = 2</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">        self.aux_ndims = 0</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a><span class="sd">        self.dual_ndims = 0</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">        if endpoint2 is None:</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">            try:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">                self._construct_from_object(endpoint1, **kwargs)</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">                return</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">            except (AttributeError, TypeError, GeometryError):</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">                pass</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">            try:</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">                self.set(endpoint1, **kwargs)</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">                return</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">            except (AttributeError, GeometryError) as e:</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">                pass</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">        self.set_endpoints(endpoint1, endpoint2, **kwargs)</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">    def set_endpoints(self, endpoint1, endpoint2=None, **kwargs):</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">        # reimplemented to also compute ideal endpoints</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">        if endpoint2 is None:</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">            self.endpoints = Point(endpoint1).proj_data</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">            self._compute_ideal_endpoints(endpoint1)</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">            return</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">        pt1 = Point(endpoint1)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">        pt2 = Point(endpoint2)</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">        self.endpoints = Point(np.stack(</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">            [pt1.proj_data, pt2.proj_data], axis=-2)</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">        )</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">        self._compute_ideal_endpoints(self.endpoints)</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">        self._set_optional(**kwargs)&quot;&quot;&quot;</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a>    <span class="nd">@property</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>    <span class="k">def</span> <span class="nf">_assert_aux_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">):</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Underlying auxiliary data for a hyperbolic&quot;</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>            <span class="s2">&quot; segment must have shape (..., 2, n) but data&quot;</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>            <span class="s2">&quot; has shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Underlying data for a hyperbolic&quot;</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="s2">&quot; segment must have shape (..., 2, n) but data&quot;</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a>            <span class="s2">&quot; has shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>            <span class="k">return</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timelike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;segment data at index [..., 0, :,&quot;</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>            <span class="s2">&quot;:] must consist of timelike vectors&quot;</span> <span class="p">)</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lightlike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;segment data at index [..., 1, :,&quot;</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a>            <span class="s2">&quot;:] must consist of lightlike vectors&quot;</span> <span class="p">)</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">end_data</span><span class="p">):</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a>        <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="n">end_data</span><span class="p">)</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="n">end_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">end_data</span> <span class="o">@</span> <span class="n">minkowski</span><span class="p">(</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>            <span class="n">dim</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>        <span class="p">)</span> <span class="o">@</span> <span class="n">end_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>        <span class="n">a11</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>        <span class="n">a22</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>        <span class="n">a12</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a12</span> <span class="o">+</span> <span class="n">a22</span>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a22</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">a22</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a>        <span class="n">mu1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>        <span class="n">mu2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a>        <span class="n">null1</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a>                 <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu1</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>        <span class="n">null2</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a>                 <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu2</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a>        <span class="n">ideal_basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">null1</span><span class="p">,</span> <span class="n">null2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a>        <span class="k">return</span> <span class="n">ideal_basis</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a>    <span class="k">def</span> <span class="nf">geodesic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a>        <span class="sd">&quot;&quot;&quot;Get the bi-infinite geodesic spanned by this segment</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">        Returns</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">        -------</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        Geodesic</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">            Geodesic in hyperbolic space spanned by this segment.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>    <span class="k">def</span> <span class="nf">ideal_endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="sd">&quot;&quot;&quot;Alias for Subspace.ideal_basis_coords.</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a circular arc corresponding to this</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">        segment in the Poincare or halfspace models.</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a><span class="sd">        Parameters</span>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">        ----------</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">        degrees : bool</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">            if `True`, return angles in degrees. Otherwise, return</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">            angles in radians</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">        model : Model</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">            hyperbolic model to use for the computation</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">        Returns</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">        -------</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">        tuple</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">            tuple `(centers, radii, thetas)`, where `centers`,</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">            `radii`, and `thetas` are `ndarray`s representing the</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">            centers, radii, and begin/end angles for the circle</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">            corresponding to this arc in the given model of hyperbolic</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">            space. Angles are always specified in counterclockwise</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">            order.</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">short_arc</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="k">class</span> <span class="nc">Hyperplane</span><span class="p">(</span><span class="n">Subspace</span><span class="p">):</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>    <span class="sd">&quot;&quot;&quot;Model for a geodesic hyperplane in hyperbolic space.&quot;&quot;&quot;</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>    <span class="c1">#TODO: reimplement so ideal_basis is aux_data</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a>            <span class="k">return</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a>            <span class="k">pass</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>            <span class="k">return</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>        <span class="k">except</span> <span class="n">GeometryError</span><span class="p">:</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>            <span class="k">pass</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ideal_basis</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">)</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>            <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Underlying data for hyperplane in H^n must&quot;</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>                                  <span class="s2">&quot; have shape (..., n, n) but data has shape&quot;</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>                                  <span class="s2">&quot; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>            <span class="k">return</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">spacelike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Hyperplane data at index [..., 0, :]&quot;</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a>                                  <span class="s2">&quot; must consist of spacelike vectors&quot;</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lightlike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Hyperplane data at index [..., 1, :]&quot;</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>                                  <span class="s2">&quot; must consist of lightlike vectors&quot;</span><span class="p">)</span> <span class="p">)</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a>    <span class="k">def</span> <span class="nf">_data_with_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>    <span class="nd">@property</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a>    <span class="k">def</span> <span class="nf">spacelike_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>    <span class="nd">@property</span>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a>    <span class="k">def</span> <span class="nf">_compute_ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>        <span class="n">spacelike_vector</span> <span class="o">=</span> <span class="n">DualPoint</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">spacelike_vector</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a>        <span class="n">transform</span> <span class="o">=</span> <span class="n">spacelike_to</span><span class="p">(</span><span class="n">spacelike_vector</span><span class="p">)</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spacelike_vector</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>            <span class="n">spacelike_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">spacelike_vector</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a>        <span class="n">standard_ideal_basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a>            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a>        <span class="p">)</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a>        <span class="n">standard_ideal_basis</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a>        <span class="n">ideal_basis</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standard_ideal_basis</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a>                                      <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;pairwise&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a>        <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spacelike_vector</span><span class="p">,</span> <span class="n">ideal_basis</span><span class="p">],</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a>                                  <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>    <span class="k">def</span> <span class="nf">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">):</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>        <span class="sd">&quot;&quot;&quot;Construct a hyperplane which is the fixpoint set of a reflection.</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a><span class="sd">        Parameters</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="sd">        ----------</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a><span class="sd">        reflection : Isometry or ndarray</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a><span class="sd">            The reflection to compute the fixed plane for</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a><span class="sd">        Raises</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="sd">        ------</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a><span class="sd">        GeometryError :</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a><span class="sd">            If the given isometry is not a reflection.</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="sd">        Returns</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="sd">        -------</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">        Hyperplane</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a><span class="sd">            A `Hyperplane` fixed by the given isometry.</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">reflection</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>        <span class="c1"># TODO: make this compatible with sage</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>        <span class="c1">#numpy&#39;s eig expects a matrix operating on the left</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>        <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>        <span class="n">dimension</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>        <span class="c1">#we expect a reflection to have eigenvalues [-1, 1, ...]</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>        <span class="n">expected_evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>        <span class="n">expected_evals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>        <span class="n">eval_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">expected_evals</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eval_differences</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Not a reflection matrix&quot;</span><span class="p">)</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>        <span class="c1">#sometimes eigenvalues will be complex due to roundoff error</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>        <span class="c1">#so we cast to reals to avoid warnings.</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>        <span class="n">reflected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">evals</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>        <span class="c1"># SAGETEST</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>        <span class="n">spacelike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">evecs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">reflected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>        <span class="p">)</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>        <span class="k">return</span> <span class="n">Hyperplane</span><span class="p">(</span><span class="n">spacelike</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="k">class</span> <span class="nc">TangentVector</span><span class="p">(</span><span class="n">PointPair</span><span class="p">):</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>    <span class="sd">&quot;&quot;&quot;Model for a tangent vector in hyperbolic space.&quot;&quot;&quot;</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">,</span> <span class="n">vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                 <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>        <span class="sd">&quot;&quot;&quot;If `vector` is `None`, interpret `point_data` as either an ndarray</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a><span class="sd">        of shape `(..., 2, n)` (where `n` is the dimension of the</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a><span class="sd">        underlying vector space), or else a composite HyperbolicObject</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="sd">        whose data can be unpacked into a point in projective space</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="sd">        and a tangent vector to a hyperboloid.</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a><span class="sd">        If `vector` is given, then `point_data` is used to construct</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a><span class="sd">        the basepoint for this tangent vector, and `vector` is used to</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a><span class="sd">        construct the tangent vector to the hyperboloid.</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a><span class="sd">        Parameters</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a><span class="sd">        ----------</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="sd">        point_data : Point or ndarray</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="sd">            The basepoint of the tangent vector, or (if `vector` is</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="sd">            `None`) the data of the basepoint and the tangent vector.</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a><span class="sd">        vector : HyperbolicObject or ndarray</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">            The tangent vector data. If `None`, `point_data` contains</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a><span class="sd">            the data for the basepoint and the tangent vector.</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>                           <span class="n">unit_ndims</span><span class="o">=</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>                           <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>                           <span class="n">dual_ndims</span><span class="o">=</span><span class="n">dual_ndims</span><span class="p">,</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>        <span class="k">if</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a>                <span class="p">(</span><span class="s2">&quot;Underlying data for a tangent vector in Hn must have shape&quot;</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>                 <span class="s2">&quot; (..., 2, n) but data has shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a>                     <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>            <span class="p">)</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>            <span class="k">return</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a>        <span class="n">point_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>        <span class="n">vector_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timelike</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;tangent vector data at index [..., 0, :] must&quot;</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a>                                <span class="s2">&quot; consist of timelike vectors&quot;</span><span class="p">)</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">point_data</span><span class="p">,</span> <span class="n">vector_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">products</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;tangent vector must be orthogonal to point&quot;</span><span class="p">)</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>        <span class="n">point_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>        <span class="n">vec_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="c1"># _compute_aux_data doesn&#39;t assume that proj_data has already</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="c1"># been set, so we don&#39;t refer to self.minkowski here</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>        <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>        <span class="n">projected</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>            <span class="n">point_data</span><span class="p">,</span> <span class="n">vec_data</span><span class="p">,</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>            <span class="n">minkowski</span><span class="p">(</span><span class="n">point_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">base_ring</span><span class="p">)</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>        <span class="p">)</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">point_data</span><span class="p">,</span> <span class="n">projected</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a>    <span class="nd">@property</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>    <span class="nd">@property</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a>    <span class="k">def</span> <span class="nf">vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a>    <span class="k">def</span> <span class="nf">normalized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>        <span class="sd">&quot;&quot;&quot;Get a unit tangent vector in the same direction as this tangent</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">        vector.</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        Returns</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">        -------</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a><span class="sd">        TangentVector</span>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">            Normalized version of this tangent vector (with respect to</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">            the standard Minkowski inner product)</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>        <span class="n">normed_vec</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">normed_vec</span><span class="p">)</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>    <span class="k">def</span> <span class="nf">origin_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking the &quot;origin&quot; to this vector.</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">        The &quot;origin&quot; is a tangent vector whose basepoint lies at (0,</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">        0, ....) in Poincare or Kleinian coordinates, and whose</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">        tangent vector is parallel to the second standard basis</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a><span class="sd">        vector.</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">        Parameters</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">        ----------</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a><span class="sd">        force_oriented : bool</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a><span class="sd">            If `True`, force the computed isometry to be</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a><span class="sd">            orientation-preserving</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a><span class="sd">        Returns</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a><span class="sd">        -------</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a><span class="sd">        Isometry</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a><span class="sd">            Isometry taking the &quot;origin&quot; to this tangent vector.</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>        <span class="n">normed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="n">isom</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>                                   <span class="n">force_oriented</span><span class="p">)</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">isom</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>    <span class="k">def</span> <span class="nf">isometry_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking this tangent vector to a scalar multiple of</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="sd">        the other.</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">        Parameters</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">        ----------</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">        other : TangentVector</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">            Tangent vector to translate this vector to</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a><span class="sd">        force_oriented : bool</span>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">            If `True`, force the computed isometry to be</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">            orientation-preserving.</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">        Returns</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a><span class="sd">        -------</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">        Isometry</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">            Isometry this tangent vector to `other`.</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">origin_to</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_to</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>        <span class="sd">&quot;&quot;&quot;Compute the angle between two tangent vectors.</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">        Parameters</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">        ----------</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a><span class="sd">        other : TangentVector</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">        Returns</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">        -------</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">        float or ndarray</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">            The angle between `self` and `other`.</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>        <span class="n">v1</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>        <span class="n">v2</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>        <span class="n">product</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>    <span class="k">def</span> <span class="nf">point_along</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="sd">&quot;&quot;&quot;Get a point in hyperbolic space along the geodesic specified by</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a><span class="sd">        this tangent vector.</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a><span class="sd">        Parameters</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a><span class="sd">        ----------</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a><span class="sd">        distance : float or ndarray</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a><span class="sd">        Returns</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a><span class="sd">        -------</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a><span class="sd">        Point</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a><span class="sd">            Point in hyperbolic space along the geodesic ray defined</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a><span class="sd">            by this tangent vector</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>        <span class="n">kleinian_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>        <span class="n">kleinian_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>        <span class="n">kleinian_pt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">kleinian_shape</span><span class="p">,</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>                                  <span class="n">like</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>        <span class="n">kleinian_pt</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">hyp_to_affine_dist</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>        <span class="n">basepoint</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">kleinian_pt</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_to</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">basepoint</span><span class="p">,</span> <span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>    <span class="k">def</span> <span class="nf">get_base_tangent</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>        <span class="sd">&quot;&quot;&quot;Get an &quot;origin&quot; tangent vector.</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a><span class="sd">        The basepoint of this tangent vector has coordinates (0, 0,</span>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">        ...) in Poincare/Klein coordinates, and the vector is parallel</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">        to the second standard basis vector in R^(n,1).</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">        Parameters</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a><span class="sd">        ----------</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a><span class="sd">        dimension : int</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a><span class="sd">            Dimension of the hyperbolic space where this tangent vector lives</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">        shape : tuple</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">            Shape of the composite TangentVector object to return.</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">        Returns</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">        -------</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">        TangentVector</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">            An &quot;origin&quot; tangent vector.</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>        <span class="n">origin</span> <span class="o">=</span> <span class="n">Point</span><span class="o">.</span><span class="n">get_origin</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>        <span class="n">vector</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>        <span class="n">vector</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a><span class="k">class</span> <span class="nc">Horosphere</span><span class="p">(</span><span class="n">HyperbolicObject</span><span class="p">):</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>    <span class="sd">&quot;&quot;&quot;Model for a horosphere in hyperbolic space.</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="sd">&quot;&quot;&quot;If `reference_point` is `None`, interpret `center` as either:</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a><span class="sd">        - a (..., 2, n) `ndarray`, where first row of the last two</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a><span class="sd">        ndindices gives the (ideal) center point for this horosphere,</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a><span class="sd">        and the second row gives some reference point on the</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a><span class="sd">        horosphere itself, or</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a><span class="sd">        - a `HyperbolicObject` whose underlying data has the form above.</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="sd">        If `reference_point` is given, then `center` can be used to</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">        construct an `IdealPoint` giving the center of the horosphere,</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a><span class="sd">        and `reference_point` can be used to construct a `Point`</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a><span class="sd">        giving some point on the horosphere.</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="sd">        Parameters</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a><span class="sd">        ----------</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a><span class="sd">        center : Point or ndarray</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="sd">            The (ideal) center point for this horosphere, or an object</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a><span class="sd">            which can be unpacked into all of the data for the</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="sd">            horosphere</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a><span class="sd">        reference_point : Point or ndarray</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="sd">            Any point lying on the horosphere itself. If `None`, then</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">            `center` contains the data for the reference point as</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">            well.</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="k">if</span> <span class="n">reference_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>                <span class="k">return</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>                <span class="k">pass</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_center_ref</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>    <span class="nd">@property</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>    <span class="nd">@property</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a>    <span class="k">def</span> <span class="nf">set_center_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a>        <span class="k">if</span> <span class="n">reference_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">IdealPoint</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a>            <span class="n">ref</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">reference_point</span><span class="p">)</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">ref</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a>    <span class="k">def</span> <span class="nf">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>        <span class="sd">&quot;&quot;&quot;Get the center and radius of a sphere giving this horosphere in</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a><span class="sd">        poincare coordinates.</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a>        <span class="n">ideal_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a>        <span class="n">ref_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>            <span class="n">model_radius</span> <span class="o">=</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">ideal_coords</span> <span class="o">-</span> <span class="n">ref_coords</span><span class="p">)</span> <span class="o">/</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>                            <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">ideal_coords</span><span class="p">,</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>                                                           <span class="n">ref_coords</span><span class="p">))))</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>            <span class="n">model_center</span> <span class="o">=</span> <span class="n">ideal_coords</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model_radius</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>            <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>                <span class="n">ideal_euc</span> <span class="o">=</span> <span class="n">ideal_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>                <span class="n">ref_euc</span> <span class="o">=</span> <span class="n">ref_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>                <span class="n">ref_z</span> <span class="o">=</span> <span class="n">ref_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>                <span class="n">model_radius</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">ideal_euc</span> <span class="o">-</span> <span class="n">ref_euc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ref_z</span> <span class="o">+</span> <span class="n">ref_z</span><span class="p">)</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>                <span class="n">model_center</span> <span class="o">=</span> <span class="n">ideal_coords</span><span class="p">[:]</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>                <span class="n">model_center</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_radius</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a>                <span class="s2">&quot;No implementation for spherical parameters for a horosphere in&quot;</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a>                <span class="s2">&quot; model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a>            <span class="p">)</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>        <span class="k">return</span> <span class="n">model_center</span><span class="p">,</span> <span class="n">model_radius</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a>    <span class="k">def</span> <span class="nf">center_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>    <span class="k">def</span> <span class="nf">ref_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>    <span class="k">def</span> <span class="nf">intersect_geodesic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geodesic</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>        <span class="sd">&quot;&quot;&quot;Compute the intersection points of a geodesic with this horosphere</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="n">Segment</span><span class="p">(</span><span class="n">geodesic</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>        <span class="n">geodesic_endpts</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">ideal_endpoint_coords</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>        <span class="c1"># compute an isometry taking this geodesic to one which passes</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>        <span class="c1"># through the origin (so we can do intersection calculations</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>        <span class="c1"># in Euclidean geometry)</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>        <span class="n">midpt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">((</span><span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>                       <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a>        <span class="n">coord_change</span> <span class="o">=</span> <span class="n">midpt</span><span class="o">.</span><span class="n">origin_to</span><span class="p">()</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>        <span class="n">coord_inv</span> <span class="o">=</span> <span class="n">coord_change</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a>        <span class="n">c_hsph</span> <span class="o">=</span> <span class="n">coord_inv</span> <span class="o">@</span> <span class="bp">self</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a>        <span class="n">c_seg</span> <span class="o">=</span> <span class="n">coord_inv</span> <span class="o">@</span> <span class="n">segment</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a>        <span class="n">p_center</span><span class="p">,</span> <span class="n">p_radius</span> <span class="o">=</span> <span class="n">c_hsph</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">()</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a>        <span class="n">geodesic_endpts</span> <span class="o">=</span> <span class="n">c_seg</span><span class="o">.</span><span class="n">ideal_endpoint_coords</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">p_center</span><span class="p">,</span> <span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">+</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a>                  <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>                  <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">p_center</span><span class="p">)</span> <span class="o">-</span> <span class="n">p_radius</span><span class="o">**</span><span class="mi">2</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a>        <span class="c1">#TODO: check to see if the intersection actually occurs</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a>        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>        <span class="n">p1_poincare</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>        <span class="n">p2_poincare</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="n">poincare_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">p1_poincare</span><span class="p">,</span> <span class="n">p2_poincare</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>        <span class="n">klein_pts</span> <span class="o">=</span> <span class="n">poincare_to_kleinian</span><span class="p">(</span><span class="n">poincare_pts</span><span class="p">)</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a>        <span class="k">return</span> <span class="n">coord_change</span> <span class="o">@</span> <span class="n">Point</span><span class="p">(</span><span class="n">klein_pts</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a><span class="k">class</span> <span class="nc">HorosphereArc</span><span class="p">(</span><span class="n">Horosphere</span><span class="p">,</span> <span class="n">PointPair</span><span class="p">):</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a>    <span class="sd">&quot;&quot;&quot;Model for an arc lying along a horosphere</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>        <span class="k">if</span> <span class="n">p1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>                <span class="k">return</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>                <span class="k">pass</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>                <span class="k">return</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>                <span class="k">pass</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_center_endpoints</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>    <span class="k">def</span> <span class="nf">set_center_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>        <span class="k">if</span> <span class="p">((</span><span class="n">p1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>            <span class="p">(</span><span class="n">p1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>                <span class="s2">&quot;Horospherical arc determined by two endpoints and a centerpoint, but&quot;</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>                <span class="s2">&quot; this was not provided&quot;</span>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>            <span class="p">)</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>        <span class="k">if</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>            <span class="n">center_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>            <span class="n">p1_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>            <span class="n">p2_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center_data</span><span class="p">,</span> <span class="n">p1_data</span><span class="p">,</span> <span class="n">p2_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>    <span class="nd">@property</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>    <span class="nd">@property</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>    <span class="nd">@property</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters for a circle describing this horospherical arc.</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">Horosphere</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a>        <span class="n">model_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">model_coords</span><span class="p">)</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a>        <span class="n">center_theta</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>            <span class="n">center</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a>        <span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">arc_include</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">center_theta</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="k">class</span> <span class="nc">BoundaryArc</span><span class="p">(</span><span class="n">Geodesic</span><span class="p">):</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>    <span class="sd">&quot;&quot;&quot;Model for an arc sitting in the boundary of hyperbolic space.</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>    <span class="nd">@property</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>    <span class="nd">@property</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>    <span class="k">def</span> <span class="nf">orientation_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>    <span class="k">def</span> <span class="nf">set_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>            <span class="n">endpoint_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>            <span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>            <span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint2</span><span class="p">)</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>            <span class="n">endpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>                <span class="p">[</span><span class="n">pt1</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">pt2</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>            <span class="p">)</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_build_orientation_point</span><span class="p">(</span><span class="n">endpoint_data</span><span class="p">)</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_optional</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>    <span class="k">def</span> <span class="nf">orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>    <span class="k">def</span> <span class="nf">flip_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>    <span class="k">def</span> <span class="nf">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>        <span class="n">endpoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>            <span class="n">endpoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>        <span class="p">)</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>        <span class="k">return</span> <span class="n">endpoints</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>    <span class="k">def</span> <span class="nf">_build_orientation_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">):</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">endpoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>        <span class="n">orientation_pt_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">endpoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>                                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>        <span class="n">orientation_pt_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">endpoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>                                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>        <span class="n">orientation_pt_1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>        <span class="n">orientation_pt_2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>        <span class="n">point_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">endpoints</span><span class="p">,</span> <span class="n">orientation_pt_1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>        <span class="c1"># force numerical approximation for determinants, since we&#39;re</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>        <span class="c1"># only using them to find point determining the orientation of</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>        <span class="c1"># the arc</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>        <span class="n">dets</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>        <span class="n">point_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">orientation_pt_2</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>        <span class="n">signs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>        <span class="n">point_data</span><span class="p">[</span><span class="n">dets</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>        <span class="sd">&quot;&quot;&quot;Compute parameters (center, radius) for this boundary arc.</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">!=</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span> <span class="ow">and</span> <span class="n">model</span> <span class="o">!=</span> <span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">:</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute circular parameters for a boundary arc in model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a>                 <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a>            <span class="p">)</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>        <span class="c1"># WRAPLITERAL</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="k">class</span> <span class="nc">Polygon</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">projective</span><span class="o">.</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>    <span class="sd">&quot;&quot;&quot;Model for a geodesic polygon in hyperbolic space.</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a><span class="sd">    Underlying data consists of the vertices of the polygon. We also</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a><span class="sd">    keep track of auxiliary data, namely the proj_data of the segments</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a><span class="sd">    making up the edges of the polygon.</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">segment_class</span> <span class="o">=</span> <span class="n">Segment</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>        <span class="n">segments</span> <span class="o">=</span> <span class="n">Segment</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>        <span class="k">return</span> <span class="n">segments</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>    <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>        <span class="k">return</span> <span class="n">Segment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">short_arc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>                          <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">flatten</span><span class="p">:</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span><span class="o">.</span><span class="n">circle_parameters</span><span class="p">(</span><span class="n">short_arc</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>        <span class="n">flat_segments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">()</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>        <span class="k">return</span> <span class="n">flat_segments</span><span class="o">.</span><span class="n">circle_parameters</span><span class="p">(</span><span class="n">short_arc</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>    <span class="k">def</span> <span class="nf">regular_polygon</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>        <span class="sd">&quot;&quot;&quot;Get a regular polygon with n vertices, inscribed on a circle of</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a><span class="sd">        radius hyp_radius.</span>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a><span class="sd">        (This is actually vectorized.)</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">angle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>                <span class="s2">&quot;Must provide either an angle or a radius to regular_polygon&quot;</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>            <span class="p">)</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">regular_polygon_radius</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>        <span class="n">hyp_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a>        <span class="n">tangent</span> <span class="o">=</span> <span class="n">TangentVector</span><span class="o">.</span><span class="n">get_base_tangent</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a>                                                 <span class="n">hyp_radius</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a>                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a>        <span class="n">start_vertex</span> <span class="o">=</span> <span class="n">tangent</span><span class="o">.</span><span class="n">point_along</span><span class="p">(</span><span class="n">hyp_radius</span><span class="p">)</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a>        <span class="n">cyclic_rep</span> <span class="o">=</span> <span class="n">HyperbolicRepresentation</span><span class="p">()</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a>        <span class="n">cyclic_rep</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Isometry</span><span class="o">.</span><span class="n">standard_rotation</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">)</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a>        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a>        <span class="n">mats</span> <span class="o">=</span> <span class="n">cyclic_rep</span><span class="o">.</span><span class="n">isometries</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="n">mats</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">start_vertex</span><span class="p">,</span> <span class="s2">&quot;pairwise_reversed&quot;</span><span class="p">)</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a>        <span class="k">return</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a>    <span class="k">def</span> <span class="nf">regular_surface_polygon</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a>        <span class="sd">&quot;&quot;&quot;Get a regular polygon which is the fundamental domain for the</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a><span class="sd">        action of a hyperbolic surface group with genus g.</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">genus_g_surface_radius</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">base_ring</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a>        <span class="k">return</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">regular_polygon</span><span class="p">(</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a>            <span class="mi">4</span> <span class="o">*</span> <span class="n">g</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>        <span class="p">)</span>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a><span class="k">class</span> <span class="nc">Isometry</span><span class="p">(</span><span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="p">,</span> <span class="n">HyperbolicObject</span><span class="p">):</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>    <span class="sd">&quot;&quot;&quot;Model for an isometry of hyperbolic space.</span>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a>        <span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="p">,</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a>                                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>    <span class="k">def</span> <span class="nf">_fixpoint_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort_eigvals</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>        <span class="c1"># find fixpoints in projective space, and their eigenvalues and minkowski norms</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>        <span class="n">norms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">eigvecs</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>  <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>        <span class="c1"># 1 for eigenvectors which actually lie in H^n, 0 for outside vectors</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>        <span class="n">in_plane</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">norms</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>        <span class="c1"># primary sort key is whether or not we&#39;re in the plane,</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>        <span class="c1"># secondary is the eigenvalue modulus</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>        <span class="k">if</span> <span class="n">sort_eigvals</span><span class="p">:</span>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>            <span class="n">sort_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="p">),</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>                                   <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)),</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>                                   <span class="n">in_plane</span><span class="p">])</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>            <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">sort_order</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>            <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sort_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>            <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">in_plane</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>        <span class="c1"># we want a descending sort to put maximum modulus eigenvalues first</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>        <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">sort_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>        <span class="n">pt_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">eigvecs</span><span class="p">,</span> <span class="n">sort_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>        <span class="k">return</span> <span class="n">pt_data</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>    <span class="k">def</span> <span class="nf">_data_to_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>        <span class="k">return</span> <span class="n">HyperbolicObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_point_pair</span><span class="p">())</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>    <span class="k">def</span> <span class="nf">isometry_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>        <span class="o">...</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>    <span class="k">def</span> <span class="nf">fixed_point_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort_eigvals</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>        <span class="sd">&quot;&quot;&quot;Find fixed points for this isometry in the closure of hyperbolic space.</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a><span class="sd">        Parameters</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a><span class="sd">        ----------</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a><span class="sd">        sort_eigvals : bool</span>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a><span class="sd">            If `True`, guarantee that the fixpoints are ordered in</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a><span class="sd">            order of descending eigenvalue moduli</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a><span class="sd">        Returns</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a><span class="sd">        -------</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a><span class="sd">        Point</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a><span class="sd">            Points fixed by this isometry object.</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a>        <span class="n">fixpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixpoint_data</span><span class="p">(</span><span class="n">sort_eigvals</span><span class="p">))</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="n">fixpoint_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a>    <span class="k">def</span> <span class="nf">fixed_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_eigval</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a>        <span class="sd">&quot;&quot;&quot;Find a fixed point for this isometry in the closure of hyperbolic</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">           space.</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">        Parameters</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a><span class="sd">        ----------</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a><span class="sd">        max_eigval : bool</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a><span class="sd">            If `True`, guarantee that the eigenvalue for this fixed</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a><span class="sd">            point has maximum modulus</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a><span class="sd">        Returns</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a><span class="sd">        -------</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a><span class="sd">        Point</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a><span class="sd">            A point (possibly ideal) fixed by this isometry object.</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a>        <span class="n">fixpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixpoint_data</span><span class="p">(</span><span class="n">max_eigval</span><span class="p">))</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">fixpoint_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a>    <span class="k">def</span> <span class="nf">elliptic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">block_elliptic</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a>                 <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a>        <span class="sd">&quot;&quot;&quot;Get an elliptic isometry stabilizing the origin in the</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a><span class="sd">        Poincare/Klein models.</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a><span class="sd">        block_elliptic is an element of O(n), whose image is taken</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a><span class="sd">        diagonally in O(n,1).</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="n">block_elliptic</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>                          <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>        <span class="c1"># add one to preserve base_ring</span>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>        <span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>        <span class="n">mat</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">block_elliptic</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>    <span class="k">def</span> <span class="nf">standard_loxodromic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>        <span class="sd">&quot;&quot;&quot;Get a loxodromic isometry whose axis intersects the origin.</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a><span class="sd">        WARNING: not vectorized.</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>        <span class="n">basis_change</span> <span class="o">=</span> <span class="n">_loxodromic_basis_change</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>        <span class="n">diagonal_loxodromic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">parameter</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">parameter</span><span class="p">],</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>                       <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimension</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>        <span class="p">)</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">((</span><span class="n">basis_change</span> <span class="o">@</span> <span class="n">diagonal_loxodromic</span> <span class="o">@</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>                        <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">basis_change</span><span class="p">)),</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>                        <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>    <span class="k">def</span> <span class="nf">standard_rotation</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>        <span class="sd">&quot;&quot;&quot;Get a rotation about the origin by a fixed angle.</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a><span class="sd">        WARNING: not vectorized.</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="n">angle</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a>        <span class="n">affine</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a>            <span class="n">dimension</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a>        <span class="p">)</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a>        <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a>            <span class="n">angle</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a>        <span class="p">)</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="o">.</span><span class="n">elliptic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">affine</span><span class="p">,</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a>                                 <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a>    <span class="k">def</span> <span class="nf">from_sl2</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a>        <span class="k">return</span> <span class="n">sl2_iso</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a>    <span class="k">def</span> <span class="nf">to_sl2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a>        <span class="k">return</span> <span class="n">lie</span><span class="o">.</span><span class="n">o_to_pgl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a><span class="k">class</span> <span class="nc">HyperbolicRepresentation</span><span class="p">(</span><span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">):</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a>    <span class="sd">&quot;&quot;&quot;Model a representation for a finitely generated group</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">    representation into O(n,1).</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="sd">    Really this is just a convenient way of mapping words in the</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a><span class="sd">    generators to hyperbolic isometries - there&#39;s no group theory</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a><span class="sd">    being done here at all.</span>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a>    <span class="k">def</span> <span class="nf">wrap_func</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">):</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>    <span class="k">def</span> <span class="nf">array_wrap_func</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">):</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>        <span class="n">dimension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">indefinite_orthogonalize</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dimension</span><span class="p">),</span> <span class="n">matrix</span><span class="p">)</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a>    <span class="k">def</span> <span class="nf">isometries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a>        <span class="sd">&quot;&quot;&quot;Get an Isometry object holding the matrices which are the images of</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a><span class="sd">        a sequence of words in the generators.</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>        <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">hom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>    <span class="k">def</span> <span class="nf">gln_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>        <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">(</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>            <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="o">.</span><span class="n">gln_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>        <span class="p">)</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a><span class="k">def</span> <span class="nf">minkowski</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a>    <span class="n">form</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a>    <span class="n">form</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a>    <span class="k">return</span> <span class="n">form</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a><span class="k">def</span> <span class="nf">kleinian_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a>    <span class="sd">&quot;&quot;&quot;Get kleinian coordinates for an ndarray of points.</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a>    <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a>                                    <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a><span class="k">def</span> <span class="nf">get_point</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">):</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a>    <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a><span class="k">def</span> <span class="nf">get_boundary_point</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a>    <span class="k">return</span> <span class="n">IdealPoint</span><span class="o">.</span><span class="n">from_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a><span class="k">def</span> <span class="nf">hyperboloid_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a>    <span class="sd">&quot;&quot;&quot;Project an ndarray of points to the unit hyperboloid defined by the</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a><span class="sd">    Minkowski quadratic form.&quot;&quot;&quot;</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a>    <span class="n">proj_coords</span> <span class="o">=</span> <span class="n">points</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>        <span class="n">proj_coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">proj_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>    <span class="n">hyperbolized</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">proj_coords</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>        <span class="n">hyperbolized</span> <span class="o">=</span> <span class="n">hyperbolized</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>    <span class="k">return</span> <span class="n">hyperbolized</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a><span class="k">def</span> <span class="nf">spacelike</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>    <span class="sd">&quot;&quot;&quot;Determine if a vector in R^(n,1) is spacelike.</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a><span class="sd">    Parameters</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a><span class="sd">    ----------</span>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a><span class="sd">    vectors : ndarray</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a><span class="sd">        Vectors to test for spacelike norms. The last index of the</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a><span class="sd">        array is the dimension of the vector space.</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a><span class="sd">    Returns</span>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a><span class="sd">    -------</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a><span class="sd">    ndarray(bool)</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a><span class="sd">        `True` for vectors which have Minkowski norm above a fixed</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a><span class="sd">        error threshold.</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a><span class="k">def</span> <span class="nf">timelike</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a>    <span class="sd">&quot;&quot;&quot;Determine if a vector in R^(n,1) is timelike.</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="sd">    Parameters</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="sd">    ----------</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="sd">    vectors : ndarray</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a><span class="sd">        Vectors to test for timelike norms. The last index of the</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="sd">        array is the dimension of the vector space.</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a><span class="sd">    Returns</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a><span class="sd">    -------</span>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a><span class="sd">    ndarray(bool)</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a><span class="sd">        `True` for vectors which have Minkowski norm below a fixed</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a><span class="sd">        error threshold.</span>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a><span class="k">def</span> <span class="nf">lightlike</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>    <span class="sd">&quot;&quot;&quot;Determine if a vector in R^(n,1) is lightlike.</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a><span class="sd">    Parameters</span>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a><span class="sd">    ----------</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a><span class="sd">    vectors : ndarray</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a><span class="sd">        Vectors to test for lightlike norms. The last index of the</span>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a><span class="sd">        array is the dimension of the vector space.</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a><span class="sd">    Returns</span>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a><span class="sd">    -------</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a><span class="sd">    ndarray(bool)</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a><span class="sd">        `True` for vectors where the absolute value of the Minkowski</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a><span class="sd">        norm is below a fixed error threshold.</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a><span class="k">def</span> <span class="nf">kleinian_to_poincare</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>    <span class="n">euc_norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>    <span class="c1">#we take absolute value to combat roundoff error</span>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a>    <span class="n">mult_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">euc_norms</span><span class="p">)))</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">mult_factor</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="k">def</span> <span class="nf">poincare_to_kleinian</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a>    <span class="n">euc_norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a>    <span class="n">mult_factor</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">euc_norms</span><span class="p">)</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">mult_factor</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="k">def</span> <span class="nf">poincare_to_halfspace</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a>    <span class="n">halfspace_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a>        <span class="n">halfspace_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>        <span class="n">halfspace_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>    <span class="k">return</span> <span class="n">halfspace_coords</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a><span class="k">def</span> <span class="nf">halfspace_to_poincare</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>    <span class="n">poincare_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>    <span class="n">poincare_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a>    <span class="n">poincare_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a>    <span class="k">return</span> <span class="n">poincare_coords</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a><span class="k">def</span> <span class="nf">timelike_to</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a>    <span class="sd">&quot;&quot;&quot;Find an isometry taking the origin of the Poincare/Klein models to</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a><span class="sd">    the given vector v.</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a><span class="sd">    We expect v to be timelike in order for this to make sense.</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">timelike</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;Cannot find isometry taking a&quot;</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a>        <span class="s2">&quot; timelike vector to a non-timelike vector.&quot;</span>  <span class="p">)</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>                                        <span class="n">v</span><span class="p">,</span> <span class="n">force_oriented</span><span class="p">),</span>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a>                    <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a><span class="k">def</span> <span class="nf">sl2_iso</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a>    <span class="sd">&quot;&quot;&quot;Convert 2x2 matrices to isometries.</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a><span class="sd">    matrix is an array of shape (..., 2, 2), and interpreted as an</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a><span class="sd">    array of elements of SL^+-(2, R).</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>    <span class="n">m_array</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">array_like</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">lie</span><span class="o">.</span><span class="n">sl2_to_so21</span><span class="p">(</span><span class="n">m_array</span><span class="p">),</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>                    <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a><span class="k">def</span> <span class="nf">project_to_hyperboloid</span><span class="p">(</span><span class="n">basepoint</span><span class="p">,</span> <span class="n">tangent_vector</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>    <span class="sd">&quot;&quot;&quot;Project a vector in R^(n,1) to lie in the tangent space to the unit</span>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a><span class="sd">    hyperboloid at a given basepoint.</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>    <span class="k">if</span> <span class="n">form</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">basepoint</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>    <span class="k">return</span> <span class="n">tangent_vector</span> <span class="o">-</span> <span class="n">utils</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>        <span class="n">tangent_vector</span><span class="p">,</span> <span class="n">basepoint</span><span class="p">,</span> <span class="n">form</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>    <span class="p">)</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a><span class="k">def</span> <span class="nf">hyp_to_affine_dist</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>    <span class="sd">&quot;&quot;&quot;Convert distance in hyperbolic space to distance from the origin in</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a><span class="sd">    the Klein model.</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">))</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a><span class="k">def</span> <span class="nf">_loxodromic_basis_change</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a>    <span class="c1"># WRAPLITERAL</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a>    <span class="n">mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a>    <span class="n">basis_change</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a>        <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a>        <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">]</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a>    <span class="p">])</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a>    <span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">basis_change</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a>    <span class="k">return</span> <span class="n">mat</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a><span class="k">def</span> <span class="nf">regular_polygon_radius</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">interior_angle</span><span class="p">):</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a>    <span class="sd">&quot;&quot;&quot;Find r such that a regular n-gon inscribed on a circle of radius r</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a><span class="sd">    has the given interior angle.</span>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a>    <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">interior_angle</span><span class="p">)</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">interior_angle</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>    <span class="n">gamma</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a>    <span class="n">term</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a>            <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a><span class="k">def</span> <span class="nf">polygon_interior_angle</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">hyp_radius</span><span class="p">):</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>    <span class="sd">&quot;&quot;&quot;Get the interior angle of a regular n-gon inscribed on a circle</span>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a><span class="sd">    with the given hyperbolic radius.</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>    <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">hyp_radius</span><span class="p">)</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>    <span class="n">gamma</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">hyp_radius</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span><span class="p">)</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a><span class="k">def</span> <span class="nf">genus_g_surface_radius</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>    <span class="sd">&quot;&quot;&quot;Find the radius of a regular polygon giving the fundamental domain</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a><span class="sd">    for the action of a hyperbolic surface group with genus g.</span>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>    <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>    <span class="k">return</span> <span class="n">regular_polygon_radius</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">g</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">))</span>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a><span class="k">def</span> <span class="nf">spacelike_to</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>    <span class="sd">&quot;&quot;&quot;Find an isometry taking the second standard basis vector (0, 1, 0,</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a><span class="sd">    ...) to the given vector v.</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a><span class="sd">    We expect v to be spacelike in order for this to make sense.</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a>    <span class="n">normed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">spacelike</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;Cannot find isometry taking a&quot;</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a>        <span class="s2">&quot; spacelike vector to a non-spacelike vector.&quot;</span><span class="p">)</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a>    <span class="n">iso</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span> <span class="n">normed</span><span class="p">)</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a>    <span class="c1">#find the index of the timelike basis vector</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a>    <span class="n">lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">iso</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a>    <span class="n">t_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a>    <span class="c1">#apply a permutation so the isometry actually preserves the</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a>    <span class="c1">#form. we do the permutation in two steps because it could be</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a>    <span class="c1">#either a 2-cycle or a 3-cycle.</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a>    <span class="n">p_iso</span> <span class="o">=</span> <span class="n">iso</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a>    <span class="c1">#first swap timelike index with zero</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">),</span> <span class="n">t_index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a>    <span class="n">p_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">t_index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>    <span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">iso</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a>    <span class="n">np</span><span class="o">.</span><span class="n">put_along_axis</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">p_indices</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a>    <span class="c1">#then swap timelike index with one</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">),</span> <span class="n">t_index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>    <span class="n">p_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">t_index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a>    <span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a>    <span class="n">np</span><span class="o">.</span><span class="n">put_along_axis</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">p_indices</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>    <span class="k">if</span> <span class="n">force_oriented</span><span class="p">:</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>        <span class="n">p_iso</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_orientation_preserving</span><span class="p">(</span><span class="n">p_iso</span><span class="p">)</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></pre></div>


            </section>
                <section id="ERROR_THRESHOLD">
                    <div class="attr variable">
            <span class="name">ERROR_THRESHOLD</span>        =
<span class="default_value">1e-08</span>

        
    </div>
    <a class="headerlink" href="#ERROR_THRESHOLD"></a>
    
    

                </section>
                <section id="BOUNDARY_THRESHOLD">
                    <div class="attr variable">
            <span class="name">BOUNDARY_THRESHOLD</span>        =
<span class="default_value">1e-05</span>

        
    </div>
    <a class="headerlink" href="#BOUNDARY_THRESHOLD"></a>
    
    

                </section>
                <section id="CHECK_LIGHT_CONE">
                    <div class="attr variable">
            <span class="name">CHECK_LIGHT_CONE</span>        =
<span class="default_value">False</span>

        
    </div>
    <a class="headerlink" href="#CHECK_LIGHT_CONE"></a>
    
    

                </section>
                <section id="Model">
                            <input id="Model-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Model</span><wbr>(<span class="base">enum.Enum</span>):

                <label class="view-source-button" for="Model-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Model"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Model-142"><a href="#Model-142"><span class="linenos">142</span></a><span class="k">class</span> <span class="nc">Model</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
</span><span id="Model-143"><a href="#Model-143"><span class="linenos">143</span></a>    <span class="sd">&quot;&quot;&quot;Enumerate implemented models of hyperbolic space.</span>
</span><span id="Model-144"><a href="#Model-144"><span class="linenos">144</span></a>
</span><span id="Model-145"><a href="#Model-145"><span class="linenos">145</span></a><span class="sd">    Models can have different aliases, and can be compared to strings</span>
</span><span id="Model-146"><a href="#Model-146"><span class="linenos">146</span></a><span class="sd">    with the == operator, which returns `True` if the strings match</span>
</span><span id="Model-147"><a href="#Model-147"><span class="linenos">147</span></a><span class="sd">    any alias name (case insensitive).</span>
</span><span id="Model-148"><a href="#Model-148"><span class="linenos">148</span></a>
</span><span id="Model-149"><a href="#Model-149"><span class="linenos">149</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Model-150"><a href="#Model-150"><span class="linenos">150</span></a>    <span class="n">POINCARE</span> <span class="o">=</span> <span class="s2">&quot;poincare&quot;</span>
</span><span id="Model-151"><a href="#Model-151"><span class="linenos">151</span></a>    <span class="n">KLEIN</span> <span class="o">=</span> <span class="s2">&quot;klein&quot;</span>
</span><span id="Model-152"><a href="#Model-152"><span class="linenos">152</span></a>    <span class="n">KLEINIAN</span> <span class="o">=</span> <span class="s2">&quot;klein&quot;</span>
</span><span id="Model-153"><a href="#Model-153"><span class="linenos">153</span></a>    <span class="n">AFFINE</span> <span class="o">=</span> <span class="s2">&quot;klein&quot;</span>
</span><span id="Model-154"><a href="#Model-154"><span class="linenos">154</span></a>    <span class="n">HALFSPACE</span> <span class="o">=</span> <span class="s2">&quot;halfspace&quot;</span>
</span><span id="Model-155"><a href="#Model-155"><span class="linenos">155</span></a>    <span class="n">HALFPLANE</span> <span class="o">=</span> <span class="s2">&quot;halfspace&quot;</span>
</span><span id="Model-156"><a href="#Model-156"><span class="linenos">156</span></a>    <span class="n">HYPERBOLOID</span> <span class="o">=</span> <span class="s2">&quot;hyperboloid&quot;</span>
</span><span id="Model-157"><a href="#Model-157"><span class="linenos">157</span></a>    <span class="n">PROJECTIVE</span> <span class="o">=</span> <span class="s2">&quot;projective&quot;</span>
</span><span id="Model-158"><a href="#Model-158"><span class="linenos">158</span></a>
</span><span id="Model-159"><a href="#Model-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Model-160"><a href="#Model-160"><span class="linenos">160</span></a>        <span class="sd">&quot;&quot;&quot;List all of the different accepted names for this hyperbolic model.&quot;&quot;&quot;</span>
</span><span id="Model-161"><a href="#Model-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">Model</span><span class="o">.</span><span class="n">__members__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Model-162"><a href="#Model-162"><span class="linenos">162</span></a>                <span class="k">if</span> <span class="n">member</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">]</span>
</span><span id="Model-163"><a href="#Model-163"><span class="linenos">163</span></a>
</span><span id="Model-164"><a href="#Model-164"><span class="linenos">164</span></a>    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Model-165"><a href="#Model-165"><span class="linenos">165</span></a>        <span class="k">if</span> <span class="bp">self</span> <span class="ow">is</span> <span class="n">other</span><span class="p">:</span>
</span><span id="Model-166"><a href="#Model-166"><span class="linenos">166</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="Model-167"><a href="#Model-167"><span class="linenos">167</span></a>
</span><span id="Model-168"><a href="#Model-168"><span class="linenos">168</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Model-169"><a href="#Model-169"><span class="linenos">169</span></a>            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aliases</span><span class="p">():</span>
</span><span id="Model-170"><a href="#Model-170"><span class="linenos">170</span></a>                <span class="k">return</span> <span class="kc">True</span>
</span><span id="Model-171"><a href="#Model-171"><span class="linenos">171</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="Model-172"><a href="#Model-172"><span class="linenos">172</span></a>            <span class="k">pass</span>
</span><span id="Model-173"><a href="#Model-173"><span class="linenos">173</span></a>
</span><span id="Model-174"><a href="#Model-174"><span class="linenos">174</span></a>        <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Enumerate implemented models of hyperbolic space.</p>

<p>Models can have different aliases, and can be compared to strings
with the == operator, which returns <code>True</code> if the strings match
any alias name (case insensitive).</p>
</div>


                            <div id="Model.POINCARE" class="classattr">
                                <div class="attr variable">
            <span class="name">POINCARE</span>        =
<span class="default_value">&lt;<a href="#Model.POINCARE">Model.POINCARE</a>: &#39;poincare&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.POINCARE"></a>
    
    

                            </div>
                            <div id="Model.KLEIN" class="classattr">
                                <div class="attr variable">
            <span class="name">KLEIN</span>        =
<span class="default_value">&lt;<a href="#Model.KLEIN">Model.KLEIN</a>: &#39;klein&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.KLEIN"></a>
    
    

                            </div>
                            <div id="Model.KLEINIAN" class="classattr">
                                <div class="attr variable">
            <span class="name">KLEINIAN</span>        =
<span class="default_value">&lt;<a href="#Model.KLEIN">Model.KLEIN</a>: &#39;klein&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.KLEINIAN"></a>
    
    

                            </div>
                            <div id="Model.AFFINE" class="classattr">
                                <div class="attr variable">
            <span class="name">AFFINE</span>        =
<span class="default_value">&lt;<a href="#Model.KLEIN">Model.KLEIN</a>: &#39;klein&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.AFFINE"></a>
    
    

                            </div>
                            <div id="Model.HALFSPACE" class="classattr">
                                <div class="attr variable">
            <span class="name">HALFSPACE</span>        =
<span class="default_value">&lt;<a href="#Model.HALFSPACE">Model.HALFSPACE</a>: &#39;halfspace&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.HALFSPACE"></a>
    
    

                            </div>
                            <div id="Model.HALFPLANE" class="classattr">
                                <div class="attr variable">
            <span class="name">HALFPLANE</span>        =
<span class="default_value">&lt;<a href="#Model.HALFSPACE">Model.HALFSPACE</a>: &#39;halfspace&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.HALFPLANE"></a>
    
    

                            </div>
                            <div id="Model.HYPERBOLOID" class="classattr">
                                <div class="attr variable">
            <span class="name">HYPERBOLOID</span>        =
<span class="default_value">&lt;<a href="#Model.HYPERBOLOID">Model.HYPERBOLOID</a>: &#39;hyperboloid&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.HYPERBOLOID"></a>
    
    

                            </div>
                            <div id="Model.PROJECTIVE" class="classattr">
                                <div class="attr variable">
            <span class="name">PROJECTIVE</span>        =
<span class="default_value">&lt;<a href="#Model.PROJECTIVE">Model.PROJECTIVE</a>: &#39;projective&#39;&gt;</span>

        
    </div>
    <a class="headerlink" href="#Model.PROJECTIVE"></a>
    
    

                            </div>
                            <div id="Model.aliases" class="classattr">
                                        <input id="Model.aliases-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">aliases</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Model.aliases-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Model.aliases"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Model.aliases-159"><a href="#Model.aliases-159"><span class="linenos">159</span></a>    <span class="k">def</span> <span class="nf">aliases</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Model.aliases-160"><a href="#Model.aliases-160"><span class="linenos">160</span></a>        <span class="sd">&quot;&quot;&quot;List all of the different accepted names for this hyperbolic model.&quot;&quot;&quot;</span>
</span><span id="Model.aliases-161"><a href="#Model.aliases-161"><span class="linenos">161</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">Model</span><span class="o">.</span><span class="n">__members__</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</span><span id="Model.aliases-162"><a href="#Model.aliases-162"><span class="linenos">162</span></a>                <span class="k">if</span> <span class="n">member</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>List all of the different accepted names for this hyperbolic model.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>enum.Enum</dt>
                                <dd id="Model.name" class="variable">name</dd>
                <dd id="Model.value" class="variable">value</dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HyperbolicObject">
                            <input id="HyperbolicObject-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">HyperbolicObject</span><wbr>(<span class="base"><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></span>):

                <label class="view-source-button" for="HyperbolicObject-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicObject"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicObject-176"><a href="#HyperbolicObject-176"><span class="linenos">176</span></a><span class="k">class</span> <span class="nc">HyperbolicObject</span><span class="p">(</span><span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveObject</span><span class="p">):</span>
</span><span id="HyperbolicObject-177"><a href="#HyperbolicObject-177"><span class="linenos">177</span></a>    <span class="sd">&quot;&quot;&quot;Model for an abstract object in hyperbolic space.</span>
</span><span id="HyperbolicObject-178"><a href="#HyperbolicObject-178"><span class="linenos">178</span></a>
</span><span id="HyperbolicObject-179"><a href="#HyperbolicObject-179"><span class="linenos">179</span></a><span class="sd">    Subclasses of HyperbolicObject model more specific objects in</span>
</span><span id="HyperbolicObject-180"><a href="#HyperbolicObject-180"><span class="linenos">180</span></a><span class="sd">    hyperbolic geometry, e.g. points, geodesic segments, hyperplanes,</span>
</span><span id="HyperbolicObject-181"><a href="#HyperbolicObject-181"><span class="linenos">181</span></a><span class="sd">    ideal points.</span>
</span><span id="HyperbolicObject-182"><a href="#HyperbolicObject-182"><span class="linenos">182</span></a>
</span><span id="HyperbolicObject-183"><a href="#HyperbolicObject-183"><span class="linenos">183</span></a><span class="sd">    Every object in hyperbolic space H^n has the underlying data of an</span>
</span><span id="HyperbolicObject-184"><a href="#HyperbolicObject-184"><span class="linenos">184</span></a><span class="sd">    ndarray whose last dimension is n+1. This is interpreted as a</span>
</span><span id="HyperbolicObject-185"><a href="#HyperbolicObject-185"><span class="linenos">185</span></a><span class="sd">    collection of (row) vectors in R^(n+1), or more precisely R^(n,1),</span>
</span><span id="HyperbolicObject-186"><a href="#HyperbolicObject-186"><span class="linenos">186</span></a><span class="sd">    which transforms via the action of the indefinite orthogonal group</span>
</span><span id="HyperbolicObject-187"><a href="#HyperbolicObject-187"><span class="linenos">187</span></a><span class="sd">    O(n,1).</span>
</span><span id="HyperbolicObject-188"><a href="#HyperbolicObject-188"><span class="linenos">188</span></a>
</span><span id="HyperbolicObject-189"><a href="#HyperbolicObject-189"><span class="linenos">189</span></a><span class="sd">    The last `unit_ndims` dimensions of this underlying array represent</span>
</span><span id="HyperbolicObject-190"><a href="#HyperbolicObject-190"><span class="linenos">190</span></a><span class="sd">    a single object in hyperbolic space, which transforms as a unit</span>
</span><span id="HyperbolicObject-191"><a href="#HyperbolicObject-191"><span class="linenos">191</span></a><span class="sd">    under the action of O(n,1). The remaining dimensions of the array</span>
</span><span id="HyperbolicObject-192"><a href="#HyperbolicObject-192"><span class="linenos">192</span></a><span class="sd">    are used to represent an array of such &quot;unit objects.&quot;</span>
</span><span id="HyperbolicObject-193"><a href="#HyperbolicObject-193"><span class="linenos">193</span></a>
</span><span id="HyperbolicObject-194"><a href="#HyperbolicObject-194"><span class="linenos">194</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="HyperbolicObject-195"><a href="#HyperbolicObject-195"><span class="linenos">195</span></a>
</span><span id="HyperbolicObject-196"><a href="#HyperbolicObject-196"><span class="linenos">196</span></a>    <span class="nd">@property</span>
</span><span id="HyperbolicObject-197"><a href="#HyperbolicObject-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HyperbolicObject-198"><a href="#HyperbolicObject-198"><span class="linenos">198</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="HyperbolicObject-199"><a href="#HyperbolicObject-199"><span class="linenos">199</span></a>            <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="HyperbolicObject-200"><a href="#HyperbolicObject-200"><span class="linenos">200</span></a>            <span class="k">return</span> <span class="n">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="HyperbolicObject-201"><a href="#HyperbolicObject-201"><span class="linenos">201</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="HyperbolicObject-202"><a href="#HyperbolicObject-202"><span class="linenos">202</span></a>            <span class="k">pass</span>
</span><span id="HyperbolicObject-203"><a href="#HyperbolicObject-203"><span class="linenos">203</span></a>
</span><span id="HyperbolicObject-204"><a href="#HyperbolicObject-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="n">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="HyperbolicObject-205"><a href="#HyperbolicObject-205"><span class="linenos">205</span></a>
</span><span id="HyperbolicObject-206"><a href="#HyperbolicObject-206"><span class="linenos">206</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicObject-207"><a href="#HyperbolicObject-207"><span class="linenos">207</span></a>        <span class="sd">&quot;&quot;&quot;Get or set a representation of this hyperbolic object in</span>
</span><span id="HyperbolicObject-208"><a href="#HyperbolicObject-208"><span class="linenos">208</span></a><span class="sd">        coordinates.</span>
</span><span id="HyperbolicObject-209"><a href="#HyperbolicObject-209"><span class="linenos">209</span></a>
</span><span id="HyperbolicObject-210"><a href="#HyperbolicObject-210"><span class="linenos">210</span></a><span class="sd">        For the base `HyperbolicObject` class, the available models</span>
</span><span id="HyperbolicObject-211"><a href="#HyperbolicObject-211"><span class="linenos">211</span></a><span class="sd">        are `Model.KLEIN` and `Model.PROJECTIVE`.</span>
</span><span id="HyperbolicObject-212"><a href="#HyperbolicObject-212"><span class="linenos">212</span></a>
</span><span id="HyperbolicObject-213"><a href="#HyperbolicObject-213"><span class="linenos">213</span></a><span class="sd">        Parameters</span>
</span><span id="HyperbolicObject-214"><a href="#HyperbolicObject-214"><span class="linenos">214</span></a><span class="sd">        ----------</span>
</span><span id="HyperbolicObject-215"><a href="#HyperbolicObject-215"><span class="linenos">215</span></a><span class="sd">        model : Model</span>
</span><span id="HyperbolicObject-216"><a href="#HyperbolicObject-216"><span class="linenos">216</span></a><span class="sd">            which model to take coordinates in</span>
</span><span id="HyperbolicObject-217"><a href="#HyperbolicObject-217"><span class="linenos">217</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="HyperbolicObject-218"><a href="#HyperbolicObject-218"><span class="linenos">218</span></a><span class="sd">            data for this hyperbolic object, interpreted as</span>
</span><span id="HyperbolicObject-219"><a href="#HyperbolicObject-219"><span class="linenos">219</span></a><span class="sd">            coordinates with respect to `model`. If `None`, just</span>
</span><span id="HyperbolicObject-220"><a href="#HyperbolicObject-220"><span class="linenos">220</span></a><span class="sd">            return coordinates.</span>
</span><span id="HyperbolicObject-221"><a href="#HyperbolicObject-221"><span class="linenos">221</span></a>
</span><span id="HyperbolicObject-222"><a href="#HyperbolicObject-222"><span class="linenos">222</span></a><span class="sd">        Raises</span>
</span><span id="HyperbolicObject-223"><a href="#HyperbolicObject-223"><span class="linenos">223</span></a><span class="sd">        ------</span>
</span><span id="HyperbolicObject-224"><a href="#HyperbolicObject-224"><span class="linenos">224</span></a><span class="sd">        GeometryError</span>
</span><span id="HyperbolicObject-225"><a href="#HyperbolicObject-225"><span class="linenos">225</span></a><span class="sd">            Raised if an unsupported model is specified.</span>
</span><span id="HyperbolicObject-226"><a href="#HyperbolicObject-226"><span class="linenos">226</span></a>
</span><span id="HyperbolicObject-227"><a href="#HyperbolicObject-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HyperbolicObject-228"><a href="#HyperbolicObject-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">:</span>
</span><span id="HyperbolicObject-229"><a href="#HyperbolicObject-229"><span class="linenos">229</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicObject-230"><a href="#HyperbolicObject-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span><span class="p">:</span>
</span><span id="HyperbolicObject-231"><a href="#HyperbolicObject-231"><span class="linenos">231</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicObject-232"><a href="#HyperbolicObject-232"><span class="linenos">232</span></a>
</span><span id="HyperbolicObject-233"><a href="#HyperbolicObject-233"><span class="linenos">233</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="HyperbolicObject-234"><a href="#HyperbolicObject-234"><span class="linenos">234</span></a>            <span class="s2">&quot;Unimplemented model for an object of type </span><span class="si">{}</span><span class="s2">: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="HyperbolicObject-235"><a href="#HyperbolicObject-235"><span class="linenos">235</span></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span>
</span><span id="HyperbolicObject-236"><a href="#HyperbolicObject-236"><span class="linenos">236</span></a>            <span class="p">))</span>
</span><span id="HyperbolicObject-237"><a href="#HyperbolicObject-237"><span class="linenos">237</span></a>
</span><span id="HyperbolicObject-238"><a href="#HyperbolicObject-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">kleinian_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicObject-239"><a href="#HyperbolicObject-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">aff_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for an abstract object in hyperbolic space.</p>

<p>Subclasses of HyperbolicObject model more specific objects in
hyperbolic geometry, e.g. points, geodesic segments, hyperplanes,
ideal points.</p>

<p>Every object in hyperbolic space H^n has the underlying data of an
ndarray whose last dimension is n+1. This is interpreted as a
collection of (row) vectors in R^(n+1), or more precisely R^(n,1),
which transforms via the action of the indefinite orthogonal group
O(n,1).</p>

<p>The last <code><a href="#HyperbolicObject.unit_ndims">unit_ndims</a></code> dimensions of this underlying array represent
a single object in hyperbolic space, which transforms as a unit
under the action of O(n,1). The remaining dimensions of the array
are used to represent an array of such "unit objects."</p>
</div>


                            <div id="HyperbolicObject.minkowski" class="classattr">
                                        <input id="HyperbolicObject.minkowski-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">minkowski</span>

                <label class="view-source-button" for="HyperbolicObject.minkowski-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicObject.minkowski"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicObject.minkowski-196"><a href="#HyperbolicObject.minkowski-196"><span class="linenos">196</span></a>    <span class="nd">@property</span>
</span><span id="HyperbolicObject.minkowski-197"><a href="#HyperbolicObject.minkowski-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HyperbolicObject.minkowski-198"><a href="#HyperbolicObject.minkowski-198"><span class="linenos">198</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="HyperbolicObject.minkowski-199"><a href="#HyperbolicObject.minkowski-199"><span class="linenos">199</span></a>            <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="HyperbolicObject.minkowski-200"><a href="#HyperbolicObject.minkowski-200"><span class="linenos">200</span></a>            <span class="k">return</span> <span class="n">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="HyperbolicObject.minkowski-201"><a href="#HyperbolicObject.minkowski-201"><span class="linenos">201</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="HyperbolicObject.minkowski-202"><a href="#HyperbolicObject.minkowski-202"><span class="linenos">202</span></a>            <span class="k">pass</span>
</span><span id="HyperbolicObject.minkowski-203"><a href="#HyperbolicObject.minkowski-203"><span class="linenos">203</span></a>
</span><span id="HyperbolicObject.minkowski-204"><a href="#HyperbolicObject.minkowski-204"><span class="linenos">204</span></a>        <span class="k">return</span> <span class="n">minkowski</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="HyperbolicObject.coords" class="classattr">
                                        <input id="HyperbolicObject.coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicObject.coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicObject.coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicObject.coords-206"><a href="#HyperbolicObject.coords-206"><span class="linenos">206</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicObject.coords-207"><a href="#HyperbolicObject.coords-207"><span class="linenos">207</span></a>        <span class="sd">&quot;&quot;&quot;Get or set a representation of this hyperbolic object in</span>
</span><span id="HyperbolicObject.coords-208"><a href="#HyperbolicObject.coords-208"><span class="linenos">208</span></a><span class="sd">        coordinates.</span>
</span><span id="HyperbolicObject.coords-209"><a href="#HyperbolicObject.coords-209"><span class="linenos">209</span></a>
</span><span id="HyperbolicObject.coords-210"><a href="#HyperbolicObject.coords-210"><span class="linenos">210</span></a><span class="sd">        For the base `HyperbolicObject` class, the available models</span>
</span><span id="HyperbolicObject.coords-211"><a href="#HyperbolicObject.coords-211"><span class="linenos">211</span></a><span class="sd">        are `Model.KLEIN` and `Model.PROJECTIVE`.</span>
</span><span id="HyperbolicObject.coords-212"><a href="#HyperbolicObject.coords-212"><span class="linenos">212</span></a>
</span><span id="HyperbolicObject.coords-213"><a href="#HyperbolicObject.coords-213"><span class="linenos">213</span></a><span class="sd">        Parameters</span>
</span><span id="HyperbolicObject.coords-214"><a href="#HyperbolicObject.coords-214"><span class="linenos">214</span></a><span class="sd">        ----------</span>
</span><span id="HyperbolicObject.coords-215"><a href="#HyperbolicObject.coords-215"><span class="linenos">215</span></a><span class="sd">        model : Model</span>
</span><span id="HyperbolicObject.coords-216"><a href="#HyperbolicObject.coords-216"><span class="linenos">216</span></a><span class="sd">            which model to take coordinates in</span>
</span><span id="HyperbolicObject.coords-217"><a href="#HyperbolicObject.coords-217"><span class="linenos">217</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="HyperbolicObject.coords-218"><a href="#HyperbolicObject.coords-218"><span class="linenos">218</span></a><span class="sd">            data for this hyperbolic object, interpreted as</span>
</span><span id="HyperbolicObject.coords-219"><a href="#HyperbolicObject.coords-219"><span class="linenos">219</span></a><span class="sd">            coordinates with respect to `model`. If `None`, just</span>
</span><span id="HyperbolicObject.coords-220"><a href="#HyperbolicObject.coords-220"><span class="linenos">220</span></a><span class="sd">            return coordinates.</span>
</span><span id="HyperbolicObject.coords-221"><a href="#HyperbolicObject.coords-221"><span class="linenos">221</span></a>
</span><span id="HyperbolicObject.coords-222"><a href="#HyperbolicObject.coords-222"><span class="linenos">222</span></a><span class="sd">        Raises</span>
</span><span id="HyperbolicObject.coords-223"><a href="#HyperbolicObject.coords-223"><span class="linenos">223</span></a><span class="sd">        ------</span>
</span><span id="HyperbolicObject.coords-224"><a href="#HyperbolicObject.coords-224"><span class="linenos">224</span></a><span class="sd">        GeometryError</span>
</span><span id="HyperbolicObject.coords-225"><a href="#HyperbolicObject.coords-225"><span class="linenos">225</span></a><span class="sd">            Raised if an unsupported model is specified.</span>
</span><span id="HyperbolicObject.coords-226"><a href="#HyperbolicObject.coords-226"><span class="linenos">226</span></a>
</span><span id="HyperbolicObject.coords-227"><a href="#HyperbolicObject.coords-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HyperbolicObject.coords-228"><a href="#HyperbolicObject.coords-228"><span class="linenos">228</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">:</span>
</span><span id="HyperbolicObject.coords-229"><a href="#HyperbolicObject.coords-229"><span class="linenos">229</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicObject.coords-230"><a href="#HyperbolicObject.coords-230"><span class="linenos">230</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span><span class="p">:</span>
</span><span id="HyperbolicObject.coords-231"><a href="#HyperbolicObject.coords-231"><span class="linenos">231</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">projective_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicObject.coords-232"><a href="#HyperbolicObject.coords-232"><span class="linenos">232</span></a>
</span><span id="HyperbolicObject.coords-233"><a href="#HyperbolicObject.coords-233"><span class="linenos">233</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="HyperbolicObject.coords-234"><a href="#HyperbolicObject.coords-234"><span class="linenos">234</span></a>            <span class="s2">&quot;Unimplemented model for an object of type </span><span class="si">{}</span><span class="s2">: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="HyperbolicObject.coords-235"><a href="#HyperbolicObject.coords-235"><span class="linenos">235</span></a>                <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span>
</span><span id="HyperbolicObject.coords-236"><a href="#HyperbolicObject.coords-236"><span class="linenos">236</span></a>            <span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Get or set a representation of this hyperbolic object in
coordinates.</p>

<p>For the base <code><a href="#HyperbolicObject">HyperbolicObject</a></code> class, the available models
are <code><a href="#Model.KLEIN">Model.KLEIN</a></code> and <code><a href="#Model.PROJECTIVE">Model.PROJECTIVE</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>model</strong> (Model):
which model to take coordinates in</li>
<li><strong>proj_data</strong> (ndarray):
data for this hyperbolic object, interpreted as
coordinates with respect to <code>model</code>. If <code>None</code>, just
return coordinates.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>GeometryError</strong>: Raised if an unsupported model is specified.</li>
</ul>
</div>


                            </div>
                            <div id="HyperbolicObject.kleinian_coords" class="classattr">
                                        <input id="HyperbolicObject.kleinian_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">kleinian_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicObject.kleinian_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicObject.kleinian_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicObject.kleinian_coords-238"><a href="#HyperbolicObject.kleinian_coords-238"><span class="linenos">238</span></a>    <span class="k">def</span> <span class="nf">kleinian_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aff_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicObject.kleinian_coords-239"><a href="#HyperbolicObject.kleinian_coords-239"><span class="linenos">239</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">aff_data</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="HyperbolicObject.__init__" class="function"><a href="projective.html#ProjectiveObject.__init__">ProjectiveObject</a></dd>
                <dd id="HyperbolicObject.unit_ndims" class="variable"><a href="projective.html#ProjectiveObject.unit_ndims">unit_ndims</a></dd>
                <dd id="HyperbolicObject.aux_ndims" class="variable"><a href="projective.html#ProjectiveObject.aux_ndims">aux_ndims</a></dd>
                <dd id="HyperbolicObject.dual_ndims" class="variable"><a href="projective.html#ProjectiveObject.dual_ndims">dual_ndims</a></dd>
                <dd id="HyperbolicObject.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="HyperbolicObject.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="HyperbolicObject.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="HyperbolicObject.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="HyperbolicObject.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="HyperbolicObject.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="HyperbolicObject.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="HyperbolicObject.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="HyperbolicObject.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="HyperbolicObject.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="HyperbolicObject.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="HyperbolicObject.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Point">
                            <input id="Point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Point</span><wbr>(<span class="base"><a href="#HyperbolicObject">HyperbolicObject</a></span>, <span class="base"><a href="projective.html#Point">geometry_tools.projective.Point</a></span>):

                <label class="view-source-button" for="Point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point-241"><a href="#Point-241"><span class="linenos">241</span></a><span class="k">class</span> <span class="nc">Point</span><span class="p">(</span><span class="n">HyperbolicObject</span><span class="p">,</span> <span class="n">projective</span><span class="o">.</span><span class="n">Point</span><span class="p">):</span>
</span><span id="Point-242"><a href="#Point-242"><span class="linenos">242</span></a>    <span class="sd">&quot;&quot;&quot;Model for a point (or ndarray of points) in the closure of</span>
</span><span id="Point-243"><a href="#Point-243"><span class="linenos">243</span></a><span class="sd">    hyperbolic space.</span>
</span><span id="Point-244"><a href="#Point-244"><span class="linenos">244</span></a>
</span><span id="Point-245"><a href="#Point-245"><span class="linenos">245</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Point-246"><a href="#Point-246"><span class="linenos">246</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-247"><a href="#Point-247"><span class="linenos">247</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Point-248"><a href="#Point-248"><span class="linenos">248</span></a>
</span><span id="Point-249"><a href="#Point-249"><span class="linenos">249</span></a><span class="sd">        Parameters</span>
</span><span id="Point-250"><a href="#Point-250"><span class="linenos">250</span></a><span class="sd">        ----------</span>
</span><span id="Point-251"><a href="#Point-251"><span class="linenos">251</span></a><span class="sd">        point : HyperbolicObject or iterable or ndarray</span>
</span><span id="Point-252"><a href="#Point-252"><span class="linenos">252</span></a><span class="sd">            Data used to construct a point or an array of points. If</span>
</span><span id="Point-253"><a href="#Point-253"><span class="linenos">253</span></a><span class="sd">            `point` is a `HyperbolicObject`, then use the underlying</span>
</span><span id="Point-254"><a href="#Point-254"><span class="linenos">254</span></a><span class="sd">            coordinate data to build an array of points. If `point` is</span>
</span><span id="Point-255"><a href="#Point-255"><span class="linenos">255</span></a><span class="sd">            an iterable of `HyperbolicObject`s, build a composite `Point`</span>
</span><span id="Point-256"><a href="#Point-256"><span class="linenos">256</span></a><span class="sd">            object out of this array. If `point` is an `ndarray`, then</span>
</span><span id="Point-257"><a href="#Point-257"><span class="linenos">257</span></a><span class="sd">            interpret this as coordinate data for an array of points</span>
</span><span id="Point-258"><a href="#Point-258"><span class="linenos">258</span></a><span class="sd">            in some hyperbolic model.</span>
</span><span id="Point-259"><a href="#Point-259"><span class="linenos">259</span></a><span class="sd">        model : Model</span>
</span><span id="Point-260"><a href="#Point-260"><span class="linenos">260</span></a><span class="sd">            if `point` is numerical data, then what model of</span>
</span><span id="Point-261"><a href="#Point-261"><span class="linenos">261</span></a><span class="sd">            hyperbolic space we should use to interpret `point` as</span>
</span><span id="Point-262"><a href="#Point-262"><span class="linenos">262</span></a><span class="sd">            coordinates.</span>
</span><span id="Point-263"><a href="#Point-263"><span class="linenos">263</span></a>
</span><span id="Point-264"><a href="#Point-264"><span class="linenos">264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-265"><a href="#Point-265"><span class="linenos">265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Point-266"><a href="#Point-266"><span class="linenos">266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point-267"><a href="#Point-267"><span class="linenos">267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point-268"><a href="#Point-268"><span class="linenos">268</span></a>
</span><span id="Point-269"><a href="#Point-269"><span class="linenos">269</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Point-270"><a href="#Point-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-271"><a href="#Point-271"><span class="linenos">271</span></a>            <span class="k">return</span>
</span><span id="Point-272"><a href="#Point-272"><span class="linenos">272</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Point-273"><a href="#Point-273"><span class="linenos">273</span></a>            <span class="k">pass</span>
</span><span id="Point-274"><a href="#Point-274"><span class="linenos">274</span></a>
</span><span id="Point-275"><a href="#Point-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-276"><a href="#Point-276"><span class="linenos">276</span></a>
</span><span id="Point-277"><a href="#Point-277"><span class="linenos">277</span></a>    <span class="k">def</span> <span class="nf">hyperboloid_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-278"><a href="#Point-278"><span class="linenos">278</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the hyperboloid model.</span>
</span><span id="Point-279"><a href="#Point-279"><span class="linenos">279</span></a>
</span><span id="Point-280"><a href="#Point-280"><span class="linenos">280</span></a><span class="sd">        Parameters</span>
</span><span id="Point-281"><a href="#Point-281"><span class="linenos">281</span></a><span class="sd">        ----------</span>
</span><span id="Point-282"><a href="#Point-282"><span class="linenos">282</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point-283"><a href="#Point-283"><span class="linenos">283</span></a><span class="sd">            Data to set coordinates to, in the hyperboloid</span>
</span><span id="Point-284"><a href="#Point-284"><span class="linenos">284</span></a><span class="sd">            model. The last dimension of the array is the</span>
</span><span id="Point-285"><a href="#Point-285"><span class="linenos">285</span></a><span class="sd">            dimension of the vector space R^(n,1). If `None`, do not</span>
</span><span id="Point-286"><a href="#Point-286"><span class="linenos">286</span></a><span class="sd">            update coordinates.</span>
</span><span id="Point-287"><a href="#Point-287"><span class="linenos">287</span></a>
</span><span id="Point-288"><a href="#Point-288"><span class="linenos">288</span></a><span class="sd">        Returns</span>
</span><span id="Point-289"><a href="#Point-289"><span class="linenos">289</span></a><span class="sd">        -------</span>
</span><span id="Point-290"><a href="#Point-290"><span class="linenos">290</span></a><span class="sd">        ndarray</span>
</span><span id="Point-291"><a href="#Point-291"><span class="linenos">291</span></a><span class="sd">            Hyperboloid coordinates for this point (or array of</span>
</span><span id="Point-292"><a href="#Point-292"><span class="linenos">292</span></a><span class="sd">            points).</span>
</span><span id="Point-293"><a href="#Point-293"><span class="linenos">293</span></a>
</span><span id="Point-294"><a href="#Point-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-295"><a href="#Point-295"><span class="linenos">295</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point-296"><a href="#Point-296"><span class="linenos">296</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-297"><a href="#Point-297"><span class="linenos">297</span></a>
</span><span id="Point-298"><a href="#Point-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="n">hyperboloid_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="Point-299"><a href="#Point-299"><span class="linenos">299</span></a>
</span><span id="Point-300"><a href="#Point-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">poincare_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-301"><a href="#Point-301"><span class="linenos">301</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the hyperboloid model.</span>
</span><span id="Point-302"><a href="#Point-302"><span class="linenos">302</span></a>
</span><span id="Point-303"><a href="#Point-303"><span class="linenos">303</span></a><span class="sd">        Parameters</span>
</span><span id="Point-304"><a href="#Point-304"><span class="linenos">304</span></a><span class="sd">        ----------</span>
</span><span id="Point-305"><a href="#Point-305"><span class="linenos">305</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point-306"><a href="#Point-306"><span class="linenos">306</span></a><span class="sd">            Data to set coordinates to, as points in projective space.</span>
</span><span id="Point-307"><a href="#Point-307"><span class="linenos">307</span></a><span class="sd">            The last dimension of the array is the dimension of the</span>
</span><span id="Point-308"><a href="#Point-308"><span class="linenos">308</span></a><span class="sd">            vector space R^(n,1). If `None`, do not update</span>
</span><span id="Point-309"><a href="#Point-309"><span class="linenos">309</span></a><span class="sd">            coordinates.</span>
</span><span id="Point-310"><a href="#Point-310"><span class="linenos">310</span></a>
</span><span id="Point-311"><a href="#Point-311"><span class="linenos">311</span></a><span class="sd">        Returns</span>
</span><span id="Point-312"><a href="#Point-312"><span class="linenos">312</span></a><span class="sd">        -------</span>
</span><span id="Point-313"><a href="#Point-313"><span class="linenos">313</span></a><span class="sd">        ndarray</span>
</span><span id="Point-314"><a href="#Point-314"><span class="linenos">314</span></a><span class="sd">            Projective coordinates for this point (or array of</span>
</span><span id="Point-315"><a href="#Point-315"><span class="linenos">315</span></a><span class="sd">            points).</span>
</span><span id="Point-316"><a href="#Point-316"><span class="linenos">316</span></a>
</span><span id="Point-317"><a href="#Point-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-318"><a href="#Point-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point-319"><a href="#Point-319"><span class="linenos">319</span></a>            <span class="n">klein</span> <span class="o">=</span> <span class="n">poincare_to_kleinian</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">))</span>
</span><span id="Point-320"><a href="#Point-320"><span class="linenos">320</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">(</span><span class="n">klein</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-321"><a href="#Point-321"><span class="linenos">321</span></a>
</span><span id="Point-322"><a href="#Point-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="n">kleinian_to_poincare</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">())</span>
</span><span id="Point-323"><a href="#Point-323"><span class="linenos">323</span></a>
</span><span id="Point-324"><a href="#Point-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">halfspace_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-325"><a href="#Point-325"><span class="linenos">325</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the half-space model.</span>
</span><span id="Point-326"><a href="#Point-326"><span class="linenos">326</span></a>
</span><span id="Point-327"><a href="#Point-327"><span class="linenos">327</span></a><span class="sd">        Parameters</span>
</span><span id="Point-328"><a href="#Point-328"><span class="linenos">328</span></a><span class="sd">        ----------</span>
</span><span id="Point-329"><a href="#Point-329"><span class="linenos">329</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point-330"><a href="#Point-330"><span class="linenos">330</span></a><span class="sd">            Data to set coordinates to, as points in half-space.  The</span>
</span><span id="Point-331"><a href="#Point-331"><span class="linenos">331</span></a><span class="sd">            last dimension of the array is the dimension of hyperbolic</span>
</span><span id="Point-332"><a href="#Point-332"><span class="linenos">332</span></a><span class="sd">            space H^n. If `None`, do not update coordinates.</span>
</span><span id="Point-333"><a href="#Point-333"><span class="linenos">333</span></a>
</span><span id="Point-334"><a href="#Point-334"><span class="linenos">334</span></a><span class="sd">        Returns</span>
</span><span id="Point-335"><a href="#Point-335"><span class="linenos">335</span></a><span class="sd">        -------</span>
</span><span id="Point-336"><a href="#Point-336"><span class="linenos">336</span></a><span class="sd">        ndarray</span>
</span><span id="Point-337"><a href="#Point-337"><span class="linenos">337</span></a><span class="sd">            Half-space coordinates for this point (or array of</span>
</span><span id="Point-338"><a href="#Point-338"><span class="linenos">338</span></a><span class="sd">            points).</span>
</span><span id="Point-339"><a href="#Point-339"><span class="linenos">339</span></a>
</span><span id="Point-340"><a href="#Point-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-341"><a href="#Point-341"><span class="linenos">341</span></a>        <span class="n">poincare</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Point-342"><a href="#Point-342"><span class="linenos">342</span></a>
</span><span id="Point-343"><a href="#Point-343"><span class="linenos">343</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point-344"><a href="#Point-344"><span class="linenos">344</span></a>            <span class="n">poincare</span> <span class="o">=</span> <span class="n">halfspace_to_poincare</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">))</span>
</span><span id="Point-345"><a href="#Point-345"><span class="linenos">345</span></a>
</span><span id="Point-346"><a href="#Point-346"><span class="linenos">346</span></a>        <span class="n">poincare_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poincare_coords</span><span class="p">(</span><span class="n">poincare</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-347"><a href="#Point-347"><span class="linenos">347</span></a>        <span class="k">return</span> <span class="n">poincare_to_halfspace</span><span class="p">(</span><span class="n">poincare_coords</span><span class="p">)</span>
</span><span id="Point-348"><a href="#Point-348"><span class="linenos">348</span></a>
</span><span id="Point-349"><a href="#Point-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-350"><a href="#Point-350"><span class="linenos">350</span></a>        <span class="sd">&quot;&quot;&quot;Get or set a representation of this hyperbolic object in</span>
</span><span id="Point-351"><a href="#Point-351"><span class="linenos">351</span></a><span class="sd">        coordinates.</span>
</span><span id="Point-352"><a href="#Point-352"><span class="linenos">352</span></a>
</span><span id="Point-353"><a href="#Point-353"><span class="linenos">353</span></a><span class="sd">        The available models are `Model.KLEIN`, `Model.PROJECTIVE`,</span>
</span><span id="Point-354"><a href="#Point-354"><span class="linenos">354</span></a><span class="sd">        `Model.POINCARE`, `Model.HYPERBOLOID`, and `Model.HALFSPACE`.</span>
</span><span id="Point-355"><a href="#Point-355"><span class="linenos">355</span></a>
</span><span id="Point-356"><a href="#Point-356"><span class="linenos">356</span></a><span class="sd">        Parameters</span>
</span><span id="Point-357"><a href="#Point-357"><span class="linenos">357</span></a><span class="sd">        ----------</span>
</span><span id="Point-358"><a href="#Point-358"><span class="linenos">358</span></a><span class="sd">        model : Model</span>
</span><span id="Point-359"><a href="#Point-359"><span class="linenos">359</span></a><span class="sd">            which model to take coordinates in</span>
</span><span id="Point-360"><a href="#Point-360"><span class="linenos">360</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point-361"><a href="#Point-361"><span class="linenos">361</span></a><span class="sd">            data for this hyperbolic object, interpreted as</span>
</span><span id="Point-362"><a href="#Point-362"><span class="linenos">362</span></a><span class="sd">            coordinates with respect to `model`. If `None`, just</span>
</span><span id="Point-363"><a href="#Point-363"><span class="linenos">363</span></a><span class="sd">            return coordinates.</span>
</span><span id="Point-364"><a href="#Point-364"><span class="linenos">364</span></a>
</span><span id="Point-365"><a href="#Point-365"><span class="linenos">365</span></a><span class="sd">        Raises</span>
</span><span id="Point-366"><a href="#Point-366"><span class="linenos">366</span></a><span class="sd">        ------</span>
</span><span id="Point-367"><a href="#Point-367"><span class="linenos">367</span></a><span class="sd">        GeometryError</span>
</span><span id="Point-368"><a href="#Point-368"><span class="linenos">368</span></a><span class="sd">            Raised if an unsupported model is specified.</span>
</span><span id="Point-369"><a href="#Point-369"><span class="linenos">369</span></a>
</span><span id="Point-370"><a href="#Point-370"><span class="linenos">370</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-371"><a href="#Point-371"><span class="linenos">371</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Point-372"><a href="#Point-372"><span class="linenos">372</span></a>            <span class="k">return</span> <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-373"><a href="#Point-373"><span class="linenos">373</span></a>        <span class="k">except</span> <span class="n">GeometryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Point-374"><a href="#Point-374"><span class="linenos">374</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Point-375"><a href="#Point-375"><span class="linenos">375</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">poincare_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-376"><a href="#Point-376"><span class="linenos">376</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HYPERBOLOID</span><span class="p">:</span>
</span><span id="Point-377"><a href="#Point-377"><span class="linenos">377</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-378"><a href="#Point-378"><span class="linenos">378</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Point-379"><a href="#Point-379"><span class="linenos">379</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">halfspace_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point-380"><a href="#Point-380"><span class="linenos">380</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span><span id="Point-381"><a href="#Point-381"><span class="linenos">381</span></a>
</span><span id="Point-382"><a href="#Point-382"><span class="linenos">382</span></a>    <span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Point-383"><a href="#Point-383"><span class="linenos">383</span></a>        <span class="sd">&quot;&quot;&quot;Compute hyperbolic distances between pairs of points, or pairs of</span>
</span><span id="Point-384"><a href="#Point-384"><span class="linenos">384</span></a><span class="sd">            arrays of points.</span>
</span><span id="Point-385"><a href="#Point-385"><span class="linenos">385</span></a>
</span><span id="Point-386"><a href="#Point-386"><span class="linenos">386</span></a><span class="sd">        Parameters</span>
</span><span id="Point-387"><a href="#Point-387"><span class="linenos">387</span></a><span class="sd">        ----------</span>
</span><span id="Point-388"><a href="#Point-388"><span class="linenos">388</span></a><span class="sd">        other : Point</span>
</span><span id="Point-389"><a href="#Point-389"><span class="linenos">389</span></a><span class="sd">            The point to compute distances to</span>
</span><span id="Point-390"><a href="#Point-390"><span class="linenos">390</span></a>
</span><span id="Point-391"><a href="#Point-391"><span class="linenos">391</span></a><span class="sd">        Returns</span>
</span><span id="Point-392"><a href="#Point-392"><span class="linenos">392</span></a><span class="sd">        -------</span>
</span><span id="Point-393"><a href="#Point-393"><span class="linenos">393</span></a><span class="sd">        ndarray</span>
</span><span id="Point-394"><a href="#Point-394"><span class="linenos">394</span></a><span class="sd">            distances in hyperbolic space between self and other</span>
</span><span id="Point-395"><a href="#Point-395"><span class="linenos">395</span></a>
</span><span id="Point-396"><a href="#Point-396"><span class="linenos">396</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-397"><a href="#Point-397"><span class="linenos">397</span></a>        <span class="c1">#TODO: allow for pairwise distances</span>
</span><span id="Point-398"><a href="#Point-398"><span class="linenos">398</span></a>        <span class="n">self_hyp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">()</span>
</span><span id="Point-399"><a href="#Point-399"><span class="linenos">399</span></a>        <span class="n">other_hyp</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">()</span>
</span><span id="Point-400"><a href="#Point-400"><span class="linenos">400</span></a>
</span><span id="Point-401"><a href="#Point-401"><span class="linenos">401</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">self_hyp</span><span class="p">,</span> <span class="n">other_hyp</span><span class="p">,</span>
</span><span id="Point-402"><a href="#Point-402"><span class="linenos">402</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="Point-403"><a href="#Point-403"><span class="linenos">403</span></a>
</span><span id="Point-404"><a href="#Point-404"><span class="linenos">404</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccosh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">products</span><span class="p">))</span>
</span><span id="Point-405"><a href="#Point-405"><span class="linenos">405</span></a>
</span><span id="Point-406"><a href="#Point-406"><span class="linenos">406</span></a>    <span class="k">def</span> <span class="nf">origin_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Point-407"><a href="#Point-407"><span class="linenos">407</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking an &quot;origin&quot; point to this point</span>
</span><span id="Point-408"><a href="#Point-408"><span class="linenos">408</span></a>
</span><span id="Point-409"><a href="#Point-409"><span class="linenos">409</span></a><span class="sd">        Returns</span>
</span><span id="Point-410"><a href="#Point-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="Point-411"><a href="#Point-411"><span class="linenos">411</span></a><span class="sd">        Isometry :</span>
</span><span id="Point-412"><a href="#Point-412"><span class="linenos">412</span></a><span class="sd">            Some isometry taking the point with Kleinian/Poincare</span>
</span><span id="Point-413"><a href="#Point-413"><span class="linenos">413</span></a><span class="sd">            coordinates (0, 0, ...) to this point. This isometry is</span>
</span><span id="Point-414"><a href="#Point-414"><span class="linenos">414</span></a><span class="sd">            not uniquely determined and is not guaranteed to be</span>
</span><span id="Point-415"><a href="#Point-415"><span class="linenos">415</span></a><span class="sd">            orientation-preserving.</span>
</span><span id="Point-416"><a href="#Point-416"><span class="linenos">416</span></a>
</span><span id="Point-417"><a href="#Point-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-418"><a href="#Point-418"><span class="linenos">418</span></a>        <span class="n">normed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
</span><span id="Point-419"><a href="#Point-419"><span class="linenos">419</span></a>            <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">),</span>
</span><span id="Point-420"><a href="#Point-420"><span class="linenos">420</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="Point-421"><a href="#Point-421"><span class="linenos">421</span></a>        <span class="p">)</span>
</span><span id="Point-422"><a href="#Point-422"><span class="linenos">422</span></a>        <span class="n">isom</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span>
</span><span id="Point-423"><a href="#Point-423"><span class="linenos">423</span></a>                                   <span class="n">force_oriented</span><span class="p">)</span>
</span><span id="Point-424"><a href="#Point-424"><span class="linenos">424</span></a>
</span><span id="Point-425"><a href="#Point-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">isom</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="Point-426"><a href="#Point-426"><span class="linenos">426</span></a>
</span><span id="Point-427"><a href="#Point-427"><span class="linenos">427</span></a>    <span class="k">def</span> <span class="nf">unit_tangent_towards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Point-428"><a href="#Point-428"><span class="linenos">428</span></a>        <span class="sd">&quot;&quot;&quot;Get a unit tangent vector with this basepoint, pointing at another point</span>
</span><span id="Point-429"><a href="#Point-429"><span class="linenos">429</span></a>
</span><span id="Point-430"><a href="#Point-430"><span class="linenos">430</span></a><span class="sd">        Parameters</span>
</span><span id="Point-431"><a href="#Point-431"><span class="linenos">431</span></a><span class="sd">        ----------</span>
</span><span id="Point-432"><a href="#Point-432"><span class="linenos">432</span></a><span class="sd">        other : Point</span>
</span><span id="Point-433"><a href="#Point-433"><span class="linenos">433</span></a><span class="sd">            another point in hyperbolic space where the unit tangent</span>
</span><span id="Point-434"><a href="#Point-434"><span class="linenos">434</span></a><span class="sd">            vector points</span>
</span><span id="Point-435"><a href="#Point-435"><span class="linenos">435</span></a>
</span><span id="Point-436"><a href="#Point-436"><span class="linenos">436</span></a><span class="sd">        Returns</span>
</span><span id="Point-437"><a href="#Point-437"><span class="linenos">437</span></a><span class="sd">        -------</span>
</span><span id="Point-438"><a href="#Point-438"><span class="linenos">438</span></a><span class="sd">        TangentVector</span>
</span><span id="Point-439"><a href="#Point-439"><span class="linenos">439</span></a><span class="sd">            A tangent vector with this point at its base and pointing</span>
</span><span id="Point-440"><a href="#Point-440"><span class="linenos">440</span></a><span class="sd">            towards `other`.</span>
</span><span id="Point-441"><a href="#Point-441"><span class="linenos">441</span></a>
</span><span id="Point-442"><a href="#Point-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-443"><a href="#Point-443"><span class="linenos">443</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Point-444"><a href="#Point-444"><span class="linenos">444</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span><span id="Point-445"><a href="#Point-445"><span class="linenos">445</span></a>
</span><span id="Point-446"><a href="#Point-446"><span class="linenos">446</span></a>    <span class="k">def</span> <span class="nf">get_origin</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point-447"><a href="#Point-447"><span class="linenos">447</span></a>        <span class="sd">&quot;&quot;&quot;Get a point (or ndarray of points) at the &quot;origin&quot; of hyperbolic</span>
</span><span id="Point-448"><a href="#Point-448"><span class="linenos">448</span></a><span class="sd">           space</span>
</span><span id="Point-449"><a href="#Point-449"><span class="linenos">449</span></a>
</span><span id="Point-450"><a href="#Point-450"><span class="linenos">450</span></a><span class="sd">        Parameters</span>
</span><span id="Point-451"><a href="#Point-451"><span class="linenos">451</span></a><span class="sd">        ----------</span>
</span><span id="Point-452"><a href="#Point-452"><span class="linenos">452</span></a><span class="sd">        dimension : int</span>
</span><span id="Point-453"><a href="#Point-453"><span class="linenos">453</span></a><span class="sd">            Dimension of hyperbolic space where this point lives</span>
</span><span id="Point-454"><a href="#Point-454"><span class="linenos">454</span></a><span class="sd">        shape : tuple(int)</span>
</span><span id="Point-455"><a href="#Point-455"><span class="linenos">455</span></a><span class="sd">            Shape of array of origin points to get</span>
</span><span id="Point-456"><a href="#Point-456"><span class="linenos">456</span></a>
</span><span id="Point-457"><a href="#Point-457"><span class="linenos">457</span></a><span class="sd">        Returns</span>
</span><span id="Point-458"><a href="#Point-458"><span class="linenos">458</span></a><span class="sd">        -------</span>
</span><span id="Point-459"><a href="#Point-459"><span class="linenos">459</span></a><span class="sd">        Point</span>
</span><span id="Point-460"><a href="#Point-460"><span class="linenos">460</span></a><span class="sd">            Point object with Kleinian/Poincare coords (0, 0, ...)</span>
</span><span id="Point-461"><a href="#Point-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point-462"><a href="#Point-462"><span class="linenos">462</span></a>
</span><span id="Point-463"><a href="#Point-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">dimension</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Point-464"><a href="#Point-464"><span class="linenos">464</span></a>                     <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a point (or ndarray of points) in the closure of
hyperbolic space.</p>
</div>


                            <div id="Point.__init__" class="classattr">
                                        <input id="Point.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">point</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.PROJECTIVE">Model.PROJECTIVE</a></span><span class="p">:</span> <span class="s1">&#39;projective&#39;</span><span class="o">&gt;</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Point.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.__init__-246"><a href="#Point.__init__-246"><span class="linenos">246</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.__init__-247"><a href="#Point.__init__-247"><span class="linenos">247</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Point.__init__-248"><a href="#Point.__init__-248"><span class="linenos">248</span></a>
</span><span id="Point.__init__-249"><a href="#Point.__init__-249"><span class="linenos">249</span></a><span class="sd">        Parameters</span>
</span><span id="Point.__init__-250"><a href="#Point.__init__-250"><span class="linenos">250</span></a><span class="sd">        ----------</span>
</span><span id="Point.__init__-251"><a href="#Point.__init__-251"><span class="linenos">251</span></a><span class="sd">        point : HyperbolicObject or iterable or ndarray</span>
</span><span id="Point.__init__-252"><a href="#Point.__init__-252"><span class="linenos">252</span></a><span class="sd">            Data used to construct a point or an array of points. If</span>
</span><span id="Point.__init__-253"><a href="#Point.__init__-253"><span class="linenos">253</span></a><span class="sd">            `point` is a `HyperbolicObject`, then use the underlying</span>
</span><span id="Point.__init__-254"><a href="#Point.__init__-254"><span class="linenos">254</span></a><span class="sd">            coordinate data to build an array of points. If `point` is</span>
</span><span id="Point.__init__-255"><a href="#Point.__init__-255"><span class="linenos">255</span></a><span class="sd">            an iterable of `HyperbolicObject`s, build a composite `Point`</span>
</span><span id="Point.__init__-256"><a href="#Point.__init__-256"><span class="linenos">256</span></a><span class="sd">            object out of this array. If `point` is an `ndarray`, then</span>
</span><span id="Point.__init__-257"><a href="#Point.__init__-257"><span class="linenos">257</span></a><span class="sd">            interpret this as coordinate data for an array of points</span>
</span><span id="Point.__init__-258"><a href="#Point.__init__-258"><span class="linenos">258</span></a><span class="sd">            in some hyperbolic model.</span>
</span><span id="Point.__init__-259"><a href="#Point.__init__-259"><span class="linenos">259</span></a><span class="sd">        model : Model</span>
</span><span id="Point.__init__-260"><a href="#Point.__init__-260"><span class="linenos">260</span></a><span class="sd">            if `point` is numerical data, then what model of</span>
</span><span id="Point.__init__-261"><a href="#Point.__init__-261"><span class="linenos">261</span></a><span class="sd">            hyperbolic space we should use to interpret `point` as</span>
</span><span id="Point.__init__-262"><a href="#Point.__init__-262"><span class="linenos">262</span></a><span class="sd">            coordinates.</span>
</span><span id="Point.__init__-263"><a href="#Point.__init__-263"><span class="linenos">263</span></a>
</span><span id="Point.__init__-264"><a href="#Point.__init__-264"><span class="linenos">264</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.__init__-265"><a href="#Point.__init__-265"><span class="linenos">265</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Point.__init__-266"><a href="#Point.__init__-266"><span class="linenos">266</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point.__init__-267"><a href="#Point.__init__-267"><span class="linenos">267</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Point.__init__-268"><a href="#Point.__init__-268"><span class="linenos">268</span></a>
</span><span id="Point.__init__-269"><a href="#Point.__init__-269"><span class="linenos">269</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Point.__init__-270"><a href="#Point.__init__-270"><span class="linenos">270</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.__init__-271"><a href="#Point.__init__-271"><span class="linenos">271</span></a>            <span class="k">return</span>
</span><span id="Point.__init__-272"><a href="#Point.__init__-272"><span class="linenos">272</span></a>        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Point.__init__-273"><a href="#Point.__init__-273"><span class="linenos">273</span></a>            <span class="k">pass</span>
</span><span id="Point.__init__-274"><a href="#Point.__init__-274"><span class="linenos">274</span></a>
</span><span id="Point.__init__-275"><a href="#Point.__init__-275"><span class="linenos">275</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>point</strong> (HyperbolicObject or iterable or ndarray):
Data used to construct a point or an array of points. If
<code>point</code> is a <code><a href="#HyperbolicObject">HyperbolicObject</a></code>, then use the underlying
coordinate data to build an array of points. If <code>point</code> is
an iterable of <code><a href="#HyperbolicObject">HyperbolicObject</a></code>s, build a composite <code><a href="#Point">Point</a></code>
object out of this array. If <code>point</code> is an <code>ndarray</code>, then
interpret this as coordinate data for an array of points
in some hyperbolic model.</li>
<li><strong>model</strong> (Model):
if <code>point</code> is numerical data, then what model of
hyperbolic space we should use to interpret <code>point</code> as
coordinates.</li>
</ul>
</div>


                            </div>
                            <div id="Point.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#Point.unit_ndims"></a>
    
    

                            </div>
                            <div id="Point.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#Point.aux_ndims"></a>
    
    

                            </div>
                            <div id="Point.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#Point.dual_ndims"></a>
    
    

                            </div>
                            <div id="Point.hyperboloid_coords" class="classattr">
                                        <input id="Point.hyperboloid_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hyperboloid_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.hyperboloid_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.hyperboloid_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.hyperboloid_coords-277"><a href="#Point.hyperboloid_coords-277"><span class="linenos">277</span></a>    <span class="k">def</span> <span class="nf">hyperboloid_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.hyperboloid_coords-278"><a href="#Point.hyperboloid_coords-278"><span class="linenos">278</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the hyperboloid model.</span>
</span><span id="Point.hyperboloid_coords-279"><a href="#Point.hyperboloid_coords-279"><span class="linenos">279</span></a>
</span><span id="Point.hyperboloid_coords-280"><a href="#Point.hyperboloid_coords-280"><span class="linenos">280</span></a><span class="sd">        Parameters</span>
</span><span id="Point.hyperboloid_coords-281"><a href="#Point.hyperboloid_coords-281"><span class="linenos">281</span></a><span class="sd">        ----------</span>
</span><span id="Point.hyperboloid_coords-282"><a href="#Point.hyperboloid_coords-282"><span class="linenos">282</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point.hyperboloid_coords-283"><a href="#Point.hyperboloid_coords-283"><span class="linenos">283</span></a><span class="sd">            Data to set coordinates to, in the hyperboloid</span>
</span><span id="Point.hyperboloid_coords-284"><a href="#Point.hyperboloid_coords-284"><span class="linenos">284</span></a><span class="sd">            model. The last dimension of the array is the</span>
</span><span id="Point.hyperboloid_coords-285"><a href="#Point.hyperboloid_coords-285"><span class="linenos">285</span></a><span class="sd">            dimension of the vector space R^(n,1). If `None`, do not</span>
</span><span id="Point.hyperboloid_coords-286"><a href="#Point.hyperboloid_coords-286"><span class="linenos">286</span></a><span class="sd">            update coordinates.</span>
</span><span id="Point.hyperboloid_coords-287"><a href="#Point.hyperboloid_coords-287"><span class="linenos">287</span></a>
</span><span id="Point.hyperboloid_coords-288"><a href="#Point.hyperboloid_coords-288"><span class="linenos">288</span></a><span class="sd">        Returns</span>
</span><span id="Point.hyperboloid_coords-289"><a href="#Point.hyperboloid_coords-289"><span class="linenos">289</span></a><span class="sd">        -------</span>
</span><span id="Point.hyperboloid_coords-290"><a href="#Point.hyperboloid_coords-290"><span class="linenos">290</span></a><span class="sd">        ndarray</span>
</span><span id="Point.hyperboloid_coords-291"><a href="#Point.hyperboloid_coords-291"><span class="linenos">291</span></a><span class="sd">            Hyperboloid coordinates for this point (or array of</span>
</span><span id="Point.hyperboloid_coords-292"><a href="#Point.hyperboloid_coords-292"><span class="linenos">292</span></a><span class="sd">            points).</span>
</span><span id="Point.hyperboloid_coords-293"><a href="#Point.hyperboloid_coords-293"><span class="linenos">293</span></a>
</span><span id="Point.hyperboloid_coords-294"><a href="#Point.hyperboloid_coords-294"><span class="linenos">294</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.hyperboloid_coords-295"><a href="#Point.hyperboloid_coords-295"><span class="linenos">295</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point.hyperboloid_coords-296"><a href="#Point.hyperboloid_coords-296"><span class="linenos">296</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.hyperboloid_coords-297"><a href="#Point.hyperboloid_coords-297"><span class="linenos">297</span></a>
</span><span id="Point.hyperboloid_coords-298"><a href="#Point.hyperboloid_coords-298"><span class="linenos">298</span></a>        <span class="k">return</span> <span class="n">hyperboloid_coords</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get or set point coordinates in the hyperboloid model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ndarray):
Data to set coordinates to, in the hyperboloid
model. The last dimension of the array is the
dimension of the vector space R^(n,1). If <code>None</code>, do not
update coordinates.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Hyperboloid coordinates for this point (or array of
points).</li>
</ul>
</div>


                            </div>
                            <div id="Point.poincare_coords" class="classattr">
                                        <input id="Point.poincare_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">poincare_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.poincare_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.poincare_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.poincare_coords-300"><a href="#Point.poincare_coords-300"><span class="linenos">300</span></a>    <span class="k">def</span> <span class="nf">poincare_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.poincare_coords-301"><a href="#Point.poincare_coords-301"><span class="linenos">301</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the hyperboloid model.</span>
</span><span id="Point.poincare_coords-302"><a href="#Point.poincare_coords-302"><span class="linenos">302</span></a>
</span><span id="Point.poincare_coords-303"><a href="#Point.poincare_coords-303"><span class="linenos">303</span></a><span class="sd">        Parameters</span>
</span><span id="Point.poincare_coords-304"><a href="#Point.poincare_coords-304"><span class="linenos">304</span></a><span class="sd">        ----------</span>
</span><span id="Point.poincare_coords-305"><a href="#Point.poincare_coords-305"><span class="linenos">305</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point.poincare_coords-306"><a href="#Point.poincare_coords-306"><span class="linenos">306</span></a><span class="sd">            Data to set coordinates to, as points in projective space.</span>
</span><span id="Point.poincare_coords-307"><a href="#Point.poincare_coords-307"><span class="linenos">307</span></a><span class="sd">            The last dimension of the array is the dimension of the</span>
</span><span id="Point.poincare_coords-308"><a href="#Point.poincare_coords-308"><span class="linenos">308</span></a><span class="sd">            vector space R^(n,1). If `None`, do not update</span>
</span><span id="Point.poincare_coords-309"><a href="#Point.poincare_coords-309"><span class="linenos">309</span></a><span class="sd">            coordinates.</span>
</span><span id="Point.poincare_coords-310"><a href="#Point.poincare_coords-310"><span class="linenos">310</span></a>
</span><span id="Point.poincare_coords-311"><a href="#Point.poincare_coords-311"><span class="linenos">311</span></a><span class="sd">        Returns</span>
</span><span id="Point.poincare_coords-312"><a href="#Point.poincare_coords-312"><span class="linenos">312</span></a><span class="sd">        -------</span>
</span><span id="Point.poincare_coords-313"><a href="#Point.poincare_coords-313"><span class="linenos">313</span></a><span class="sd">        ndarray</span>
</span><span id="Point.poincare_coords-314"><a href="#Point.poincare_coords-314"><span class="linenos">314</span></a><span class="sd">            Projective coordinates for this point (or array of</span>
</span><span id="Point.poincare_coords-315"><a href="#Point.poincare_coords-315"><span class="linenos">315</span></a><span class="sd">            points).</span>
</span><span id="Point.poincare_coords-316"><a href="#Point.poincare_coords-316"><span class="linenos">316</span></a>
</span><span id="Point.poincare_coords-317"><a href="#Point.poincare_coords-317"><span class="linenos">317</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.poincare_coords-318"><a href="#Point.poincare_coords-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point.poincare_coords-319"><a href="#Point.poincare_coords-319"><span class="linenos">319</span></a>            <span class="n">klein</span> <span class="o">=</span> <span class="n">poincare_to_kleinian</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">))</span>
</span><span id="Point.poincare_coords-320"><a href="#Point.poincare_coords-320"><span class="linenos">320</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">(</span><span class="n">klein</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.poincare_coords-321"><a href="#Point.poincare_coords-321"><span class="linenos">321</span></a>
</span><span id="Point.poincare_coords-322"><a href="#Point.poincare_coords-322"><span class="linenos">322</span></a>        <span class="k">return</span> <span class="n">kleinian_to_poincare</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">kleinian_coords</span><span class="p">())</span>
</span></pre></div>


            <div class="docstring"><p>Get or set point coordinates in the hyperboloid model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ndarray):
Data to set coordinates to, as points in projective space.
The last dimension of the array is the dimension of the
vector space R^(n,1). If <code>None</code>, do not update
coordinates.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Projective coordinates for this point (or array of
points).</li>
</ul>
</div>


                            </div>
                            <div id="Point.halfspace_coords" class="classattr">
                                        <input id="Point.halfspace_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">halfspace_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.halfspace_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.halfspace_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.halfspace_coords-324"><a href="#Point.halfspace_coords-324"><span class="linenos">324</span></a>    <span class="k">def</span> <span class="nf">halfspace_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.halfspace_coords-325"><a href="#Point.halfspace_coords-325"><span class="linenos">325</span></a>        <span class="sd">&quot;&quot;&quot;Get or set point coordinates in the half-space model.</span>
</span><span id="Point.halfspace_coords-326"><a href="#Point.halfspace_coords-326"><span class="linenos">326</span></a>
</span><span id="Point.halfspace_coords-327"><a href="#Point.halfspace_coords-327"><span class="linenos">327</span></a><span class="sd">        Parameters</span>
</span><span id="Point.halfspace_coords-328"><a href="#Point.halfspace_coords-328"><span class="linenos">328</span></a><span class="sd">        ----------</span>
</span><span id="Point.halfspace_coords-329"><a href="#Point.halfspace_coords-329"><span class="linenos">329</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point.halfspace_coords-330"><a href="#Point.halfspace_coords-330"><span class="linenos">330</span></a><span class="sd">            Data to set coordinates to, as points in half-space.  The</span>
</span><span id="Point.halfspace_coords-331"><a href="#Point.halfspace_coords-331"><span class="linenos">331</span></a><span class="sd">            last dimension of the array is the dimension of hyperbolic</span>
</span><span id="Point.halfspace_coords-332"><a href="#Point.halfspace_coords-332"><span class="linenos">332</span></a><span class="sd">            space H^n. If `None`, do not update coordinates.</span>
</span><span id="Point.halfspace_coords-333"><a href="#Point.halfspace_coords-333"><span class="linenos">333</span></a>
</span><span id="Point.halfspace_coords-334"><a href="#Point.halfspace_coords-334"><span class="linenos">334</span></a><span class="sd">        Returns</span>
</span><span id="Point.halfspace_coords-335"><a href="#Point.halfspace_coords-335"><span class="linenos">335</span></a><span class="sd">        -------</span>
</span><span id="Point.halfspace_coords-336"><a href="#Point.halfspace_coords-336"><span class="linenos">336</span></a><span class="sd">        ndarray</span>
</span><span id="Point.halfspace_coords-337"><a href="#Point.halfspace_coords-337"><span class="linenos">337</span></a><span class="sd">            Half-space coordinates for this point (or array of</span>
</span><span id="Point.halfspace_coords-338"><a href="#Point.halfspace_coords-338"><span class="linenos">338</span></a><span class="sd">            points).</span>
</span><span id="Point.halfspace_coords-339"><a href="#Point.halfspace_coords-339"><span class="linenos">339</span></a>
</span><span id="Point.halfspace_coords-340"><a href="#Point.halfspace_coords-340"><span class="linenos">340</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.halfspace_coords-341"><a href="#Point.halfspace_coords-341"><span class="linenos">341</span></a>        <span class="n">poincare</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="Point.halfspace_coords-342"><a href="#Point.halfspace_coords-342"><span class="linenos">342</span></a>
</span><span id="Point.halfspace_coords-343"><a href="#Point.halfspace_coords-343"><span class="linenos">343</span></a>        <span class="k">if</span> <span class="n">proj_data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Point.halfspace_coords-344"><a href="#Point.halfspace_coords-344"><span class="linenos">344</span></a>            <span class="n">poincare</span> <span class="o">=</span> <span class="n">halfspace_to_poincare</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">proj_data</span><span class="p">))</span>
</span><span id="Point.halfspace_coords-345"><a href="#Point.halfspace_coords-345"><span class="linenos">345</span></a>
</span><span id="Point.halfspace_coords-346"><a href="#Point.halfspace_coords-346"><span class="linenos">346</span></a>        <span class="n">poincare_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">poincare_coords</span><span class="p">(</span><span class="n">poincare</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.halfspace_coords-347"><a href="#Point.halfspace_coords-347"><span class="linenos">347</span></a>        <span class="k">return</span> <span class="n">poincare_to_halfspace</span><span class="p">(</span><span class="n">poincare_coords</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get or set point coordinates in the half-space model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ndarray):
Data to set coordinates to, as points in half-space.  The
last dimension of the array is the dimension of hyperbolic
space H^n. If <code>None</code>, do not update coordinates.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Half-space coordinates for this point (or array of
points).</li>
</ul>
</div>


                            </div>
                            <div id="Point.coords" class="classattr">
                                        <input id="Point.coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span>, </span><span class="param"><span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.coords-349"><a href="#Point.coords-349"><span class="linenos">349</span></a>    <span class="k">def</span> <span class="nf">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.coords-350"><a href="#Point.coords-350"><span class="linenos">350</span></a>        <span class="sd">&quot;&quot;&quot;Get or set a representation of this hyperbolic object in</span>
</span><span id="Point.coords-351"><a href="#Point.coords-351"><span class="linenos">351</span></a><span class="sd">        coordinates.</span>
</span><span id="Point.coords-352"><a href="#Point.coords-352"><span class="linenos">352</span></a>
</span><span id="Point.coords-353"><a href="#Point.coords-353"><span class="linenos">353</span></a><span class="sd">        The available models are `Model.KLEIN`, `Model.PROJECTIVE`,</span>
</span><span id="Point.coords-354"><a href="#Point.coords-354"><span class="linenos">354</span></a><span class="sd">        `Model.POINCARE`, `Model.HYPERBOLOID`, and `Model.HALFSPACE`.</span>
</span><span id="Point.coords-355"><a href="#Point.coords-355"><span class="linenos">355</span></a>
</span><span id="Point.coords-356"><a href="#Point.coords-356"><span class="linenos">356</span></a><span class="sd">        Parameters</span>
</span><span id="Point.coords-357"><a href="#Point.coords-357"><span class="linenos">357</span></a><span class="sd">        ----------</span>
</span><span id="Point.coords-358"><a href="#Point.coords-358"><span class="linenos">358</span></a><span class="sd">        model : Model</span>
</span><span id="Point.coords-359"><a href="#Point.coords-359"><span class="linenos">359</span></a><span class="sd">            which model to take coordinates in</span>
</span><span id="Point.coords-360"><a href="#Point.coords-360"><span class="linenos">360</span></a><span class="sd">        proj_data : ndarray</span>
</span><span id="Point.coords-361"><a href="#Point.coords-361"><span class="linenos">361</span></a><span class="sd">            data for this hyperbolic object, interpreted as</span>
</span><span id="Point.coords-362"><a href="#Point.coords-362"><span class="linenos">362</span></a><span class="sd">            coordinates with respect to `model`. If `None`, just</span>
</span><span id="Point.coords-363"><a href="#Point.coords-363"><span class="linenos">363</span></a><span class="sd">            return coordinates.</span>
</span><span id="Point.coords-364"><a href="#Point.coords-364"><span class="linenos">364</span></a>
</span><span id="Point.coords-365"><a href="#Point.coords-365"><span class="linenos">365</span></a><span class="sd">        Raises</span>
</span><span id="Point.coords-366"><a href="#Point.coords-366"><span class="linenos">366</span></a><span class="sd">        ------</span>
</span><span id="Point.coords-367"><a href="#Point.coords-367"><span class="linenos">367</span></a><span class="sd">        GeometryError</span>
</span><span id="Point.coords-368"><a href="#Point.coords-368"><span class="linenos">368</span></a><span class="sd">            Raised if an unsupported model is specified.</span>
</span><span id="Point.coords-369"><a href="#Point.coords-369"><span class="linenos">369</span></a>
</span><span id="Point.coords-370"><a href="#Point.coords-370"><span class="linenos">370</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.coords-371"><a href="#Point.coords-371"><span class="linenos">371</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Point.coords-372"><a href="#Point.coords-372"><span class="linenos">372</span></a>            <span class="k">return</span> <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.coords-373"><a href="#Point.coords-373"><span class="linenos">373</span></a>        <span class="k">except</span> <span class="n">GeometryError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="Point.coords-374"><a href="#Point.coords-374"><span class="linenos">374</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Point.coords-375"><a href="#Point.coords-375"><span class="linenos">375</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">poincare_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.coords-376"><a href="#Point.coords-376"><span class="linenos">376</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HYPERBOLOID</span><span class="p">:</span>
</span><span id="Point.coords-377"><a href="#Point.coords-377"><span class="linenos">377</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.coords-378"><a href="#Point.coords-378"><span class="linenos">378</span></a>            <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Point.coords-379"><a href="#Point.coords-379"><span class="linenos">379</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">halfspace_coords</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Point.coords-380"><a href="#Point.coords-380"><span class="linenos">380</span></a>            <span class="k">raise</span> <span class="n">e</span>
</span></pre></div>


            <div class="docstring"><p>Get or set a representation of this hyperbolic object in
coordinates.</p>

<p>The available models are <code><a href="#Model.KLEIN">Model.KLEIN</a></code>, <code><a href="#Model.PROJECTIVE">Model.PROJECTIVE</a></code>,
<code><a href="#Model.POINCARE">Model.POINCARE</a></code>, <code><a href="#Model.HYPERBOLOID">Model.HYPERBOLOID</a></code>, and <code><a href="#Model.HALFSPACE">Model.HALFSPACE</a></code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>model</strong> (Model):
which model to take coordinates in</li>
<li><strong>proj_data</strong> (ndarray):
data for this hyperbolic object, interpreted as
coordinates with respect to <code>model</code>. If <code>None</code>, just
return coordinates.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>GeometryError</strong>: Raised if an unsupported model is specified.</li>
</ul>
</div>


                            </div>
                            <div id="Point.distance" class="classattr">
                                        <input id="Point.distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">distance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.distance-382"><a href="#Point.distance-382"><span class="linenos">382</span></a>    <span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Point.distance-383"><a href="#Point.distance-383"><span class="linenos">383</span></a>        <span class="sd">&quot;&quot;&quot;Compute hyperbolic distances between pairs of points, or pairs of</span>
</span><span id="Point.distance-384"><a href="#Point.distance-384"><span class="linenos">384</span></a><span class="sd">            arrays of points.</span>
</span><span id="Point.distance-385"><a href="#Point.distance-385"><span class="linenos">385</span></a>
</span><span id="Point.distance-386"><a href="#Point.distance-386"><span class="linenos">386</span></a><span class="sd">        Parameters</span>
</span><span id="Point.distance-387"><a href="#Point.distance-387"><span class="linenos">387</span></a><span class="sd">        ----------</span>
</span><span id="Point.distance-388"><a href="#Point.distance-388"><span class="linenos">388</span></a><span class="sd">        other : Point</span>
</span><span id="Point.distance-389"><a href="#Point.distance-389"><span class="linenos">389</span></a><span class="sd">            The point to compute distances to</span>
</span><span id="Point.distance-390"><a href="#Point.distance-390"><span class="linenos">390</span></a>
</span><span id="Point.distance-391"><a href="#Point.distance-391"><span class="linenos">391</span></a><span class="sd">        Returns</span>
</span><span id="Point.distance-392"><a href="#Point.distance-392"><span class="linenos">392</span></a><span class="sd">        -------</span>
</span><span id="Point.distance-393"><a href="#Point.distance-393"><span class="linenos">393</span></a><span class="sd">        ndarray</span>
</span><span id="Point.distance-394"><a href="#Point.distance-394"><span class="linenos">394</span></a><span class="sd">            distances in hyperbolic space between self and other</span>
</span><span id="Point.distance-395"><a href="#Point.distance-395"><span class="linenos">395</span></a>
</span><span id="Point.distance-396"><a href="#Point.distance-396"><span class="linenos">396</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.distance-397"><a href="#Point.distance-397"><span class="linenos">397</span></a>        <span class="c1">#TODO: allow for pairwise distances</span>
</span><span id="Point.distance-398"><a href="#Point.distance-398"><span class="linenos">398</span></a>        <span class="n">self_hyp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">()</span>
</span><span id="Point.distance-399"><a href="#Point.distance-399"><span class="linenos">399</span></a>        <span class="n">other_hyp</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">hyperboloid_coords</span><span class="p">()</span>
</span><span id="Point.distance-400"><a href="#Point.distance-400"><span class="linenos">400</span></a>
</span><span id="Point.distance-401"><a href="#Point.distance-401"><span class="linenos">401</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">self_hyp</span><span class="p">,</span> <span class="n">other_hyp</span><span class="p">,</span>
</span><span id="Point.distance-402"><a href="#Point.distance-402"><span class="linenos">402</span></a>                                        <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="Point.distance-403"><a href="#Point.distance-403"><span class="linenos">403</span></a>
</span><span id="Point.distance-404"><a href="#Point.distance-404"><span class="linenos">404</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccosh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">products</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Compute hyperbolic distances between pairs of points, or pairs of
    arrays of points.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong> (Point):
The point to compute distances to</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: distances in hyperbolic space between self and other</li>
</ul>
</div>


                            </div>
                            <div id="Point.origin_to" class="classattr">
                                        <input id="Point.origin_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">origin_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.origin_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.origin_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.origin_to-406"><a href="#Point.origin_to-406"><span class="linenos">406</span></a>    <span class="k">def</span> <span class="nf">origin_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Point.origin_to-407"><a href="#Point.origin_to-407"><span class="linenos">407</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking an &quot;origin&quot; point to this point</span>
</span><span id="Point.origin_to-408"><a href="#Point.origin_to-408"><span class="linenos">408</span></a>
</span><span id="Point.origin_to-409"><a href="#Point.origin_to-409"><span class="linenos">409</span></a><span class="sd">        Returns</span>
</span><span id="Point.origin_to-410"><a href="#Point.origin_to-410"><span class="linenos">410</span></a><span class="sd">        -------</span>
</span><span id="Point.origin_to-411"><a href="#Point.origin_to-411"><span class="linenos">411</span></a><span class="sd">        Isometry :</span>
</span><span id="Point.origin_to-412"><a href="#Point.origin_to-412"><span class="linenos">412</span></a><span class="sd">            Some isometry taking the point with Kleinian/Poincare</span>
</span><span id="Point.origin_to-413"><a href="#Point.origin_to-413"><span class="linenos">413</span></a><span class="sd">            coordinates (0, 0, ...) to this point. This isometry is</span>
</span><span id="Point.origin_to-414"><a href="#Point.origin_to-414"><span class="linenos">414</span></a><span class="sd">            not uniquely determined and is not guaranteed to be</span>
</span><span id="Point.origin_to-415"><a href="#Point.origin_to-415"><span class="linenos">415</span></a><span class="sd">            orientation-preserving.</span>
</span><span id="Point.origin_to-416"><a href="#Point.origin_to-416"><span class="linenos">416</span></a>
</span><span id="Point.origin_to-417"><a href="#Point.origin_to-417"><span class="linenos">417</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.origin_to-418"><a href="#Point.origin_to-418"><span class="linenos">418</span></a>        <span class="n">normed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
</span><span id="Point.origin_to-419"><a href="#Point.origin_to-419"><span class="linenos">419</span></a>            <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">),</span>
</span><span id="Point.origin_to-420"><a href="#Point.origin_to-420"><span class="linenos">420</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="Point.origin_to-421"><a href="#Point.origin_to-421"><span class="linenos">421</span></a>        <span class="p">)</span>
</span><span id="Point.origin_to-422"><a href="#Point.origin_to-422"><span class="linenos">422</span></a>        <span class="n">isom</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span>
</span><span id="Point.origin_to-423"><a href="#Point.origin_to-423"><span class="linenos">423</span></a>                                   <span class="n">force_oriented</span><span class="p">)</span>
</span><span id="Point.origin_to-424"><a href="#Point.origin_to-424"><span class="linenos">424</span></a>
</span><span id="Point.origin_to-425"><a href="#Point.origin_to-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">isom</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get an isometry taking an "origin" point to this point</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Isometry :</strong>: Some isometry taking the point with Kleinian/Poincare
coordinates (0, 0, ...) to this point. This isometry is
not uniquely determined and is not guaranteed to be
orientation-preserving.</li>
</ul>
</div>


                            </div>
                            <div id="Point.unit_tangent_towards" class="classattr">
                                        <input id="Point.unit_tangent_towards-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">unit_tangent_towards</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.unit_tangent_towards-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.unit_tangent_towards"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.unit_tangent_towards-427"><a href="#Point.unit_tangent_towards-427"><span class="linenos">427</span></a>    <span class="k">def</span> <span class="nf">unit_tangent_towards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="Point.unit_tangent_towards-428"><a href="#Point.unit_tangent_towards-428"><span class="linenos">428</span></a>        <span class="sd">&quot;&quot;&quot;Get a unit tangent vector with this basepoint, pointing at another point</span>
</span><span id="Point.unit_tangent_towards-429"><a href="#Point.unit_tangent_towards-429"><span class="linenos">429</span></a>
</span><span id="Point.unit_tangent_towards-430"><a href="#Point.unit_tangent_towards-430"><span class="linenos">430</span></a><span class="sd">        Parameters</span>
</span><span id="Point.unit_tangent_towards-431"><a href="#Point.unit_tangent_towards-431"><span class="linenos">431</span></a><span class="sd">        ----------</span>
</span><span id="Point.unit_tangent_towards-432"><a href="#Point.unit_tangent_towards-432"><span class="linenos">432</span></a><span class="sd">        other : Point</span>
</span><span id="Point.unit_tangent_towards-433"><a href="#Point.unit_tangent_towards-433"><span class="linenos">433</span></a><span class="sd">            another point in hyperbolic space where the unit tangent</span>
</span><span id="Point.unit_tangent_towards-434"><a href="#Point.unit_tangent_towards-434"><span class="linenos">434</span></a><span class="sd">            vector points</span>
</span><span id="Point.unit_tangent_towards-435"><a href="#Point.unit_tangent_towards-435"><span class="linenos">435</span></a>
</span><span id="Point.unit_tangent_towards-436"><a href="#Point.unit_tangent_towards-436"><span class="linenos">436</span></a><span class="sd">        Returns</span>
</span><span id="Point.unit_tangent_towards-437"><a href="#Point.unit_tangent_towards-437"><span class="linenos">437</span></a><span class="sd">        -------</span>
</span><span id="Point.unit_tangent_towards-438"><a href="#Point.unit_tangent_towards-438"><span class="linenos">438</span></a><span class="sd">        TangentVector</span>
</span><span id="Point.unit_tangent_towards-439"><a href="#Point.unit_tangent_towards-439"><span class="linenos">439</span></a><span class="sd">            A tangent vector with this point at its base and pointing</span>
</span><span id="Point.unit_tangent_towards-440"><a href="#Point.unit_tangent_towards-440"><span class="linenos">440</span></a><span class="sd">            towards `other`.</span>
</span><span id="Point.unit_tangent_towards-441"><a href="#Point.unit_tangent_towards-441"><span class="linenos">441</span></a>
</span><span id="Point.unit_tangent_towards-442"><a href="#Point.unit_tangent_towards-442"><span class="linenos">442</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.unit_tangent_towards-443"><a href="#Point.unit_tangent_towards-443"><span class="linenos">443</span></a>        <span class="n">diff</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">proj_data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Point.unit_tangent_towards-444"><a href="#Point.unit_tangent_towards-444"><span class="linenos">444</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">diff</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get a unit tangent vector with this basepoint, pointing at another point</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong> (Point):
another point in hyperbolic space where the unit tangent
vector points</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>TangentVector</strong>: A tangent vector with this point at its base and pointing
towards <code>other</code>.</li>
</ul>
</div>


                            </div>
                            <div id="Point.get_origin" class="classattr">
                                        <input id="Point.get_origin-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_origin</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span>, </span><span class="param"><span class="n">shape</span><span class="o">=</span><span class="p">()</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Point.get_origin-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Point.get_origin"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Point.get_origin-446"><a href="#Point.get_origin-446"><span class="linenos">446</span></a>    <span class="k">def</span> <span class="nf">get_origin</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Point.get_origin-447"><a href="#Point.get_origin-447"><span class="linenos">447</span></a>        <span class="sd">&quot;&quot;&quot;Get a point (or ndarray of points) at the &quot;origin&quot; of hyperbolic</span>
</span><span id="Point.get_origin-448"><a href="#Point.get_origin-448"><span class="linenos">448</span></a><span class="sd">           space</span>
</span><span id="Point.get_origin-449"><a href="#Point.get_origin-449"><span class="linenos">449</span></a>
</span><span id="Point.get_origin-450"><a href="#Point.get_origin-450"><span class="linenos">450</span></a><span class="sd">        Parameters</span>
</span><span id="Point.get_origin-451"><a href="#Point.get_origin-451"><span class="linenos">451</span></a><span class="sd">        ----------</span>
</span><span id="Point.get_origin-452"><a href="#Point.get_origin-452"><span class="linenos">452</span></a><span class="sd">        dimension : int</span>
</span><span id="Point.get_origin-453"><a href="#Point.get_origin-453"><span class="linenos">453</span></a><span class="sd">            Dimension of hyperbolic space where this point lives</span>
</span><span id="Point.get_origin-454"><a href="#Point.get_origin-454"><span class="linenos">454</span></a><span class="sd">        shape : tuple(int)</span>
</span><span id="Point.get_origin-455"><a href="#Point.get_origin-455"><span class="linenos">455</span></a><span class="sd">            Shape of array of origin points to get</span>
</span><span id="Point.get_origin-456"><a href="#Point.get_origin-456"><span class="linenos">456</span></a>
</span><span id="Point.get_origin-457"><a href="#Point.get_origin-457"><span class="linenos">457</span></a><span class="sd">        Returns</span>
</span><span id="Point.get_origin-458"><a href="#Point.get_origin-458"><span class="linenos">458</span></a><span class="sd">        -------</span>
</span><span id="Point.get_origin-459"><a href="#Point.get_origin-459"><span class="linenos">459</span></a><span class="sd">        Point</span>
</span><span id="Point.get_origin-460"><a href="#Point.get_origin-460"><span class="linenos">460</span></a><span class="sd">            Point object with Kleinian/Poincare coords (0, 0, ...)</span>
</span><span id="Point.get_origin-461"><a href="#Point.get_origin-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Point.get_origin-462"><a href="#Point.get_origin-462"><span class="linenos">462</span></a>
</span><span id="Point.get_origin-463"><a href="#Point.get_origin-463"><span class="linenos">463</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">dimension</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">),</span>
</span><span id="Point.get_origin-464"><a href="#Point.get_origin-464"><span class="linenos">464</span></a>                     <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a point (or ndarray of points) at the "origin" of hyperbolic
   space</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dimension</strong> (int):
Dimension of hyperbolic space where this point lives</li>
<li><strong>shape</strong> (tuple(int)):
Shape of array of origin points to get</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Point object with Kleinian/Poincare coords (0, 0, ...)</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Point.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Point.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="Point.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Point.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Point.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Point.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Point.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Point.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Point.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Point.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Point.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Point.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Point.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Point.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Point.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="DualPoint">
                            <input id="DualPoint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DualPoint</span><wbr>(<span class="base"><a href="#Point">Point</a></span>):

                <label class="view-source-button" for="DualPoint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DualPoint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DualPoint-466"><a href="#DualPoint-466"><span class="linenos">466</span></a><span class="k">class</span> <span class="nc">DualPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="DualPoint-467"><a href="#DualPoint-467"><span class="linenos">467</span></a>    <span class="sd">&quot;&quot;&quot;Model for a &quot;dual point&quot; in hyperbolic space (a point in the</span>
</span><span id="DualPoint-468"><a href="#DualPoint-468"><span class="linenos">468</span></a><span class="sd">    complement of the projectivization of the Minkowski light cone,</span>
</span><span id="DualPoint-469"><a href="#DualPoint-469"><span class="linenos">469</span></a><span class="sd">    corresponding to a geodesic hyperplane in hyperbolic space).</span>
</span><span id="DualPoint-470"><a href="#DualPoint-470"><span class="linenos">470</span></a>
</span><span id="DualPoint-471"><a href="#DualPoint-471"><span class="linenos">471</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DualPoint-472"><a href="#DualPoint-472"><span class="linenos">472</span></a>
</span><span id="DualPoint-473"><a href="#DualPoint-473"><span class="linenos">473</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="DualPoint-474"><a href="#DualPoint-474"><span class="linenos">474</span></a>        <span class="n">Point</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="DualPoint-475"><a href="#DualPoint-475"><span class="linenos">475</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="DualPoint-476"><a href="#DualPoint-476"><span class="linenos">476</span></a>            <span class="k">return</span>
</span><span id="DualPoint-477"><a href="#DualPoint-477"><span class="linenos">477</span></a>
</span><span id="DualPoint-478"><a href="#DualPoint-478"><span class="linenos">478</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">spacelike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="DualPoint-479"><a href="#DualPoint-479"><span class="linenos">479</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Dual point data must consist of vectors&quot;</span>
</span><span id="DualPoint-480"><a href="#DualPoint-480"><span class="linenos">480</span></a>                                <span class="s2">&quot; in the complement of the Minkowski light cone&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a "dual point" in hyperbolic space (a point in the
complement of the projectivization of the Minkowski light cone,
corresponding to a geodesic hyperplane in hyperbolic space).</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="DualPoint.__init__" class="function"><a href="#Point.__init__">Point</a></dd>
                <dd id="DualPoint.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="DualPoint.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="DualPoint.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="DualPoint.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="DualPoint.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="DualPoint.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="DualPoint.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="DualPoint.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="DualPoint.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="DualPoint.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="DualPoint.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="DualPoint.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="DualPoint.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="DualPoint.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="DualPoint.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="DualPoint.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="DualPoint.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="DualPoint.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="DualPoint.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="DualPoint.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="DualPoint.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="DualPoint.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="DualPoint.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="DualPoint.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="DualPoint.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="DualPoint.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="IdealPoint">
                            <input id="IdealPoint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">IdealPoint</span><wbr>(<span class="base"><a href="#Point">Point</a></span>):

                <label class="view-source-button" for="IdealPoint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IdealPoint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IdealPoint-482"><a href="#IdealPoint-482"><span class="linenos">482</span></a><span class="k">class</span> <span class="nc">IdealPoint</span><span class="p">(</span><span class="n">Point</span><span class="p">):</span>
</span><span id="IdealPoint-483"><a href="#IdealPoint-483"><span class="linenos">483</span></a>    <span class="sd">&quot;&quot;&quot;Model for an ideal point in hyperbolic space (lying on the boundary</span>
</span><span id="IdealPoint-484"><a href="#IdealPoint-484"><span class="linenos">484</span></a><span class="sd">    of the projectivization of the Minkowski light cone)</span>
</span><span id="IdealPoint-485"><a href="#IdealPoint-485"><span class="linenos">485</span></a>
</span><span id="IdealPoint-486"><a href="#IdealPoint-486"><span class="linenos">486</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="IdealPoint-487"><a href="#IdealPoint-487"><span class="linenos">487</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="IdealPoint-488"><a href="#IdealPoint-488"><span class="linenos">488</span></a>        <span class="n">Point</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="IdealPoint-489"><a href="#IdealPoint-489"><span class="linenos">489</span></a>
</span><span id="IdealPoint-490"><a href="#IdealPoint-490"><span class="linenos">490</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="IdealPoint-491"><a href="#IdealPoint-491"><span class="linenos">491</span></a>            <span class="k">return</span>
</span><span id="IdealPoint-492"><a href="#IdealPoint-492"><span class="linenos">492</span></a>
</span><span id="IdealPoint-493"><a href="#IdealPoint-493"><span class="linenos">493</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lightlike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="IdealPoint-494"><a href="#IdealPoint-494"><span class="linenos">494</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Ideal point data must consist of vectors&quot;</span>
</span><span id="IdealPoint-495"><a href="#IdealPoint-495"><span class="linenos">495</span></a>                                <span class="s2">&quot;in the boundary of the Minkowski light cone&quot;</span><span class="p">)</span>
</span><span id="IdealPoint-496"><a href="#IdealPoint-496"><span class="linenos">496</span></a>
</span><span id="IdealPoint-497"><a href="#IdealPoint-497"><span class="linenos">497</span></a>    <span class="nd">@staticmethod</span>
</span><span id="IdealPoint-498"><a href="#IdealPoint-498"><span class="linenos">498</span></a>    <span class="k">def</span> <span class="nf">from_angle</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IdealPoint-499"><a href="#IdealPoint-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="IdealPoint-500"><a href="#IdealPoint-500"><span class="linenos">500</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="IdealPoint-501"><a href="#IdealPoint-501"><span class="linenos">501</span></a>                <span class="s2">&quot;Cannot use an angle to specify a point on the boundary of&quot;</span>
</span><span id="IdealPoint-502"><a href="#IdealPoint-502"><span class="linenos">502</span></a>                <span class="s2">&quot; hyperbolic 1-space&quot;</span>
</span><span id="IdealPoint-503"><a href="#IdealPoint-503"><span class="linenos">503</span></a>            <span class="p">)</span>
</span><span id="IdealPoint-504"><a href="#IdealPoint-504"><span class="linenos">504</span></a>
</span><span id="IdealPoint-505"><a href="#IdealPoint-505"><span class="linenos">505</span></a>
</span><span id="IdealPoint-506"><a href="#IdealPoint-506"><span class="linenos">506</span></a>        <span class="c1"># INTENDED BEHAVIOR: if this function is passed a Sage</span>
</span><span id="IdealPoint-507"><a href="#IdealPoint-507"><span class="linenos">507</span></a>        <span class="c1"># integer, and no base_ring or dtype information is provided,</span>
</span><span id="IdealPoint-508"><a href="#IdealPoint-508"><span class="linenos">508</span></a>        <span class="c1"># the returned result should have dtype(&#39;float64&#39;).</span>
</span><span id="IdealPoint-509"><a href="#IdealPoint-509"><span class="linenos">509</span></a>        <span class="n">like</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="IdealPoint-510"><a href="#IdealPoint-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="IdealPoint-511"><a href="#IdealPoint-511"><span class="linenos">511</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="IdealPoint-512"><a href="#IdealPoint-512"><span class="linenos">512</span></a>
</span><span id="IdealPoint-513"><a href="#IdealPoint-513"><span class="linenos">513</span></a>        <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="IdealPoint-514"><a href="#IdealPoint-514"><span class="linenos">514</span></a>
</span><span id="IdealPoint-515"><a href="#IdealPoint-515"><span class="linenos">515</span></a>
</span><span id="IdealPoint-516"><a href="#IdealPoint-516"><span class="linenos">516</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span>
</span><span id="IdealPoint-517"><a href="#IdealPoint-517"><span class="linenos">517</span></a>                             <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="IdealPoint-518"><a href="#IdealPoint-518"><span class="linenos">518</span></a>
</span><span id="IdealPoint-519"><a href="#IdealPoint-519"><span class="linenos">519</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="IdealPoint-520"><a href="#IdealPoint-520"><span class="linenos">520</span></a>
</span><span id="IdealPoint-521"><a href="#IdealPoint-521"><span class="linenos">521</span></a>        <span class="c1"># TODO: replace this with a utils function that accepts dtype</span>
</span><span id="IdealPoint-522"><a href="#IdealPoint-522"><span class="linenos">522</span></a>        <span class="c1"># and base_ring data, so that cos and sin have a sage type if</span>
</span><span id="IdealPoint-523"><a href="#IdealPoint-523"><span class="linenos">523</span></a>        <span class="c1"># theta does also.</span>
</span><span id="IdealPoint-524"><a href="#IdealPoint-524"><span class="linenos">524</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="IdealPoint-525"><a href="#IdealPoint-525"><span class="linenos">525</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="IdealPoint-526"><a href="#IdealPoint-526"><span class="linenos">526</span></a>
</span><span id="IdealPoint-527"><a href="#IdealPoint-527"><span class="linenos">527</span></a>        <span class="n">pt</span> <span class="o">=</span> <span class="n">IdealPoint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="IdealPoint-528"><a href="#IdealPoint-528"><span class="linenos">528</span></a>
</span><span id="IdealPoint-529"><a href="#IdealPoint-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="IdealPoint-530"><a href="#IdealPoint-530"><span class="linenos">530</span></a>            <span class="n">pt</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="IdealPoint-531"><a href="#IdealPoint-531"><span class="linenos">531</span></a>
</span><span id="IdealPoint-532"><a href="#IdealPoint-532"><span class="linenos">532</span></a>        <span class="k">return</span> <span class="n">pt</span>
</span></pre></div>


            <div class="docstring"><p>Model for an ideal point in hyperbolic space (lying on the boundary
of the projectivization of the Minkowski light cone)</p>
</div>


                            <div id="IdealPoint.from_angle" class="classattr">
                                        <input id="IdealPoint.from_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">theta</span>, </span><span class="param"><span class="n">dimension</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dtype</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="IdealPoint.from_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#IdealPoint.from_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="IdealPoint.from_angle-497"><a href="#IdealPoint.from_angle-497"><span class="linenos">497</span></a>    <span class="nd">@staticmethod</span>
</span><span id="IdealPoint.from_angle-498"><a href="#IdealPoint.from_angle-498"><span class="linenos">498</span></a>    <span class="k">def</span> <span class="nf">from_angle</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="IdealPoint.from_angle-499"><a href="#IdealPoint.from_angle-499"><span class="linenos">499</span></a>        <span class="k">if</span> <span class="n">dimension</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="IdealPoint.from_angle-500"><a href="#IdealPoint.from_angle-500"><span class="linenos">500</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="IdealPoint.from_angle-501"><a href="#IdealPoint.from_angle-501"><span class="linenos">501</span></a>                <span class="s2">&quot;Cannot use an angle to specify a point on the boundary of&quot;</span>
</span><span id="IdealPoint.from_angle-502"><a href="#IdealPoint.from_angle-502"><span class="linenos">502</span></a>                <span class="s2">&quot; hyperbolic 1-space&quot;</span>
</span><span id="IdealPoint.from_angle-503"><a href="#IdealPoint.from_angle-503"><span class="linenos">503</span></a>            <span class="p">)</span>
</span><span id="IdealPoint.from_angle-504"><a href="#IdealPoint.from_angle-504"><span class="linenos">504</span></a>
</span><span id="IdealPoint.from_angle-505"><a href="#IdealPoint.from_angle-505"><span class="linenos">505</span></a>
</span><span id="IdealPoint.from_angle-506"><a href="#IdealPoint.from_angle-506"><span class="linenos">506</span></a>        <span class="c1"># INTENDED BEHAVIOR: if this function is passed a Sage</span>
</span><span id="IdealPoint.from_angle-507"><a href="#IdealPoint.from_angle-507"><span class="linenos">507</span></a>        <span class="c1"># integer, and no base_ring or dtype information is provided,</span>
</span><span id="IdealPoint.from_angle-508"><a href="#IdealPoint.from_angle-508"><span class="linenos">508</span></a>        <span class="c1"># the returned result should have dtype(&#39;float64&#39;).</span>
</span><span id="IdealPoint.from_angle-509"><a href="#IdealPoint.from_angle-509"><span class="linenos">509</span></a>        <span class="n">like</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-510"><a href="#IdealPoint.from_angle-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="n">dtype</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="IdealPoint.from_angle-511"><a href="#IdealPoint.from_angle-511"><span class="linenos">511</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="IdealPoint.from_angle-512"><a href="#IdealPoint.from_angle-512"><span class="linenos">512</span></a>
</span><span id="IdealPoint.from_angle-513"><a href="#IdealPoint.from_angle-513"><span class="linenos">513</span></a>        <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-514"><a href="#IdealPoint.from_angle-514"><span class="linenos">514</span></a>
</span><span id="IdealPoint.from_angle-515"><a href="#IdealPoint.from_angle-515"><span class="linenos">515</span></a>
</span><span id="IdealPoint.from_angle-516"><a href="#IdealPoint.from_angle-516"><span class="linenos">516</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="o">+</span> <span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span>
</span><span id="IdealPoint.from_angle-517"><a href="#IdealPoint.from_angle-517"><span class="linenos">517</span></a>                             <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-518"><a href="#IdealPoint.from_angle-518"><span class="linenos">518</span></a>
</span><span id="IdealPoint.from_angle-519"><a href="#IdealPoint.from_angle-519"><span class="linenos">519</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="IdealPoint.from_angle-520"><a href="#IdealPoint.from_angle-520"><span class="linenos">520</span></a>
</span><span id="IdealPoint.from_angle-521"><a href="#IdealPoint.from_angle-521"><span class="linenos">521</span></a>        <span class="c1"># TODO: replace this with a utils function that accepts dtype</span>
</span><span id="IdealPoint.from_angle-522"><a href="#IdealPoint.from_angle-522"><span class="linenos">522</span></a>        <span class="c1"># and base_ring data, so that cos and sin have a sage type if</span>
</span><span id="IdealPoint.from_angle-523"><a href="#IdealPoint.from_angle-523"><span class="linenos">523</span></a>        <span class="c1"># theta does also.</span>
</span><span id="IdealPoint.from_angle-524"><a href="#IdealPoint.from_angle-524"><span class="linenos">524</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-525"><a href="#IdealPoint.from_angle-525"><span class="linenos">525</span></a>        <span class="n">result</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-526"><a href="#IdealPoint.from_angle-526"><span class="linenos">526</span></a>
</span><span id="IdealPoint.from_angle-527"><a href="#IdealPoint.from_angle-527"><span class="linenos">527</span></a>        <span class="n">pt</span> <span class="o">=</span> <span class="n">IdealPoint</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-528"><a href="#IdealPoint.from_angle-528"><span class="linenos">528</span></a>
</span><span id="IdealPoint.from_angle-529"><a href="#IdealPoint.from_angle-529"><span class="linenos">529</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="IdealPoint.from_angle-530"><a href="#IdealPoint.from_angle-530"><span class="linenos">530</span></a>            <span class="n">pt</span> <span class="o">=</span> <span class="n">pt</span><span class="o">.</span><span class="n">change_base_ring</span><span class="p">(</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="IdealPoint.from_angle-531"><a href="#IdealPoint.from_angle-531"><span class="linenos">531</span></a>
</span><span id="IdealPoint.from_angle-532"><a href="#IdealPoint.from_angle-532"><span class="linenos">532</span></a>        <span class="k">return</span> <span class="n">pt</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="IdealPoint.__init__" class="function"><a href="#Point.__init__">Point</a></dd>
                <dd id="IdealPoint.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="IdealPoint.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="IdealPoint.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="IdealPoint.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="IdealPoint.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="IdealPoint.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="IdealPoint.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="IdealPoint.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="IdealPoint.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="IdealPoint.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="IdealPoint.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="IdealPoint.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="IdealPoint.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="IdealPoint.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="IdealPoint.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="IdealPoint.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="IdealPoint.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="IdealPoint.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="IdealPoint.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="IdealPoint.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="IdealPoint.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="IdealPoint.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="IdealPoint.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="IdealPoint.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="IdealPoint.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="IdealPoint.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Subspace">
                            <input id="Subspace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Subspace</span><wbr>(<span class="base"><a href="#IdealPoint">IdealPoint</a></span>):

                <label class="view-source-button" for="Subspace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace-534"><a href="#Subspace-534"><span class="linenos">534</span></a><span class="k">class</span> <span class="nc">Subspace</span><span class="p">(</span><span class="n">IdealPoint</span><span class="p">):</span>
</span><span id="Subspace-535"><a href="#Subspace-535"><span class="linenos">535</span></a>    <span class="sd">&quot;&quot;&quot;Model for a geodesic subspace of hyperbolic space.</span>
</span><span id="Subspace-536"><a href="#Subspace-536"><span class="linenos">536</span></a>
</span><span id="Subspace-537"><a href="#Subspace-537"><span class="linenos">537</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Subspace-538"><a href="#Subspace-538"><span class="linenos">538</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Subspace-539"><a href="#Subspace-539"><span class="linenos">539</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Subspace-540"><a href="#Subspace-540"><span class="linenos">540</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace-541"><a href="#Subspace-541"><span class="linenos">541</span></a><span class="sd">        ----------</span>
</span><span id="Subspace-542"><a href="#Subspace-542"><span class="linenos">542</span></a><span class="sd">        proj_data : HyperbolicObject or ndarray</span>
</span><span id="Subspace-543"><a href="#Subspace-543"><span class="linenos">543</span></a><span class="sd">            Data used to construct a subspace (or array of</span>
</span><span id="Subspace-544"><a href="#Subspace-544"><span class="linenos">544</span></a><span class="sd">            subspaces). If `proj_data` is a `HyperbolicObject`, then</span>
</span><span id="Subspace-545"><a href="#Subspace-545"><span class="linenos">545</span></a><span class="sd">            use underlying coordinate data to build an array of</span>
</span><span id="Subspace-546"><a href="#Subspace-546"><span class="linenos">546</span></a><span class="sd">            subspaces. If `proj_data` is an `ndarray`, then interpret</span>
</span><span id="Subspace-547"><a href="#Subspace-547"><span class="linenos">547</span></a><span class="sd">            this as coordinate data for an array of subspaces in the</span>
</span><span id="Subspace-548"><a href="#Subspace-548"><span class="linenos">548</span></a><span class="sd">            projective model.</span>
</span><span id="Subspace-549"><a href="#Subspace-549"><span class="linenos">549</span></a>
</span><span id="Subspace-550"><a href="#Subspace-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-551"><a href="#Subspace-551"><span class="linenos">551</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Subspace-552"><a href="#Subspace-552"><span class="linenos">552</span></a>
</span><span id="Subspace-553"><a href="#Subspace-553"><span class="linenos">553</span></a>    <span class="nd">@property</span>
</span><span id="Subspace-554"><a href="#Subspace-554"><span class="linenos">554</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace-555"><a href="#Subspace-555"><span class="linenos">555</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Subspace-556"><a href="#Subspace-556"><span class="linenos">556</span></a>
</span><span id="Subspace-557"><a href="#Subspace-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="nf">ideal_basis_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="Subspace-558"><a href="#Subspace-558"><span class="linenos">558</span></a>        <span class="sd">&quot;&quot;&quot;Get coordinates for a basis of this subspace lying in the ideal</span>
</span><span id="Subspace-559"><a href="#Subspace-559"><span class="linenos">559</span></a><span class="sd">           boundary of hyperbolic space</span>
</span><span id="Subspace-560"><a href="#Subspace-560"><span class="linenos">560</span></a>
</span><span id="Subspace-561"><a href="#Subspace-561"><span class="linenos">561</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace-562"><a href="#Subspace-562"><span class="linenos">562</span></a><span class="sd">        ----------</span>
</span><span id="Subspace-563"><a href="#Subspace-563"><span class="linenos">563</span></a><span class="sd">        model : Model</span>
</span><span id="Subspace-564"><a href="#Subspace-564"><span class="linenos">564</span></a><span class="sd">            Model of hyperbolic space in which to compute coordinates</span>
</span><span id="Subspace-565"><a href="#Subspace-565"><span class="linenos">565</span></a>
</span><span id="Subspace-566"><a href="#Subspace-566"><span class="linenos">566</span></a><span class="sd">        Returns</span>
</span><span id="Subspace-567"><a href="#Subspace-567"><span class="linenos">567</span></a><span class="sd">        -------</span>
</span><span id="Subspace-568"><a href="#Subspace-568"><span class="linenos">568</span></a><span class="sd">        ndarray</span>
</span><span id="Subspace-569"><a href="#Subspace-569"><span class="linenos">569</span></a><span class="sd">            Coordinates for k vectors in the ideal boundary of</span>
</span><span id="Subspace-570"><a href="#Subspace-570"><span class="linenos">570</span></a><span class="sd">            hyperbolic space, giving a basis for this subspace.</span>
</span><span id="Subspace-571"><a href="#Subspace-571"><span class="linenos">571</span></a>
</span><span id="Subspace-572"><a href="#Subspace-572"><span class="linenos">572</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-573"><a href="#Subspace-573"><span class="linenos">573</span></a>        <span class="c1">#we don&#39;t return proj_data directly, since we want subclasses</span>
</span><span id="Subspace-574"><a href="#Subspace-574"><span class="linenos">574</span></a>        <span class="c1">#to be able to use this method even if the structure of the</span>
</span><span id="Subspace-575"><a href="#Subspace-575"><span class="linenos">575</span></a>        <span class="c1">#underlying data is different.</span>
</span><span id="Subspace-576"><a href="#Subspace-576"><span class="linenos">576</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Subspace-577"><a href="#Subspace-577"><span class="linenos">577</span></a>
</span><span id="Subspace-578"><a href="#Subspace-578"><span class="linenos">578</span></a>    <span class="k">def</span> <span class="nf">spacelike_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace-579"><a href="#Subspace-579"><span class="linenos">579</span></a>        <span class="sd">&quot;&quot;&quot;Get a spacelike point in the orthogonal complement to this subspace</span>
</span><span id="Subspace-580"><a href="#Subspace-580"><span class="linenos">580</span></a>
</span><span id="Subspace-581"><a href="#Subspace-581"><span class="linenos">581</span></a><span class="sd">        Returns</span>
</span><span id="Subspace-582"><a href="#Subspace-582"><span class="linenos">582</span></a><span class="sd">        -------</span>
</span><span id="Subspace-583"><a href="#Subspace-583"><span class="linenos">583</span></a><span class="sd">        DualPoint</span>
</span><span id="Subspace-584"><a href="#Subspace-584"><span class="linenos">584</span></a><span class="sd">            A spacelike (i.e. Minkowski-positive) point which is</span>
</span><span id="Subspace-585"><a href="#Subspace-585"><span class="linenos">585</span></a><span class="sd">            Minkowski-orthogonal to this subspace. This is not</span>
</span><span id="Subspace-586"><a href="#Subspace-586"><span class="linenos">586</span></a><span class="sd">            uniquely determined (as a point in projective space)</span>
</span><span id="Subspace-587"><a href="#Subspace-587"><span class="linenos">587</span></a><span class="sd">            unless the subspace is a hyperplane.</span>
</span><span id="Subspace-588"><a href="#Subspace-588"><span class="linenos">588</span></a>
</span><span id="Subspace-589"><a href="#Subspace-589"><span class="linenos">589</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-590"><a href="#Subspace-590"><span class="linenos">590</span></a>
</span><span id="Subspace-591"><a href="#Subspace-591"><span class="linenos">591</span></a>        <span class="n">orthed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_with_dual</span><span class="p">()</span>
</span><span id="Subspace-592"><a href="#Subspace-592"><span class="linenos">592</span></a>        <span class="k">return</span> <span class="n">DualPoint</span><span class="p">(</span><span class="n">orthed</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Subspace-593"><a href="#Subspace-593"><span class="linenos">593</span></a>
</span><span id="Subspace-594"><a href="#Subspace-594"><span class="linenos">594</span></a>    <span class="k">def</span> <span class="nf">_data_with_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace-595"><a href="#Subspace-595"><span class="linenos">595</span></a>        <span class="n">midpoints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Subspace-596"><a href="#Subspace-596"><span class="linenos">596</span></a>
</span><span id="Subspace-597"><a href="#Subspace-597"><span class="linenos">597</span></a>        <span class="n">poincare_ctr</span><span class="p">,</span> <span class="n">poincare_rad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">)</span>
</span><span id="Subspace-598"><a href="#Subspace-598"><span class="linenos">598</span></a>        <span class="n">spacelike_guess</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">poincare_ctr</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span>
</span><span id="Subspace-599"><a href="#Subspace-599"><span class="linenos">599</span></a>            <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">PROJECTIVE</span>
</span><span id="Subspace-600"><a href="#Subspace-600"><span class="linenos">600</span></a>        <span class="p">)</span>
</span><span id="Subspace-601"><a href="#Subspace-601"><span class="linenos">601</span></a>
</span><span id="Subspace-602"><a href="#Subspace-602"><span class="linenos">602</span></a>        <span class="n">to_orthogonalize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
</span><span id="Subspace-603"><a href="#Subspace-603"><span class="linenos">603</span></a>            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">midpoints</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="Subspace-604"><a href="#Subspace-604"><span class="linenos">604</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span>
</span><span id="Subspace-605"><a href="#Subspace-605"><span class="linenos">605</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">spacelike_guess</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)],</span>
</span><span id="Subspace-606"><a href="#Subspace-606"><span class="linenos">606</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace-607"><a href="#Subspace-607"><span class="linenos">607</span></a>
</span><span id="Subspace-608"><a href="#Subspace-608"><span class="linenos">608</span></a>        <span class="n">orthed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">indefinite_orthogonalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span>
</span><span id="Subspace-609"><a href="#Subspace-609"><span class="linenos">609</span></a>                                                <span class="n">to_orthogonalize</span><span class="p">)</span>
</span><span id="Subspace-610"><a href="#Subspace-610"><span class="linenos">610</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span>
</span><span id="Subspace-611"><a href="#Subspace-611"><span class="linenos">611</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">orthed</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">),</span>
</span><span id="Subspace-612"><a href="#Subspace-612"><span class="linenos">612</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Subspace-613"><a href="#Subspace-613"><span class="linenos">613</span></a>
</span><span id="Subspace-614"><a href="#Subspace-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Subspace-615"><a href="#Subspace-615"><span class="linenos">615</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a k-sphere corresponding to this subspace</span>
</span><span id="Subspace-616"><a href="#Subspace-616"><span class="linenos">616</span></a><span class="sd">        in the Poincare model.</span>
</span><span id="Subspace-617"><a href="#Subspace-617"><span class="linenos">617</span></a>
</span><span id="Subspace-618"><a href="#Subspace-618"><span class="linenos">618</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace-619"><a href="#Subspace-619"><span class="linenos">619</span></a><span class="sd">        ----------</span>
</span><span id="Subspace-620"><a href="#Subspace-620"><span class="linenos">620</span></a><span class="sd">        model : Model</span>
</span><span id="Subspace-621"><a href="#Subspace-621"><span class="linenos">621</span></a><span class="sd">            hyperbolic model to use. Acceptable values are</span>
</span><span id="Subspace-622"><a href="#Subspace-622"><span class="linenos">622</span></a><span class="sd">            `Model.POINCARE` and `Model.HALFSPACE`</span>
</span><span id="Subspace-623"><a href="#Subspace-623"><span class="linenos">623</span></a>
</span><span id="Subspace-624"><a href="#Subspace-624"><span class="linenos">624</span></a><span class="sd">        Returns</span>
</span><span id="Subspace-625"><a href="#Subspace-625"><span class="linenos">625</span></a><span class="sd">        -------</span>
</span><span id="Subspace-626"><a href="#Subspace-626"><span class="linenos">626</span></a><span class="sd">        tuple</span>
</span><span id="Subspace-627"><a href="#Subspace-627"><span class="linenos">627</span></a><span class="sd">            Tuple of the form `(centers, radii)`, where `centers` and</span>
</span><span id="Subspace-628"><a href="#Subspace-628"><span class="linenos">628</span></a><span class="sd">            `radii` are `ndarray`s respectively holding the centers</span>
</span><span id="Subspace-629"><a href="#Subspace-629"><span class="linenos">629</span></a><span class="sd">            and radii of spheres corresponding to this subspace in the</span>
</span><span id="Subspace-630"><a href="#Subspace-630"><span class="linenos">630</span></a><span class="sd">            given hyperbolic model.</span>
</span><span id="Subspace-631"><a href="#Subspace-631"><span class="linenos">631</span></a>
</span><span id="Subspace-632"><a href="#Subspace-632"><span class="linenos">632</span></a><span class="sd">        Raises</span>
</span><span id="Subspace-633"><a href="#Subspace-633"><span class="linenos">633</span></a><span class="sd">        ------</span>
</span><span id="Subspace-634"><a href="#Subspace-634"><span class="linenos">634</span></a><span class="sd">        GeometryError</span>
</span><span id="Subspace-635"><a href="#Subspace-635"><span class="linenos">635</span></a>
</span><span id="Subspace-636"><a href="#Subspace-636"><span class="linenos">636</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-637"><a href="#Subspace-637"><span class="linenos">637</span></a>
</span><span id="Subspace-638"><a href="#Subspace-638"><span class="linenos">638</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Subspace-639"><a href="#Subspace-639"><span class="linenos">639</span></a>            <span class="n">klein_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Subspace-640"><a href="#Subspace-640"><span class="linenos">640</span></a>            <span class="n">klein_midpoint</span> <span class="o">=</span> <span class="n">klein_basis</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">klein_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Subspace-641"><a href="#Subspace-641"><span class="linenos">641</span></a>            <span class="n">poincare_midpoint</span> <span class="o">=</span> <span class="n">kleinian_to_poincare</span><span class="p">(</span><span class="n">klein_midpoint</span><span class="p">)</span>
</span><span id="Subspace-642"><a href="#Subspace-642"><span class="linenos">642</span></a>            <span class="n">poincare_extreme</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">sphere_inversion</span><span class="p">(</span><span class="n">poincare_midpoint</span><span class="p">)</span>
</span><span id="Subspace-643"><a href="#Subspace-643"><span class="linenos">643</span></a>
</span><span id="Subspace-644"><a href="#Subspace-644"><span class="linenos">644</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">poincare_midpoint</span> <span class="o">+</span> <span class="n">poincare_extreme</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="Subspace-645"><a href="#Subspace-645"><span class="linenos">645</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">poincare_midpoint</span> <span class="o">-</span> <span class="n">poincare_extreme</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="Subspace-646"><a href="#Subspace-646"><span class="linenos">646</span></a>
</span><span id="Subspace-647"><a href="#Subspace-647"><span class="linenos">647</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Subspace-648"><a href="#Subspace-648"><span class="linenos">648</span></a>            <span class="n">halfspace_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">)</span>
</span><span id="Subspace-649"><a href="#Subspace-649"><span class="linenos">649</span></a>            <span class="n">halfspace_midpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">halfspace_basis</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
</span><span id="Subspace-650"><a href="#Subspace-650"><span class="linenos">650</span></a>                                  <span class="n">halfspace_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Subspace-651"><a href="#Subspace-651"><span class="linenos">651</span></a>
</span><span id="Subspace-652"><a href="#Subspace-652"><span class="linenos">652</span></a>            <span class="c1">#just use the first element of the basis</span>
</span><span id="Subspace-653"><a href="#Subspace-653"><span class="linenos">653</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">halfspace_midpoint</span>
</span><span id="Subspace-654"><a href="#Subspace-654"><span class="linenos">654</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="Subspace-655"><a href="#Subspace-655"><span class="linenos">655</span></a>                <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">halfspace_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">halfspace_midpoint</span><span class="p">)</span>
</span><span id="Subspace-656"><a href="#Subspace-656"><span class="linenos">656</span></a>            <span class="p">)</span>
</span><span id="Subspace-657"><a href="#Subspace-657"><span class="linenos">657</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Subspace-658"><a href="#Subspace-658"><span class="linenos">658</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Subspace-659"><a href="#Subspace-659"><span class="linenos">659</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute spherical parameters for an object of type </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="Subspace-660"><a href="#Subspace-660"><span class="linenos">660</span></a>                 <span class="s2">&quot; in model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="Subspace-661"><a href="#Subspace-661"><span class="linenos">661</span></a>            <span class="p">)</span>
</span><span id="Subspace-662"><a href="#Subspace-662"><span class="linenos">662</span></a>
</span><span id="Subspace-663"><a href="#Subspace-663"><span class="linenos">663</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span>
</span><span id="Subspace-664"><a href="#Subspace-664"><span class="linenos">664</span></a>
</span><span id="Subspace-665"><a href="#Subspace-665"><span class="linenos">665</span></a>    <span class="k">def</span> <span class="nf">reflection_across</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace-666"><a href="#Subspace-666"><span class="linenos">666</span></a>        <span class="sd">&quot;&quot;&quot;Get a hyperbolic isometry reflecting across this hyperplane.</span>
</span><span id="Subspace-667"><a href="#Subspace-667"><span class="linenos">667</span></a>
</span><span id="Subspace-668"><a href="#Subspace-668"><span class="linenos">668</span></a><span class="sd">        Returns</span>
</span><span id="Subspace-669"><a href="#Subspace-669"><span class="linenos">669</span></a><span class="sd">        -------</span>
</span><span id="Subspace-670"><a href="#Subspace-670"><span class="linenos">670</span></a><span class="sd">        Isometry</span>
</span><span id="Subspace-671"><a href="#Subspace-671"><span class="linenos">671</span></a><span class="sd">            Isometry reflecting across this hyperplane.</span>
</span><span id="Subspace-672"><a href="#Subspace-672"><span class="linenos">672</span></a>
</span><span id="Subspace-673"><a href="#Subspace-673"><span class="linenos">673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace-674"><a href="#Subspace-674"><span class="linenos">674</span></a>        <span class="n">dual_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_with_dual</span><span class="p">()</span>
</span><span id="Subspace-675"><a href="#Subspace-675"><span class="linenos">675</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="Subspace-676"><a href="#Subspace-676"><span class="linenos">676</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Subspace-677"><a href="#Subspace-677"><span class="linenos">677</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute a reflection across a subspace of &quot;</span>
</span><span id="Subspace-678"><a href="#Subspace-678"><span class="linenos">678</span></a>                 <span class="s2">&quot;dimension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Subspace-679"><a href="#Subspace-679"><span class="linenos">679</span></a>            <span class="p">)</span>
</span><span id="Subspace-680"><a href="#Subspace-680"><span class="linenos">680</span></a>
</span><span id="Subspace-681"><a href="#Subspace-681"><span class="linenos">681</span></a>        <span class="n">refdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span> <span class="o">@</span>
</span><span id="Subspace-682"><a href="#Subspace-682"><span class="linenos">682</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span> <span class="o">@</span>
</span><span id="Subspace-683"><a href="#Subspace-683"><span class="linenos">683</span></a>                   <span class="n">dual_data</span><span class="p">)</span>
</span><span id="Subspace-684"><a href="#Subspace-684"><span class="linenos">684</span></a>
</span><span id="Subspace-685"><a href="#Subspace-685"><span class="linenos">685</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">refdata</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a geodesic subspace of hyperbolic space.</p>
</div>


                            <div id="Subspace.__init__" class="classattr">
                                        <input id="Subspace.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Subspace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">proj_data</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Subspace.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.__init__-538"><a href="#Subspace.__init__-538"><span class="linenos">538</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Subspace.__init__-539"><a href="#Subspace.__init__-539"><span class="linenos">539</span></a>        <span class="sd">&quot;&quot;&quot;</span>
</span><span id="Subspace.__init__-540"><a href="#Subspace.__init__-540"><span class="linenos">540</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace.__init__-541"><a href="#Subspace.__init__-541"><span class="linenos">541</span></a><span class="sd">        ----------</span>
</span><span id="Subspace.__init__-542"><a href="#Subspace.__init__-542"><span class="linenos">542</span></a><span class="sd">        proj_data : HyperbolicObject or ndarray</span>
</span><span id="Subspace.__init__-543"><a href="#Subspace.__init__-543"><span class="linenos">543</span></a><span class="sd">            Data used to construct a subspace (or array of</span>
</span><span id="Subspace.__init__-544"><a href="#Subspace.__init__-544"><span class="linenos">544</span></a><span class="sd">            subspaces). If `proj_data` is a `HyperbolicObject`, then</span>
</span><span id="Subspace.__init__-545"><a href="#Subspace.__init__-545"><span class="linenos">545</span></a><span class="sd">            use underlying coordinate data to build an array of</span>
</span><span id="Subspace.__init__-546"><a href="#Subspace.__init__-546"><span class="linenos">546</span></a><span class="sd">            subspaces. If `proj_data` is an `ndarray`, then interpret</span>
</span><span id="Subspace.__init__-547"><a href="#Subspace.__init__-547"><span class="linenos">547</span></a><span class="sd">            this as coordinate data for an array of subspaces in the</span>
</span><span id="Subspace.__init__-548"><a href="#Subspace.__init__-548"><span class="linenos">548</span></a><span class="sd">            projective model.</span>
</span><span id="Subspace.__init__-549"><a href="#Subspace.__init__-549"><span class="linenos">549</span></a>
</span><span id="Subspace.__init__-550"><a href="#Subspace.__init__-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.__init__-551"><a href="#Subspace.__init__-551"><span class="linenos">551</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (HyperbolicObject or ndarray):
Data used to construct a subspace (or array of
subspaces). If <code>proj_data</code> is a <code><a href="#HyperbolicObject">HyperbolicObject</a></code>, then
use underlying coordinate data to build an array of
subspaces. If <code>proj_data</code> is an <code>ndarray</code>, then interpret
this as coordinate data for an array of subspaces in the
projective model.</li>
</ul>
</div>


                            </div>
                            <div id="Subspace.ideal_basis" class="classattr">
                                        <input id="Subspace.ideal_basis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ideal_basis</span>

                <label class="view-source-button" for="Subspace.ideal_basis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.ideal_basis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.ideal_basis-553"><a href="#Subspace.ideal_basis-553"><span class="linenos">553</span></a>    <span class="nd">@property</span>
</span><span id="Subspace.ideal_basis-554"><a href="#Subspace.ideal_basis-554"><span class="linenos">554</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace.ideal_basis-555"><a href="#Subspace.ideal_basis-555"><span class="linenos">555</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span></pre></div>


    

                            </div>
                            <div id="Subspace.ideal_basis_coords" class="classattr">
                                        <input id="Subspace.ideal_basis_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ideal_basis_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.KLEIN">Model.KLEIN</a></span><span class="p">:</span> <span class="s1">&#39;klein&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Subspace.ideal_basis_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.ideal_basis_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.ideal_basis_coords-557"><a href="#Subspace.ideal_basis_coords-557"><span class="linenos">557</span></a>    <span class="k">def</span> <span class="nf">ideal_basis_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="Subspace.ideal_basis_coords-558"><a href="#Subspace.ideal_basis_coords-558"><span class="linenos">558</span></a>        <span class="sd">&quot;&quot;&quot;Get coordinates for a basis of this subspace lying in the ideal</span>
</span><span id="Subspace.ideal_basis_coords-559"><a href="#Subspace.ideal_basis_coords-559"><span class="linenos">559</span></a><span class="sd">           boundary of hyperbolic space</span>
</span><span id="Subspace.ideal_basis_coords-560"><a href="#Subspace.ideal_basis_coords-560"><span class="linenos">560</span></a>
</span><span id="Subspace.ideal_basis_coords-561"><a href="#Subspace.ideal_basis_coords-561"><span class="linenos">561</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace.ideal_basis_coords-562"><a href="#Subspace.ideal_basis_coords-562"><span class="linenos">562</span></a><span class="sd">        ----------</span>
</span><span id="Subspace.ideal_basis_coords-563"><a href="#Subspace.ideal_basis_coords-563"><span class="linenos">563</span></a><span class="sd">        model : Model</span>
</span><span id="Subspace.ideal_basis_coords-564"><a href="#Subspace.ideal_basis_coords-564"><span class="linenos">564</span></a><span class="sd">            Model of hyperbolic space in which to compute coordinates</span>
</span><span id="Subspace.ideal_basis_coords-565"><a href="#Subspace.ideal_basis_coords-565"><span class="linenos">565</span></a>
</span><span id="Subspace.ideal_basis_coords-566"><a href="#Subspace.ideal_basis_coords-566"><span class="linenos">566</span></a><span class="sd">        Returns</span>
</span><span id="Subspace.ideal_basis_coords-567"><a href="#Subspace.ideal_basis_coords-567"><span class="linenos">567</span></a><span class="sd">        -------</span>
</span><span id="Subspace.ideal_basis_coords-568"><a href="#Subspace.ideal_basis_coords-568"><span class="linenos">568</span></a><span class="sd">        ndarray</span>
</span><span id="Subspace.ideal_basis_coords-569"><a href="#Subspace.ideal_basis_coords-569"><span class="linenos">569</span></a><span class="sd">            Coordinates for k vectors in the ideal boundary of</span>
</span><span id="Subspace.ideal_basis_coords-570"><a href="#Subspace.ideal_basis_coords-570"><span class="linenos">570</span></a><span class="sd">            hyperbolic space, giving a basis for this subspace.</span>
</span><span id="Subspace.ideal_basis_coords-571"><a href="#Subspace.ideal_basis_coords-571"><span class="linenos">571</span></a>
</span><span id="Subspace.ideal_basis_coords-572"><a href="#Subspace.ideal_basis_coords-572"><span class="linenos">572</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.ideal_basis_coords-573"><a href="#Subspace.ideal_basis_coords-573"><span class="linenos">573</span></a>        <span class="c1">#we don&#39;t return proj_data directly, since we want subclasses</span>
</span><span id="Subspace.ideal_basis_coords-574"><a href="#Subspace.ideal_basis_coords-574"><span class="linenos">574</span></a>        <span class="c1">#to be able to use this method even if the structure of the</span>
</span><span id="Subspace.ideal_basis_coords-575"><a href="#Subspace.ideal_basis_coords-575"><span class="linenos">575</span></a>        <span class="c1">#underlying data is different.</span>
</span><span id="Subspace.ideal_basis_coords-576"><a href="#Subspace.ideal_basis_coords-576"><span class="linenos">576</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get coordinates for a basis of this subspace lying in the ideal
   boundary of hyperbolic space</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>model</strong> (Model):
Model of hyperbolic space in which to compute coordinates</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Coordinates for k vectors in the ideal boundary of
hyperbolic space, giving a basis for this subspace.</li>
</ul>
</div>


                            </div>
                            <div id="Subspace.spacelike_complement" class="classattr">
                                        <input id="Subspace.spacelike_complement-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">spacelike_complement</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Subspace.spacelike_complement-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.spacelike_complement"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.spacelike_complement-578"><a href="#Subspace.spacelike_complement-578"><span class="linenos">578</span></a>    <span class="k">def</span> <span class="nf">spacelike_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace.spacelike_complement-579"><a href="#Subspace.spacelike_complement-579"><span class="linenos">579</span></a>        <span class="sd">&quot;&quot;&quot;Get a spacelike point in the orthogonal complement to this subspace</span>
</span><span id="Subspace.spacelike_complement-580"><a href="#Subspace.spacelike_complement-580"><span class="linenos">580</span></a>
</span><span id="Subspace.spacelike_complement-581"><a href="#Subspace.spacelike_complement-581"><span class="linenos">581</span></a><span class="sd">        Returns</span>
</span><span id="Subspace.spacelike_complement-582"><a href="#Subspace.spacelike_complement-582"><span class="linenos">582</span></a><span class="sd">        -------</span>
</span><span id="Subspace.spacelike_complement-583"><a href="#Subspace.spacelike_complement-583"><span class="linenos">583</span></a><span class="sd">        DualPoint</span>
</span><span id="Subspace.spacelike_complement-584"><a href="#Subspace.spacelike_complement-584"><span class="linenos">584</span></a><span class="sd">            A spacelike (i.e. Minkowski-positive) point which is</span>
</span><span id="Subspace.spacelike_complement-585"><a href="#Subspace.spacelike_complement-585"><span class="linenos">585</span></a><span class="sd">            Minkowski-orthogonal to this subspace. This is not</span>
</span><span id="Subspace.spacelike_complement-586"><a href="#Subspace.spacelike_complement-586"><span class="linenos">586</span></a><span class="sd">            uniquely determined (as a point in projective space)</span>
</span><span id="Subspace.spacelike_complement-587"><a href="#Subspace.spacelike_complement-587"><span class="linenos">587</span></a><span class="sd">            unless the subspace is a hyperplane.</span>
</span><span id="Subspace.spacelike_complement-588"><a href="#Subspace.spacelike_complement-588"><span class="linenos">588</span></a>
</span><span id="Subspace.spacelike_complement-589"><a href="#Subspace.spacelike_complement-589"><span class="linenos">589</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.spacelike_complement-590"><a href="#Subspace.spacelike_complement-590"><span class="linenos">590</span></a>
</span><span id="Subspace.spacelike_complement-591"><a href="#Subspace.spacelike_complement-591"><span class="linenos">591</span></a>        <span class="n">orthed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_with_dual</span><span class="p">()</span>
</span><span id="Subspace.spacelike_complement-592"><a href="#Subspace.spacelike_complement-592"><span class="linenos">592</span></a>        <span class="k">return</span> <span class="n">DualPoint</span><span class="p">(</span><span class="n">orthed</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Get a spacelike point in the orthogonal complement to this subspace</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>DualPoint</strong>: A spacelike (i.e. Minkowski-positive) point which is
Minkowski-orthogonal to this subspace. This is not
uniquely determined (as a point in projective space)
unless the subspace is a hyperplane.</li>
</ul>
</div>


                            </div>
                            <div id="Subspace.sphere_parameters" class="classattr">
                                        <input id="Subspace.sphere_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sphere_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Subspace.sphere_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.sphere_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.sphere_parameters-614"><a href="#Subspace.sphere_parameters-614"><span class="linenos">614</span></a>    <span class="k">def</span> <span class="nf">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Subspace.sphere_parameters-615"><a href="#Subspace.sphere_parameters-615"><span class="linenos">615</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a k-sphere corresponding to this subspace</span>
</span><span id="Subspace.sphere_parameters-616"><a href="#Subspace.sphere_parameters-616"><span class="linenos">616</span></a><span class="sd">        in the Poincare model.</span>
</span><span id="Subspace.sphere_parameters-617"><a href="#Subspace.sphere_parameters-617"><span class="linenos">617</span></a>
</span><span id="Subspace.sphere_parameters-618"><a href="#Subspace.sphere_parameters-618"><span class="linenos">618</span></a><span class="sd">        Parameters</span>
</span><span id="Subspace.sphere_parameters-619"><a href="#Subspace.sphere_parameters-619"><span class="linenos">619</span></a><span class="sd">        ----------</span>
</span><span id="Subspace.sphere_parameters-620"><a href="#Subspace.sphere_parameters-620"><span class="linenos">620</span></a><span class="sd">        model : Model</span>
</span><span id="Subspace.sphere_parameters-621"><a href="#Subspace.sphere_parameters-621"><span class="linenos">621</span></a><span class="sd">            hyperbolic model to use. Acceptable values are</span>
</span><span id="Subspace.sphere_parameters-622"><a href="#Subspace.sphere_parameters-622"><span class="linenos">622</span></a><span class="sd">            `Model.POINCARE` and `Model.HALFSPACE`</span>
</span><span id="Subspace.sphere_parameters-623"><a href="#Subspace.sphere_parameters-623"><span class="linenos">623</span></a>
</span><span id="Subspace.sphere_parameters-624"><a href="#Subspace.sphere_parameters-624"><span class="linenos">624</span></a><span class="sd">        Returns</span>
</span><span id="Subspace.sphere_parameters-625"><a href="#Subspace.sphere_parameters-625"><span class="linenos">625</span></a><span class="sd">        -------</span>
</span><span id="Subspace.sphere_parameters-626"><a href="#Subspace.sphere_parameters-626"><span class="linenos">626</span></a><span class="sd">        tuple</span>
</span><span id="Subspace.sphere_parameters-627"><a href="#Subspace.sphere_parameters-627"><span class="linenos">627</span></a><span class="sd">            Tuple of the form `(centers, radii)`, where `centers` and</span>
</span><span id="Subspace.sphere_parameters-628"><a href="#Subspace.sphere_parameters-628"><span class="linenos">628</span></a><span class="sd">            `radii` are `ndarray`s respectively holding the centers</span>
</span><span id="Subspace.sphere_parameters-629"><a href="#Subspace.sphere_parameters-629"><span class="linenos">629</span></a><span class="sd">            and radii of spheres corresponding to this subspace in the</span>
</span><span id="Subspace.sphere_parameters-630"><a href="#Subspace.sphere_parameters-630"><span class="linenos">630</span></a><span class="sd">            given hyperbolic model.</span>
</span><span id="Subspace.sphere_parameters-631"><a href="#Subspace.sphere_parameters-631"><span class="linenos">631</span></a>
</span><span id="Subspace.sphere_parameters-632"><a href="#Subspace.sphere_parameters-632"><span class="linenos">632</span></a><span class="sd">        Raises</span>
</span><span id="Subspace.sphere_parameters-633"><a href="#Subspace.sphere_parameters-633"><span class="linenos">633</span></a><span class="sd">        ------</span>
</span><span id="Subspace.sphere_parameters-634"><a href="#Subspace.sphere_parameters-634"><span class="linenos">634</span></a><span class="sd">        GeometryError</span>
</span><span id="Subspace.sphere_parameters-635"><a href="#Subspace.sphere_parameters-635"><span class="linenos">635</span></a>
</span><span id="Subspace.sphere_parameters-636"><a href="#Subspace.sphere_parameters-636"><span class="linenos">636</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.sphere_parameters-637"><a href="#Subspace.sphere_parameters-637"><span class="linenos">637</span></a>
</span><span id="Subspace.sphere_parameters-638"><a href="#Subspace.sphere_parameters-638"><span class="linenos">638</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Subspace.sphere_parameters-639"><a href="#Subspace.sphere_parameters-639"><span class="linenos">639</span></a>            <span class="n">klein_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Subspace.sphere_parameters-640"><a href="#Subspace.sphere_parameters-640"><span class="linenos">640</span></a>            <span class="n">klein_midpoint</span> <span class="o">=</span> <span class="n">klein_basis</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">klein_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
</span><span id="Subspace.sphere_parameters-641"><a href="#Subspace.sphere_parameters-641"><span class="linenos">641</span></a>            <span class="n">poincare_midpoint</span> <span class="o">=</span> <span class="n">kleinian_to_poincare</span><span class="p">(</span><span class="n">klein_midpoint</span><span class="p">)</span>
</span><span id="Subspace.sphere_parameters-642"><a href="#Subspace.sphere_parameters-642"><span class="linenos">642</span></a>            <span class="n">poincare_extreme</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">sphere_inversion</span><span class="p">(</span><span class="n">poincare_midpoint</span><span class="p">)</span>
</span><span id="Subspace.sphere_parameters-643"><a href="#Subspace.sphere_parameters-643"><span class="linenos">643</span></a>
</span><span id="Subspace.sphere_parameters-644"><a href="#Subspace.sphere_parameters-644"><span class="linenos">644</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="p">(</span><span class="n">poincare_midpoint</span> <span class="o">+</span> <span class="n">poincare_extreme</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="Subspace.sphere_parameters-645"><a href="#Subspace.sphere_parameters-645"><span class="linenos">645</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">poincare_midpoint</span> <span class="o">-</span> <span class="n">poincare_extreme</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="Subspace.sphere_parameters-646"><a href="#Subspace.sphere_parameters-646"><span class="linenos">646</span></a>
</span><span id="Subspace.sphere_parameters-647"><a href="#Subspace.sphere_parameters-647"><span class="linenos">647</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Subspace.sphere_parameters-648"><a href="#Subspace.sphere_parameters-648"><span class="linenos">648</span></a>            <span class="n">halfspace_basis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">)</span>
</span><span id="Subspace.sphere_parameters-649"><a href="#Subspace.sphere_parameters-649"><span class="linenos">649</span></a>            <span class="n">halfspace_midpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">halfspace_basis</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
</span><span id="Subspace.sphere_parameters-650"><a href="#Subspace.sphere_parameters-650"><span class="linenos">650</span></a>                                  <span class="n">halfspace_basis</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Subspace.sphere_parameters-651"><a href="#Subspace.sphere_parameters-651"><span class="linenos">651</span></a>
</span><span id="Subspace.sphere_parameters-652"><a href="#Subspace.sphere_parameters-652"><span class="linenos">652</span></a>            <span class="c1">#just use the first element of the basis</span>
</span><span id="Subspace.sphere_parameters-653"><a href="#Subspace.sphere_parameters-653"><span class="linenos">653</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">halfspace_midpoint</span>
</span><span id="Subspace.sphere_parameters-654"><a href="#Subspace.sphere_parameters-654"><span class="linenos">654</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
</span><span id="Subspace.sphere_parameters-655"><a href="#Subspace.sphere_parameters-655"><span class="linenos">655</span></a>                <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">halfspace_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">halfspace_midpoint</span><span class="p">)</span>
</span><span id="Subspace.sphere_parameters-656"><a href="#Subspace.sphere_parameters-656"><span class="linenos">656</span></a>            <span class="p">)</span>
</span><span id="Subspace.sphere_parameters-657"><a href="#Subspace.sphere_parameters-657"><span class="linenos">657</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Subspace.sphere_parameters-658"><a href="#Subspace.sphere_parameters-658"><span class="linenos">658</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Subspace.sphere_parameters-659"><a href="#Subspace.sphere_parameters-659"><span class="linenos">659</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute spherical parameters for an object of type </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="Subspace.sphere_parameters-660"><a href="#Subspace.sphere_parameters-660"><span class="linenos">660</span></a>                 <span class="s2">&quot; in model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="Subspace.sphere_parameters-661"><a href="#Subspace.sphere_parameters-661"><span class="linenos">661</span></a>            <span class="p">)</span>
</span><span id="Subspace.sphere_parameters-662"><a href="#Subspace.sphere_parameters-662"><span class="linenos">662</span></a>
</span><span id="Subspace.sphere_parameters-663"><a href="#Subspace.sphere_parameters-663"><span class="linenos">663</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span>
</span></pre></div>


            <div class="docstring"><p>Get parameters describing a k-sphere corresponding to this subspace
in the Poincare model.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>model</strong> (Model):
hyperbolic model to use. Acceptable values are
<code><a href="#Model.POINCARE">Model.POINCARE</a></code> and <code><a href="#Model.HALFSPACE">Model.HALFSPACE</a></code></li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: Tuple of the form <code>(centers, radii)</code>, where <code>centers</code> and
<code>radii</code> are <code>ndarray</code>s respectively holding the centers
and radii of spheres corresponding to this subspace in the
given hyperbolic model.</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>GeometryError</strong></li>
</ul>
</div>


                            </div>
                            <div id="Subspace.reflection_across" class="classattr">
                                        <input id="Subspace.reflection_across-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">reflection_across</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Subspace.reflection_across-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Subspace.reflection_across"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Subspace.reflection_across-665"><a href="#Subspace.reflection_across-665"><span class="linenos">665</span></a>    <span class="k">def</span> <span class="nf">reflection_across</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Subspace.reflection_across-666"><a href="#Subspace.reflection_across-666"><span class="linenos">666</span></a>        <span class="sd">&quot;&quot;&quot;Get a hyperbolic isometry reflecting across this hyperplane.</span>
</span><span id="Subspace.reflection_across-667"><a href="#Subspace.reflection_across-667"><span class="linenos">667</span></a>
</span><span id="Subspace.reflection_across-668"><a href="#Subspace.reflection_across-668"><span class="linenos">668</span></a><span class="sd">        Returns</span>
</span><span id="Subspace.reflection_across-669"><a href="#Subspace.reflection_across-669"><span class="linenos">669</span></a><span class="sd">        -------</span>
</span><span id="Subspace.reflection_across-670"><a href="#Subspace.reflection_across-670"><span class="linenos">670</span></a><span class="sd">        Isometry</span>
</span><span id="Subspace.reflection_across-671"><a href="#Subspace.reflection_across-671"><span class="linenos">671</span></a><span class="sd">            Isometry reflecting across this hyperplane.</span>
</span><span id="Subspace.reflection_across-672"><a href="#Subspace.reflection_across-672"><span class="linenos">672</span></a>
</span><span id="Subspace.reflection_across-673"><a href="#Subspace.reflection_across-673"><span class="linenos">673</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Subspace.reflection_across-674"><a href="#Subspace.reflection_across-674"><span class="linenos">674</span></a>        <span class="n">dual_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data_with_dual</span><span class="p">()</span>
</span><span id="Subspace.reflection_across-675"><a href="#Subspace.reflection_across-675"><span class="linenos">675</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">!=</span> <span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
</span><span id="Subspace.reflection_across-676"><a href="#Subspace.reflection_across-676"><span class="linenos">676</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Subspace.reflection_across-677"><a href="#Subspace.reflection_across-677"><span class="linenos">677</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute a reflection across a subspace of &quot;</span>
</span><span id="Subspace.reflection_across-678"><a href="#Subspace.reflection_across-678"><span class="linenos">678</span></a>                 <span class="s2">&quot;dimension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dual_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="Subspace.reflection_across-679"><a href="#Subspace.reflection_across-679"><span class="linenos">679</span></a>            <span class="p">)</span>
</span><span id="Subspace.reflection_across-680"><a href="#Subspace.reflection_across-680"><span class="linenos">680</span></a>
</span><span id="Subspace.reflection_across-681"><a href="#Subspace.reflection_across-681"><span class="linenos">681</span></a>        <span class="n">refdata</span> <span class="o">=</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">dual_data</span><span class="p">)</span> <span class="o">@</span>
</span><span id="Subspace.reflection_across-682"><a href="#Subspace.reflection_across-682"><span class="linenos">682</span></a>                   <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span> <span class="o">@</span>
</span><span id="Subspace.reflection_across-683"><a href="#Subspace.reflection_across-683"><span class="linenos">683</span></a>                   <span class="n">dual_data</span><span class="p">)</span>
</span><span id="Subspace.reflection_across-684"><a href="#Subspace.reflection_across-684"><span class="linenos">684</span></a>
</span><span id="Subspace.reflection_across-685"><a href="#Subspace.reflection_across-685"><span class="linenos">685</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">refdata</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a hyperbolic isometry reflecting across this hyperplane.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Isometry</strong>: Isometry reflecting across this hyperplane.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#IdealPoint">IdealPoint</a></dt>
                                <dd id="Subspace.from_angle" class="function"><a href="#IdealPoint.from_angle">from_angle</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Subspace.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="Subspace.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="Subspace.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="Subspace.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="Subspace.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="Subspace.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="Subspace.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="Subspace.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="Subspace.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="Subspace.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="Subspace.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Subspace.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Subspace.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="Subspace.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Subspace.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Subspace.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Subspace.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Subspace.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Subspace.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Subspace.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Subspace.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Subspace.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Subspace.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Subspace.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Subspace.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Subspace.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="PointPair">
                            <input id="PointPair-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PointPair</span><wbr>(<span class="base"><a href="#Point">Point</a></span>, <span class="base"><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></span>):

                <label class="view-source-button" for="PointPair-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair-687"><a href="#PointPair-687"><span class="linenos">687</span></a><span class="k">class</span> <span class="nc">PointPair</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">projective</span><span class="o">.</span><span class="n">PointPair</span><span class="p">):</span>
</span><span id="PointPair-688"><a href="#PointPair-688"><span class="linenos">688</span></a>    <span class="sd">&quot;&quot;&quot;Abstract model for a hyperbolic object whose underlying data is</span>
</span><span id="PointPair-689"><a href="#PointPair-689"><span class="linenos">689</span></a><span class="sd">    determined by a pair of points in R^(n,1)</span>
</span><span id="PointPair-690"><a href="#PointPair-690"><span class="linenos">690</span></a>
</span><span id="PointPair-691"><a href="#PointPair-691"><span class="linenos">691</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PointPair-692"><a href="#PointPair-692"><span class="linenos">692</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointPair-693"><a href="#PointPair-693"><span class="linenos">693</span></a>        <span class="sd">&quot;&quot;&quot;If `endpoint2` is `None`, interpret `endpoint1` as either a (2</span>
</span><span id="PointPair-694"><a href="#PointPair-694"><span class="linenos">694</span></a><span class="sd">        x...x n) `ndarray` (where n is the dimension of the underlying</span>
</span><span id="PointPair-695"><a href="#PointPair-695"><span class="linenos">695</span></a><span class="sd">        vector space), or else a composite `Point` object which can be</span>
</span><span id="PointPair-696"><a href="#PointPair-696"><span class="linenos">696</span></a><span class="sd">        unpacked into two Points (which may themselves be composite).</span>
</span><span id="PointPair-697"><a href="#PointPair-697"><span class="linenos">697</span></a>
</span><span id="PointPair-698"><a href="#PointPair-698"><span class="linenos">698</span></a><span class="sd">        If `endpoint2` is given, then both `endpoint1` and `endpoint2`</span>
</span><span id="PointPair-699"><a href="#PointPair-699"><span class="linenos">699</span></a><span class="sd">        can be used to construct `Point` objects, which serve as the</span>
</span><span id="PointPair-700"><a href="#PointPair-700"><span class="linenos">700</span></a><span class="sd">        endpoints for this pair of points.</span>
</span><span id="PointPair-701"><a href="#PointPair-701"><span class="linenos">701</span></a>
</span><span id="PointPair-702"><a href="#PointPair-702"><span class="linenos">702</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair-703"><a href="#PointPair-703"><span class="linenos">703</span></a><span class="sd">        ----------</span>
</span><span id="PointPair-704"><a href="#PointPair-704"><span class="linenos">704</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="PointPair-705"><a href="#PointPair-705"><span class="linenos">705</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="PointPair-706"><a href="#PointPair-706"><span class="linenos">706</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="PointPair-707"><a href="#PointPair-707"><span class="linenos">707</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="PointPair-708"><a href="#PointPair-708"><span class="linenos">708</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="PointPair-709"><a href="#PointPair-709"><span class="linenos">709</span></a>
</span><span id="PointPair-710"><a href="#PointPair-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-711"><a href="#PointPair-711"><span class="linenos">711</span></a>
</span><span id="PointPair-712"><a href="#PointPair-712"><span class="linenos">712</span></a>        <span class="n">projective</span><span class="o">.</span><span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="PointPair-713"><a href="#PointPair-713"><span class="linenos">713</span></a>
</span><span id="PointPair-714"><a href="#PointPair-714"><span class="linenos">714</span></a>    <span class="k">def</span> <span class="nf">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="PointPair-715"><a href="#PointPair-715"><span class="linenos">715</span></a>        <span class="sd">&quot;&quot;&quot;Get coordinates for the endpoints of this point pair</span>
</span><span id="PointPair-716"><a href="#PointPair-716"><span class="linenos">716</span></a>
</span><span id="PointPair-717"><a href="#PointPair-717"><span class="linenos">717</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair-718"><a href="#PointPair-718"><span class="linenos">718</span></a><span class="sd">        ----------</span>
</span><span id="PointPair-719"><a href="#PointPair-719"><span class="linenos">719</span></a><span class="sd">        model : Model</span>
</span><span id="PointPair-720"><a href="#PointPair-720"><span class="linenos">720</span></a><span class="sd">            model to compute coordinates in</span>
</span><span id="PointPair-721"><a href="#PointPair-721"><span class="linenos">721</span></a>
</span><span id="PointPair-722"><a href="#PointPair-722"><span class="linenos">722</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-723"><a href="#PointPair-723"><span class="linenos">723</span></a><span class="sd">        -------</span>
</span><span id="PointPair-724"><a href="#PointPair-724"><span class="linenos">724</span></a><span class="sd">        ndarray</span>
</span><span id="PointPair-725"><a href="#PointPair-725"><span class="linenos">725</span></a><span class="sd">            Coordinates for the endpoints of this PointPair, as an</span>
</span><span id="PointPair-726"><a href="#PointPair-726"><span class="linenos">726</span></a><span class="sd">            ndarray with shape `(2, ... n)` (where `n` is the</span>
</span><span id="PointPair-727"><a href="#PointPair-727"><span class="linenos">727</span></a><span class="sd">            dimension of the hyperbolic space).</span>
</span><span id="PointPair-728"><a href="#PointPair-728"><span class="linenos">728</span></a>
</span><span id="PointPair-729"><a href="#PointPair-729"><span class="linenos">729</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-730"><a href="#PointPair-730"><span class="linenos">730</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="PointPair-731"><a href="#PointPair-731"><span class="linenos">731</span></a>
</span><span id="PointPair-732"><a href="#PointPair-732"><span class="linenos">732</span></a>    <span class="k">def</span> <span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair-733"><a href="#PointPair-733"><span class="linenos">733</span></a>        <span class="sd">&quot;&quot;&quot;Convert this pair of points to a composite `Point` object</span>
</span><span id="PointPair-734"><a href="#PointPair-734"><span class="linenos">734</span></a>
</span><span id="PointPair-735"><a href="#PointPair-735"><span class="linenos">735</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-736"><a href="#PointPair-736"><span class="linenos">736</span></a><span class="sd">        -------</span>
</span><span id="PointPair-737"><a href="#PointPair-737"><span class="linenos">737</span></a><span class="sd">        Point</span>
</span><span id="PointPair-738"><a href="#PointPair-738"><span class="linenos">738</span></a><span class="sd">            Composite `Point` object with the same underlying data as</span>
</span><span id="PointPair-739"><a href="#PointPair-739"><span class="linenos">739</span></a><span class="sd">            this point pair.</span>
</span><span id="PointPair-740"><a href="#PointPair-740"><span class="linenos">740</span></a>
</span><span id="PointPair-741"><a href="#PointPair-741"><span class="linenos">741</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair-742"><a href="#PointPair-742"><span class="linenos">742</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">)</span>
</span><span id="PointPair-743"><a href="#PointPair-743"><span class="linenos">743</span></a>
</span><span id="PointPair-744"><a href="#PointPair-744"><span class="linenos">744</span></a>    <span class="k">def</span> <span class="nf">get_end_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_points</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="PointPair-745"><a href="#PointPair-745"><span class="linenos">745</span></a>        <span class="sd">&quot;&quot;&quot;Get a pair of `Point` objects, one for each endpoint of this PointPair</span>
</span><span id="PointPair-746"><a href="#PointPair-746"><span class="linenos">746</span></a>
</span><span id="PointPair-747"><a href="#PointPair-747"><span class="linenos">747</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair-748"><a href="#PointPair-748"><span class="linenos">748</span></a><span class="sd">        ----------</span>
</span><span id="PointPair-749"><a href="#PointPair-749"><span class="linenos">749</span></a><span class="sd">        as_points : bool</span>
</span><span id="PointPair-750"><a href="#PointPair-750"><span class="linenos">750</span></a><span class="sd">            If `True`, return a pair of `Point` objects. Otherwise,</span>
</span><span id="PointPair-751"><a href="#PointPair-751"><span class="linenos">751</span></a><span class="sd">            return a pair of `ndarray`s with projective coordinates</span>
</span><span id="PointPair-752"><a href="#PointPair-752"><span class="linenos">752</span></a><span class="sd">            for these points.</span>
</span><span id="PointPair-753"><a href="#PointPair-753"><span class="linenos">753</span></a>
</span><span id="PointPair-754"><a href="#PointPair-754"><span class="linenos">754</span></a><span class="sd">        Returns</span>
</span><span id="PointPair-755"><a href="#PointPair-755"><span class="linenos">755</span></a><span class="sd">        -------</span>
</span><span id="PointPair-756"><a href="#PointPair-756"><span class="linenos">756</span></a><span class="sd">        tuple</span>
</span><span id="PointPair-757"><a href="#PointPair-757"><span class="linenos">757</span></a><span class="sd">            A tuple `(p1, p2)`, where `p1` and `p2` are either both</span>
</span><span id="PointPair-758"><a href="#PointPair-758"><span class="linenos">758</span></a><span class="sd">            `Point`s or both `ndarrays`, representing the endpoints of</span>
</span><span id="PointPair-759"><a href="#PointPair-759"><span class="linenos">759</span></a><span class="sd">            this pair.</span>
</span><span id="PointPair-760"><a href="#PointPair-760"><span class="linenos">760</span></a>
</span><span id="PointPair-761"><a href="#PointPair-761"><span class="linenos">761</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PointPair-762"><a href="#PointPair-762"><span class="linenos">762</span></a>        <span class="k">if</span> <span class="n">as_points</span><span class="p">:</span>
</span><span id="PointPair-763"><a href="#PointPair-763"><span class="linenos">763</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_pair</span><span class="p">(</span><span class="n">as_points</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PointPair-764"><a href="#PointPair-764"><span class="linenos">764</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
</span><span id="PointPair-765"><a href="#PointPair-765"><span class="linenos">765</span></a>
</span><span id="PointPair-766"><a href="#PointPair-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Abstract model for a hyperbolic object whose underlying data is
determined by a pair of points in R^(n,1)</p>
</div>


                            <div id="PointPair.__init__" class="classattr">
                                        <input id="PointPair.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PointPair</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">endpoint1</span>, </span><span class="param"><span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="PointPair.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.__init__-692"><a href="#PointPair.__init__-692"><span class="linenos">692</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PointPair.__init__-693"><a href="#PointPair.__init__-693"><span class="linenos">693</span></a>        <span class="sd">&quot;&quot;&quot;If `endpoint2` is `None`, interpret `endpoint1` as either a (2</span>
</span><span id="PointPair.__init__-694"><a href="#PointPair.__init__-694"><span class="linenos">694</span></a><span class="sd">        x...x n) `ndarray` (where n is the dimension of the underlying</span>
</span><span id="PointPair.__init__-695"><a href="#PointPair.__init__-695"><span class="linenos">695</span></a><span class="sd">        vector space), or else a composite `Point` object which can be</span>
</span><span id="PointPair.__init__-696"><a href="#PointPair.__init__-696"><span class="linenos">696</span></a><span class="sd">        unpacked into two Points (which may themselves be composite).</span>
</span><span id="PointPair.__init__-697"><a href="#PointPair.__init__-697"><span class="linenos">697</span></a>
</span><span id="PointPair.__init__-698"><a href="#PointPair.__init__-698"><span class="linenos">698</span></a><span class="sd">        If `endpoint2` is given, then both `endpoint1` and `endpoint2`</span>
</span><span id="PointPair.__init__-699"><a href="#PointPair.__init__-699"><span class="linenos">699</span></a><span class="sd">        can be used to construct `Point` objects, which serve as the</span>
</span><span id="PointPair.__init__-700"><a href="#PointPair.__init__-700"><span class="linenos">700</span></a><span class="sd">        endpoints for this pair of points.</span>
</span><span id="PointPair.__init__-701"><a href="#PointPair.__init__-701"><span class="linenos">701</span></a>
</span><span id="PointPair.__init__-702"><a href="#PointPair.__init__-702"><span class="linenos">702</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair.__init__-703"><a href="#PointPair.__init__-703"><span class="linenos">703</span></a><span class="sd">        ----------</span>
</span><span id="PointPair.__init__-704"><a href="#PointPair.__init__-704"><span class="linenos">704</span></a><span class="sd">        endpoint1 : Point or ndarray</span>
</span><span id="PointPair.__init__-705"><a href="#PointPair.__init__-705"><span class="linenos">705</span></a><span class="sd">            One (or both) endpoints of the point pair</span>
</span><span id="PointPair.__init__-706"><a href="#PointPair.__init__-706"><span class="linenos">706</span></a><span class="sd">        endpoint2 : Point or ndarray</span>
</span><span id="PointPair.__init__-707"><a href="#PointPair.__init__-707"><span class="linenos">707</span></a><span class="sd">            The other endpoint of the point pair. If `None`,</span>
</span><span id="PointPair.__init__-708"><a href="#PointPair.__init__-708"><span class="linenos">708</span></a><span class="sd">            `endpoint1` contains the data for both points in the pair.</span>
</span><span id="PointPair.__init__-709"><a href="#PointPair.__init__-709"><span class="linenos">709</span></a>
</span><span id="PointPair.__init__-710"><a href="#PointPair.__init__-710"><span class="linenos">710</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.__init__-711"><a href="#PointPair.__init__-711"><span class="linenos">711</span></a>
</span><span id="PointPair.__init__-712"><a href="#PointPair.__init__-712"><span class="linenos">712</span></a>        <span class="n">projective</span><span class="o">.</span><span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If <code>endpoint2</code> is <code>None</code>, interpret <code>endpoint1</code> as either a (2
x...x n) <code>ndarray</code> (where n is the dimension of the underlying
vector space), or else a composite <code><a href="#Point">Point</a></code> object which can be
unpacked into two Points (which may themselves be composite).</p>

<p>If <code>endpoint2</code> is given, then both <code>endpoint1</code> and <code>endpoint2</code>
can be used to construct <code><a href="#Point">Point</a></code> objects, which serve as the
endpoints for this pair of points.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>endpoint1</strong> (Point or ndarray):
One (or both) endpoints of the point pair</li>
<li><strong>endpoint2</strong> (Point or ndarray):
The other endpoint of the point pair. If <code>None</code>,
<code>endpoint1</code> contains the data for both points in the pair.</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.endpoint_coords" class="classattr">
                                        <input id="PointPair.endpoint_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">endpoint_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.KLEIN">Model.KLEIN</a></span><span class="p">:</span> <span class="s1">&#39;klein&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.endpoint_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.endpoint_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.endpoint_coords-714"><a href="#PointPair.endpoint_coords-714"><span class="linenos">714</span></a>    <span class="k">def</span> <span class="nf">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="PointPair.endpoint_coords-715"><a href="#PointPair.endpoint_coords-715"><span class="linenos">715</span></a>        <span class="sd">&quot;&quot;&quot;Get coordinates for the endpoints of this point pair</span>
</span><span id="PointPair.endpoint_coords-716"><a href="#PointPair.endpoint_coords-716"><span class="linenos">716</span></a>
</span><span id="PointPair.endpoint_coords-717"><a href="#PointPair.endpoint_coords-717"><span class="linenos">717</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair.endpoint_coords-718"><a href="#PointPair.endpoint_coords-718"><span class="linenos">718</span></a><span class="sd">        ----------</span>
</span><span id="PointPair.endpoint_coords-719"><a href="#PointPair.endpoint_coords-719"><span class="linenos">719</span></a><span class="sd">        model : Model</span>
</span><span id="PointPair.endpoint_coords-720"><a href="#PointPair.endpoint_coords-720"><span class="linenos">720</span></a><span class="sd">            model to compute coordinates in</span>
</span><span id="PointPair.endpoint_coords-721"><a href="#PointPair.endpoint_coords-721"><span class="linenos">721</span></a>
</span><span id="PointPair.endpoint_coords-722"><a href="#PointPair.endpoint_coords-722"><span class="linenos">722</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.endpoint_coords-723"><a href="#PointPair.endpoint_coords-723"><span class="linenos">723</span></a><span class="sd">        -------</span>
</span><span id="PointPair.endpoint_coords-724"><a href="#PointPair.endpoint_coords-724"><span class="linenos">724</span></a><span class="sd">        ndarray</span>
</span><span id="PointPair.endpoint_coords-725"><a href="#PointPair.endpoint_coords-725"><span class="linenos">725</span></a><span class="sd">            Coordinates for the endpoints of this PointPair, as an</span>
</span><span id="PointPair.endpoint_coords-726"><a href="#PointPair.endpoint_coords-726"><span class="linenos">726</span></a><span class="sd">            ndarray with shape `(2, ... n)` (where `n` is the</span>
</span><span id="PointPair.endpoint_coords-727"><a href="#PointPair.endpoint_coords-727"><span class="linenos">727</span></a><span class="sd">            dimension of the hyperbolic space).</span>
</span><span id="PointPair.endpoint_coords-728"><a href="#PointPair.endpoint_coords-728"><span class="linenos">728</span></a>
</span><span id="PointPair.endpoint_coords-729"><a href="#PointPair.endpoint_coords-729"><span class="linenos">729</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.endpoint_coords-730"><a href="#PointPair.endpoint_coords-730"><span class="linenos">730</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_endpoints</span><span class="p">()</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get coordinates for the endpoints of this point pair</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>model</strong> (Model):
model to compute coordinates in</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Coordinates for the endpoints of this PointPair, as an
ndarray with shape <code>(2, ... n)</code> (where <code>n</code> is the
dimension of the hyperbolic space).</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.get_endpoints" class="classattr">
                                        <input id="PointPair.get_endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_endpoints</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.get_endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.get_endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.get_endpoints-732"><a href="#PointPair.get_endpoints-732"><span class="linenos">732</span></a>    <span class="k">def</span> <span class="nf">get_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="PointPair.get_endpoints-733"><a href="#PointPair.get_endpoints-733"><span class="linenos">733</span></a>        <span class="sd">&quot;&quot;&quot;Convert this pair of points to a composite `Point` object</span>
</span><span id="PointPair.get_endpoints-734"><a href="#PointPair.get_endpoints-734"><span class="linenos">734</span></a>
</span><span id="PointPair.get_endpoints-735"><a href="#PointPair.get_endpoints-735"><span class="linenos">735</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.get_endpoints-736"><a href="#PointPair.get_endpoints-736"><span class="linenos">736</span></a><span class="sd">        -------</span>
</span><span id="PointPair.get_endpoints-737"><a href="#PointPair.get_endpoints-737"><span class="linenos">737</span></a><span class="sd">        Point</span>
</span><span id="PointPair.get_endpoints-738"><a href="#PointPair.get_endpoints-738"><span class="linenos">738</span></a><span class="sd">            Composite `Point` object with the same underlying data as</span>
</span><span id="PointPair.get_endpoints-739"><a href="#PointPair.get_endpoints-739"><span class="linenos">739</span></a><span class="sd">            this point pair.</span>
</span><span id="PointPair.get_endpoints-740"><a href="#PointPair.get_endpoints-740"><span class="linenos">740</span></a>
</span><span id="PointPair.get_endpoints-741"><a href="#PointPair.get_endpoints-741"><span class="linenos">741</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PointPair.get_endpoints-742"><a href="#PointPair.get_endpoints-742"><span class="linenos">742</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert this pair of points to a composite <code><a href="#Point">Point</a></code> object</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Composite <code><a href="#Point">Point</a></code> object with the same underlying data as
this point pair.</li>
</ul>
</div>


                            </div>
                            <div id="PointPair.get_end_pair" class="classattr">
                                        <input id="PointPair.get_end_pair-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_end_pair</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">as_points</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PointPair.get_end_pair-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PointPair.get_end_pair"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PointPair.get_end_pair-744"><a href="#PointPair.get_end_pair-744"><span class="linenos">744</span></a>    <span class="k">def</span> <span class="nf">get_end_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_points</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="PointPair.get_end_pair-745"><a href="#PointPair.get_end_pair-745"><span class="linenos">745</span></a>        <span class="sd">&quot;&quot;&quot;Get a pair of `Point` objects, one for each endpoint of this PointPair</span>
</span><span id="PointPair.get_end_pair-746"><a href="#PointPair.get_end_pair-746"><span class="linenos">746</span></a>
</span><span id="PointPair.get_end_pair-747"><a href="#PointPair.get_end_pair-747"><span class="linenos">747</span></a><span class="sd">        Parameters</span>
</span><span id="PointPair.get_end_pair-748"><a href="#PointPair.get_end_pair-748"><span class="linenos">748</span></a><span class="sd">        ----------</span>
</span><span id="PointPair.get_end_pair-749"><a href="#PointPair.get_end_pair-749"><span class="linenos">749</span></a><span class="sd">        as_points : bool</span>
</span><span id="PointPair.get_end_pair-750"><a href="#PointPair.get_end_pair-750"><span class="linenos">750</span></a><span class="sd">            If `True`, return a pair of `Point` objects. Otherwise,</span>
</span><span id="PointPair.get_end_pair-751"><a href="#PointPair.get_end_pair-751"><span class="linenos">751</span></a><span class="sd">            return a pair of `ndarray`s with projective coordinates</span>
</span><span id="PointPair.get_end_pair-752"><a href="#PointPair.get_end_pair-752"><span class="linenos">752</span></a><span class="sd">            for these points.</span>
</span><span id="PointPair.get_end_pair-753"><a href="#PointPair.get_end_pair-753"><span class="linenos">753</span></a>
</span><span id="PointPair.get_end_pair-754"><a href="#PointPair.get_end_pair-754"><span class="linenos">754</span></a><span class="sd">        Returns</span>
</span><span id="PointPair.get_end_pair-755"><a href="#PointPair.get_end_pair-755"><span class="linenos">755</span></a><span class="sd">        -------</span>
</span><span id="PointPair.get_end_pair-756"><a href="#PointPair.get_end_pair-756"><span class="linenos">756</span></a><span class="sd">        tuple</span>
</span><span id="PointPair.get_end_pair-757"><a href="#PointPair.get_end_pair-757"><span class="linenos">757</span></a><span class="sd">            A tuple `(p1, p2)`, where `p1` and `p2` are either both</span>
</span><span id="PointPair.get_end_pair-758"><a href="#PointPair.get_end_pair-758"><span class="linenos">758</span></a><span class="sd">            `Point`s or both `ndarrays`, representing the endpoints of</span>
</span><span id="PointPair.get_end_pair-759"><a href="#PointPair.get_end_pair-759"><span class="linenos">759</span></a><span class="sd">            this pair.</span>
</span><span id="PointPair.get_end_pair-760"><a href="#PointPair.get_end_pair-760"><span class="linenos">760</span></a>
</span><span id="PointPair.get_end_pair-761"><a href="#PointPair.get_end_pair-761"><span class="linenos">761</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PointPair.get_end_pair-762"><a href="#PointPair.get_end_pair-762"><span class="linenos">762</span></a>        <span class="k">if</span> <span class="n">as_points</span><span class="p">:</span>
</span><span id="PointPair.get_end_pair-763"><a href="#PointPair.get_end_pair-763"><span class="linenos">763</span></a>            <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_end_pair</span><span class="p">(</span><span class="n">as_points</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PointPair.get_end_pair-764"><a href="#PointPair.get_end_pair-764"><span class="linenos">764</span></a>            <span class="k">return</span> <span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">p1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">p2</span><span class="p">))</span>
</span><span id="PointPair.get_end_pair-765"><a href="#PointPair.get_end_pair-765"><span class="linenos">765</span></a>
</span><span id="PointPair.get_end_pair-766"><a href="#PointPair.get_end_pair-766"><span class="linenos">766</span></a>        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoints</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Get a pair of <code><a href="#Point">Point</a></code> objects, one for each endpoint of this PointPair</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>as_points</strong> (bool):
If <code>True</code>, return a pair of <code><a href="#Point">Point</a></code> objects. Otherwise,
return a pair of <code>ndarray</code>s with projective coordinates
for these points.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: A tuple <code>(p1, p2)</code>, where <code>p1</code> and <code>p2</code> are either both
<code><a href="#Point">Point</a></code>s or both <code>ndarrays</code>, representing the endpoints of
this pair.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="PointPair.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="PointPair.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="PointPair.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="PointPair.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="PointPair.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="PointPair.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="PointPair.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="PointPair.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="PointPair.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="PointPair.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="PointPair.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="PointPair.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="PointPair.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></dt>
                                <dd id="PointPair.endpoints" class="variable"><a href="projective.html#PointPair.endpoints">endpoints</a></dd>
                <dd id="PointPair.set_endpoints" class="function"><a href="projective.html#PointPair.set_endpoints">set_endpoints</a></dd>
                <dd id="PointPair.endpoint_affine_coords" class="function"><a href="projective.html#PointPair.endpoint_affine_coords">endpoint_affine_coords</a></dd>
                <dd id="PointPair.endpoint_projective_coords" class="function"><a href="projective.html#PointPair.endpoint_projective_coords">endpoint_projective_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="PointPair.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="PointPair.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="PointPair.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="PointPair.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="PointPair.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="PointPair.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="PointPair.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="PointPair.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="PointPair.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="PointPair.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="PointPair.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="PointPair.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="PointPair.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Geodesic">
                            <input id="Geodesic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Geodesic</span><wbr>(<span class="base"><a href="#PointPair">PointPair</a></span>, <span class="base"><a href="#Subspace">Subspace</a></span>):

                <label class="view-source-button" for="Geodesic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Geodesic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Geodesic-768"><a href="#Geodesic-768"><span class="linenos">768</span></a><span class="k">class</span> <span class="nc">Geodesic</span><span class="p">(</span><span class="n">PointPair</span><span class="p">,</span> <span class="n">Subspace</span><span class="p">):</span>
</span><span id="Geodesic-769"><a href="#Geodesic-769"><span class="linenos">769</span></a>    <span class="sd">&quot;&quot;&quot;Model for a bi-infinite gedoesic in hyperbolic space.</span>
</span><span id="Geodesic-770"><a href="#Geodesic-770"><span class="linenos">770</span></a>
</span><span id="Geodesic-771"><a href="#Geodesic-771"><span class="linenos">771</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Geodesic-772"><a href="#Geodesic-772"><span class="linenos">772</span></a>    <span class="nd">@property</span>
</span><span id="Geodesic-773"><a href="#Geodesic-773"><span class="linenos">773</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Geodesic-774"><a href="#Geodesic-774"><span class="linenos">774</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Geodesic-775"><a href="#Geodesic-775"><span class="linenos">775</span></a>
</span><span id="Geodesic-776"><a href="#Geodesic-776"><span class="linenos">776</span></a>    <span class="nd">@property</span>
</span><span id="Geodesic-777"><a href="#Geodesic-777"><span class="linenos">777</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Geodesic-778"><a href="#Geodesic-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Geodesic-779"><a href="#Geodesic-779"><span class="linenos">779</span></a>
</span><span id="Geodesic-780"><a href="#Geodesic-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Geodesic-781"><a href="#Geodesic-781"><span class="linenos">781</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a circular arc corresponding to this</span>
</span><span id="Geodesic-782"><a href="#Geodesic-782"><span class="linenos">782</span></a><span class="sd">        geodesic in the Poincare or halfspace models.</span>
</span><span id="Geodesic-783"><a href="#Geodesic-783"><span class="linenos">783</span></a>
</span><span id="Geodesic-784"><a href="#Geodesic-784"><span class="linenos">784</span></a><span class="sd">        Parameters</span>
</span><span id="Geodesic-785"><a href="#Geodesic-785"><span class="linenos">785</span></a><span class="sd">        ----------</span>
</span><span id="Geodesic-786"><a href="#Geodesic-786"><span class="linenos">786</span></a><span class="sd">        degrees : bool</span>
</span><span id="Geodesic-787"><a href="#Geodesic-787"><span class="linenos">787</span></a><span class="sd">            if `True`, return angles in degrees. Otherwise, return</span>
</span><span id="Geodesic-788"><a href="#Geodesic-788"><span class="linenos">788</span></a><span class="sd">            angles in radians</span>
</span><span id="Geodesic-789"><a href="#Geodesic-789"><span class="linenos">789</span></a><span class="sd">        model : Model</span>
</span><span id="Geodesic-790"><a href="#Geodesic-790"><span class="linenos">790</span></a><span class="sd">            hyperbolic model to use for the computation</span>
</span><span id="Geodesic-791"><a href="#Geodesic-791"><span class="linenos">791</span></a>
</span><span id="Geodesic-792"><a href="#Geodesic-792"><span class="linenos">792</span></a><span class="sd">        Returns</span>
</span><span id="Geodesic-793"><a href="#Geodesic-793"><span class="linenos">793</span></a><span class="sd">        -------</span>
</span><span id="Geodesic-794"><a href="#Geodesic-794"><span class="linenos">794</span></a><span class="sd">        tuple</span>
</span><span id="Geodesic-795"><a href="#Geodesic-795"><span class="linenos">795</span></a><span class="sd">            tuple `(centers, radii, thetas)`, where `centers`,</span>
</span><span id="Geodesic-796"><a href="#Geodesic-796"><span class="linenos">796</span></a><span class="sd">            `radii`, and `thetas` are `ndarray`s representing the</span>
</span><span id="Geodesic-797"><a href="#Geodesic-797"><span class="linenos">797</span></a><span class="sd">            centers, radii, and begin/end angles for the circle</span>
</span><span id="Geodesic-798"><a href="#Geodesic-798"><span class="linenos">798</span></a><span class="sd">            corresponding to this arc in the given model of hyperbolic</span>
</span><span id="Geodesic-799"><a href="#Geodesic-799"><span class="linenos">799</span></a><span class="sd">            space. Angles are always specified in counterclockwise</span>
</span><span id="Geodesic-800"><a href="#Geodesic-800"><span class="linenos">800</span></a><span class="sd">            order.</span>
</span><span id="Geodesic-801"><a href="#Geodesic-801"><span class="linenos">801</span></a>
</span><span id="Geodesic-802"><a href="#Geodesic-802"><span class="linenos">802</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Geodesic-803"><a href="#Geodesic-803"><span class="linenos">803</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Geodesic-804"><a href="#Geodesic-804"><span class="linenos">804</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Geodesic-805"><a href="#Geodesic-805"><span class="linenos">805</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
</span><span id="Geodesic-806"><a href="#Geodesic-806"><span class="linenos">806</span></a>
</span><span id="Geodesic-807"><a href="#Geodesic-807"><span class="linenos">807</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Geodesic-808"><a href="#Geodesic-808"><span class="linenos">808</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">short_arc</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Geodesic-809"><a href="#Geodesic-809"><span class="linenos">809</span></a>
</span><span id="Geodesic-810"><a href="#Geodesic-810"><span class="linenos">810</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Geodesic-811"><a href="#Geodesic-811"><span class="linenos">811</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Geodesic-812"><a href="#Geodesic-812"><span class="linenos">812</span></a>
</span><span id="Geodesic-813"><a href="#Geodesic-813"><span class="linenos">813</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Geodesic-814"><a href="#Geodesic-814"><span class="linenos">814</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="Geodesic-815"><a href="#Geodesic-815"><span class="linenos">815</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="Geodesic-816"><a href="#Geodesic-816"><span class="linenos">816</span></a>
</span><span id="Geodesic-817"><a href="#Geodesic-817"><span class="linenos">817</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span><span id="Geodesic-818"><a href="#Geodesic-818"><span class="linenos">818</span></a>
</span><span id="Geodesic-819"><a href="#Geodesic-819"><span class="linenos">819</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Geodesic-820"><a href="#Geodesic-820"><span class="linenos">820</span></a>    <span class="k">def</span> <span class="nf">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">):</span>
</span><span id="Geodesic-821"><a href="#Geodesic-821"><span class="linenos">821</span></a>        <span class="sd">&quot;&quot;&quot;Construct a geodesic which is the fixpoint set of a reflection.</span>
</span><span id="Geodesic-822"><a href="#Geodesic-822"><span class="linenos">822</span></a>
</span><span id="Geodesic-823"><a href="#Geodesic-823"><span class="linenos">823</span></a><span class="sd">        Parameters</span>
</span><span id="Geodesic-824"><a href="#Geodesic-824"><span class="linenos">824</span></a><span class="sd">        ----------</span>
</span><span id="Geodesic-825"><a href="#Geodesic-825"><span class="linenos">825</span></a><span class="sd">        reflection : Isometry or ndarray</span>
</span><span id="Geodesic-826"><a href="#Geodesic-826"><span class="linenos">826</span></a><span class="sd">            The reflection to compute the fixed geodesic for</span>
</span><span id="Geodesic-827"><a href="#Geodesic-827"><span class="linenos">827</span></a>
</span><span id="Geodesic-828"><a href="#Geodesic-828"><span class="linenos">828</span></a><span class="sd">        Raises</span>
</span><span id="Geodesic-829"><a href="#Geodesic-829"><span class="linenos">829</span></a><span class="sd">        ------</span>
</span><span id="Geodesic-830"><a href="#Geodesic-830"><span class="linenos">830</span></a><span class="sd">        GeometryError :</span>
</span><span id="Geodesic-831"><a href="#Geodesic-831"><span class="linenos">831</span></a><span class="sd">            If the given isometry is not a reflection, or if the</span>
</span><span id="Geodesic-832"><a href="#Geodesic-832"><span class="linenos">832</span></a><span class="sd">            dimension of the underlying hyperbolic space is not 2.</span>
</span><span id="Geodesic-833"><a href="#Geodesic-833"><span class="linenos">833</span></a>
</span><span id="Geodesic-834"><a href="#Geodesic-834"><span class="linenos">834</span></a><span class="sd">        Returns</span>
</span><span id="Geodesic-835"><a href="#Geodesic-835"><span class="linenos">835</span></a><span class="sd">        -------</span>
</span><span id="Geodesic-836"><a href="#Geodesic-836"><span class="linenos">836</span></a><span class="sd">        Geodesic</span>
</span><span id="Geodesic-837"><a href="#Geodesic-837"><span class="linenos">837</span></a><span class="sd">            A `Geodesic` fixed by the given isometry.</span>
</span><span id="Geodesic-838"><a href="#Geodesic-838"><span class="linenos">838</span></a>
</span><span id="Geodesic-839"><a href="#Geodesic-839"><span class="linenos">839</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Geodesic-840"><a href="#Geodesic-840"><span class="linenos">840</span></a>        <span class="k">if</span> <span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Geodesic-841"><a href="#Geodesic-841"><span class="linenos">841</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Creating segment from reflection expects dimension 2, got dimension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span><span class="p">))</span>
</span><span id="Geodesic-842"><a href="#Geodesic-842"><span class="linenos">842</span></a>
</span><span id="Geodesic-843"><a href="#Geodesic-843"><span class="linenos">843</span></a>        <span class="n">hyperplane</span> <span class="o">=</span> <span class="n">Hyperplane</span><span class="o">.</span><span class="n">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">)</span>
</span><span id="Geodesic-844"><a href="#Geodesic-844"><span class="linenos">844</span></a>        <span class="n">pt1</span> <span class="o">=</span> <span class="n">hyperplane</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Geodesic-845"><a href="#Geodesic-845"><span class="linenos">845</span></a>        <span class="n">pt2</span> <span class="o">=</span> <span class="n">hyperplane</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Geodesic-846"><a href="#Geodesic-846"><span class="linenos">846</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a bi-infinite gedoesic in hyperbolic space.</p>
</div>


                            <div id="Geodesic.endpoints" class="classattr">
                                        <input id="Geodesic.endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">endpoints</span>

                <label class="view-source-button" for="Geodesic.endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Geodesic.endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Geodesic.endpoints-772"><a href="#Geodesic.endpoints-772"><span class="linenos">772</span></a>    <span class="nd">@property</span>
</span><span id="Geodesic.endpoints-773"><a href="#Geodesic.endpoints-773"><span class="linenos">773</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Geodesic.endpoints-774"><a href="#Geodesic.endpoints-774"><span class="linenos">774</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="Geodesic.ideal_basis" class="classattr">
                                        <input id="Geodesic.ideal_basis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ideal_basis</span>

                <label class="view-source-button" for="Geodesic.ideal_basis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Geodesic.ideal_basis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Geodesic.ideal_basis-776"><a href="#Geodesic.ideal_basis-776"><span class="linenos">776</span></a>    <span class="nd">@property</span>
</span><span id="Geodesic.ideal_basis-777"><a href="#Geodesic.ideal_basis-777"><span class="linenos">777</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Geodesic.ideal_basis-778"><a href="#Geodesic.ideal_basis-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="Geodesic.circle_parameters" class="classattr">
                                        <input id="Geodesic.circle_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Geodesic.circle_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Geodesic.circle_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Geodesic.circle_parameters-780"><a href="#Geodesic.circle_parameters-780"><span class="linenos">780</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Geodesic.circle_parameters-781"><a href="#Geodesic.circle_parameters-781"><span class="linenos">781</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a circular arc corresponding to this</span>
</span><span id="Geodesic.circle_parameters-782"><a href="#Geodesic.circle_parameters-782"><span class="linenos">782</span></a><span class="sd">        geodesic in the Poincare or halfspace models.</span>
</span><span id="Geodesic.circle_parameters-783"><a href="#Geodesic.circle_parameters-783"><span class="linenos">783</span></a>
</span><span id="Geodesic.circle_parameters-784"><a href="#Geodesic.circle_parameters-784"><span class="linenos">784</span></a><span class="sd">        Parameters</span>
</span><span id="Geodesic.circle_parameters-785"><a href="#Geodesic.circle_parameters-785"><span class="linenos">785</span></a><span class="sd">        ----------</span>
</span><span id="Geodesic.circle_parameters-786"><a href="#Geodesic.circle_parameters-786"><span class="linenos">786</span></a><span class="sd">        degrees : bool</span>
</span><span id="Geodesic.circle_parameters-787"><a href="#Geodesic.circle_parameters-787"><span class="linenos">787</span></a><span class="sd">            if `True`, return angles in degrees. Otherwise, return</span>
</span><span id="Geodesic.circle_parameters-788"><a href="#Geodesic.circle_parameters-788"><span class="linenos">788</span></a><span class="sd">            angles in radians</span>
</span><span id="Geodesic.circle_parameters-789"><a href="#Geodesic.circle_parameters-789"><span class="linenos">789</span></a><span class="sd">        model : Model</span>
</span><span id="Geodesic.circle_parameters-790"><a href="#Geodesic.circle_parameters-790"><span class="linenos">790</span></a><span class="sd">            hyperbolic model to use for the computation</span>
</span><span id="Geodesic.circle_parameters-791"><a href="#Geodesic.circle_parameters-791"><span class="linenos">791</span></a>
</span><span id="Geodesic.circle_parameters-792"><a href="#Geodesic.circle_parameters-792"><span class="linenos">792</span></a><span class="sd">        Returns</span>
</span><span id="Geodesic.circle_parameters-793"><a href="#Geodesic.circle_parameters-793"><span class="linenos">793</span></a><span class="sd">        -------</span>
</span><span id="Geodesic.circle_parameters-794"><a href="#Geodesic.circle_parameters-794"><span class="linenos">794</span></a><span class="sd">        tuple</span>
</span><span id="Geodesic.circle_parameters-795"><a href="#Geodesic.circle_parameters-795"><span class="linenos">795</span></a><span class="sd">            tuple `(centers, radii, thetas)`, where `centers`,</span>
</span><span id="Geodesic.circle_parameters-796"><a href="#Geodesic.circle_parameters-796"><span class="linenos">796</span></a><span class="sd">            `radii`, and `thetas` are `ndarray`s representing the</span>
</span><span id="Geodesic.circle_parameters-797"><a href="#Geodesic.circle_parameters-797"><span class="linenos">797</span></a><span class="sd">            centers, radii, and begin/end angles for the circle</span>
</span><span id="Geodesic.circle_parameters-798"><a href="#Geodesic.circle_parameters-798"><span class="linenos">798</span></a><span class="sd">            corresponding to this arc in the given model of hyperbolic</span>
</span><span id="Geodesic.circle_parameters-799"><a href="#Geodesic.circle_parameters-799"><span class="linenos">799</span></a><span class="sd">            space. Angles are always specified in counterclockwise</span>
</span><span id="Geodesic.circle_parameters-800"><a href="#Geodesic.circle_parameters-800"><span class="linenos">800</span></a><span class="sd">            order.</span>
</span><span id="Geodesic.circle_parameters-801"><a href="#Geodesic.circle_parameters-801"><span class="linenos">801</span></a>
</span><span id="Geodesic.circle_parameters-802"><a href="#Geodesic.circle_parameters-802"><span class="linenos">802</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Geodesic.circle_parameters-803"><a href="#Geodesic.circle_parameters-803"><span class="linenos">803</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Geodesic.circle_parameters-804"><a href="#Geodesic.circle_parameters-804"><span class="linenos">804</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Geodesic.circle_parameters-805"><a href="#Geodesic.circle_parameters-805"><span class="linenos">805</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
</span><span id="Geodesic.circle_parameters-806"><a href="#Geodesic.circle_parameters-806"><span class="linenos">806</span></a>
</span><span id="Geodesic.circle_parameters-807"><a href="#Geodesic.circle_parameters-807"><span class="linenos">807</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Geodesic.circle_parameters-808"><a href="#Geodesic.circle_parameters-808"><span class="linenos">808</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">short_arc</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Geodesic.circle_parameters-809"><a href="#Geodesic.circle_parameters-809"><span class="linenos">809</span></a>
</span><span id="Geodesic.circle_parameters-810"><a href="#Geodesic.circle_parameters-810"><span class="linenos">810</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Geodesic.circle_parameters-811"><a href="#Geodesic.circle_parameters-811"><span class="linenos">811</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Geodesic.circle_parameters-812"><a href="#Geodesic.circle_parameters-812"><span class="linenos">812</span></a>
</span><span id="Geodesic.circle_parameters-813"><a href="#Geodesic.circle_parameters-813"><span class="linenos">813</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Geodesic.circle_parameters-814"><a href="#Geodesic.circle_parameters-814"><span class="linenos">814</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="Geodesic.circle_parameters-815"><a href="#Geodesic.circle_parameters-815"><span class="linenos">815</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="Geodesic.circle_parameters-816"><a href="#Geodesic.circle_parameters-816"><span class="linenos">816</span></a>
</span><span id="Geodesic.circle_parameters-817"><a href="#Geodesic.circle_parameters-817"><span class="linenos">817</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Get parameters describing a circular arc corresponding to this
geodesic in the Poincare or halfspace models.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>degrees</strong> (bool):
if <code>True</code>, return angles in degrees. Otherwise, return
angles in radians</li>
<li><strong>model</strong> (Model):
hyperbolic model to use for the computation</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: tuple <code>(centers, radii, thetas)</code>, where <code>centers</code>,
<code>radii</code>, and <code>thetas</code> are <code>ndarray</code>s representing the
centers, radii, and begin/end angles for the circle
corresponding to this arc in the given model of hyperbolic
space. Angles are always specified in counterclockwise
order.</li>
</ul>
</div>


                            </div>
                            <div id="Geodesic.from_reflection" class="classattr">
                                        <input id="Geodesic.from_reflection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_reflection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">reflection</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Geodesic.from_reflection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Geodesic.from_reflection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Geodesic.from_reflection-819"><a href="#Geodesic.from_reflection-819"><span class="linenos">819</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Geodesic.from_reflection-820"><a href="#Geodesic.from_reflection-820"><span class="linenos">820</span></a>    <span class="k">def</span> <span class="nf">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">):</span>
</span><span id="Geodesic.from_reflection-821"><a href="#Geodesic.from_reflection-821"><span class="linenos">821</span></a>        <span class="sd">&quot;&quot;&quot;Construct a geodesic which is the fixpoint set of a reflection.</span>
</span><span id="Geodesic.from_reflection-822"><a href="#Geodesic.from_reflection-822"><span class="linenos">822</span></a>
</span><span id="Geodesic.from_reflection-823"><a href="#Geodesic.from_reflection-823"><span class="linenos">823</span></a><span class="sd">        Parameters</span>
</span><span id="Geodesic.from_reflection-824"><a href="#Geodesic.from_reflection-824"><span class="linenos">824</span></a><span class="sd">        ----------</span>
</span><span id="Geodesic.from_reflection-825"><a href="#Geodesic.from_reflection-825"><span class="linenos">825</span></a><span class="sd">        reflection : Isometry or ndarray</span>
</span><span id="Geodesic.from_reflection-826"><a href="#Geodesic.from_reflection-826"><span class="linenos">826</span></a><span class="sd">            The reflection to compute the fixed geodesic for</span>
</span><span id="Geodesic.from_reflection-827"><a href="#Geodesic.from_reflection-827"><span class="linenos">827</span></a>
</span><span id="Geodesic.from_reflection-828"><a href="#Geodesic.from_reflection-828"><span class="linenos">828</span></a><span class="sd">        Raises</span>
</span><span id="Geodesic.from_reflection-829"><a href="#Geodesic.from_reflection-829"><span class="linenos">829</span></a><span class="sd">        ------</span>
</span><span id="Geodesic.from_reflection-830"><a href="#Geodesic.from_reflection-830"><span class="linenos">830</span></a><span class="sd">        GeometryError :</span>
</span><span id="Geodesic.from_reflection-831"><a href="#Geodesic.from_reflection-831"><span class="linenos">831</span></a><span class="sd">            If the given isometry is not a reflection, or if the</span>
</span><span id="Geodesic.from_reflection-832"><a href="#Geodesic.from_reflection-832"><span class="linenos">832</span></a><span class="sd">            dimension of the underlying hyperbolic space is not 2.</span>
</span><span id="Geodesic.from_reflection-833"><a href="#Geodesic.from_reflection-833"><span class="linenos">833</span></a>
</span><span id="Geodesic.from_reflection-834"><a href="#Geodesic.from_reflection-834"><span class="linenos">834</span></a><span class="sd">        Returns</span>
</span><span id="Geodesic.from_reflection-835"><a href="#Geodesic.from_reflection-835"><span class="linenos">835</span></a><span class="sd">        -------</span>
</span><span id="Geodesic.from_reflection-836"><a href="#Geodesic.from_reflection-836"><span class="linenos">836</span></a><span class="sd">        Geodesic</span>
</span><span id="Geodesic.from_reflection-837"><a href="#Geodesic.from_reflection-837"><span class="linenos">837</span></a><span class="sd">            A `Geodesic` fixed by the given isometry.</span>
</span><span id="Geodesic.from_reflection-838"><a href="#Geodesic.from_reflection-838"><span class="linenos">838</span></a>
</span><span id="Geodesic.from_reflection-839"><a href="#Geodesic.from_reflection-839"><span class="linenos">839</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Geodesic.from_reflection-840"><a href="#Geodesic.from_reflection-840"><span class="linenos">840</span></a>        <span class="k">if</span> <span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Geodesic.from_reflection-841"><a href="#Geodesic.from_reflection-841"><span class="linenos">841</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Creating segment from reflection expects dimension 2, got dimension </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span><span class="p">))</span>
</span><span id="Geodesic.from_reflection-842"><a href="#Geodesic.from_reflection-842"><span class="linenos">842</span></a>
</span><span id="Geodesic.from_reflection-843"><a href="#Geodesic.from_reflection-843"><span class="linenos">843</span></a>        <span class="n">hyperplane</span> <span class="o">=</span> <span class="n">Hyperplane</span><span class="o">.</span><span class="n">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">)</span>
</span><span id="Geodesic.from_reflection-844"><a href="#Geodesic.from_reflection-844"><span class="linenos">844</span></a>        <span class="n">pt1</span> <span class="o">=</span> <span class="n">hyperplane</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Geodesic.from_reflection-845"><a href="#Geodesic.from_reflection-845"><span class="linenos">845</span></a>        <span class="n">pt2</span> <span class="o">=</span> <span class="n">hyperplane</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Geodesic.from_reflection-846"><a href="#Geodesic.from_reflection-846"><span class="linenos">846</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="n">pt1</span><span class="p">,</span> <span class="n">pt2</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Construct a geodesic which is the fixpoint set of a reflection.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>reflection</strong> (Isometry or ndarray):
The reflection to compute the fixed geodesic for</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>GeometryError :</strong>: If the given isometry is not a reflection, or if the
dimension of the underlying hyperbolic space is not 2.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Geodesic</strong>: A <code><a href="#Geodesic">Geodesic</a></code> fixed by the given isometry.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PointPair">PointPair</a></dt>
                                <dd id="Geodesic.__init__" class="function"><a href="#PointPair.__init__">PointPair</a></dd>
                <dd id="Geodesic.endpoint_coords" class="function"><a href="#PointPair.endpoint_coords">endpoint_coords</a></dd>
                <dd id="Geodesic.get_endpoints" class="function"><a href="#PointPair.get_endpoints">get_endpoints</a></dd>
                <dd id="Geodesic.get_end_pair" class="function"><a href="#PointPair.get_end_pair">get_end_pair</a></dd>

            </div>
            <div><dt><a href="#Subspace">Subspace</a></dt>
                                <dd id="Geodesic.ideal_basis_coords" class="function"><a href="#Subspace.ideal_basis_coords">ideal_basis_coords</a></dd>
                <dd id="Geodesic.spacelike_complement" class="function"><a href="#Subspace.spacelike_complement">spacelike_complement</a></dd>
                <dd id="Geodesic.sphere_parameters" class="function"><a href="#Subspace.sphere_parameters">sphere_parameters</a></dd>
                <dd id="Geodesic.reflection_across" class="function"><a href="#Subspace.reflection_across">reflection_across</a></dd>

            </div>
            <div><dt><a href="#IdealPoint">IdealPoint</a></dt>
                                <dd id="Geodesic.from_angle" class="function"><a href="#IdealPoint.from_angle">from_angle</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Geodesic.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="Geodesic.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="Geodesic.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="Geodesic.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="Geodesic.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="Geodesic.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="Geodesic.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="Geodesic.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="Geodesic.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="Geodesic.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="Geodesic.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Geodesic.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Geodesic.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></dt>
                                <dd id="Geodesic.set_endpoints" class="function"><a href="projective.html#PointPair.set_endpoints">set_endpoints</a></dd>
                <dd id="Geodesic.endpoint_affine_coords" class="function"><a href="projective.html#PointPair.endpoint_affine_coords">endpoint_affine_coords</a></dd>
                <dd id="Geodesic.endpoint_projective_coords" class="function"><a href="projective.html#PointPair.endpoint_projective_coords">endpoint_projective_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="Geodesic.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Geodesic.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Geodesic.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Geodesic.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Geodesic.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Geodesic.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Geodesic.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Geodesic.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Geodesic.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Geodesic.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Geodesic.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Geodesic.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Geodesic.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Segment">
                            <input id="Segment-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Segment</span><wbr>(<span class="base"><a href="#Geodesic">Geodesic</a></span>):

                <label class="view-source-button" for="Segment-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Segment"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Segment-848"><a href="#Segment-848"><span class="linenos"> 848</span></a><span class="k">class</span> <span class="nc">Segment</span><span class="p">(</span><span class="n">Geodesic</span><span class="p">):</span>
</span><span id="Segment-849"><a href="#Segment-849"><span class="linenos"> 849</span></a>    <span class="sd">&quot;&quot;&quot;Model a geodesic segment in hyperbolic space.&quot;&quot;&quot;</span>
</span><span id="Segment-850"><a href="#Segment-850"><span class="linenos"> 850</span></a>
</span><span id="Segment-851"><a href="#Segment-851"><span class="linenos"> 851</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Segment-852"><a href="#Segment-852"><span class="linenos"> 852</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Segment-853"><a href="#Segment-853"><span class="linenos"> 853</span></a>
</span><span id="Segment-854"><a href="#Segment-854"><span class="linenos"> 854</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span>
</span><span id="Segment-855"><a href="#Segment-855"><span class="linenos"> 855</span></a>                           <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Segment-856"><a href="#Segment-856"><span class="linenos"> 856</span></a>
</span><span id="Segment-857"><a href="#Segment-857"><span class="linenos"> 857</span></a>        <span class="sd">&quot;&quot;&quot;self.unit_ndims = 2</span>
</span><span id="Segment-858"><a href="#Segment-858"><span class="linenos"> 858</span></a><span class="sd">        self.aux_ndims = 0</span>
</span><span id="Segment-859"><a href="#Segment-859"><span class="linenos"> 859</span></a><span class="sd">        self.dual_ndims = 0</span>
</span><span id="Segment-860"><a href="#Segment-860"><span class="linenos"> 860</span></a>
</span><span id="Segment-861"><a href="#Segment-861"><span class="linenos"> 861</span></a><span class="sd">        if endpoint2 is None:</span>
</span><span id="Segment-862"><a href="#Segment-862"><span class="linenos"> 862</span></a><span class="sd">            try:</span>
</span><span id="Segment-863"><a href="#Segment-863"><span class="linenos"> 863</span></a><span class="sd">                self._construct_from_object(endpoint1, **kwargs)</span>
</span><span id="Segment-864"><a href="#Segment-864"><span class="linenos"> 864</span></a><span class="sd">                return</span>
</span><span id="Segment-865"><a href="#Segment-865"><span class="linenos"> 865</span></a><span class="sd">            except (AttributeError, TypeError, GeometryError):</span>
</span><span id="Segment-866"><a href="#Segment-866"><span class="linenos"> 866</span></a><span class="sd">                pass</span>
</span><span id="Segment-867"><a href="#Segment-867"><span class="linenos"> 867</span></a>
</span><span id="Segment-868"><a href="#Segment-868"><span class="linenos"> 868</span></a><span class="sd">            try:</span>
</span><span id="Segment-869"><a href="#Segment-869"><span class="linenos"> 869</span></a><span class="sd">                self.set(endpoint1, **kwargs)</span>
</span><span id="Segment-870"><a href="#Segment-870"><span class="linenos"> 870</span></a><span class="sd">                return</span>
</span><span id="Segment-871"><a href="#Segment-871"><span class="linenos"> 871</span></a><span class="sd">            except (AttributeError, GeometryError) as e:</span>
</span><span id="Segment-872"><a href="#Segment-872"><span class="linenos"> 872</span></a><span class="sd">                pass</span>
</span><span id="Segment-873"><a href="#Segment-873"><span class="linenos"> 873</span></a>
</span><span id="Segment-874"><a href="#Segment-874"><span class="linenos"> 874</span></a><span class="sd">        self.set_endpoints(endpoint1, endpoint2, **kwargs)</span>
</span><span id="Segment-875"><a href="#Segment-875"><span class="linenos"> 875</span></a>
</span><span id="Segment-876"><a href="#Segment-876"><span class="linenos"> 876</span></a><span class="sd">    def set_endpoints(self, endpoint1, endpoint2=None, **kwargs):</span>
</span><span id="Segment-877"><a href="#Segment-877"><span class="linenos"> 877</span></a><span class="sd">        # reimplemented to also compute ideal endpoints</span>
</span><span id="Segment-878"><a href="#Segment-878"><span class="linenos"> 878</span></a><span class="sd">        if endpoint2 is None:</span>
</span><span id="Segment-879"><a href="#Segment-879"><span class="linenos"> 879</span></a><span class="sd">            self.endpoints = Point(endpoint1).proj_data</span>
</span><span id="Segment-880"><a href="#Segment-880"><span class="linenos"> 880</span></a><span class="sd">            self._compute_ideal_endpoints(endpoint1)</span>
</span><span id="Segment-881"><a href="#Segment-881"><span class="linenos"> 881</span></a><span class="sd">            return</span>
</span><span id="Segment-882"><a href="#Segment-882"><span class="linenos"> 882</span></a>
</span><span id="Segment-883"><a href="#Segment-883"><span class="linenos"> 883</span></a><span class="sd">        pt1 = Point(endpoint1)</span>
</span><span id="Segment-884"><a href="#Segment-884"><span class="linenos"> 884</span></a><span class="sd">        pt2 = Point(endpoint2)</span>
</span><span id="Segment-885"><a href="#Segment-885"><span class="linenos"> 885</span></a><span class="sd">        self.endpoints = Point(np.stack(</span>
</span><span id="Segment-886"><a href="#Segment-886"><span class="linenos"> 886</span></a><span class="sd">            [pt1.proj_data, pt2.proj_data], axis=-2)</span>
</span><span id="Segment-887"><a href="#Segment-887"><span class="linenos"> 887</span></a><span class="sd">        )</span>
</span><span id="Segment-888"><a href="#Segment-888"><span class="linenos"> 888</span></a>
</span><span id="Segment-889"><a href="#Segment-889"><span class="linenos"> 889</span></a><span class="sd">        self._compute_ideal_endpoints(self.endpoints)</span>
</span><span id="Segment-890"><a href="#Segment-890"><span class="linenos"> 890</span></a><span class="sd">        self._set_optional(**kwargs)&quot;&quot;&quot;</span>
</span><span id="Segment-891"><a href="#Segment-891"><span class="linenos"> 891</span></a>
</span><span id="Segment-892"><a href="#Segment-892"><span class="linenos"> 892</span></a>    <span class="nd">@property</span>
</span><span id="Segment-893"><a href="#Segment-893"><span class="linenos"> 893</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Segment-894"><a href="#Segment-894"><span class="linenos"> 894</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span>
</span><span id="Segment-895"><a href="#Segment-895"><span class="linenos"> 895</span></a>
</span><span id="Segment-896"><a href="#Segment-896"><span class="linenos"> 896</span></a>    <span class="k">def</span> <span class="nf">_assert_aux_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">):</span>
</span><span id="Segment-897"><a href="#Segment-897"><span class="linenos"> 897</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">aux_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="Segment-898"><a href="#Segment-898"><span class="linenos"> 898</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Underlying auxiliary data for a hyperbolic&quot;</span>
</span><span id="Segment-899"><a href="#Segment-899"><span class="linenos"> 899</span></a>            <span class="s2">&quot; segment must have shape (..., 2, n) but data&quot;</span>
</span><span id="Segment-900"><a href="#Segment-900"><span class="linenos"> 900</span></a>            <span class="s2">&quot; has shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Segment-901"><a href="#Segment-901"><span class="linenos"> 901</span></a>
</span><span id="Segment-902"><a href="#Segment-902"><span class="linenos"> 902</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="Segment-903"><a href="#Segment-903"><span class="linenos"> 903</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="Segment-904"><a href="#Segment-904"><span class="linenos"> 904</span></a>
</span><span id="Segment-905"><a href="#Segment-905"><span class="linenos"> 905</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">):</span>
</span><span id="Segment-906"><a href="#Segment-906"><span class="linenos"> 906</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Underlying data for a hyperbolic&quot;</span>
</span><span id="Segment-907"><a href="#Segment-907"><span class="linenos"> 907</span></a>            <span class="s2">&quot; segment must have shape (..., 2, n) but data&quot;</span>
</span><span id="Segment-908"><a href="#Segment-908"><span class="linenos"> 908</span></a>            <span class="s2">&quot; has shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Segment-909"><a href="#Segment-909"><span class="linenos"> 909</span></a>
</span><span id="Segment-910"><a href="#Segment-910"><span class="linenos"> 910</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="Segment-911"><a href="#Segment-911"><span class="linenos"> 911</span></a>            <span class="k">return</span>
</span><span id="Segment-912"><a href="#Segment-912"><span class="linenos"> 912</span></a>
</span><span id="Segment-913"><a href="#Segment-913"><span class="linenos"> 913</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timelike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="Segment-914"><a href="#Segment-914"><span class="linenos"> 914</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;segment data at index [..., 0, :,&quot;</span>
</span><span id="Segment-915"><a href="#Segment-915"><span class="linenos"> 915</span></a>            <span class="s2">&quot;:] must consist of timelike vectors&quot;</span> <span class="p">)</span>
</span><span id="Segment-916"><a href="#Segment-916"><span class="linenos"> 916</span></a>
</span><span id="Segment-917"><a href="#Segment-917"><span class="linenos"> 917</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lightlike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="Segment-918"><a href="#Segment-918"><span class="linenos"> 918</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;segment data at index [..., 1, :,&quot;</span>
</span><span id="Segment-919"><a href="#Segment-919"><span class="linenos"> 919</span></a>            <span class="s2">&quot;:] must consist of lightlike vectors&quot;</span> <span class="p">)</span>
</span><span id="Segment-920"><a href="#Segment-920"><span class="linenos"> 920</span></a>
</span><span id="Segment-921"><a href="#Segment-921"><span class="linenos"> 921</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">end_data</span><span class="p">):</span>
</span><span id="Segment-922"><a href="#Segment-922"><span class="linenos"> 922</span></a>        <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="n">end_data</span><span class="p">)</span>
</span><span id="Segment-923"><a href="#Segment-923"><span class="linenos"> 923</span></a>        <span class="n">dim</span> <span class="o">=</span> <span class="n">end_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Segment-924"><a href="#Segment-924"><span class="linenos"> 924</span></a>
</span><span id="Segment-925"><a href="#Segment-925"><span class="linenos"> 925</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">end_data</span> <span class="o">@</span> <span class="n">minkowski</span><span class="p">(</span>
</span><span id="Segment-926"><a href="#Segment-926"><span class="linenos"> 926</span></a>            <span class="n">dim</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span>
</span><span id="Segment-927"><a href="#Segment-927"><span class="linenos"> 927</span></a>        <span class="p">)</span> <span class="o">@</span> <span class="n">end_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Segment-928"><a href="#Segment-928"><span class="linenos"> 928</span></a>        <span class="n">a11</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Segment-929"><a href="#Segment-929"><span class="linenos"> 929</span></a>        <span class="n">a22</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Segment-930"><a href="#Segment-930"><span class="linenos"> 930</span></a>        <span class="n">a12</span> <span class="o">=</span> <span class="n">products</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="Segment-931"><a href="#Segment-931"><span class="linenos"> 931</span></a>
</span><span id="Segment-932"><a href="#Segment-932"><span class="linenos"> 932</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">a11</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a12</span> <span class="o">+</span> <span class="n">a22</span>
</span><span id="Segment-933"><a href="#Segment-933"><span class="linenos"> 933</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a12</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">a22</span>
</span><span id="Segment-934"><a href="#Segment-934"><span class="linenos"> 934</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">a22</span>
</span><span id="Segment-935"><a href="#Segment-935"><span class="linenos"> 935</span></a>
</span><span id="Segment-936"><a href="#Segment-936"><span class="linenos"> 936</span></a>        <span class="n">mu1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span><span id="Segment-937"><a href="#Segment-937"><span class="linenos"> 937</span></a>        <span class="n">mu2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
</span><span id="Segment-938"><a href="#Segment-938"><span class="linenos"> 938</span></a>
</span><span id="Segment-939"><a href="#Segment-939"><span class="linenos"> 939</span></a>        <span class="n">null1</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span>
</span><span id="Segment-940"><a href="#Segment-940"><span class="linenos"> 940</span></a>                 <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu1</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Segment-941"><a href="#Segment-941"><span class="linenos"> 941</span></a>
</span><span id="Segment-942"><a href="#Segment-942"><span class="linenos"> 942</span></a>        <span class="n">null2</span> <span class="o">=</span> <span class="p">(</span><span class="n">mu2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span>
</span><span id="Segment-943"><a href="#Segment-943"><span class="linenos"> 943</span></a>                 <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">mu2</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">end_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Segment-944"><a href="#Segment-944"><span class="linenos"> 944</span></a>
</span><span id="Segment-945"><a href="#Segment-945"><span class="linenos"> 945</span></a>        <span class="n">ideal_basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">null1</span><span class="p">,</span> <span class="n">null2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Segment-946"><a href="#Segment-946"><span class="linenos"> 946</span></a>
</span><span id="Segment-947"><a href="#Segment-947"><span class="linenos"> 947</span></a>        <span class="k">return</span> <span class="n">ideal_basis</span>
</span><span id="Segment-948"><a href="#Segment-948"><span class="linenos"> 948</span></a>
</span><span id="Segment-949"><a href="#Segment-949"><span class="linenos"> 949</span></a>    <span class="k">def</span> <span class="nf">geodesic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Segment-950"><a href="#Segment-950"><span class="linenos"> 950</span></a>        <span class="sd">&quot;&quot;&quot;Get the bi-infinite geodesic spanned by this segment</span>
</span><span id="Segment-951"><a href="#Segment-951"><span class="linenos"> 951</span></a>
</span><span id="Segment-952"><a href="#Segment-952"><span class="linenos"> 952</span></a><span class="sd">        Returns</span>
</span><span id="Segment-953"><a href="#Segment-953"><span class="linenos"> 953</span></a><span class="sd">        -------</span>
</span><span id="Segment-954"><a href="#Segment-954"><span class="linenos"> 954</span></a><span class="sd">        Geodesic</span>
</span><span id="Segment-955"><a href="#Segment-955"><span class="linenos"> 955</span></a><span class="sd">            Geodesic in hyperbolic space spanned by this segment.</span>
</span><span id="Segment-956"><a href="#Segment-956"><span class="linenos"> 956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Segment-957"><a href="#Segment-957"><span class="linenos"> 957</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span>
</span><span id="Segment-958"><a href="#Segment-958"><span class="linenos"> 958</span></a>
</span><span id="Segment-959"><a href="#Segment-959"><span class="linenos"> 959</span></a>    <span class="k">def</span> <span class="nf">ideal_endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="Segment-960"><a href="#Segment-960"><span class="linenos"> 960</span></a>        <span class="sd">&quot;&quot;&quot;Alias for Subspace.ideal_basis_coords.</span>
</span><span id="Segment-961"><a href="#Segment-961"><span class="linenos"> 961</span></a>
</span><span id="Segment-962"><a href="#Segment-962"><span class="linenos"> 962</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Segment-963"><a href="#Segment-963"><span class="linenos"> 963</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Segment-964"><a href="#Segment-964"><span class="linenos"> 964</span></a>
</span><span id="Segment-965"><a href="#Segment-965"><span class="linenos"> 965</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Segment-966"><a href="#Segment-966"><span class="linenos"> 966</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a circular arc corresponding to this</span>
</span><span id="Segment-967"><a href="#Segment-967"><span class="linenos"> 967</span></a><span class="sd">        segment in the Poincare or halfspace models.</span>
</span><span id="Segment-968"><a href="#Segment-968"><span class="linenos"> 968</span></a>
</span><span id="Segment-969"><a href="#Segment-969"><span class="linenos"> 969</span></a><span class="sd">        Parameters</span>
</span><span id="Segment-970"><a href="#Segment-970"><span class="linenos"> 970</span></a><span class="sd">        ----------</span>
</span><span id="Segment-971"><a href="#Segment-971"><span class="linenos"> 971</span></a><span class="sd">        degrees : bool</span>
</span><span id="Segment-972"><a href="#Segment-972"><span class="linenos"> 972</span></a><span class="sd">            if `True`, return angles in degrees. Otherwise, return</span>
</span><span id="Segment-973"><a href="#Segment-973"><span class="linenos"> 973</span></a><span class="sd">            angles in radians</span>
</span><span id="Segment-974"><a href="#Segment-974"><span class="linenos"> 974</span></a><span class="sd">        model : Model</span>
</span><span id="Segment-975"><a href="#Segment-975"><span class="linenos"> 975</span></a><span class="sd">            hyperbolic model to use for the computation</span>
</span><span id="Segment-976"><a href="#Segment-976"><span class="linenos"> 976</span></a>
</span><span id="Segment-977"><a href="#Segment-977"><span class="linenos"> 977</span></a><span class="sd">        Returns</span>
</span><span id="Segment-978"><a href="#Segment-978"><span class="linenos"> 978</span></a><span class="sd">        -------</span>
</span><span id="Segment-979"><a href="#Segment-979"><span class="linenos"> 979</span></a><span class="sd">        tuple</span>
</span><span id="Segment-980"><a href="#Segment-980"><span class="linenos"> 980</span></a><span class="sd">            tuple `(centers, radii, thetas)`, where `centers`,</span>
</span><span id="Segment-981"><a href="#Segment-981"><span class="linenos"> 981</span></a><span class="sd">            `radii`, and `thetas` are `ndarray`s representing the</span>
</span><span id="Segment-982"><a href="#Segment-982"><span class="linenos"> 982</span></a><span class="sd">            centers, radii, and begin/end angles for the circle</span>
</span><span id="Segment-983"><a href="#Segment-983"><span class="linenos"> 983</span></a><span class="sd">            corresponding to this arc in the given model of hyperbolic</span>
</span><span id="Segment-984"><a href="#Segment-984"><span class="linenos"> 984</span></a><span class="sd">            space. Angles are always specified in counterclockwise</span>
</span><span id="Segment-985"><a href="#Segment-985"><span class="linenos"> 985</span></a><span class="sd">            order.</span>
</span><span id="Segment-986"><a href="#Segment-986"><span class="linenos"> 986</span></a>
</span><span id="Segment-987"><a href="#Segment-987"><span class="linenos"> 987</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Segment-988"><a href="#Segment-988"><span class="linenos"> 988</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Segment-989"><a href="#Segment-989"><span class="linenos"> 989</span></a>
</span><span id="Segment-990"><a href="#Segment-990"><span class="linenos"> 990</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Segment-991"><a href="#Segment-991"><span class="linenos"> 991</span></a>
</span><span id="Segment-992"><a href="#Segment-992"><span class="linenos"> 992</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
</span><span id="Segment-993"><a href="#Segment-993"><span class="linenos"> 993</span></a>
</span><span id="Segment-994"><a href="#Segment-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Segment-995"><a href="#Segment-995"><span class="linenos"> 995</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">short_arc</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Segment-996"><a href="#Segment-996"><span class="linenos"> 996</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Segment-997"><a href="#Segment-997"><span class="linenos"> 997</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Segment-998"><a href="#Segment-998"><span class="linenos"> 998</span></a>
</span><span id="Segment-999"><a href="#Segment-999"><span class="linenos"> 999</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Segment-1000"><a href="#Segment-1000"><span class="linenos">1000</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="Segment-1001"><a href="#Segment-1001"><span class="linenos">1001</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="Segment-1002"><a href="#Segment-1002"><span class="linenos">1002</span></a>
</span><span id="Segment-1003"><a href="#Segment-1003"><span class="linenos">1003</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Model a geodesic segment in hyperbolic space.</p>
</div>


                            <div id="Segment.__init__" class="classattr">
                                        <input id="Segment.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Segment</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">endpoint1</span>, </span><span class="param"><span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Segment.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Segment.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Segment.__init__-851"><a href="#Segment.__init__-851"><span class="linenos">851</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
</span><span id="Segment.__init__-852"><a href="#Segment.__init__-852"><span class="linenos">852</span></a>                 <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Segment.__init__-853"><a href="#Segment.__init__-853"><span class="linenos">853</span></a>
</span><span id="Segment.__init__-854"><a href="#Segment.__init__-854"><span class="linenos">854</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span>
</span><span id="Segment.__init__-855"><a href="#Segment.__init__-855"><span class="linenos">855</span></a>                           <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Segment.__init__-856"><a href="#Segment.__init__-856"><span class="linenos">856</span></a>
</span><span id="Segment.__init__-857"><a href="#Segment.__init__-857"><span class="linenos">857</span></a>        <span class="sd">&quot;&quot;&quot;self.unit_ndims = 2</span>
</span><span id="Segment.__init__-858"><a href="#Segment.__init__-858"><span class="linenos">858</span></a><span class="sd">        self.aux_ndims = 0</span>
</span><span id="Segment.__init__-859"><a href="#Segment.__init__-859"><span class="linenos">859</span></a><span class="sd">        self.dual_ndims = 0</span>
</span><span id="Segment.__init__-860"><a href="#Segment.__init__-860"><span class="linenos">860</span></a>
</span><span id="Segment.__init__-861"><a href="#Segment.__init__-861"><span class="linenos">861</span></a><span class="sd">        if endpoint2 is None:</span>
</span><span id="Segment.__init__-862"><a href="#Segment.__init__-862"><span class="linenos">862</span></a><span class="sd">            try:</span>
</span><span id="Segment.__init__-863"><a href="#Segment.__init__-863"><span class="linenos">863</span></a><span class="sd">                self._construct_from_object(endpoint1, **kwargs)</span>
</span><span id="Segment.__init__-864"><a href="#Segment.__init__-864"><span class="linenos">864</span></a><span class="sd">                return</span>
</span><span id="Segment.__init__-865"><a href="#Segment.__init__-865"><span class="linenos">865</span></a><span class="sd">            except (AttributeError, TypeError, GeometryError):</span>
</span><span id="Segment.__init__-866"><a href="#Segment.__init__-866"><span class="linenos">866</span></a><span class="sd">                pass</span>
</span><span id="Segment.__init__-867"><a href="#Segment.__init__-867"><span class="linenos">867</span></a>
</span><span id="Segment.__init__-868"><a href="#Segment.__init__-868"><span class="linenos">868</span></a><span class="sd">            try:</span>
</span><span id="Segment.__init__-869"><a href="#Segment.__init__-869"><span class="linenos">869</span></a><span class="sd">                self.set(endpoint1, **kwargs)</span>
</span><span id="Segment.__init__-870"><a href="#Segment.__init__-870"><span class="linenos">870</span></a><span class="sd">                return</span>
</span><span id="Segment.__init__-871"><a href="#Segment.__init__-871"><span class="linenos">871</span></a><span class="sd">            except (AttributeError, GeometryError) as e:</span>
</span><span id="Segment.__init__-872"><a href="#Segment.__init__-872"><span class="linenos">872</span></a><span class="sd">                pass</span>
</span><span id="Segment.__init__-873"><a href="#Segment.__init__-873"><span class="linenos">873</span></a>
</span><span id="Segment.__init__-874"><a href="#Segment.__init__-874"><span class="linenos">874</span></a><span class="sd">        self.set_endpoints(endpoint1, endpoint2, **kwargs)</span>
</span><span id="Segment.__init__-875"><a href="#Segment.__init__-875"><span class="linenos">875</span></a>
</span><span id="Segment.__init__-876"><a href="#Segment.__init__-876"><span class="linenos">876</span></a><span class="sd">    def set_endpoints(self, endpoint1, endpoint2=None, **kwargs):</span>
</span><span id="Segment.__init__-877"><a href="#Segment.__init__-877"><span class="linenos">877</span></a><span class="sd">        # reimplemented to also compute ideal endpoints</span>
</span><span id="Segment.__init__-878"><a href="#Segment.__init__-878"><span class="linenos">878</span></a><span class="sd">        if endpoint2 is None:</span>
</span><span id="Segment.__init__-879"><a href="#Segment.__init__-879"><span class="linenos">879</span></a><span class="sd">            self.endpoints = Point(endpoint1).proj_data</span>
</span><span id="Segment.__init__-880"><a href="#Segment.__init__-880"><span class="linenos">880</span></a><span class="sd">            self._compute_ideal_endpoints(endpoint1)</span>
</span><span id="Segment.__init__-881"><a href="#Segment.__init__-881"><span class="linenos">881</span></a><span class="sd">            return</span>
</span><span id="Segment.__init__-882"><a href="#Segment.__init__-882"><span class="linenos">882</span></a>
</span><span id="Segment.__init__-883"><a href="#Segment.__init__-883"><span class="linenos">883</span></a><span class="sd">        pt1 = Point(endpoint1)</span>
</span><span id="Segment.__init__-884"><a href="#Segment.__init__-884"><span class="linenos">884</span></a><span class="sd">        pt2 = Point(endpoint2)</span>
</span><span id="Segment.__init__-885"><a href="#Segment.__init__-885"><span class="linenos">885</span></a><span class="sd">        self.endpoints = Point(np.stack(</span>
</span><span id="Segment.__init__-886"><a href="#Segment.__init__-886"><span class="linenos">886</span></a><span class="sd">            [pt1.proj_data, pt2.proj_data], axis=-2)</span>
</span><span id="Segment.__init__-887"><a href="#Segment.__init__-887"><span class="linenos">887</span></a><span class="sd">        )</span>
</span><span id="Segment.__init__-888"><a href="#Segment.__init__-888"><span class="linenos">888</span></a>
</span><span id="Segment.__init__-889"><a href="#Segment.__init__-889"><span class="linenos">889</span></a><span class="sd">        self._compute_ideal_endpoints(self.endpoints)</span>
</span><span id="Segment.__init__-890"><a href="#Segment.__init__-890"><span class="linenos">890</span></a><span class="sd">        self._set_optional(**kwargs)&quot;&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>If <code>endpoint2</code> is <code>None</code>, interpret <code>endpoint1</code> as either a (2
x...x n) <code>ndarray</code> (where n is the dimension of the underlying
vector space), or else a composite <code><a href="#Point">Point</a></code> object which can be
unpacked into two Points (which may themselves be composite).</p>

<p>If <code>endpoint2</code> is given, then both <code>endpoint1</code> and <code>endpoint2</code>
can be used to construct <code><a href="#Point">Point</a></code> objects, which serve as the
endpoints for this pair of points.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>endpoint1</strong> (Point or ndarray):
One (or both) endpoints of the point pair</li>
<li><strong>endpoint2</strong> (Point or ndarray):
The other endpoint of the point pair. If <code>None</code>,
<code>endpoint1</code> contains the data for both points in the pair.</li>
</ul>
</div>


                            </div>
                            <div id="Segment.ideal_basis" class="classattr">
                                        <input id="Segment.ideal_basis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ideal_basis</span>

                <label class="view-source-button" for="Segment.ideal_basis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Segment.ideal_basis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Segment.ideal_basis-892"><a href="#Segment.ideal_basis-892"><span class="linenos">892</span></a>    <span class="nd">@property</span>
</span><span id="Segment.ideal_basis-893"><a href="#Segment.ideal_basis-893"><span class="linenos">893</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Segment.ideal_basis-894"><a href="#Segment.ideal_basis-894"><span class="linenos">894</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span>
</span></pre></div>


    

                            </div>
                            <div id="Segment.geodesic" class="classattr">
                                        <input id="Segment.geodesic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">geodesic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Segment.geodesic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Segment.geodesic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Segment.geodesic-949"><a href="#Segment.geodesic-949"><span class="linenos">949</span></a>    <span class="k">def</span> <span class="nf">geodesic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Segment.geodesic-950"><a href="#Segment.geodesic-950"><span class="linenos">950</span></a>        <span class="sd">&quot;&quot;&quot;Get the bi-infinite geodesic spanned by this segment</span>
</span><span id="Segment.geodesic-951"><a href="#Segment.geodesic-951"><span class="linenos">951</span></a>
</span><span id="Segment.geodesic-952"><a href="#Segment.geodesic-952"><span class="linenos">952</span></a><span class="sd">        Returns</span>
</span><span id="Segment.geodesic-953"><a href="#Segment.geodesic-953"><span class="linenos">953</span></a><span class="sd">        -------</span>
</span><span id="Segment.geodesic-954"><a href="#Segment.geodesic-954"><span class="linenos">954</span></a><span class="sd">        Geodesic</span>
</span><span id="Segment.geodesic-955"><a href="#Segment.geodesic-955"><span class="linenos">955</span></a><span class="sd">            Geodesic in hyperbolic space spanned by this segment.</span>
</span><span id="Segment.geodesic-956"><a href="#Segment.geodesic-956"><span class="linenos">956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Segment.geodesic-957"><a href="#Segment.geodesic-957"><span class="linenos">957</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the bi-infinite geodesic spanned by this segment</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Geodesic</strong>: Geodesic in hyperbolic space spanned by this segment.</li>
</ul>
</div>


                            </div>
                            <div id="Segment.ideal_endpoint_coords" class="classattr">
                                        <input id="Segment.ideal_endpoint_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ideal_endpoint_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.KLEIN">Model.KLEIN</a></span><span class="p">:</span> <span class="s1">&#39;klein&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Segment.ideal_endpoint_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Segment.ideal_endpoint_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Segment.ideal_endpoint_coords-959"><a href="#Segment.ideal_endpoint_coords-959"><span class="linenos">959</span></a>    <span class="k">def</span> <span class="nf">ideal_endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="Segment.ideal_endpoint_coords-960"><a href="#Segment.ideal_endpoint_coords-960"><span class="linenos">960</span></a>        <span class="sd">&quot;&quot;&quot;Alias for Subspace.ideal_basis_coords.</span>
</span><span id="Segment.ideal_endpoint_coords-961"><a href="#Segment.ideal_endpoint_coords-961"><span class="linenos">961</span></a>
</span><span id="Segment.ideal_endpoint_coords-962"><a href="#Segment.ideal_endpoint_coords-962"><span class="linenos">962</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Segment.ideal_endpoint_coords-963"><a href="#Segment.ideal_endpoint_coords-963"><span class="linenos">963</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ideal_basis_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Alias for <a href="#Subspace.ideal_basis_coords">Subspace.ideal_basis_coords</a>.</p>
</div>


                            </div>
                            <div id="Segment.circle_parameters" class="classattr">
                                        <input id="Segment.circle_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Segment.circle_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Segment.circle_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Segment.circle_parameters-965"><a href="#Segment.circle_parameters-965"><span class="linenos"> 965</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Segment.circle_parameters-966"><a href="#Segment.circle_parameters-966"><span class="linenos"> 966</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters describing a circular arc corresponding to this</span>
</span><span id="Segment.circle_parameters-967"><a href="#Segment.circle_parameters-967"><span class="linenos"> 967</span></a><span class="sd">        segment in the Poincare or halfspace models.</span>
</span><span id="Segment.circle_parameters-968"><a href="#Segment.circle_parameters-968"><span class="linenos"> 968</span></a>
</span><span id="Segment.circle_parameters-969"><a href="#Segment.circle_parameters-969"><span class="linenos"> 969</span></a><span class="sd">        Parameters</span>
</span><span id="Segment.circle_parameters-970"><a href="#Segment.circle_parameters-970"><span class="linenos"> 970</span></a><span class="sd">        ----------</span>
</span><span id="Segment.circle_parameters-971"><a href="#Segment.circle_parameters-971"><span class="linenos"> 971</span></a><span class="sd">        degrees : bool</span>
</span><span id="Segment.circle_parameters-972"><a href="#Segment.circle_parameters-972"><span class="linenos"> 972</span></a><span class="sd">            if `True`, return angles in degrees. Otherwise, return</span>
</span><span id="Segment.circle_parameters-973"><a href="#Segment.circle_parameters-973"><span class="linenos"> 973</span></a><span class="sd">            angles in radians</span>
</span><span id="Segment.circle_parameters-974"><a href="#Segment.circle_parameters-974"><span class="linenos"> 974</span></a><span class="sd">        model : Model</span>
</span><span id="Segment.circle_parameters-975"><a href="#Segment.circle_parameters-975"><span class="linenos"> 975</span></a><span class="sd">            hyperbolic model to use for the computation</span>
</span><span id="Segment.circle_parameters-976"><a href="#Segment.circle_parameters-976"><span class="linenos"> 976</span></a>
</span><span id="Segment.circle_parameters-977"><a href="#Segment.circle_parameters-977"><span class="linenos"> 977</span></a><span class="sd">        Returns</span>
</span><span id="Segment.circle_parameters-978"><a href="#Segment.circle_parameters-978"><span class="linenos"> 978</span></a><span class="sd">        -------</span>
</span><span id="Segment.circle_parameters-979"><a href="#Segment.circle_parameters-979"><span class="linenos"> 979</span></a><span class="sd">        tuple</span>
</span><span id="Segment.circle_parameters-980"><a href="#Segment.circle_parameters-980"><span class="linenos"> 980</span></a><span class="sd">            tuple `(centers, radii, thetas)`, where `centers`,</span>
</span><span id="Segment.circle_parameters-981"><a href="#Segment.circle_parameters-981"><span class="linenos"> 981</span></a><span class="sd">            `radii`, and `thetas` are `ndarray`s representing the</span>
</span><span id="Segment.circle_parameters-982"><a href="#Segment.circle_parameters-982"><span class="linenos"> 982</span></a><span class="sd">            centers, radii, and begin/end angles for the circle</span>
</span><span id="Segment.circle_parameters-983"><a href="#Segment.circle_parameters-983"><span class="linenos"> 983</span></a><span class="sd">            corresponding to this arc in the given model of hyperbolic</span>
</span><span id="Segment.circle_parameters-984"><a href="#Segment.circle_parameters-984"><span class="linenos"> 984</span></a><span class="sd">            space. Angles are always specified in counterclockwise</span>
</span><span id="Segment.circle_parameters-985"><a href="#Segment.circle_parameters-985"><span class="linenos"> 985</span></a><span class="sd">            order.</span>
</span><span id="Segment.circle_parameters-986"><a href="#Segment.circle_parameters-986"><span class="linenos"> 986</span></a>
</span><span id="Segment.circle_parameters-987"><a href="#Segment.circle_parameters-987"><span class="linenos"> 987</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Segment.circle_parameters-988"><a href="#Segment.circle_parameters-988"><span class="linenos"> 988</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Segment.circle_parameters-989"><a href="#Segment.circle_parameters-989"><span class="linenos"> 989</span></a>
</span><span id="Segment.circle_parameters-990"><a href="#Segment.circle_parameters-990"><span class="linenos"> 990</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Segment.circle_parameters-991"><a href="#Segment.circle_parameters-991"><span class="linenos"> 991</span></a>
</span><span id="Segment.circle_parameters-992"><a href="#Segment.circle_parameters-992"><span class="linenos"> 992</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">)</span>
</span><span id="Segment.circle_parameters-993"><a href="#Segment.circle_parameters-993"><span class="linenos"> 993</span></a>
</span><span id="Segment.circle_parameters-994"><a href="#Segment.circle_parameters-994"><span class="linenos"> 994</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Segment.circle_parameters-995"><a href="#Segment.circle_parameters-995"><span class="linenos"> 995</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">short_arc</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Segment.circle_parameters-996"><a href="#Segment.circle_parameters-996"><span class="linenos"> 996</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Segment.circle_parameters-997"><a href="#Segment.circle_parameters-997"><span class="linenos"> 997</span></a>            <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Segment.circle_parameters-998"><a href="#Segment.circle_parameters-998"><span class="linenos"> 998</span></a>
</span><span id="Segment.circle_parameters-999"><a href="#Segment.circle_parameters-999"><span class="linenos"> 999</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="Segment.circle_parameters-1000"><a href="#Segment.circle_parameters-1000"><span class="linenos">1000</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="Segment.circle_parameters-1001"><a href="#Segment.circle_parameters-1001"><span class="linenos">1001</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="Segment.circle_parameters-1002"><a href="#Segment.circle_parameters-1002"><span class="linenos">1002</span></a>
</span><span id="Segment.circle_parameters-1003"><a href="#Segment.circle_parameters-1003"><span class="linenos">1003</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Get parameters describing a circular arc corresponding to this
segment in the Poincare or halfspace models.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>degrees</strong> (bool):
if <code>True</code>, return angles in degrees. Otherwise, return
angles in radians</li>
<li><strong>model</strong> (Model):
hyperbolic model to use for the computation</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>tuple</strong>: tuple <code>(centers, radii, thetas)</code>, where <code>centers</code>,
<code>radii</code>, and <code>thetas</code> are <code>ndarray</code>s representing the
centers, radii, and begin/end angles for the circle
corresponding to this arc in the given model of hyperbolic
space. Angles are always specified in counterclockwise
order.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Geodesic">Geodesic</a></dt>
                                <dd id="Segment.endpoints" class="variable"><a href="#Geodesic.endpoints">endpoints</a></dd>
                <dd id="Segment.from_reflection" class="function"><a href="#Geodesic.from_reflection">from_reflection</a></dd>

            </div>
            <div><dt><a href="#PointPair">PointPair</a></dt>
                                <dd id="Segment.endpoint_coords" class="function"><a href="#PointPair.endpoint_coords">endpoint_coords</a></dd>
                <dd id="Segment.get_endpoints" class="function"><a href="#PointPair.get_endpoints">get_endpoints</a></dd>
                <dd id="Segment.get_end_pair" class="function"><a href="#PointPair.get_end_pair">get_end_pair</a></dd>

            </div>
            <div><dt><a href="#Subspace">Subspace</a></dt>
                                <dd id="Segment.ideal_basis_coords" class="function"><a href="#Subspace.ideal_basis_coords">ideal_basis_coords</a></dd>
                <dd id="Segment.spacelike_complement" class="function"><a href="#Subspace.spacelike_complement">spacelike_complement</a></dd>
                <dd id="Segment.sphere_parameters" class="function"><a href="#Subspace.sphere_parameters">sphere_parameters</a></dd>
                <dd id="Segment.reflection_across" class="function"><a href="#Subspace.reflection_across">reflection_across</a></dd>

            </div>
            <div><dt><a href="#IdealPoint">IdealPoint</a></dt>
                                <dd id="Segment.from_angle" class="function"><a href="#IdealPoint.from_angle">from_angle</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Segment.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="Segment.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="Segment.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="Segment.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="Segment.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="Segment.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="Segment.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="Segment.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="Segment.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="Segment.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="Segment.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Segment.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Segment.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></dt>
                                <dd id="Segment.set_endpoints" class="function"><a href="projective.html#PointPair.set_endpoints">set_endpoints</a></dd>
                <dd id="Segment.endpoint_affine_coords" class="function"><a href="projective.html#PointPair.endpoint_affine_coords">endpoint_affine_coords</a></dd>
                <dd id="Segment.endpoint_projective_coords" class="function"><a href="projective.html#PointPair.endpoint_projective_coords">endpoint_projective_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="Segment.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Segment.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Segment.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Segment.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Segment.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Segment.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Segment.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Segment.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Segment.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Segment.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Segment.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Segment.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Segment.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Hyperplane">
                            <input id="Hyperplane-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Hyperplane</span><wbr>(<span class="base"><a href="#Subspace">Subspace</a></span>):

                <label class="view-source-button" for="Hyperplane-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Hyperplane"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Hyperplane-1006"><a href="#Hyperplane-1006"><span class="linenos">1006</span></a><span class="k">class</span> <span class="nc">Hyperplane</span><span class="p">(</span><span class="n">Subspace</span><span class="p">):</span>
</span><span id="Hyperplane-1007"><a href="#Hyperplane-1007"><span class="linenos">1007</span></a>    <span class="sd">&quot;&quot;&quot;Model for a geodesic hyperplane in hyperbolic space.&quot;&quot;&quot;</span>
</span><span id="Hyperplane-1008"><a href="#Hyperplane-1008"><span class="linenos">1008</span></a>
</span><span id="Hyperplane-1009"><a href="#Hyperplane-1009"><span class="linenos">1009</span></a>    <span class="c1">#TODO: reimplement so ideal_basis is aux_data</span>
</span><span id="Hyperplane-1010"><a href="#Hyperplane-1010"><span class="linenos">1010</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Hyperplane-1011"><a href="#Hyperplane-1011"><span class="linenos">1011</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Hyperplane-1012"><a href="#Hyperplane-1012"><span class="linenos">1012</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Hyperplane-1013"><a href="#Hyperplane-1013"><span class="linenos">1013</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Hyperplane-1014"><a href="#Hyperplane-1014"><span class="linenos">1014</span></a>
</span><span id="Hyperplane-1015"><a href="#Hyperplane-1015"><span class="linenos">1015</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Hyperplane-1016"><a href="#Hyperplane-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Hyperplane-1017"><a href="#Hyperplane-1017"><span class="linenos">1017</span></a>            <span class="k">return</span>
</span><span id="Hyperplane-1018"><a href="#Hyperplane-1018"><span class="linenos">1018</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="Hyperplane-1019"><a href="#Hyperplane-1019"><span class="linenos">1019</span></a>            <span class="k">pass</span>
</span><span id="Hyperplane-1020"><a href="#Hyperplane-1020"><span class="linenos">1020</span></a>
</span><span id="Hyperplane-1021"><a href="#Hyperplane-1021"><span class="linenos">1021</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Hyperplane-1022"><a href="#Hyperplane-1022"><span class="linenos">1022</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Hyperplane-1023"><a href="#Hyperplane-1023"><span class="linenos">1023</span></a>            <span class="k">return</span>
</span><span id="Hyperplane-1024"><a href="#Hyperplane-1024"><span class="linenos">1024</span></a>        <span class="k">except</span> <span class="n">GeometryError</span><span class="p">:</span>
</span><span id="Hyperplane-1025"><a href="#Hyperplane-1025"><span class="linenos">1025</span></a>            <span class="k">pass</span>
</span><span id="Hyperplane-1026"><a href="#Hyperplane-1026"><span class="linenos">1026</span></a>
</span><span id="Hyperplane-1027"><a href="#Hyperplane-1027"><span class="linenos">1027</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ideal_basis</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">)</span>
</span><span id="Hyperplane-1028"><a href="#Hyperplane-1028"><span class="linenos">1028</span></a>
</span><span id="Hyperplane-1029"><a href="#Hyperplane-1029"><span class="linenos">1029</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="Hyperplane-1030"><a href="#Hyperplane-1030"><span class="linenos">1030</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="Hyperplane-1031"><a href="#Hyperplane-1031"><span class="linenos">1031</span></a>
</span><span id="Hyperplane-1032"><a href="#Hyperplane-1032"><span class="linenos">1032</span></a>        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span>
</span><span id="Hyperplane-1033"><a href="#Hyperplane-1033"><span class="linenos">1033</span></a>            <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
</span><span id="Hyperplane-1034"><a href="#Hyperplane-1034"><span class="linenos">1034</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Underlying data for hyperplane in H^n must&quot;</span>
</span><span id="Hyperplane-1035"><a href="#Hyperplane-1035"><span class="linenos">1035</span></a>                                  <span class="s2">&quot; have shape (..., n, n) but data has shape&quot;</span>
</span><span id="Hyperplane-1036"><a href="#Hyperplane-1036"><span class="linenos">1036</span></a>                                  <span class="s2">&quot; </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</span><span id="Hyperplane-1037"><a href="#Hyperplane-1037"><span class="linenos">1037</span></a>
</span><span id="Hyperplane-1038"><a href="#Hyperplane-1038"><span class="linenos">1038</span></a>
</span><span id="Hyperplane-1039"><a href="#Hyperplane-1039"><span class="linenos">1039</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="Hyperplane-1040"><a href="#Hyperplane-1040"><span class="linenos">1040</span></a>            <span class="k">return</span>
</span><span id="Hyperplane-1041"><a href="#Hyperplane-1041"><span class="linenos">1041</span></a>
</span><span id="Hyperplane-1042"><a href="#Hyperplane-1042"><span class="linenos">1042</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">spacelike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="Hyperplane-1043"><a href="#Hyperplane-1043"><span class="linenos">1043</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Hyperplane data at index [..., 0, :]&quot;</span>
</span><span id="Hyperplane-1044"><a href="#Hyperplane-1044"><span class="linenos">1044</span></a>                                  <span class="s2">&quot; must consist of spacelike vectors&quot;</span><span class="p">)</span> <span class="p">)</span>
</span><span id="Hyperplane-1045"><a href="#Hyperplane-1045"><span class="linenos">1045</span></a>
</span><span id="Hyperplane-1046"><a href="#Hyperplane-1046"><span class="linenos">1046</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lightlike</span><span class="p">(</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:])</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="Hyperplane-1047"><a href="#Hyperplane-1047"><span class="linenos">1047</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="p">(</span><span class="s2">&quot;Hyperplane data at index [..., 1, :]&quot;</span>
</span><span id="Hyperplane-1048"><a href="#Hyperplane-1048"><span class="linenos">1048</span></a>                                  <span class="s2">&quot; must consist of lightlike vectors&quot;</span><span class="p">)</span> <span class="p">)</span>
</span><span id="Hyperplane-1049"><a href="#Hyperplane-1049"><span class="linenos">1049</span></a>
</span><span id="Hyperplane-1050"><a href="#Hyperplane-1050"><span class="linenos">1050</span></a>    <span class="k">def</span> <span class="nf">_data_with_dual</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Hyperplane-1051"><a href="#Hyperplane-1051"><span class="linenos">1051</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Hyperplane-1052"><a href="#Hyperplane-1052"><span class="linenos">1052</span></a>
</span><span id="Hyperplane-1053"><a href="#Hyperplane-1053"><span class="linenos">1053</span></a>    <span class="nd">@property</span>
</span><span id="Hyperplane-1054"><a href="#Hyperplane-1054"><span class="linenos">1054</span></a>    <span class="k">def</span> <span class="nf">spacelike_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Hyperplane-1055"><a href="#Hyperplane-1055"><span class="linenos">1055</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Hyperplane-1056"><a href="#Hyperplane-1056"><span class="linenos">1056</span></a>
</span><span id="Hyperplane-1057"><a href="#Hyperplane-1057"><span class="linenos">1057</span></a>    <span class="nd">@property</span>
</span><span id="Hyperplane-1058"><a href="#Hyperplane-1058"><span class="linenos">1058</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Hyperplane-1059"><a href="#Hyperplane-1059"><span class="linenos">1059</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span><span id="Hyperplane-1060"><a href="#Hyperplane-1060"><span class="linenos">1060</span></a>
</span><span id="Hyperplane-1061"><a href="#Hyperplane-1061"><span class="linenos">1061</span></a>    <span class="k">def</span> <span class="nf">_compute_ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vector</span><span class="p">):</span>
</span><span id="Hyperplane-1062"><a href="#Hyperplane-1062"><span class="linenos">1062</span></a>        <span class="n">spacelike_vector</span> <span class="o">=</span> <span class="n">DualPoint</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Hyperplane-1063"><a href="#Hyperplane-1063"><span class="linenos">1063</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">spacelike_vector</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Hyperplane-1064"><a href="#Hyperplane-1064"><span class="linenos">1064</span></a>        <span class="n">transform</span> <span class="o">=</span> <span class="n">spacelike_to</span><span class="p">(</span><span class="n">spacelike_vector</span><span class="p">)</span>
</span><span id="Hyperplane-1065"><a href="#Hyperplane-1065"><span class="linenos">1065</span></a>
</span><span id="Hyperplane-1066"><a href="#Hyperplane-1066"><span class="linenos">1066</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">spacelike_vector</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="Hyperplane-1067"><a href="#Hyperplane-1067"><span class="linenos">1067</span></a>            <span class="n">spacelike_vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">spacelike_vector</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="Hyperplane-1068"><a href="#Hyperplane-1068"><span class="linenos">1068</span></a>
</span><span id="Hyperplane-1069"><a href="#Hyperplane-1069"><span class="linenos">1069</span></a>        <span class="n">standard_ideal_basis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span>
</span><span id="Hyperplane-1070"><a href="#Hyperplane-1070"><span class="linenos">1070</span></a>            <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
</span><span id="Hyperplane-1071"><a href="#Hyperplane-1071"><span class="linenos">1071</span></a>        <span class="p">)</span>
</span><span id="Hyperplane-1072"><a href="#Hyperplane-1072"><span class="linenos">1072</span></a>        <span class="n">standard_ideal_basis</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
</span><span id="Hyperplane-1073"><a href="#Hyperplane-1073"><span class="linenos">1073</span></a>
</span><span id="Hyperplane-1074"><a href="#Hyperplane-1074"><span class="linenos">1074</span></a>
</span><span id="Hyperplane-1075"><a href="#Hyperplane-1075"><span class="linenos">1075</span></a>        <span class="n">ideal_basis</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">standard_ideal_basis</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
</span><span id="Hyperplane-1076"><a href="#Hyperplane-1076"><span class="linenos">1076</span></a>                                      <span class="n">broadcast</span><span class="o">=</span><span class="s2">&quot;pairwise&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Hyperplane-1077"><a href="#Hyperplane-1077"><span class="linenos">1077</span></a>        <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spacelike_vector</span><span class="p">,</span> <span class="n">ideal_basis</span><span class="p">],</span>
</span><span id="Hyperplane-1078"><a href="#Hyperplane-1078"><span class="linenos">1078</span></a>                                  <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Hyperplane-1079"><a href="#Hyperplane-1079"><span class="linenos">1079</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="Hyperplane-1080"><a href="#Hyperplane-1080"><span class="linenos">1080</span></a>
</span><span id="Hyperplane-1081"><a href="#Hyperplane-1081"><span class="linenos">1081</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Hyperplane-1082"><a href="#Hyperplane-1082"><span class="linenos">1082</span></a>    <span class="k">def</span> <span class="nf">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">):</span>
</span><span id="Hyperplane-1083"><a href="#Hyperplane-1083"><span class="linenos">1083</span></a>        <span class="sd">&quot;&quot;&quot;Construct a hyperplane which is the fixpoint set of a reflection.</span>
</span><span id="Hyperplane-1084"><a href="#Hyperplane-1084"><span class="linenos">1084</span></a>
</span><span id="Hyperplane-1085"><a href="#Hyperplane-1085"><span class="linenos">1085</span></a><span class="sd">        Parameters</span>
</span><span id="Hyperplane-1086"><a href="#Hyperplane-1086"><span class="linenos">1086</span></a><span class="sd">        ----------</span>
</span><span id="Hyperplane-1087"><a href="#Hyperplane-1087"><span class="linenos">1087</span></a><span class="sd">        reflection : Isometry or ndarray</span>
</span><span id="Hyperplane-1088"><a href="#Hyperplane-1088"><span class="linenos">1088</span></a><span class="sd">            The reflection to compute the fixed plane for</span>
</span><span id="Hyperplane-1089"><a href="#Hyperplane-1089"><span class="linenos">1089</span></a>
</span><span id="Hyperplane-1090"><a href="#Hyperplane-1090"><span class="linenos">1090</span></a><span class="sd">        Raises</span>
</span><span id="Hyperplane-1091"><a href="#Hyperplane-1091"><span class="linenos">1091</span></a><span class="sd">        ------</span>
</span><span id="Hyperplane-1092"><a href="#Hyperplane-1092"><span class="linenos">1092</span></a><span class="sd">        GeometryError :</span>
</span><span id="Hyperplane-1093"><a href="#Hyperplane-1093"><span class="linenos">1093</span></a><span class="sd">            If the given isometry is not a reflection.</span>
</span><span id="Hyperplane-1094"><a href="#Hyperplane-1094"><span class="linenos">1094</span></a>
</span><span id="Hyperplane-1095"><a href="#Hyperplane-1095"><span class="linenos">1095</span></a><span class="sd">        Returns</span>
</span><span id="Hyperplane-1096"><a href="#Hyperplane-1096"><span class="linenos">1096</span></a><span class="sd">        -------</span>
</span><span id="Hyperplane-1097"><a href="#Hyperplane-1097"><span class="linenos">1097</span></a><span class="sd">        Hyperplane</span>
</span><span id="Hyperplane-1098"><a href="#Hyperplane-1098"><span class="linenos">1098</span></a><span class="sd">            A `Hyperplane` fixed by the given isometry.</span>
</span><span id="Hyperplane-1099"><a href="#Hyperplane-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Hyperplane-1100"><a href="#Hyperplane-1100"><span class="linenos">1100</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Hyperplane-1101"><a href="#Hyperplane-1101"><span class="linenos">1101</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Hyperplane-1102"><a href="#Hyperplane-1102"><span class="linenos">1102</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="Hyperplane-1103"><a href="#Hyperplane-1103"><span class="linenos">1103</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">reflection</span>
</span><span id="Hyperplane-1104"><a href="#Hyperplane-1104"><span class="linenos">1104</span></a>
</span><span id="Hyperplane-1105"><a href="#Hyperplane-1105"><span class="linenos">1105</span></a>        <span class="c1"># TODO: make this compatible with sage</span>
</span><span id="Hyperplane-1106"><a href="#Hyperplane-1106"><span class="linenos">1106</span></a>
</span><span id="Hyperplane-1107"><a href="#Hyperplane-1107"><span class="linenos">1107</span></a>        <span class="c1">#numpy&#39;s eig expects a matrix operating on the left</span>
</span><span id="Hyperplane-1108"><a href="#Hyperplane-1108"><span class="linenos">1108</span></a>        <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="Hyperplane-1109"><a href="#Hyperplane-1109"><span class="linenos">1109</span></a>
</span><span id="Hyperplane-1110"><a href="#Hyperplane-1110"><span class="linenos">1110</span></a>        <span class="n">dimension</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span>
</span><span id="Hyperplane-1111"><a href="#Hyperplane-1111"><span class="linenos">1111</span></a>
</span><span id="Hyperplane-1112"><a href="#Hyperplane-1112"><span class="linenos">1112</span></a>        <span class="c1">#we expect a reflection to have eigenvalues [-1, 1, ...]</span>
</span><span id="Hyperplane-1113"><a href="#Hyperplane-1113"><span class="linenos">1113</span></a>        <span class="n">expected_evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Hyperplane-1114"><a href="#Hyperplane-1114"><span class="linenos">1114</span></a>        <span class="n">expected_evals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
</span><span id="Hyperplane-1115"><a href="#Hyperplane-1115"><span class="linenos">1115</span></a>        <span class="n">eval_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">expected_evals</span>
</span><span id="Hyperplane-1116"><a href="#Hyperplane-1116"><span class="linenos">1116</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eval_differences</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="Hyperplane-1117"><a href="#Hyperplane-1117"><span class="linenos">1117</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Not a reflection matrix&quot;</span><span class="p">)</span>
</span><span id="Hyperplane-1118"><a href="#Hyperplane-1118"><span class="linenos">1118</span></a>
</span><span id="Hyperplane-1119"><a href="#Hyperplane-1119"><span class="linenos">1119</span></a>        <span class="c1">#sometimes eigenvalues will be complex due to roundoff error</span>
</span><span id="Hyperplane-1120"><a href="#Hyperplane-1120"><span class="linenos">1120</span></a>        <span class="c1">#so we cast to reals to avoid warnings.</span>
</span><span id="Hyperplane-1121"><a href="#Hyperplane-1121"><span class="linenos">1121</span></a>        <span class="n">reflected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">evals</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Hyperplane-1122"><a href="#Hyperplane-1122"><span class="linenos">1122</span></a>
</span><span id="Hyperplane-1123"><a href="#Hyperplane-1123"><span class="linenos">1123</span></a>        <span class="c1"># SAGETEST</span>
</span><span id="Hyperplane-1124"><a href="#Hyperplane-1124"><span class="linenos">1124</span></a>        <span class="n">spacelike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span>
</span><span id="Hyperplane-1125"><a href="#Hyperplane-1125"><span class="linenos">1125</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">evecs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">reflected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="Hyperplane-1126"><a href="#Hyperplane-1126"><span class="linenos">1126</span></a>        <span class="p">)</span>
</span><span id="Hyperplane-1127"><a href="#Hyperplane-1127"><span class="linenos">1127</span></a>
</span><span id="Hyperplane-1128"><a href="#Hyperplane-1128"><span class="linenos">1128</span></a>        <span class="k">return</span> <span class="n">Hyperplane</span><span class="p">(</span><span class="n">spacelike</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Model for a geodesic hyperplane in hyperbolic space.</p>
</div>


                            <div id="Hyperplane.__init__" class="classattr">
                                        <input id="Hyperplane.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Hyperplane</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">hyperplane_data</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Hyperplane.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Hyperplane.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Hyperplane.__init__-1010"><a href="#Hyperplane.__init__-1010"><span class="linenos">1010</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Hyperplane.__init__-1011"><a href="#Hyperplane.__init__-1011"><span class="linenos">1011</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Hyperplane.__init__-1012"><a href="#Hyperplane.__init__-1012"><span class="linenos">1012</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Hyperplane.__init__-1013"><a href="#Hyperplane.__init__-1013"><span class="linenos">1013</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Hyperplane.__init__-1014"><a href="#Hyperplane.__init__-1014"><span class="linenos">1014</span></a>
</span><span id="Hyperplane.__init__-1015"><a href="#Hyperplane.__init__-1015"><span class="linenos">1015</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Hyperplane.__init__-1016"><a href="#Hyperplane.__init__-1016"><span class="linenos">1016</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Hyperplane.__init__-1017"><a href="#Hyperplane.__init__-1017"><span class="linenos">1017</span></a>            <span class="k">return</span>
</span><span id="Hyperplane.__init__-1018"><a href="#Hyperplane.__init__-1018"><span class="linenos">1018</span></a>        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="Hyperplane.__init__-1019"><a href="#Hyperplane.__init__-1019"><span class="linenos">1019</span></a>            <span class="k">pass</span>
</span><span id="Hyperplane.__init__-1020"><a href="#Hyperplane.__init__-1020"><span class="linenos">1020</span></a>
</span><span id="Hyperplane.__init__-1021"><a href="#Hyperplane.__init__-1021"><span class="linenos">1021</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Hyperplane.__init__-1022"><a href="#Hyperplane.__init__-1022"><span class="linenos">1022</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Hyperplane.__init__-1023"><a href="#Hyperplane.__init__-1023"><span class="linenos">1023</span></a>            <span class="k">return</span>
</span><span id="Hyperplane.__init__-1024"><a href="#Hyperplane.__init__-1024"><span class="linenos">1024</span></a>        <span class="k">except</span> <span class="n">GeometryError</span><span class="p">:</span>
</span><span id="Hyperplane.__init__-1025"><a href="#Hyperplane.__init__-1025"><span class="linenos">1025</span></a>            <span class="k">pass</span>
</span><span id="Hyperplane.__init__-1026"><a href="#Hyperplane.__init__-1026"><span class="linenos">1026</span></a>
</span><span id="Hyperplane.__init__-1027"><a href="#Hyperplane.__init__-1027"><span class="linenos">1027</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_compute_ideal_basis</span><span class="p">(</span><span class="n">hyperplane_data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (HyperbolicObject or ndarray):
Data used to construct a subspace (or array of
subspaces). If <code>proj_data</code> is a <code><a href="#HyperbolicObject">HyperbolicObject</a></code>, then
use underlying coordinate data to build an array of
subspaces. If <code>proj_data</code> is an <code>ndarray</code>, then interpret
this as coordinate data for an array of subspaces in the
projective model.</li>
</ul>
</div>


                            </div>
                            <div id="Hyperplane.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#Hyperplane.unit_ndims"></a>
    
    

                            </div>
                            <div id="Hyperplane.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#Hyperplane.aux_ndims"></a>
    
    

                            </div>
                            <div id="Hyperplane.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#Hyperplane.dual_ndims"></a>
    
    

                            </div>
                            <div id="Hyperplane.spacelike_vector" class="classattr">
                                        <input id="Hyperplane.spacelike_vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">spacelike_vector</span>

                <label class="view-source-button" for="Hyperplane.spacelike_vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Hyperplane.spacelike_vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Hyperplane.spacelike_vector-1053"><a href="#Hyperplane.spacelike_vector-1053"><span class="linenos">1053</span></a>    <span class="nd">@property</span>
</span><span id="Hyperplane.spacelike_vector-1054"><a href="#Hyperplane.spacelike_vector-1054"><span class="linenos">1054</span></a>    <span class="k">def</span> <span class="nf">spacelike_vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Hyperplane.spacelike_vector-1055"><a href="#Hyperplane.spacelike_vector-1055"><span class="linenos">1055</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="Hyperplane.ideal_basis" class="classattr">
                                        <input id="Hyperplane.ideal_basis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">ideal_basis</span>

                <label class="view-source-button" for="Hyperplane.ideal_basis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Hyperplane.ideal_basis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Hyperplane.ideal_basis-1057"><a href="#Hyperplane.ideal_basis-1057"><span class="linenos">1057</span></a>    <span class="nd">@property</span>
</span><span id="Hyperplane.ideal_basis-1058"><a href="#Hyperplane.ideal_basis-1058"><span class="linenos">1058</span></a>    <span class="k">def</span> <span class="nf">ideal_basis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Hyperplane.ideal_basis-1059"><a href="#Hyperplane.ideal_basis-1059"><span class="linenos">1059</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="Hyperplane.from_reflection" class="classattr">
                                        <input id="Hyperplane.from_reflection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_reflection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">reflection</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Hyperplane.from_reflection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Hyperplane.from_reflection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Hyperplane.from_reflection-1081"><a href="#Hyperplane.from_reflection-1081"><span class="linenos">1081</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Hyperplane.from_reflection-1082"><a href="#Hyperplane.from_reflection-1082"><span class="linenos">1082</span></a>    <span class="k">def</span> <span class="nf">from_reflection</span><span class="p">(</span><span class="n">reflection</span><span class="p">):</span>
</span><span id="Hyperplane.from_reflection-1083"><a href="#Hyperplane.from_reflection-1083"><span class="linenos">1083</span></a>        <span class="sd">&quot;&quot;&quot;Construct a hyperplane which is the fixpoint set of a reflection.</span>
</span><span id="Hyperplane.from_reflection-1084"><a href="#Hyperplane.from_reflection-1084"><span class="linenos">1084</span></a>
</span><span id="Hyperplane.from_reflection-1085"><a href="#Hyperplane.from_reflection-1085"><span class="linenos">1085</span></a><span class="sd">        Parameters</span>
</span><span id="Hyperplane.from_reflection-1086"><a href="#Hyperplane.from_reflection-1086"><span class="linenos">1086</span></a><span class="sd">        ----------</span>
</span><span id="Hyperplane.from_reflection-1087"><a href="#Hyperplane.from_reflection-1087"><span class="linenos">1087</span></a><span class="sd">        reflection : Isometry or ndarray</span>
</span><span id="Hyperplane.from_reflection-1088"><a href="#Hyperplane.from_reflection-1088"><span class="linenos">1088</span></a><span class="sd">            The reflection to compute the fixed plane for</span>
</span><span id="Hyperplane.from_reflection-1089"><a href="#Hyperplane.from_reflection-1089"><span class="linenos">1089</span></a>
</span><span id="Hyperplane.from_reflection-1090"><a href="#Hyperplane.from_reflection-1090"><span class="linenos">1090</span></a><span class="sd">        Raises</span>
</span><span id="Hyperplane.from_reflection-1091"><a href="#Hyperplane.from_reflection-1091"><span class="linenos">1091</span></a><span class="sd">        ------</span>
</span><span id="Hyperplane.from_reflection-1092"><a href="#Hyperplane.from_reflection-1092"><span class="linenos">1092</span></a><span class="sd">        GeometryError :</span>
</span><span id="Hyperplane.from_reflection-1093"><a href="#Hyperplane.from_reflection-1093"><span class="linenos">1093</span></a><span class="sd">            If the given isometry is not a reflection.</span>
</span><span id="Hyperplane.from_reflection-1094"><a href="#Hyperplane.from_reflection-1094"><span class="linenos">1094</span></a>
</span><span id="Hyperplane.from_reflection-1095"><a href="#Hyperplane.from_reflection-1095"><span class="linenos">1095</span></a><span class="sd">        Returns</span>
</span><span id="Hyperplane.from_reflection-1096"><a href="#Hyperplane.from_reflection-1096"><span class="linenos">1096</span></a><span class="sd">        -------</span>
</span><span id="Hyperplane.from_reflection-1097"><a href="#Hyperplane.from_reflection-1097"><span class="linenos">1097</span></a><span class="sd">        Hyperplane</span>
</span><span id="Hyperplane.from_reflection-1098"><a href="#Hyperplane.from_reflection-1098"><span class="linenos">1098</span></a><span class="sd">            A `Hyperplane` fixed by the given isometry.</span>
</span><span id="Hyperplane.from_reflection-1099"><a href="#Hyperplane.from_reflection-1099"><span class="linenos">1099</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Hyperplane.from_reflection-1100"><a href="#Hyperplane.from_reflection-1100"><span class="linenos">1100</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="Hyperplane.from_reflection-1101"><a href="#Hyperplane.from_reflection-1101"><span class="linenos">1101</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Hyperplane.from_reflection-1102"><a href="#Hyperplane.from_reflection-1102"><span class="linenos">1102</span></a>        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
</span><span id="Hyperplane.from_reflection-1103"><a href="#Hyperplane.from_reflection-1103"><span class="linenos">1103</span></a>            <span class="n">matrix</span> <span class="o">=</span> <span class="n">reflection</span>
</span><span id="Hyperplane.from_reflection-1104"><a href="#Hyperplane.from_reflection-1104"><span class="linenos">1104</span></a>
</span><span id="Hyperplane.from_reflection-1105"><a href="#Hyperplane.from_reflection-1105"><span class="linenos">1105</span></a>        <span class="c1"># TODO: make this compatible with sage</span>
</span><span id="Hyperplane.from_reflection-1106"><a href="#Hyperplane.from_reflection-1106"><span class="linenos">1106</span></a>
</span><span id="Hyperplane.from_reflection-1107"><a href="#Hyperplane.from_reflection-1107"><span class="linenos">1107</span></a>        <span class="c1">#numpy&#39;s eig expects a matrix operating on the left</span>
</span><span id="Hyperplane.from_reflection-1108"><a href="#Hyperplane.from_reflection-1108"><span class="linenos">1108</span></a>        <span class="n">evals</span><span class="p">,</span> <span class="n">evecs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
</span><span id="Hyperplane.from_reflection-1109"><a href="#Hyperplane.from_reflection-1109"><span class="linenos">1109</span></a>
</span><span id="Hyperplane.from_reflection-1110"><a href="#Hyperplane.from_reflection-1110"><span class="linenos">1110</span></a>        <span class="n">dimension</span> <span class="o">=</span> <span class="n">reflection</span><span class="o">.</span><span class="n">dimension</span>
</span><span id="Hyperplane.from_reflection-1111"><a href="#Hyperplane.from_reflection-1111"><span class="linenos">1111</span></a>
</span><span id="Hyperplane.from_reflection-1112"><a href="#Hyperplane.from_reflection-1112"><span class="linenos">1112</span></a>        <span class="c1">#we expect a reflection to have eigenvalues [-1, 1, ...]</span>
</span><span id="Hyperplane.from_reflection-1113"><a href="#Hyperplane.from_reflection-1113"><span class="linenos">1113</span></a>        <span class="n">expected_evals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Hyperplane.from_reflection-1114"><a href="#Hyperplane.from_reflection-1114"><span class="linenos">1114</span></a>        <span class="n">expected_evals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
</span><span id="Hyperplane.from_reflection-1115"><a href="#Hyperplane.from_reflection-1115"><span class="linenos">1115</span></a>        <span class="n">eval_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">evals</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">expected_evals</span>
</span><span id="Hyperplane.from_reflection-1116"><a href="#Hyperplane.from_reflection-1116"><span class="linenos">1116</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eval_differences</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="Hyperplane.from_reflection-1117"><a href="#Hyperplane.from_reflection-1117"><span class="linenos">1117</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;Not a reflection matrix&quot;</span><span class="p">)</span>
</span><span id="Hyperplane.from_reflection-1118"><a href="#Hyperplane.from_reflection-1118"><span class="linenos">1118</span></a>
</span><span id="Hyperplane.from_reflection-1119"><a href="#Hyperplane.from_reflection-1119"><span class="linenos">1119</span></a>        <span class="c1">#sometimes eigenvalues will be complex due to roundoff error</span>
</span><span id="Hyperplane.from_reflection-1120"><a href="#Hyperplane.from_reflection-1120"><span class="linenos">1120</span></a>        <span class="c1">#so we cast to reals to avoid warnings.</span>
</span><span id="Hyperplane.from_reflection-1121"><a href="#Hyperplane.from_reflection-1121"><span class="linenos">1121</span></a>        <span class="n">reflected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">evals</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Hyperplane.from_reflection-1122"><a href="#Hyperplane.from_reflection-1122"><span class="linenos">1122</span></a>
</span><span id="Hyperplane.from_reflection-1123"><a href="#Hyperplane.from_reflection-1123"><span class="linenos">1123</span></a>        <span class="c1"># SAGETEST</span>
</span><span id="Hyperplane.from_reflection-1124"><a href="#Hyperplane.from_reflection-1124"><span class="linenos">1124</span></a>        <span class="n">spacelike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span>
</span><span id="Hyperplane.from_reflection-1125"><a href="#Hyperplane.from_reflection-1125"><span class="linenos">1125</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">evecs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">reflected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span>
</span><span id="Hyperplane.from_reflection-1126"><a href="#Hyperplane.from_reflection-1126"><span class="linenos">1126</span></a>        <span class="p">)</span>
</span><span id="Hyperplane.from_reflection-1127"><a href="#Hyperplane.from_reflection-1127"><span class="linenos">1127</span></a>
</span><span id="Hyperplane.from_reflection-1128"><a href="#Hyperplane.from_reflection-1128"><span class="linenos">1128</span></a>        <span class="k">return</span> <span class="n">Hyperplane</span><span class="p">(</span><span class="n">spacelike</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Construct a hyperplane which is the fixpoint set of a reflection.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>reflection</strong> (Isometry or ndarray):
The reflection to compute the fixed plane for</li>
</ul>

<h6 id="raises">Raises</h6>

<ul>
<li><strong>GeometryError :</strong>: If the given isometry is not a reflection.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Hyperplane</strong>: A <code><a href="#Hyperplane">Hyperplane</a></code> fixed by the given isometry.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Subspace">Subspace</a></dt>
                                <dd id="Hyperplane.ideal_basis_coords" class="function"><a href="#Subspace.ideal_basis_coords">ideal_basis_coords</a></dd>
                <dd id="Hyperplane.spacelike_complement" class="function"><a href="#Subspace.spacelike_complement">spacelike_complement</a></dd>
                <dd id="Hyperplane.sphere_parameters" class="function"><a href="#Subspace.sphere_parameters">sphere_parameters</a></dd>
                <dd id="Hyperplane.reflection_across" class="function"><a href="#Subspace.reflection_across">reflection_across</a></dd>

            </div>
            <div><dt><a href="#IdealPoint">IdealPoint</a></dt>
                                <dd id="Hyperplane.from_angle" class="function"><a href="#IdealPoint.from_angle">from_angle</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Hyperplane.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="Hyperplane.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="Hyperplane.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="Hyperplane.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="Hyperplane.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="Hyperplane.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="Hyperplane.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="Hyperplane.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Hyperplane.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Hyperplane.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="Hyperplane.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Hyperplane.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Hyperplane.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Hyperplane.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Hyperplane.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Hyperplane.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Hyperplane.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Hyperplane.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Hyperplane.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Hyperplane.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Hyperplane.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Hyperplane.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Hyperplane.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="TangentVector">
                            <input id="TangentVector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">TangentVector</span><wbr>(<span class="base"><a href="#PointPair">PointPair</a></span>):

                <label class="view-source-button" for="TangentVector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector-1130"><a href="#TangentVector-1130"><span class="linenos">1130</span></a><span class="k">class</span> <span class="nc">TangentVector</span><span class="p">(</span><span class="n">PointPair</span><span class="p">):</span>
</span><span id="TangentVector-1131"><a href="#TangentVector-1131"><span class="linenos">1131</span></a>    <span class="sd">&quot;&quot;&quot;Model for a tangent vector in hyperbolic space.&quot;&quot;&quot;</span>
</span><span id="TangentVector-1132"><a href="#TangentVector-1132"><span class="linenos">1132</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">,</span> <span class="n">vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TangentVector-1133"><a href="#TangentVector-1133"><span class="linenos">1133</span></a>                 <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TangentVector-1134"><a href="#TangentVector-1134"><span class="linenos">1134</span></a>        <span class="sd">&quot;&quot;&quot;If `vector` is `None`, interpret `point_data` as either an ndarray</span>
</span><span id="TangentVector-1135"><a href="#TangentVector-1135"><span class="linenos">1135</span></a><span class="sd">        of shape `(..., 2, n)` (where `n` is the dimension of the</span>
</span><span id="TangentVector-1136"><a href="#TangentVector-1136"><span class="linenos">1136</span></a><span class="sd">        underlying vector space), or else a composite HyperbolicObject</span>
</span><span id="TangentVector-1137"><a href="#TangentVector-1137"><span class="linenos">1137</span></a><span class="sd">        whose data can be unpacked into a point in projective space</span>
</span><span id="TangentVector-1138"><a href="#TangentVector-1138"><span class="linenos">1138</span></a><span class="sd">        and a tangent vector to a hyperboloid.</span>
</span><span id="TangentVector-1139"><a href="#TangentVector-1139"><span class="linenos">1139</span></a>
</span><span id="TangentVector-1140"><a href="#TangentVector-1140"><span class="linenos">1140</span></a><span class="sd">        If `vector` is given, then `point_data` is used to construct</span>
</span><span id="TangentVector-1141"><a href="#TangentVector-1141"><span class="linenos">1141</span></a><span class="sd">        the basepoint for this tangent vector, and `vector` is used to</span>
</span><span id="TangentVector-1142"><a href="#TangentVector-1142"><span class="linenos">1142</span></a><span class="sd">        construct the tangent vector to the hyperboloid.</span>
</span><span id="TangentVector-1143"><a href="#TangentVector-1143"><span class="linenos">1143</span></a>
</span><span id="TangentVector-1144"><a href="#TangentVector-1144"><span class="linenos">1144</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector-1145"><a href="#TangentVector-1145"><span class="linenos">1145</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector-1146"><a href="#TangentVector-1146"><span class="linenos">1146</span></a><span class="sd">        point_data : Point or ndarray</span>
</span><span id="TangentVector-1147"><a href="#TangentVector-1147"><span class="linenos">1147</span></a><span class="sd">            The basepoint of the tangent vector, or (if `vector` is</span>
</span><span id="TangentVector-1148"><a href="#TangentVector-1148"><span class="linenos">1148</span></a><span class="sd">            `None`) the data of the basepoint and the tangent vector.</span>
</span><span id="TangentVector-1149"><a href="#TangentVector-1149"><span class="linenos">1149</span></a><span class="sd">        vector : HyperbolicObject or ndarray</span>
</span><span id="TangentVector-1150"><a href="#TangentVector-1150"><span class="linenos">1150</span></a><span class="sd">            The tangent vector data. If `None`, `point_data` contains</span>
</span><span id="TangentVector-1151"><a href="#TangentVector-1151"><span class="linenos">1151</span></a><span class="sd">            the data for the basepoint and the tangent vector.</span>
</span><span id="TangentVector-1152"><a href="#TangentVector-1152"><span class="linenos">1152</span></a>
</span><span id="TangentVector-1153"><a href="#TangentVector-1153"><span class="linenos">1153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector-1154"><a href="#TangentVector-1154"><span class="linenos">1154</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span>
</span><span id="TangentVector-1155"><a href="#TangentVector-1155"><span class="linenos">1155</span></a>                           <span class="n">unit_ndims</span><span class="o">=</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="TangentVector-1156"><a href="#TangentVector-1156"><span class="linenos">1156</span></a>                           <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="TangentVector-1157"><a href="#TangentVector-1157"><span class="linenos">1157</span></a>                           <span class="n">dual_ndims</span><span class="o">=</span><span class="n">dual_ndims</span><span class="p">,</span>
</span><span id="TangentVector-1158"><a href="#TangentVector-1158"><span class="linenos">1158</span></a>                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector-1159"><a href="#TangentVector-1159"><span class="linenos">1159</span></a>
</span><span id="TangentVector-1160"><a href="#TangentVector-1160"><span class="linenos">1160</span></a>    <span class="k">def</span> <span class="nf">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="TangentVector-1161"><a href="#TangentVector-1161"><span class="linenos">1161</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="n">_assert_geometry_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">)</span>
</span><span id="TangentVector-1162"><a href="#TangentVector-1162"><span class="linenos">1162</span></a>
</span><span id="TangentVector-1163"><a href="#TangentVector-1163"><span class="linenos">1163</span></a>        <span class="k">if</span> <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="TangentVector-1164"><a href="#TangentVector-1164"><span class="linenos">1164</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="TangentVector-1165"><a href="#TangentVector-1165"><span class="linenos">1165</span></a>                <span class="p">(</span><span class="s2">&quot;Underlying data for a tangent vector in Hn must have shape&quot;</span>
</span><span id="TangentVector-1166"><a href="#TangentVector-1166"><span class="linenos">1166</span></a>                 <span class="s2">&quot; (..., 2, n) but data has shape </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="TangentVector-1167"><a href="#TangentVector-1167"><span class="linenos">1167</span></a>                     <span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="TangentVector-1168"><a href="#TangentVector-1168"><span class="linenos">1168</span></a>            <span class="p">)</span>
</span><span id="TangentVector-1169"><a href="#TangentVector-1169"><span class="linenos">1169</span></a>
</span><span id="TangentVector-1170"><a href="#TangentVector-1170"><span class="linenos">1170</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">CHECK_LIGHT_CONE</span><span class="p">:</span>
</span><span id="TangentVector-1171"><a href="#TangentVector-1171"><span class="linenos">1171</span></a>            <span class="k">return</span>
</span><span id="TangentVector-1172"><a href="#TangentVector-1172"><span class="linenos">1172</span></a>
</span><span id="TangentVector-1173"><a href="#TangentVector-1173"><span class="linenos">1173</span></a>        <span class="n">point_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="TangentVector-1174"><a href="#TangentVector-1174"><span class="linenos">1174</span></a>        <span class="n">vector_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="TangentVector-1175"><a href="#TangentVector-1175"><span class="linenos">1175</span></a>
</span><span id="TangentVector-1176"><a href="#TangentVector-1176"><span class="linenos">1176</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">timelike</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="TangentVector-1177"><a href="#TangentVector-1177"><span class="linenos">1177</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;tangent vector data at index [..., 0, :] must&quot;</span>
</span><span id="TangentVector-1178"><a href="#TangentVector-1178"><span class="linenos">1178</span></a>                                <span class="s2">&quot; consist of timelike vectors&quot;</span><span class="p">)</span>
</span><span id="TangentVector-1179"><a href="#TangentVector-1179"><span class="linenos">1179</span></a>
</span><span id="TangentVector-1180"><a href="#TangentVector-1180"><span class="linenos">1180</span></a>        <span class="n">products</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">point_data</span><span class="p">,</span> <span class="n">vector_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector-1181"><a href="#TangentVector-1181"><span class="linenos">1181</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">products</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
</span><span id="TangentVector-1182"><a href="#TangentVector-1182"><span class="linenos">1182</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span><span class="s2">&quot;tangent vector must be orthogonal to point&quot;</span><span class="p">)</span>
</span><span id="TangentVector-1183"><a href="#TangentVector-1183"><span class="linenos">1183</span></a>
</span><span id="TangentVector-1184"><a href="#TangentVector-1184"><span class="linenos">1184</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="TangentVector-1185"><a href="#TangentVector-1185"><span class="linenos">1185</span></a>        <span class="n">point_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="TangentVector-1186"><a href="#TangentVector-1186"><span class="linenos">1186</span></a>        <span class="n">vec_data</span> <span class="o">=</span> <span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="TangentVector-1187"><a href="#TangentVector-1187"><span class="linenos">1187</span></a>
</span><span id="TangentVector-1188"><a href="#TangentVector-1188"><span class="linenos">1188</span></a>        <span class="c1"># _compute_aux_data doesn&#39;t assume that proj_data has already</span>
</span><span id="TangentVector-1189"><a href="#TangentVector-1189"><span class="linenos">1189</span></a>        <span class="c1"># been set, so we don&#39;t refer to self.minkowski here</span>
</span><span id="TangentVector-1190"><a href="#TangentVector-1190"><span class="linenos">1190</span></a>        <span class="n">base_ring</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">guess_literal_ring</span><span class="p">(</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="TangentVector-1191"><a href="#TangentVector-1191"><span class="linenos">1191</span></a>
</span><span id="TangentVector-1192"><a href="#TangentVector-1192"><span class="linenos">1192</span></a>        <span class="n">projected</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span>
</span><span id="TangentVector-1193"><a href="#TangentVector-1193"><span class="linenos">1193</span></a>            <span class="n">point_data</span><span class="p">,</span> <span class="n">vec_data</span><span class="p">,</span>
</span><span id="TangentVector-1194"><a href="#TangentVector-1194"><span class="linenos">1194</span></a>            <span class="n">minkowski</span><span class="p">(</span><span class="n">point_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">base_ring</span><span class="p">)</span>
</span><span id="TangentVector-1195"><a href="#TangentVector-1195"><span class="linenos">1195</span></a>        <span class="p">)</span>
</span><span id="TangentVector-1196"><a href="#TangentVector-1196"><span class="linenos">1196</span></a>
</span><span id="TangentVector-1197"><a href="#TangentVector-1197"><span class="linenos">1197</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">point_data</span><span class="p">,</span> <span class="n">projected</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="TangentVector-1198"><a href="#TangentVector-1198"><span class="linenos">1198</span></a>
</span><span id="TangentVector-1199"><a href="#TangentVector-1199"><span class="linenos">1199</span></a>    <span class="nd">@property</span>
</span><span id="TangentVector-1200"><a href="#TangentVector-1200"><span class="linenos">1200</span></a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TangentVector-1201"><a href="#TangentVector-1201"><span class="linenos">1201</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="TangentVector-1202"><a href="#TangentVector-1202"><span class="linenos">1202</span></a>
</span><span id="TangentVector-1203"><a href="#TangentVector-1203"><span class="linenos">1203</span></a>    <span class="nd">@property</span>
</span><span id="TangentVector-1204"><a href="#TangentVector-1204"><span class="linenos">1204</span></a>    <span class="k">def</span> <span class="nf">vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TangentVector-1205"><a href="#TangentVector-1205"><span class="linenos">1205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="TangentVector-1206"><a href="#TangentVector-1206"><span class="linenos">1206</span></a>
</span><span id="TangentVector-1207"><a href="#TangentVector-1207"><span class="linenos">1207</span></a>    <span class="k">def</span> <span class="nf">normalized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TangentVector-1208"><a href="#TangentVector-1208"><span class="linenos">1208</span></a>        <span class="sd">&quot;&quot;&quot;Get a unit tangent vector in the same direction as this tangent</span>
</span><span id="TangentVector-1209"><a href="#TangentVector-1209"><span class="linenos">1209</span></a><span class="sd">        vector.</span>
</span><span id="TangentVector-1210"><a href="#TangentVector-1210"><span class="linenos">1210</span></a>
</span><span id="TangentVector-1211"><a href="#TangentVector-1211"><span class="linenos">1211</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector-1212"><a href="#TangentVector-1212"><span class="linenos">1212</span></a><span class="sd">        -------</span>
</span><span id="TangentVector-1213"><a href="#TangentVector-1213"><span class="linenos">1213</span></a><span class="sd">        TangentVector</span>
</span><span id="TangentVector-1214"><a href="#TangentVector-1214"><span class="linenos">1214</span></a><span class="sd">            Normalized version of this tangent vector (with respect to</span>
</span><span id="TangentVector-1215"><a href="#TangentVector-1215"><span class="linenos">1215</span></a><span class="sd">            the standard Minkowski inner product)</span>
</span><span id="TangentVector-1216"><a href="#TangentVector-1216"><span class="linenos">1216</span></a>
</span><span id="TangentVector-1217"><a href="#TangentVector-1217"><span class="linenos">1217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector-1218"><a href="#TangentVector-1218"><span class="linenos">1218</span></a>        <span class="n">normed_vec</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector-1219"><a href="#TangentVector-1219"><span class="linenos">1219</span></a>
</span><span id="TangentVector-1220"><a href="#TangentVector-1220"><span class="linenos">1220</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">normed_vec</span><span class="p">)</span>
</span><span id="TangentVector-1221"><a href="#TangentVector-1221"><span class="linenos">1221</span></a>
</span><span id="TangentVector-1222"><a href="#TangentVector-1222"><span class="linenos">1222</span></a>    <span class="k">def</span> <span class="nf">origin_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TangentVector-1223"><a href="#TangentVector-1223"><span class="linenos">1223</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking the &quot;origin&quot; to this vector.</span>
</span><span id="TangentVector-1224"><a href="#TangentVector-1224"><span class="linenos">1224</span></a>
</span><span id="TangentVector-1225"><a href="#TangentVector-1225"><span class="linenos">1225</span></a><span class="sd">        The &quot;origin&quot; is a tangent vector whose basepoint lies at (0,</span>
</span><span id="TangentVector-1226"><a href="#TangentVector-1226"><span class="linenos">1226</span></a><span class="sd">        0, ....) in Poincare or Kleinian coordinates, and whose</span>
</span><span id="TangentVector-1227"><a href="#TangentVector-1227"><span class="linenos">1227</span></a><span class="sd">        tangent vector is parallel to the second standard basis</span>
</span><span id="TangentVector-1228"><a href="#TangentVector-1228"><span class="linenos">1228</span></a><span class="sd">        vector.</span>
</span><span id="TangentVector-1229"><a href="#TangentVector-1229"><span class="linenos">1229</span></a>
</span><span id="TangentVector-1230"><a href="#TangentVector-1230"><span class="linenos">1230</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector-1231"><a href="#TangentVector-1231"><span class="linenos">1231</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector-1232"><a href="#TangentVector-1232"><span class="linenos">1232</span></a><span class="sd">        force_oriented : bool</span>
</span><span id="TangentVector-1233"><a href="#TangentVector-1233"><span class="linenos">1233</span></a><span class="sd">            If `True`, force the computed isometry to be</span>
</span><span id="TangentVector-1234"><a href="#TangentVector-1234"><span class="linenos">1234</span></a><span class="sd">            orientation-preserving</span>
</span><span id="TangentVector-1235"><a href="#TangentVector-1235"><span class="linenos">1235</span></a>
</span><span id="TangentVector-1236"><a href="#TangentVector-1236"><span class="linenos">1236</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector-1237"><a href="#TangentVector-1237"><span class="linenos">1237</span></a><span class="sd">        -------</span>
</span><span id="TangentVector-1238"><a href="#TangentVector-1238"><span class="linenos">1238</span></a><span class="sd">        Isometry</span>
</span><span id="TangentVector-1239"><a href="#TangentVector-1239"><span class="linenos">1239</span></a><span class="sd">            Isometry taking the &quot;origin&quot; to this tangent vector.</span>
</span><span id="TangentVector-1240"><a href="#TangentVector-1240"><span class="linenos">1240</span></a>
</span><span id="TangentVector-1241"><a href="#TangentVector-1241"><span class="linenos">1241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector-1242"><a href="#TangentVector-1242"><span class="linenos">1242</span></a>        <span class="n">normed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector-1243"><a href="#TangentVector-1243"><span class="linenos">1243</span></a>        <span class="n">isom</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span>
</span><span id="TangentVector-1244"><a href="#TangentVector-1244"><span class="linenos">1244</span></a>                                   <span class="n">force_oriented</span><span class="p">)</span>
</span><span id="TangentVector-1245"><a href="#TangentVector-1245"><span class="linenos">1245</span></a>
</span><span id="TangentVector-1246"><a href="#TangentVector-1246"><span class="linenos">1246</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">isom</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="TangentVector-1247"><a href="#TangentVector-1247"><span class="linenos">1247</span></a>
</span><span id="TangentVector-1248"><a href="#TangentVector-1248"><span class="linenos">1248</span></a>    <span class="k">def</span> <span class="nf">isometry_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TangentVector-1249"><a href="#TangentVector-1249"><span class="linenos">1249</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking this tangent vector to a scalar multiple of</span>
</span><span id="TangentVector-1250"><a href="#TangentVector-1250"><span class="linenos">1250</span></a><span class="sd">        the other.</span>
</span><span id="TangentVector-1251"><a href="#TangentVector-1251"><span class="linenos">1251</span></a>
</span><span id="TangentVector-1252"><a href="#TangentVector-1252"><span class="linenos">1252</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector-1253"><a href="#TangentVector-1253"><span class="linenos">1253</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector-1254"><a href="#TangentVector-1254"><span class="linenos">1254</span></a><span class="sd">        other : TangentVector</span>
</span><span id="TangentVector-1255"><a href="#TangentVector-1255"><span class="linenos">1255</span></a><span class="sd">            Tangent vector to translate this vector to</span>
</span><span id="TangentVector-1256"><a href="#TangentVector-1256"><span class="linenos">1256</span></a><span class="sd">        force_oriented : bool</span>
</span><span id="TangentVector-1257"><a href="#TangentVector-1257"><span class="linenos">1257</span></a><span class="sd">            If `True`, force the computed isometry to be</span>
</span><span id="TangentVector-1258"><a href="#TangentVector-1258"><span class="linenos">1258</span></a><span class="sd">            orientation-preserving.</span>
</span><span id="TangentVector-1259"><a href="#TangentVector-1259"><span class="linenos">1259</span></a>
</span><span id="TangentVector-1260"><a href="#TangentVector-1260"><span class="linenos">1260</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector-1261"><a href="#TangentVector-1261"><span class="linenos">1261</span></a><span class="sd">        -------</span>
</span><span id="TangentVector-1262"><a href="#TangentVector-1262"><span class="linenos">1262</span></a><span class="sd">        Isometry</span>
</span><span id="TangentVector-1263"><a href="#TangentVector-1263"><span class="linenos">1263</span></a><span class="sd">            Isometry this tangent vector to `other`.</span>
</span><span id="TangentVector-1264"><a href="#TangentVector-1264"><span class="linenos">1264</span></a>
</span><span id="TangentVector-1265"><a href="#TangentVector-1265"><span class="linenos">1265</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TangentVector-1266"><a href="#TangentVector-1266"><span class="linenos">1266</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">origin_to</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_to</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="TangentVector-1267"><a href="#TangentVector-1267"><span class="linenos">1267</span></a>
</span><span id="TangentVector-1268"><a href="#TangentVector-1268"><span class="linenos">1268</span></a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="TangentVector-1269"><a href="#TangentVector-1269"><span class="linenos">1269</span></a>        <span class="sd">&quot;&quot;&quot;Compute the angle between two tangent vectors.</span>
</span><span id="TangentVector-1270"><a href="#TangentVector-1270"><span class="linenos">1270</span></a>
</span><span id="TangentVector-1271"><a href="#TangentVector-1271"><span class="linenos">1271</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector-1272"><a href="#TangentVector-1272"><span class="linenos">1272</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector-1273"><a href="#TangentVector-1273"><span class="linenos">1273</span></a><span class="sd">        other : TangentVector</span>
</span><span id="TangentVector-1274"><a href="#TangentVector-1274"><span class="linenos">1274</span></a>
</span><span id="TangentVector-1275"><a href="#TangentVector-1275"><span class="linenos">1275</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector-1276"><a href="#TangentVector-1276"><span class="linenos">1276</span></a><span class="sd">        -------</span>
</span><span id="TangentVector-1277"><a href="#TangentVector-1277"><span class="linenos">1277</span></a><span class="sd">        float or ndarray</span>
</span><span id="TangentVector-1278"><a href="#TangentVector-1278"><span class="linenos">1278</span></a><span class="sd">            The angle between `self` and `other`.</span>
</span><span id="TangentVector-1279"><a href="#TangentVector-1279"><span class="linenos">1279</span></a>
</span><span id="TangentVector-1280"><a href="#TangentVector-1280"><span class="linenos">1280</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector-1281"><a href="#TangentVector-1281"><span class="linenos">1281</span></a>        <span class="n">v1</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
</span><span id="TangentVector-1282"><a href="#TangentVector-1282"><span class="linenos">1282</span></a>        <span class="n">v2</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
</span><span id="TangentVector-1283"><a href="#TangentVector-1283"><span class="linenos">1283</span></a>
</span><span id="TangentVector-1284"><a href="#TangentVector-1284"><span class="linenos">1284</span></a>        <span class="n">product</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector-1285"><a href="#TangentVector-1285"><span class="linenos">1285</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span><span id="TangentVector-1286"><a href="#TangentVector-1286"><span class="linenos">1286</span></a>
</span><span id="TangentVector-1287"><a href="#TangentVector-1287"><span class="linenos">1287</span></a>    <span class="k">def</span> <span class="nf">point_along</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
</span><span id="TangentVector-1288"><a href="#TangentVector-1288"><span class="linenos">1288</span></a>        <span class="sd">&quot;&quot;&quot;Get a point in hyperbolic space along the geodesic specified by</span>
</span><span id="TangentVector-1289"><a href="#TangentVector-1289"><span class="linenos">1289</span></a><span class="sd">        this tangent vector.</span>
</span><span id="TangentVector-1290"><a href="#TangentVector-1290"><span class="linenos">1290</span></a>
</span><span id="TangentVector-1291"><a href="#TangentVector-1291"><span class="linenos">1291</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector-1292"><a href="#TangentVector-1292"><span class="linenos">1292</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector-1293"><a href="#TangentVector-1293"><span class="linenos">1293</span></a><span class="sd">        distance : float or ndarray</span>
</span><span id="TangentVector-1294"><a href="#TangentVector-1294"><span class="linenos">1294</span></a>
</span><span id="TangentVector-1295"><a href="#TangentVector-1295"><span class="linenos">1295</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector-1296"><a href="#TangentVector-1296"><span class="linenos">1296</span></a><span class="sd">        -------</span>
</span><span id="TangentVector-1297"><a href="#TangentVector-1297"><span class="linenos">1297</span></a><span class="sd">        Point</span>
</span><span id="TangentVector-1298"><a href="#TangentVector-1298"><span class="linenos">1298</span></a><span class="sd">            Point in hyperbolic space along the geodesic ray defined</span>
</span><span id="TangentVector-1299"><a href="#TangentVector-1299"><span class="linenos">1299</span></a><span class="sd">            by this tangent vector</span>
</span><span id="TangentVector-1300"><a href="#TangentVector-1300"><span class="linenos">1300</span></a>
</span><span id="TangentVector-1301"><a href="#TangentVector-1301"><span class="linenos">1301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector-1302"><a href="#TangentVector-1302"><span class="linenos">1302</span></a>        <span class="n">kleinian_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="TangentVector-1303"><a href="#TangentVector-1303"><span class="linenos">1303</span></a>        <span class="n">kleinian_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="TangentVector-1304"><a href="#TangentVector-1304"><span class="linenos">1304</span></a>
</span><span id="TangentVector-1305"><a href="#TangentVector-1305"><span class="linenos">1305</span></a>        <span class="n">kleinian_pt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">kleinian_shape</span><span class="p">,</span>
</span><span id="TangentVector-1306"><a href="#TangentVector-1306"><span class="linenos">1306</span></a>                                  <span class="n">like</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="TangentVector-1307"><a href="#TangentVector-1307"><span class="linenos">1307</span></a>
</span><span id="TangentVector-1308"><a href="#TangentVector-1308"><span class="linenos">1308</span></a>        <span class="n">kleinian_pt</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">hyp_to_affine_dist</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
</span><span id="TangentVector-1309"><a href="#TangentVector-1309"><span class="linenos">1309</span></a>
</span><span id="TangentVector-1310"><a href="#TangentVector-1310"><span class="linenos">1310</span></a>        <span class="n">basepoint</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">kleinian_pt</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="TangentVector-1311"><a href="#TangentVector-1311"><span class="linenos">1311</span></a>
</span><span id="TangentVector-1312"><a href="#TangentVector-1312"><span class="linenos">1312</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_to</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">basepoint</span><span class="p">,</span> <span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span><span id="TangentVector-1313"><a href="#TangentVector-1313"><span class="linenos">1313</span></a>
</span><span id="TangentVector-1314"><a href="#TangentVector-1314"><span class="linenos">1314</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TangentVector-1315"><a href="#TangentVector-1315"><span class="linenos">1315</span></a>    <span class="k">def</span> <span class="nf">get_base_tangent</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TangentVector-1316"><a href="#TangentVector-1316"><span class="linenos">1316</span></a>        <span class="sd">&quot;&quot;&quot;Get an &quot;origin&quot; tangent vector.</span>
</span><span id="TangentVector-1317"><a href="#TangentVector-1317"><span class="linenos">1317</span></a>
</span><span id="TangentVector-1318"><a href="#TangentVector-1318"><span class="linenos">1318</span></a><span class="sd">        The basepoint of this tangent vector has coordinates (0, 0,</span>
</span><span id="TangentVector-1319"><a href="#TangentVector-1319"><span class="linenos">1319</span></a><span class="sd">        ...) in Poincare/Klein coordinates, and the vector is parallel</span>
</span><span id="TangentVector-1320"><a href="#TangentVector-1320"><span class="linenos">1320</span></a><span class="sd">        to the second standard basis vector in R^(n,1).</span>
</span><span id="TangentVector-1321"><a href="#TangentVector-1321"><span class="linenos">1321</span></a>
</span><span id="TangentVector-1322"><a href="#TangentVector-1322"><span class="linenos">1322</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector-1323"><a href="#TangentVector-1323"><span class="linenos">1323</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector-1324"><a href="#TangentVector-1324"><span class="linenos">1324</span></a><span class="sd">        dimension : int</span>
</span><span id="TangentVector-1325"><a href="#TangentVector-1325"><span class="linenos">1325</span></a><span class="sd">            Dimension of the hyperbolic space where this tangent vector lives</span>
</span><span id="TangentVector-1326"><a href="#TangentVector-1326"><span class="linenos">1326</span></a><span class="sd">        shape : tuple</span>
</span><span id="TangentVector-1327"><a href="#TangentVector-1327"><span class="linenos">1327</span></a><span class="sd">            Shape of the composite TangentVector object to return.</span>
</span><span id="TangentVector-1328"><a href="#TangentVector-1328"><span class="linenos">1328</span></a>
</span><span id="TangentVector-1329"><a href="#TangentVector-1329"><span class="linenos">1329</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector-1330"><a href="#TangentVector-1330"><span class="linenos">1330</span></a><span class="sd">        -------</span>
</span><span id="TangentVector-1331"><a href="#TangentVector-1331"><span class="linenos">1331</span></a><span class="sd">        TangentVector</span>
</span><span id="TangentVector-1332"><a href="#TangentVector-1332"><span class="linenos">1332</span></a><span class="sd">            An &quot;origin&quot; tangent vector.</span>
</span><span id="TangentVector-1333"><a href="#TangentVector-1333"><span class="linenos">1333</span></a>
</span><span id="TangentVector-1334"><a href="#TangentVector-1334"><span class="linenos">1334</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector-1335"><a href="#TangentVector-1335"><span class="linenos">1335</span></a>
</span><span id="TangentVector-1336"><a href="#TangentVector-1336"><span class="linenos">1336</span></a>        <span class="n">origin</span> <span class="o">=</span> <span class="n">Point</span><span class="o">.</span><span class="n">get_origin</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector-1337"><a href="#TangentVector-1337"><span class="linenos">1337</span></a>        <span class="n">vector</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector-1338"><a href="#TangentVector-1338"><span class="linenos">1338</span></a>
</span><span id="TangentVector-1339"><a href="#TangentVector-1339"><span class="linenos">1339</span></a>        <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector-1340"><a href="#TangentVector-1340"><span class="linenos">1340</span></a>        <span class="n">vector</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="TangentVector-1341"><a href="#TangentVector-1341"><span class="linenos">1341</span></a>
</span><span id="TangentVector-1342"><a href="#TangentVector-1342"><span class="linenos">1342</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a tangent vector in hyperbolic space.</p>
</div>


                            <div id="TangentVector.__init__" class="classattr">
                                        <input id="TangentVector.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">TangentVector</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">point_data</span>,</span><span class="param">	<span class="n">vector</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span>,</span><span class="param">	<span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="TangentVector.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.__init__-1132"><a href="#TangentVector.__init__-1132"><span class="linenos">1132</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">,</span> <span class="n">vector</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="TangentVector.__init__-1133"><a href="#TangentVector.__init__-1133"><span class="linenos">1133</span></a>                 <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dual_ndims</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TangentVector.__init__-1134"><a href="#TangentVector.__init__-1134"><span class="linenos">1134</span></a>        <span class="sd">&quot;&quot;&quot;If `vector` is `None`, interpret `point_data` as either an ndarray</span>
</span><span id="TangentVector.__init__-1135"><a href="#TangentVector.__init__-1135"><span class="linenos">1135</span></a><span class="sd">        of shape `(..., 2, n)` (where `n` is the dimension of the</span>
</span><span id="TangentVector.__init__-1136"><a href="#TangentVector.__init__-1136"><span class="linenos">1136</span></a><span class="sd">        underlying vector space), or else a composite HyperbolicObject</span>
</span><span id="TangentVector.__init__-1137"><a href="#TangentVector.__init__-1137"><span class="linenos">1137</span></a><span class="sd">        whose data can be unpacked into a point in projective space</span>
</span><span id="TangentVector.__init__-1138"><a href="#TangentVector.__init__-1138"><span class="linenos">1138</span></a><span class="sd">        and a tangent vector to a hyperboloid.</span>
</span><span id="TangentVector.__init__-1139"><a href="#TangentVector.__init__-1139"><span class="linenos">1139</span></a>
</span><span id="TangentVector.__init__-1140"><a href="#TangentVector.__init__-1140"><span class="linenos">1140</span></a><span class="sd">        If `vector` is given, then `point_data` is used to construct</span>
</span><span id="TangentVector.__init__-1141"><a href="#TangentVector.__init__-1141"><span class="linenos">1141</span></a><span class="sd">        the basepoint for this tangent vector, and `vector` is used to</span>
</span><span id="TangentVector.__init__-1142"><a href="#TangentVector.__init__-1142"><span class="linenos">1142</span></a><span class="sd">        construct the tangent vector to the hyperboloid.</span>
</span><span id="TangentVector.__init__-1143"><a href="#TangentVector.__init__-1143"><span class="linenos">1143</span></a>
</span><span id="TangentVector.__init__-1144"><a href="#TangentVector.__init__-1144"><span class="linenos">1144</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector.__init__-1145"><a href="#TangentVector.__init__-1145"><span class="linenos">1145</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector.__init__-1146"><a href="#TangentVector.__init__-1146"><span class="linenos">1146</span></a><span class="sd">        point_data : Point or ndarray</span>
</span><span id="TangentVector.__init__-1147"><a href="#TangentVector.__init__-1147"><span class="linenos">1147</span></a><span class="sd">            The basepoint of the tangent vector, or (if `vector` is</span>
</span><span id="TangentVector.__init__-1148"><a href="#TangentVector.__init__-1148"><span class="linenos">1148</span></a><span class="sd">            `None`) the data of the basepoint and the tangent vector.</span>
</span><span id="TangentVector.__init__-1149"><a href="#TangentVector.__init__-1149"><span class="linenos">1149</span></a><span class="sd">        vector : HyperbolicObject or ndarray</span>
</span><span id="TangentVector.__init__-1150"><a href="#TangentVector.__init__-1150"><span class="linenos">1150</span></a><span class="sd">            The tangent vector data. If `None`, `point_data` contains</span>
</span><span id="TangentVector.__init__-1151"><a href="#TangentVector.__init__-1151"><span class="linenos">1151</span></a><span class="sd">            the data for the basepoint and the tangent vector.</span>
</span><span id="TangentVector.__init__-1152"><a href="#TangentVector.__init__-1152"><span class="linenos">1152</span></a>
</span><span id="TangentVector.__init__-1153"><a href="#TangentVector.__init__-1153"><span class="linenos">1153</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector.__init__-1154"><a href="#TangentVector.__init__-1154"><span class="linenos">1154</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point_data</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span>
</span><span id="TangentVector.__init__-1155"><a href="#TangentVector.__init__-1155"><span class="linenos">1155</span></a>                           <span class="n">unit_ndims</span><span class="o">=</span><span class="n">unit_ndims</span><span class="p">,</span>
</span><span id="TangentVector.__init__-1156"><a href="#TangentVector.__init__-1156"><span class="linenos">1156</span></a>                           <span class="n">aux_ndims</span><span class="o">=</span><span class="n">aux_ndims</span><span class="p">,</span>
</span><span id="TangentVector.__init__-1157"><a href="#TangentVector.__init__-1157"><span class="linenos">1157</span></a>                           <span class="n">dual_ndims</span><span class="o">=</span><span class="n">dual_ndims</span><span class="p">,</span>
</span><span id="TangentVector.__init__-1158"><a href="#TangentVector.__init__-1158"><span class="linenos">1158</span></a>                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If <code><a href="#TangentVector.vector">vector</a></code> is <code>None</code>, interpret <code>point_data</code> as either an ndarray
of shape <code>(..., 2, n)</code> (where <code>n</code> is the dimension of the
underlying vector space), or else a composite HyperbolicObject
whose data can be unpacked into a point in projective space
and a tangent vector to a hyperboloid.</p>

<p>If <code><a href="#TangentVector.vector">vector</a></code> is given, then <code>point_data</code> is used to construct
the basepoint for this tangent vector, and <code><a href="#TangentVector.vector">vector</a></code> is used to
construct the tangent vector to the hyperboloid.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>point_data</strong> (Point or ndarray):
The basepoint of the tangent vector, or (if <code><a href="#TangentVector.vector">vector</a></code> is
<code>None</code>) the data of the basepoint and the tangent vector.</li>
<li><strong>vector</strong> (HyperbolicObject or ndarray):
The tangent vector data. If <code>None</code>, <code>point_data</code> contains
the data for the basepoint and the tangent vector.</li>
</ul>
</div>


                            </div>
                            <div id="TangentVector.point" class="classattr">
                                        <input id="TangentVector.point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">point</span>

                <label class="view-source-button" for="TangentVector.point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.point-1199"><a href="#TangentVector.point-1199"><span class="linenos">1199</span></a>    <span class="nd">@property</span>
</span><span id="TangentVector.point-1200"><a href="#TangentVector.point-1200"><span class="linenos">1200</span></a>    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TangentVector.point-1201"><a href="#TangentVector.point-1201"><span class="linenos">1201</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="TangentVector.vector" class="classattr">
                                        <input id="TangentVector.vector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">vector</span>

                <label class="view-source-button" for="TangentVector.vector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.vector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.vector-1203"><a href="#TangentVector.vector-1203"><span class="linenos">1203</span></a>    <span class="nd">@property</span>
</span><span id="TangentVector.vector-1204"><a href="#TangentVector.vector-1204"><span class="linenos">1204</span></a>    <span class="k">def</span> <span class="nf">vector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TangentVector.vector-1205"><a href="#TangentVector.vector-1205"><span class="linenos">1205</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="TangentVector.normalized" class="classattr">
                                        <input id="TangentVector.normalized-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalized</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TangentVector.normalized-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.normalized"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.normalized-1207"><a href="#TangentVector.normalized-1207"><span class="linenos">1207</span></a>    <span class="k">def</span> <span class="nf">normalized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="TangentVector.normalized-1208"><a href="#TangentVector.normalized-1208"><span class="linenos">1208</span></a>        <span class="sd">&quot;&quot;&quot;Get a unit tangent vector in the same direction as this tangent</span>
</span><span id="TangentVector.normalized-1209"><a href="#TangentVector.normalized-1209"><span class="linenos">1209</span></a><span class="sd">        vector.</span>
</span><span id="TangentVector.normalized-1210"><a href="#TangentVector.normalized-1210"><span class="linenos">1210</span></a>
</span><span id="TangentVector.normalized-1211"><a href="#TangentVector.normalized-1211"><span class="linenos">1211</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector.normalized-1212"><a href="#TangentVector.normalized-1212"><span class="linenos">1212</span></a><span class="sd">        -------</span>
</span><span id="TangentVector.normalized-1213"><a href="#TangentVector.normalized-1213"><span class="linenos">1213</span></a><span class="sd">        TangentVector</span>
</span><span id="TangentVector.normalized-1214"><a href="#TangentVector.normalized-1214"><span class="linenos">1214</span></a><span class="sd">            Normalized version of this tangent vector (with respect to</span>
</span><span id="TangentVector.normalized-1215"><a href="#TangentVector.normalized-1215"><span class="linenos">1215</span></a><span class="sd">            the standard Minkowski inner product)</span>
</span><span id="TangentVector.normalized-1216"><a href="#TangentVector.normalized-1216"><span class="linenos">1216</span></a>
</span><span id="TangentVector.normalized-1217"><a href="#TangentVector.normalized-1217"><span class="linenos">1217</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector.normalized-1218"><a href="#TangentVector.normalized-1218"><span class="linenos">1218</span></a>        <span class="n">normed_vec</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector.normalized-1219"><a href="#TangentVector.normalized-1219"><span class="linenos">1219</span></a>
</span><span id="TangentVector.normalized-1220"><a href="#TangentVector.normalized-1220"><span class="linenos">1220</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">normed_vec</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a unit tangent vector in the same direction as this tangent
vector.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>TangentVector</strong>: Normalized version of this tangent vector (with respect to
the standard Minkowski inner product)</li>
</ul>
</div>


                            </div>
                            <div id="TangentVector.origin_to" class="classattr">
                                        <input id="TangentVector.origin_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">origin_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TangentVector.origin_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.origin_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.origin_to-1222"><a href="#TangentVector.origin_to-1222"><span class="linenos">1222</span></a>    <span class="k">def</span> <span class="nf">origin_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="TangentVector.origin_to-1223"><a href="#TangentVector.origin_to-1223"><span class="linenos">1223</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking the &quot;origin&quot; to this vector.</span>
</span><span id="TangentVector.origin_to-1224"><a href="#TangentVector.origin_to-1224"><span class="linenos">1224</span></a>
</span><span id="TangentVector.origin_to-1225"><a href="#TangentVector.origin_to-1225"><span class="linenos">1225</span></a><span class="sd">        The &quot;origin&quot; is a tangent vector whose basepoint lies at (0,</span>
</span><span id="TangentVector.origin_to-1226"><a href="#TangentVector.origin_to-1226"><span class="linenos">1226</span></a><span class="sd">        0, ....) in Poincare or Kleinian coordinates, and whose</span>
</span><span id="TangentVector.origin_to-1227"><a href="#TangentVector.origin_to-1227"><span class="linenos">1227</span></a><span class="sd">        tangent vector is parallel to the second standard basis</span>
</span><span id="TangentVector.origin_to-1228"><a href="#TangentVector.origin_to-1228"><span class="linenos">1228</span></a><span class="sd">        vector.</span>
</span><span id="TangentVector.origin_to-1229"><a href="#TangentVector.origin_to-1229"><span class="linenos">1229</span></a>
</span><span id="TangentVector.origin_to-1230"><a href="#TangentVector.origin_to-1230"><span class="linenos">1230</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector.origin_to-1231"><a href="#TangentVector.origin_to-1231"><span class="linenos">1231</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector.origin_to-1232"><a href="#TangentVector.origin_to-1232"><span class="linenos">1232</span></a><span class="sd">        force_oriented : bool</span>
</span><span id="TangentVector.origin_to-1233"><a href="#TangentVector.origin_to-1233"><span class="linenos">1233</span></a><span class="sd">            If `True`, force the computed isometry to be</span>
</span><span id="TangentVector.origin_to-1234"><a href="#TangentVector.origin_to-1234"><span class="linenos">1234</span></a><span class="sd">            orientation-preserving</span>
</span><span id="TangentVector.origin_to-1235"><a href="#TangentVector.origin_to-1235"><span class="linenos">1235</span></a>
</span><span id="TangentVector.origin_to-1236"><a href="#TangentVector.origin_to-1236"><span class="linenos">1236</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector.origin_to-1237"><a href="#TangentVector.origin_to-1237"><span class="linenos">1237</span></a><span class="sd">        -------</span>
</span><span id="TangentVector.origin_to-1238"><a href="#TangentVector.origin_to-1238"><span class="linenos">1238</span></a><span class="sd">        Isometry</span>
</span><span id="TangentVector.origin_to-1239"><a href="#TangentVector.origin_to-1239"><span class="linenos">1239</span></a><span class="sd">            Isometry taking the &quot;origin&quot; to this tangent vector.</span>
</span><span id="TangentVector.origin_to-1240"><a href="#TangentVector.origin_to-1240"><span class="linenos">1240</span></a>
</span><span id="TangentVector.origin_to-1241"><a href="#TangentVector.origin_to-1241"><span class="linenos">1241</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector.origin_to-1242"><a href="#TangentVector.origin_to-1242"><span class="linenos">1242</span></a>        <span class="n">normed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aux_data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector.origin_to-1243"><a href="#TangentVector.origin_to-1243"><span class="linenos">1243</span></a>        <span class="n">isom</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">,</span> <span class="n">normed</span><span class="p">,</span>
</span><span id="TangentVector.origin_to-1244"><a href="#TangentVector.origin_to-1244"><span class="linenos">1244</span></a>                                   <span class="n">force_oriented</span><span class="p">)</span>
</span><span id="TangentVector.origin_to-1245"><a href="#TangentVector.origin_to-1245"><span class="linenos">1245</span></a>
</span><span id="TangentVector.origin_to-1246"><a href="#TangentVector.origin_to-1246"><span class="linenos">1246</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">isom</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get an isometry taking the "origin" to this vector.</p>

<p>The "origin" is a tangent vector whose basepoint lies at (0,
0, ....) in Poincare or Kleinian coordinates, and whose
tangent vector is parallel to the second standard basis
vector.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>force_oriented</strong> (bool):
If <code>True</code>, force the computed isometry to be
orientation-preserving</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Isometry</strong>: Isometry taking the "origin" to this tangent vector.</li>
</ul>
</div>


                            </div>
                            <div id="TangentVector.isometry_to" class="classattr">
                                        <input id="TangentVector.isometry_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isometry_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TangentVector.isometry_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.isometry_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.isometry_to-1248"><a href="#TangentVector.isometry_to-1248"><span class="linenos">1248</span></a>    <span class="k">def</span> <span class="nf">isometry_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TangentVector.isometry_to-1249"><a href="#TangentVector.isometry_to-1249"><span class="linenos">1249</span></a>        <span class="sd">&quot;&quot;&quot;Get an isometry taking this tangent vector to a scalar multiple of</span>
</span><span id="TangentVector.isometry_to-1250"><a href="#TangentVector.isometry_to-1250"><span class="linenos">1250</span></a><span class="sd">        the other.</span>
</span><span id="TangentVector.isometry_to-1251"><a href="#TangentVector.isometry_to-1251"><span class="linenos">1251</span></a>
</span><span id="TangentVector.isometry_to-1252"><a href="#TangentVector.isometry_to-1252"><span class="linenos">1252</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector.isometry_to-1253"><a href="#TangentVector.isometry_to-1253"><span class="linenos">1253</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector.isometry_to-1254"><a href="#TangentVector.isometry_to-1254"><span class="linenos">1254</span></a><span class="sd">        other : TangentVector</span>
</span><span id="TangentVector.isometry_to-1255"><a href="#TangentVector.isometry_to-1255"><span class="linenos">1255</span></a><span class="sd">            Tangent vector to translate this vector to</span>
</span><span id="TangentVector.isometry_to-1256"><a href="#TangentVector.isometry_to-1256"><span class="linenos">1256</span></a><span class="sd">        force_oriented : bool</span>
</span><span id="TangentVector.isometry_to-1257"><a href="#TangentVector.isometry_to-1257"><span class="linenos">1257</span></a><span class="sd">            If `True`, force the computed isometry to be</span>
</span><span id="TangentVector.isometry_to-1258"><a href="#TangentVector.isometry_to-1258"><span class="linenos">1258</span></a><span class="sd">            orientation-preserving.</span>
</span><span id="TangentVector.isometry_to-1259"><a href="#TangentVector.isometry_to-1259"><span class="linenos">1259</span></a>
</span><span id="TangentVector.isometry_to-1260"><a href="#TangentVector.isometry_to-1260"><span class="linenos">1260</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector.isometry_to-1261"><a href="#TangentVector.isometry_to-1261"><span class="linenos">1261</span></a><span class="sd">        -------</span>
</span><span id="TangentVector.isometry_to-1262"><a href="#TangentVector.isometry_to-1262"><span class="linenos">1262</span></a><span class="sd">        Isometry</span>
</span><span id="TangentVector.isometry_to-1263"><a href="#TangentVector.isometry_to-1263"><span class="linenos">1263</span></a><span class="sd">            Isometry this tangent vector to `other`.</span>
</span><span id="TangentVector.isometry_to-1264"><a href="#TangentVector.isometry_to-1264"><span class="linenos">1264</span></a>
</span><span id="TangentVector.isometry_to-1265"><a href="#TangentVector.isometry_to-1265"><span class="linenos">1265</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="TangentVector.isometry_to-1266"><a href="#TangentVector.isometry_to-1266"><span class="linenos">1266</span></a>        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="n">origin_to</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_to</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Get an isometry taking this tangent vector to a scalar multiple of
the other.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong> (TangentVector):
Tangent vector to translate this vector to</li>
<li><strong>force_oriented</strong> (bool):
If <code>True</code>, force the computed isometry to be
orientation-preserving.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Isometry</strong>: Isometry this tangent vector to <code>other</code>.</li>
</ul>
</div>


                            </div>
                            <div id="TangentVector.angle" class="classattr">
                                        <input id="TangentVector.angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">other</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TangentVector.angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.angle-1268"><a href="#TangentVector.angle-1268"><span class="linenos">1268</span></a>    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
</span><span id="TangentVector.angle-1269"><a href="#TangentVector.angle-1269"><span class="linenos">1269</span></a>        <span class="sd">&quot;&quot;&quot;Compute the angle between two tangent vectors.</span>
</span><span id="TangentVector.angle-1270"><a href="#TangentVector.angle-1270"><span class="linenos">1270</span></a>
</span><span id="TangentVector.angle-1271"><a href="#TangentVector.angle-1271"><span class="linenos">1271</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector.angle-1272"><a href="#TangentVector.angle-1272"><span class="linenos">1272</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector.angle-1273"><a href="#TangentVector.angle-1273"><span class="linenos">1273</span></a><span class="sd">        other : TangentVector</span>
</span><span id="TangentVector.angle-1274"><a href="#TangentVector.angle-1274"><span class="linenos">1274</span></a>
</span><span id="TangentVector.angle-1275"><a href="#TangentVector.angle-1275"><span class="linenos">1275</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector.angle-1276"><a href="#TangentVector.angle-1276"><span class="linenos">1276</span></a><span class="sd">        -------</span>
</span><span id="TangentVector.angle-1277"><a href="#TangentVector.angle-1277"><span class="linenos">1277</span></a><span class="sd">        float or ndarray</span>
</span><span id="TangentVector.angle-1278"><a href="#TangentVector.angle-1278"><span class="linenos">1278</span></a><span class="sd">            The angle between `self` and `other`.</span>
</span><span id="TangentVector.angle-1279"><a href="#TangentVector.angle-1279"><span class="linenos">1279</span></a>
</span><span id="TangentVector.angle-1280"><a href="#TangentVector.angle-1280"><span class="linenos">1280</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector.angle-1281"><a href="#TangentVector.angle-1281"><span class="linenos">1281</span></a>        <span class="n">v1</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
</span><span id="TangentVector.angle-1282"><a href="#TangentVector.angle-1282"><span class="linenos">1282</span></a>        <span class="n">v2</span> <span class="o">=</span> <span class="n">project_to_hyperboloid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>
</span><span id="TangentVector.angle-1283"><a href="#TangentVector.angle-1283"><span class="linenos">1283</span></a>
</span><span id="TangentVector.angle-1284"><a href="#TangentVector.angle-1284"><span class="linenos">1284</span></a>        <span class="n">product</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="TangentVector.angle-1285"><a href="#TangentVector.angle-1285"><span class="linenos">1285</span></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">product</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the angle between two tangent vectors.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>other</strong> (TangentVector):</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>float or ndarray</strong>: The angle between <code>self</code> and <code>other</code>.</li>
</ul>
</div>


                            </div>
                            <div id="TangentVector.point_along" class="classattr">
                                        <input id="TangentVector.point_along-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">point_along</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">distance</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TangentVector.point_along-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.point_along"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.point_along-1287"><a href="#TangentVector.point_along-1287"><span class="linenos">1287</span></a>    <span class="k">def</span> <span class="nf">point_along</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">):</span>
</span><span id="TangentVector.point_along-1288"><a href="#TangentVector.point_along-1288"><span class="linenos">1288</span></a>        <span class="sd">&quot;&quot;&quot;Get a point in hyperbolic space along the geodesic specified by</span>
</span><span id="TangentVector.point_along-1289"><a href="#TangentVector.point_along-1289"><span class="linenos">1289</span></a><span class="sd">        this tangent vector.</span>
</span><span id="TangentVector.point_along-1290"><a href="#TangentVector.point_along-1290"><span class="linenos">1290</span></a>
</span><span id="TangentVector.point_along-1291"><a href="#TangentVector.point_along-1291"><span class="linenos">1291</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector.point_along-1292"><a href="#TangentVector.point_along-1292"><span class="linenos">1292</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector.point_along-1293"><a href="#TangentVector.point_along-1293"><span class="linenos">1293</span></a><span class="sd">        distance : float or ndarray</span>
</span><span id="TangentVector.point_along-1294"><a href="#TangentVector.point_along-1294"><span class="linenos">1294</span></a>
</span><span id="TangentVector.point_along-1295"><a href="#TangentVector.point_along-1295"><span class="linenos">1295</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector.point_along-1296"><a href="#TangentVector.point_along-1296"><span class="linenos">1296</span></a><span class="sd">        -------</span>
</span><span id="TangentVector.point_along-1297"><a href="#TangentVector.point_along-1297"><span class="linenos">1297</span></a><span class="sd">        Point</span>
</span><span id="TangentVector.point_along-1298"><a href="#TangentVector.point_along-1298"><span class="linenos">1298</span></a><span class="sd">            Point in hyperbolic space along the geodesic ray defined</span>
</span><span id="TangentVector.point_along-1299"><a href="#TangentVector.point_along-1299"><span class="linenos">1299</span></a><span class="sd">            by this tangent vector</span>
</span><span id="TangentVector.point_along-1300"><a href="#TangentVector.point_along-1300"><span class="linenos">1300</span></a>
</span><span id="TangentVector.point_along-1301"><a href="#TangentVector.point_along-1301"><span class="linenos">1301</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector.point_along-1302"><a href="#TangentVector.point_along-1302"><span class="linenos">1302</span></a>        <span class="n">kleinian_shape</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</span><span id="TangentVector.point_along-1303"><a href="#TangentVector.point_along-1303"><span class="linenos">1303</span></a>        <span class="n">kleinian_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="TangentVector.point_along-1304"><a href="#TangentVector.point_along-1304"><span class="linenos">1304</span></a>
</span><span id="TangentVector.point_along-1305"><a href="#TangentVector.point_along-1305"><span class="linenos">1305</span></a>        <span class="n">kleinian_pt</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">kleinian_shape</span><span class="p">,</span>
</span><span id="TangentVector.point_along-1306"><a href="#TangentVector.point_along-1306"><span class="linenos">1306</span></a>                                  <span class="n">like</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="TangentVector.point_along-1307"><a href="#TangentVector.point_along-1307"><span class="linenos">1307</span></a>
</span><span id="TangentVector.point_along-1308"><a href="#TangentVector.point_along-1308"><span class="linenos">1308</span></a>        <span class="n">kleinian_pt</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">hyp_to_affine_dist</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
</span><span id="TangentVector.point_along-1309"><a href="#TangentVector.point_along-1309"><span class="linenos">1309</span></a>
</span><span id="TangentVector.point_along-1310"><a href="#TangentVector.point_along-1310"><span class="linenos">1310</span></a>        <span class="n">basepoint</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">kleinian_pt</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="TangentVector.point_along-1311"><a href="#TangentVector.point_along-1311"><span class="linenos">1311</span></a>
</span><span id="TangentVector.point_along-1312"><a href="#TangentVector.point_along-1312"><span class="linenos">1312</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">origin_to</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">basepoint</span><span class="p">,</span> <span class="s2">&quot;elementwise&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a point in hyperbolic space along the geodesic specified by
this tangent vector.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>distance</strong> (float or ndarray):</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Point in hyperbolic space along the geodesic ray defined
by this tangent vector</li>
</ul>
</div>


                            </div>
                            <div id="TangentVector.get_base_tangent" class="classattr">
                                        <input id="TangentVector.get_base_tangent-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">get_base_tangent</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span>, </span><span class="param"><span class="n">shape</span><span class="o">=</span><span class="p">()</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="TangentVector.get_base_tangent-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#TangentVector.get_base_tangent"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="TangentVector.get_base_tangent-1314"><a href="#TangentVector.get_base_tangent-1314"><span class="linenos">1314</span></a>    <span class="nd">@staticmethod</span>
</span><span id="TangentVector.get_base_tangent-1315"><a href="#TangentVector.get_base_tangent-1315"><span class="linenos">1315</span></a>    <span class="k">def</span> <span class="nf">get_base_tangent</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="TangentVector.get_base_tangent-1316"><a href="#TangentVector.get_base_tangent-1316"><span class="linenos">1316</span></a>        <span class="sd">&quot;&quot;&quot;Get an &quot;origin&quot; tangent vector.</span>
</span><span id="TangentVector.get_base_tangent-1317"><a href="#TangentVector.get_base_tangent-1317"><span class="linenos">1317</span></a>
</span><span id="TangentVector.get_base_tangent-1318"><a href="#TangentVector.get_base_tangent-1318"><span class="linenos">1318</span></a><span class="sd">        The basepoint of this tangent vector has coordinates (0, 0,</span>
</span><span id="TangentVector.get_base_tangent-1319"><a href="#TangentVector.get_base_tangent-1319"><span class="linenos">1319</span></a><span class="sd">        ...) in Poincare/Klein coordinates, and the vector is parallel</span>
</span><span id="TangentVector.get_base_tangent-1320"><a href="#TangentVector.get_base_tangent-1320"><span class="linenos">1320</span></a><span class="sd">        to the second standard basis vector in R^(n,1).</span>
</span><span id="TangentVector.get_base_tangent-1321"><a href="#TangentVector.get_base_tangent-1321"><span class="linenos">1321</span></a>
</span><span id="TangentVector.get_base_tangent-1322"><a href="#TangentVector.get_base_tangent-1322"><span class="linenos">1322</span></a><span class="sd">        Parameters</span>
</span><span id="TangentVector.get_base_tangent-1323"><a href="#TangentVector.get_base_tangent-1323"><span class="linenos">1323</span></a><span class="sd">        ----------</span>
</span><span id="TangentVector.get_base_tangent-1324"><a href="#TangentVector.get_base_tangent-1324"><span class="linenos">1324</span></a><span class="sd">        dimension : int</span>
</span><span id="TangentVector.get_base_tangent-1325"><a href="#TangentVector.get_base_tangent-1325"><span class="linenos">1325</span></a><span class="sd">            Dimension of the hyperbolic space where this tangent vector lives</span>
</span><span id="TangentVector.get_base_tangent-1326"><a href="#TangentVector.get_base_tangent-1326"><span class="linenos">1326</span></a><span class="sd">        shape : tuple</span>
</span><span id="TangentVector.get_base_tangent-1327"><a href="#TangentVector.get_base_tangent-1327"><span class="linenos">1327</span></a><span class="sd">            Shape of the composite TangentVector object to return.</span>
</span><span id="TangentVector.get_base_tangent-1328"><a href="#TangentVector.get_base_tangent-1328"><span class="linenos">1328</span></a>
</span><span id="TangentVector.get_base_tangent-1329"><a href="#TangentVector.get_base_tangent-1329"><span class="linenos">1329</span></a><span class="sd">        Returns</span>
</span><span id="TangentVector.get_base_tangent-1330"><a href="#TangentVector.get_base_tangent-1330"><span class="linenos">1330</span></a><span class="sd">        -------</span>
</span><span id="TangentVector.get_base_tangent-1331"><a href="#TangentVector.get_base_tangent-1331"><span class="linenos">1331</span></a><span class="sd">        TangentVector</span>
</span><span id="TangentVector.get_base_tangent-1332"><a href="#TangentVector.get_base_tangent-1332"><span class="linenos">1332</span></a><span class="sd">            An &quot;origin&quot; tangent vector.</span>
</span><span id="TangentVector.get_base_tangent-1333"><a href="#TangentVector.get_base_tangent-1333"><span class="linenos">1333</span></a>
</span><span id="TangentVector.get_base_tangent-1334"><a href="#TangentVector.get_base_tangent-1334"><span class="linenos">1334</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="TangentVector.get_base_tangent-1335"><a href="#TangentVector.get_base_tangent-1335"><span class="linenos">1335</span></a>
</span><span id="TangentVector.get_base_tangent-1336"><a href="#TangentVector.get_base_tangent-1336"><span class="linenos">1336</span></a>        <span class="n">origin</span> <span class="o">=</span> <span class="n">Point</span><span class="o">.</span><span class="n">get_origin</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector.get_base_tangent-1337"><a href="#TangentVector.get_base_tangent-1337"><span class="linenos">1337</span></a>        <span class="n">vector</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector.get_base_tangent-1338"><a href="#TangentVector.get_base_tangent-1338"><span class="linenos">1338</span></a>
</span><span id="TangentVector.get_base_tangent-1339"><a href="#TangentVector.get_base_tangent-1339"><span class="linenos">1339</span></a>        <span class="n">one</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="TangentVector.get_base_tangent-1340"><a href="#TangentVector.get_base_tangent-1340"><span class="linenos">1340</span></a>        <span class="n">vector</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">one</span>
</span><span id="TangentVector.get_base_tangent-1341"><a href="#TangentVector.get_base_tangent-1341"><span class="linenos">1341</span></a>
</span><span id="TangentVector.get_base_tangent-1342"><a href="#TangentVector.get_base_tangent-1342"><span class="linenos">1342</span></a>        <span class="k">return</span> <span class="n">TangentVector</span><span class="p">(</span><span class="n">origin</span><span class="p">,</span> <span class="n">vector</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get an "origin" tangent vector.</p>

<p>The basepoint of this tangent vector has coordinates (0, 0,
...) in Poincare/Klein coordinates, and the vector is parallel
to the second standard basis vector in R^(n,1).</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>dimension</strong> (int):
Dimension of the hyperbolic space where this tangent vector lives</li>
<li><strong>shape</strong> (tuple):
Shape of the composite TangentVector object to return.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>TangentVector</strong>: An "origin" tangent vector.</li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#PointPair">PointPair</a></dt>
                                <dd id="TangentVector.endpoint_coords" class="function"><a href="#PointPair.endpoint_coords">endpoint_coords</a></dd>
                <dd id="TangentVector.get_endpoints" class="function"><a href="#PointPair.get_endpoints">get_endpoints</a></dd>
                <dd id="TangentVector.get_end_pair" class="function"><a href="#PointPair.get_end_pair">get_end_pair</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="TangentVector.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="TangentVector.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="TangentVector.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="TangentVector.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="TangentVector.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="TangentVector.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="TangentVector.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="TangentVector.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="TangentVector.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="TangentVector.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="TangentVector.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="TangentVector.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></dt>
                                <dd id="TangentVector.endpoints" class="variable"><a href="projective.html#PointPair.endpoints">endpoints</a></dd>
                <dd id="TangentVector.set_endpoints" class="function"><a href="projective.html#PointPair.set_endpoints">set_endpoints</a></dd>
                <dd id="TangentVector.endpoint_affine_coords" class="function"><a href="projective.html#PointPair.endpoint_affine_coords">endpoint_affine_coords</a></dd>
                <dd id="TangentVector.endpoint_projective_coords" class="function"><a href="projective.html#PointPair.endpoint_projective_coords">endpoint_projective_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="TangentVector.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="TangentVector.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="TangentVector.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="TangentVector.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="TangentVector.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="TangentVector.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="TangentVector.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="TangentVector.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="TangentVector.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="TangentVector.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="TangentVector.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="TangentVector.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="TangentVector.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Horosphere">
                            <input id="Horosphere-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Horosphere</span><wbr>(<span class="base"><a href="#HyperbolicObject">HyperbolicObject</a></span>):

                <label class="view-source-button" for="Horosphere-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere-1344"><a href="#Horosphere-1344"><span class="linenos">1344</span></a><span class="k">class</span> <span class="nc">Horosphere</span><span class="p">(</span><span class="n">HyperbolicObject</span><span class="p">):</span>
</span><span id="Horosphere-1345"><a href="#Horosphere-1345"><span class="linenos">1345</span></a>    <span class="sd">&quot;&quot;&quot;Model for a horosphere in hyperbolic space.</span>
</span><span id="Horosphere-1346"><a href="#Horosphere-1346"><span class="linenos">1346</span></a>
</span><span id="Horosphere-1347"><a href="#Horosphere-1347"><span class="linenos">1347</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Horosphere-1348"><a href="#Horosphere-1348"><span class="linenos">1348</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Horosphere-1349"><a href="#Horosphere-1349"><span class="linenos">1349</span></a>        <span class="sd">&quot;&quot;&quot;If `reference_point` is `None`, interpret `center` as either:</span>
</span><span id="Horosphere-1350"><a href="#Horosphere-1350"><span class="linenos">1350</span></a>
</span><span id="Horosphere-1351"><a href="#Horosphere-1351"><span class="linenos">1351</span></a><span class="sd">        - a (..., 2, n) `ndarray`, where first row of the last two</span>
</span><span id="Horosphere-1352"><a href="#Horosphere-1352"><span class="linenos">1352</span></a><span class="sd">        ndindices gives the (ideal) center point for this horosphere,</span>
</span><span id="Horosphere-1353"><a href="#Horosphere-1353"><span class="linenos">1353</span></a><span class="sd">        and the second row gives some reference point on the</span>
</span><span id="Horosphere-1354"><a href="#Horosphere-1354"><span class="linenos">1354</span></a><span class="sd">        horosphere itself, or</span>
</span><span id="Horosphere-1355"><a href="#Horosphere-1355"><span class="linenos">1355</span></a>
</span><span id="Horosphere-1356"><a href="#Horosphere-1356"><span class="linenos">1356</span></a><span class="sd">        - a `HyperbolicObject` whose underlying data has the form above.</span>
</span><span id="Horosphere-1357"><a href="#Horosphere-1357"><span class="linenos">1357</span></a>
</span><span id="Horosphere-1358"><a href="#Horosphere-1358"><span class="linenos">1358</span></a><span class="sd">        If `reference_point` is given, then `center` can be used to</span>
</span><span id="Horosphere-1359"><a href="#Horosphere-1359"><span class="linenos">1359</span></a><span class="sd">        construct an `IdealPoint` giving the center of the horosphere,</span>
</span><span id="Horosphere-1360"><a href="#Horosphere-1360"><span class="linenos">1360</span></a><span class="sd">        and `reference_point` can be used to construct a `Point`</span>
</span><span id="Horosphere-1361"><a href="#Horosphere-1361"><span class="linenos">1361</span></a><span class="sd">        giving some point on the horosphere.</span>
</span><span id="Horosphere-1362"><a href="#Horosphere-1362"><span class="linenos">1362</span></a>
</span><span id="Horosphere-1363"><a href="#Horosphere-1363"><span class="linenos">1363</span></a><span class="sd">        Parameters</span>
</span><span id="Horosphere-1364"><a href="#Horosphere-1364"><span class="linenos">1364</span></a><span class="sd">        ----------</span>
</span><span id="Horosphere-1365"><a href="#Horosphere-1365"><span class="linenos">1365</span></a><span class="sd">        center : Point or ndarray</span>
</span><span id="Horosphere-1366"><a href="#Horosphere-1366"><span class="linenos">1366</span></a><span class="sd">            The (ideal) center point for this horosphere, or an object</span>
</span><span id="Horosphere-1367"><a href="#Horosphere-1367"><span class="linenos">1367</span></a><span class="sd">            which can be unpacked into all of the data for the</span>
</span><span id="Horosphere-1368"><a href="#Horosphere-1368"><span class="linenos">1368</span></a><span class="sd">            horosphere</span>
</span><span id="Horosphere-1369"><a href="#Horosphere-1369"><span class="linenos">1369</span></a><span class="sd">        reference_point : Point or ndarray</span>
</span><span id="Horosphere-1370"><a href="#Horosphere-1370"><span class="linenos">1370</span></a><span class="sd">            Any point lying on the horosphere itself. If `None`, then</span>
</span><span id="Horosphere-1371"><a href="#Horosphere-1371"><span class="linenos">1371</span></a><span class="sd">            `center` contains the data for the reference point as</span>
</span><span id="Horosphere-1372"><a href="#Horosphere-1372"><span class="linenos">1372</span></a><span class="sd">            well.</span>
</span><span id="Horosphere-1373"><a href="#Horosphere-1373"><span class="linenos">1373</span></a>
</span><span id="Horosphere-1374"><a href="#Horosphere-1374"><span class="linenos">1374</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Horosphere-1375"><a href="#Horosphere-1375"><span class="linenos">1375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Horosphere-1376"><a href="#Horosphere-1376"><span class="linenos">1376</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Horosphere-1377"><a href="#Horosphere-1377"><span class="linenos">1377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Horosphere-1378"><a href="#Horosphere-1378"><span class="linenos">1378</span></a>
</span><span id="Horosphere-1379"><a href="#Horosphere-1379"><span class="linenos">1379</span></a>        <span class="k">if</span> <span class="n">reference_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Horosphere-1380"><a href="#Horosphere-1380"><span class="linenos">1380</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Horosphere-1381"><a href="#Horosphere-1381"><span class="linenos">1381</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Horosphere-1382"><a href="#Horosphere-1382"><span class="linenos">1382</span></a>                <span class="k">return</span>
</span><span id="Horosphere-1383"><a href="#Horosphere-1383"><span class="linenos">1383</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Horosphere-1384"><a href="#Horosphere-1384"><span class="linenos">1384</span></a>                <span class="k">pass</span>
</span><span id="Horosphere-1385"><a href="#Horosphere-1385"><span class="linenos">1385</span></a>
</span><span id="Horosphere-1386"><a href="#Horosphere-1386"><span class="linenos">1386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_center_ref</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Horosphere-1387"><a href="#Horosphere-1387"><span class="linenos">1387</span></a>
</span><span id="Horosphere-1388"><a href="#Horosphere-1388"><span class="linenos">1388</span></a>    <span class="nd">@property</span>
</span><span id="Horosphere-1389"><a href="#Horosphere-1389"><span class="linenos">1389</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Horosphere-1390"><a href="#Horosphere-1390"><span class="linenos">1390</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Horosphere-1391"><a href="#Horosphere-1391"><span class="linenos">1391</span></a>
</span><span id="Horosphere-1392"><a href="#Horosphere-1392"><span class="linenos">1392</span></a>    <span class="nd">@property</span>
</span><span id="Horosphere-1393"><a href="#Horosphere-1393"><span class="linenos">1393</span></a>    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Horosphere-1394"><a href="#Horosphere-1394"><span class="linenos">1394</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Horosphere-1395"><a href="#Horosphere-1395"><span class="linenos">1395</span></a>
</span><span id="Horosphere-1396"><a href="#Horosphere-1396"><span class="linenos">1396</span></a>    <span class="k">def</span> <span class="nf">set_center_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Horosphere-1397"><a href="#Horosphere-1397"><span class="linenos">1397</span></a>        <span class="k">if</span> <span class="n">reference_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Horosphere-1398"><a href="#Horosphere-1398"><span class="linenos">1398</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Horosphere-1399"><a href="#Horosphere-1399"><span class="linenos">1399</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Horosphere-1400"><a href="#Horosphere-1400"><span class="linenos">1400</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">IdealPoint</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</span><span id="Horosphere-1401"><a href="#Horosphere-1401"><span class="linenos">1401</span></a>            <span class="n">ref</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">reference_point</span><span class="p">)</span>
</span><span id="Horosphere-1402"><a href="#Horosphere-1402"><span class="linenos">1402</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">ref</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Horosphere-1403"><a href="#Horosphere-1403"><span class="linenos">1403</span></a>
</span><span id="Horosphere-1404"><a href="#Horosphere-1404"><span class="linenos">1404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Horosphere-1405"><a href="#Horosphere-1405"><span class="linenos">1405</span></a>
</span><span id="Horosphere-1406"><a href="#Horosphere-1406"><span class="linenos">1406</span></a>    <span class="k">def</span> <span class="nf">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Horosphere-1407"><a href="#Horosphere-1407"><span class="linenos">1407</span></a>        <span class="sd">&quot;&quot;&quot;Get the center and radius of a sphere giving this horosphere in</span>
</span><span id="Horosphere-1408"><a href="#Horosphere-1408"><span class="linenos">1408</span></a><span class="sd">        poincare coordinates.</span>
</span><span id="Horosphere-1409"><a href="#Horosphere-1409"><span class="linenos">1409</span></a>
</span><span id="Horosphere-1410"><a href="#Horosphere-1410"><span class="linenos">1410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Horosphere-1411"><a href="#Horosphere-1411"><span class="linenos">1411</span></a>        <span class="n">ideal_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere-1412"><a href="#Horosphere-1412"><span class="linenos">1412</span></a>        <span class="n">ref_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere-1413"><a href="#Horosphere-1413"><span class="linenos">1413</span></a>
</span><span id="Horosphere-1414"><a href="#Horosphere-1414"><span class="linenos">1414</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Horosphere-1415"><a href="#Horosphere-1415"><span class="linenos">1415</span></a>            <span class="n">model_radius</span> <span class="o">=</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">ideal_coords</span> <span class="o">-</span> <span class="n">ref_coords</span><span class="p">)</span> <span class="o">/</span>
</span><span id="Horosphere-1416"><a href="#Horosphere-1416"><span class="linenos">1416</span></a>                            <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">ideal_coords</span><span class="p">,</span>
</span><span id="Horosphere-1417"><a href="#Horosphere-1417"><span class="linenos">1417</span></a>                                                           <span class="n">ref_coords</span><span class="p">))))</span>
</span><span id="Horosphere-1418"><a href="#Horosphere-1418"><span class="linenos">1418</span></a>            <span class="n">model_center</span> <span class="o">=</span> <span class="n">ideal_coords</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model_radius</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
</span><span id="Horosphere-1419"><a href="#Horosphere-1419"><span class="linenos">1419</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Horosphere-1420"><a href="#Horosphere-1420"><span class="linenos">1420</span></a>            <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
</span><span id="Horosphere-1421"><a href="#Horosphere-1421"><span class="linenos">1421</span></a>                <span class="n">ideal_euc</span> <span class="o">=</span> <span class="n">ideal_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Horosphere-1422"><a href="#Horosphere-1422"><span class="linenos">1422</span></a>                <span class="n">ref_euc</span> <span class="o">=</span> <span class="n">ref_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Horosphere-1423"><a href="#Horosphere-1423"><span class="linenos">1423</span></a>                <span class="n">ref_z</span> <span class="o">=</span> <span class="n">ref_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Horosphere-1424"><a href="#Horosphere-1424"><span class="linenos">1424</span></a>
</span><span id="Horosphere-1425"><a href="#Horosphere-1425"><span class="linenos">1425</span></a>
</span><span id="Horosphere-1426"><a href="#Horosphere-1426"><span class="linenos">1426</span></a>                <span class="n">model_radius</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">ideal_euc</span> <span class="o">-</span> <span class="n">ref_euc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ref_z</span> <span class="o">+</span> <span class="n">ref_z</span><span class="p">)</span>
</span><span id="Horosphere-1427"><a href="#Horosphere-1427"><span class="linenos">1427</span></a>                <span class="n">model_center</span> <span class="o">=</span> <span class="n">ideal_coords</span><span class="p">[:]</span>
</span><span id="Horosphere-1428"><a href="#Horosphere-1428"><span class="linenos">1428</span></a>                <span class="n">model_center</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_radius</span>
</span><span id="Horosphere-1429"><a href="#Horosphere-1429"><span class="linenos">1429</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Horosphere-1430"><a href="#Horosphere-1430"><span class="linenos">1430</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Horosphere-1431"><a href="#Horosphere-1431"><span class="linenos">1431</span></a>                <span class="s2">&quot;No implementation for spherical parameters for a horosphere in&quot;</span>
</span><span id="Horosphere-1432"><a href="#Horosphere-1432"><span class="linenos">1432</span></a>                <span class="s2">&quot; model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere-1433"><a href="#Horosphere-1433"><span class="linenos">1433</span></a>            <span class="p">)</span>
</span><span id="Horosphere-1434"><a href="#Horosphere-1434"><span class="linenos">1434</span></a>
</span><span id="Horosphere-1435"><a href="#Horosphere-1435"><span class="linenos">1435</span></a>        <span class="k">return</span> <span class="n">model_center</span><span class="p">,</span> <span class="n">model_radius</span>
</span><span id="Horosphere-1436"><a href="#Horosphere-1436"><span class="linenos">1436</span></a>
</span><span id="Horosphere-1437"><a href="#Horosphere-1437"><span class="linenos">1437</span></a>    <span class="k">def</span> <span class="nf">center_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="Horosphere-1438"><a href="#Horosphere-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere-1439"><a href="#Horosphere-1439"><span class="linenos">1439</span></a>
</span><span id="Horosphere-1440"><a href="#Horosphere-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">ref_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
</span><span id="Horosphere-1441"><a href="#Horosphere-1441"><span class="linenos">1441</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere-1442"><a href="#Horosphere-1442"><span class="linenos">1442</span></a>
</span><span id="Horosphere-1443"><a href="#Horosphere-1443"><span class="linenos">1443</span></a>    <span class="k">def</span> <span class="nf">intersect_geodesic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geodesic</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Horosphere-1444"><a href="#Horosphere-1444"><span class="linenos">1444</span></a>        <span class="sd">&quot;&quot;&quot;Compute the intersection points of a geodesic with this horosphere</span>
</span><span id="Horosphere-1445"><a href="#Horosphere-1445"><span class="linenos">1445</span></a>
</span><span id="Horosphere-1446"><a href="#Horosphere-1446"><span class="linenos">1446</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Horosphere-1447"><a href="#Horosphere-1447"><span class="linenos">1447</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="n">Segment</span><span class="p">(</span><span class="n">geodesic</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="Horosphere-1448"><a href="#Horosphere-1448"><span class="linenos">1448</span></a>        <span class="n">geodesic_endpts</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">ideal_endpoint_coords</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Horosphere-1449"><a href="#Horosphere-1449"><span class="linenos">1449</span></a>
</span><span id="Horosphere-1450"><a href="#Horosphere-1450"><span class="linenos">1450</span></a>        <span class="c1"># compute an isometry taking this geodesic to one which passes</span>
</span><span id="Horosphere-1451"><a href="#Horosphere-1451"><span class="linenos">1451</span></a>        <span class="c1"># through the origin (so we can do intersection calculations</span>
</span><span id="Horosphere-1452"><a href="#Horosphere-1452"><span class="linenos">1452</span></a>        <span class="c1"># in Euclidean geometry)</span>
</span><span id="Horosphere-1453"><a href="#Horosphere-1453"><span class="linenos">1453</span></a>        <span class="n">midpt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">((</span><span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Horosphere-1454"><a href="#Horosphere-1454"><span class="linenos">1454</span></a>                       <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Horosphere-1455"><a href="#Horosphere-1455"><span class="linenos">1455</span></a>        <span class="n">coord_change</span> <span class="o">=</span> <span class="n">midpt</span><span class="o">.</span><span class="n">origin_to</span><span class="p">()</span>
</span><span id="Horosphere-1456"><a href="#Horosphere-1456"><span class="linenos">1456</span></a>        <span class="n">coord_inv</span> <span class="o">=</span> <span class="n">coord_change</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Horosphere-1457"><a href="#Horosphere-1457"><span class="linenos">1457</span></a>
</span><span id="Horosphere-1458"><a href="#Horosphere-1458"><span class="linenos">1458</span></a>        <span class="n">c_hsph</span> <span class="o">=</span> <span class="n">coord_inv</span> <span class="o">@</span> <span class="bp">self</span>
</span><span id="Horosphere-1459"><a href="#Horosphere-1459"><span class="linenos">1459</span></a>        <span class="n">c_seg</span> <span class="o">=</span> <span class="n">coord_inv</span> <span class="o">@</span> <span class="n">segment</span>
</span><span id="Horosphere-1460"><a href="#Horosphere-1460"><span class="linenos">1460</span></a>
</span><span id="Horosphere-1461"><a href="#Horosphere-1461"><span class="linenos">1461</span></a>        <span class="n">p_center</span><span class="p">,</span> <span class="n">p_radius</span> <span class="o">=</span> <span class="n">c_hsph</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">()</span>
</span><span id="Horosphere-1462"><a href="#Horosphere-1462"><span class="linenos">1462</span></a>        <span class="n">geodesic_endpts</span> <span class="o">=</span> <span class="n">c_seg</span><span class="o">.</span><span class="n">ideal_endpoint_coords</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Horosphere-1463"><a href="#Horosphere-1463"><span class="linenos">1463</span></a>
</span><span id="Horosphere-1464"><a href="#Horosphere-1464"><span class="linenos">1464</span></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Horosphere-1465"><a href="#Horosphere-1465"><span class="linenos">1465</span></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Horosphere-1466"><a href="#Horosphere-1466"><span class="linenos">1466</span></a>
</span><span id="Horosphere-1467"><a href="#Horosphere-1467"><span class="linenos">1467</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Horosphere-1468"><a href="#Horosphere-1468"><span class="linenos">1468</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">p_center</span><span class="p">,</span> <span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">+</span>
</span><span id="Horosphere-1469"><a href="#Horosphere-1469"><span class="linenos">1469</span></a>                  <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-</span>
</span><span id="Horosphere-1470"><a href="#Horosphere-1470"><span class="linenos">1470</span></a>                  <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
</span><span id="Horosphere-1471"><a href="#Horosphere-1471"><span class="linenos">1471</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">p_center</span><span class="p">)</span> <span class="o">-</span> <span class="n">p_radius</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Horosphere-1472"><a href="#Horosphere-1472"><span class="linenos">1472</span></a>
</span><span id="Horosphere-1473"><a href="#Horosphere-1473"><span class="linenos">1473</span></a>        <span class="c1">#TODO: check to see if the intersection actually occurs</span>
</span><span id="Horosphere-1474"><a href="#Horosphere-1474"><span class="linenos">1474</span></a>        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Horosphere-1475"><a href="#Horosphere-1475"><span class="linenos">1475</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Horosphere-1476"><a href="#Horosphere-1476"><span class="linenos">1476</span></a>
</span><span id="Horosphere-1477"><a href="#Horosphere-1477"><span class="linenos">1477</span></a>        <span class="n">p1_poincare</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="Horosphere-1478"><a href="#Horosphere-1478"><span class="linenos">1478</span></a>        <span class="n">p2_poincare</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="Horosphere-1479"><a href="#Horosphere-1479"><span class="linenos">1479</span></a>
</span><span id="Horosphere-1480"><a href="#Horosphere-1480"><span class="linenos">1480</span></a>        <span class="n">poincare_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">p1_poincare</span><span class="p">,</span> <span class="n">p2_poincare</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Horosphere-1481"><a href="#Horosphere-1481"><span class="linenos">1481</span></a>        <span class="n">klein_pts</span> <span class="o">=</span> <span class="n">poincare_to_kleinian</span><span class="p">(</span><span class="n">poincare_pts</span><span class="p">)</span>
</span><span id="Horosphere-1482"><a href="#Horosphere-1482"><span class="linenos">1482</span></a>
</span><span id="Horosphere-1483"><a href="#Horosphere-1483"><span class="linenos">1483</span></a>        <span class="k">return</span> <span class="n">coord_change</span> <span class="o">@</span> <span class="n">Point</span><span class="p">(</span><span class="n">klein_pts</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a horosphere in hyperbolic space.</p>
</div>


                            <div id="Horosphere.__init__" class="classattr">
                                        <input id="Horosphere.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Horosphere</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Horosphere.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.__init__-1348"><a href="#Horosphere.__init__-1348"><span class="linenos">1348</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Horosphere.__init__-1349"><a href="#Horosphere.__init__-1349"><span class="linenos">1349</span></a>        <span class="sd">&quot;&quot;&quot;If `reference_point` is `None`, interpret `center` as either:</span>
</span><span id="Horosphere.__init__-1350"><a href="#Horosphere.__init__-1350"><span class="linenos">1350</span></a>
</span><span id="Horosphere.__init__-1351"><a href="#Horosphere.__init__-1351"><span class="linenos">1351</span></a><span class="sd">        - a (..., 2, n) `ndarray`, where first row of the last two</span>
</span><span id="Horosphere.__init__-1352"><a href="#Horosphere.__init__-1352"><span class="linenos">1352</span></a><span class="sd">        ndindices gives the (ideal) center point for this horosphere,</span>
</span><span id="Horosphere.__init__-1353"><a href="#Horosphere.__init__-1353"><span class="linenos">1353</span></a><span class="sd">        and the second row gives some reference point on the</span>
</span><span id="Horosphere.__init__-1354"><a href="#Horosphere.__init__-1354"><span class="linenos">1354</span></a><span class="sd">        horosphere itself, or</span>
</span><span id="Horosphere.__init__-1355"><a href="#Horosphere.__init__-1355"><span class="linenos">1355</span></a>
</span><span id="Horosphere.__init__-1356"><a href="#Horosphere.__init__-1356"><span class="linenos">1356</span></a><span class="sd">        - a `HyperbolicObject` whose underlying data has the form above.</span>
</span><span id="Horosphere.__init__-1357"><a href="#Horosphere.__init__-1357"><span class="linenos">1357</span></a>
</span><span id="Horosphere.__init__-1358"><a href="#Horosphere.__init__-1358"><span class="linenos">1358</span></a><span class="sd">        If `reference_point` is given, then `center` can be used to</span>
</span><span id="Horosphere.__init__-1359"><a href="#Horosphere.__init__-1359"><span class="linenos">1359</span></a><span class="sd">        construct an `IdealPoint` giving the center of the horosphere,</span>
</span><span id="Horosphere.__init__-1360"><a href="#Horosphere.__init__-1360"><span class="linenos">1360</span></a><span class="sd">        and `reference_point` can be used to construct a `Point`</span>
</span><span id="Horosphere.__init__-1361"><a href="#Horosphere.__init__-1361"><span class="linenos">1361</span></a><span class="sd">        giving some point on the horosphere.</span>
</span><span id="Horosphere.__init__-1362"><a href="#Horosphere.__init__-1362"><span class="linenos">1362</span></a>
</span><span id="Horosphere.__init__-1363"><a href="#Horosphere.__init__-1363"><span class="linenos">1363</span></a><span class="sd">        Parameters</span>
</span><span id="Horosphere.__init__-1364"><a href="#Horosphere.__init__-1364"><span class="linenos">1364</span></a><span class="sd">        ----------</span>
</span><span id="Horosphere.__init__-1365"><a href="#Horosphere.__init__-1365"><span class="linenos">1365</span></a><span class="sd">        center : Point or ndarray</span>
</span><span id="Horosphere.__init__-1366"><a href="#Horosphere.__init__-1366"><span class="linenos">1366</span></a><span class="sd">            The (ideal) center point for this horosphere, or an object</span>
</span><span id="Horosphere.__init__-1367"><a href="#Horosphere.__init__-1367"><span class="linenos">1367</span></a><span class="sd">            which can be unpacked into all of the data for the</span>
</span><span id="Horosphere.__init__-1368"><a href="#Horosphere.__init__-1368"><span class="linenos">1368</span></a><span class="sd">            horosphere</span>
</span><span id="Horosphere.__init__-1369"><a href="#Horosphere.__init__-1369"><span class="linenos">1369</span></a><span class="sd">        reference_point : Point or ndarray</span>
</span><span id="Horosphere.__init__-1370"><a href="#Horosphere.__init__-1370"><span class="linenos">1370</span></a><span class="sd">            Any point lying on the horosphere itself. If `None`, then</span>
</span><span id="Horosphere.__init__-1371"><a href="#Horosphere.__init__-1371"><span class="linenos">1371</span></a><span class="sd">            `center` contains the data for the reference point as</span>
</span><span id="Horosphere.__init__-1372"><a href="#Horosphere.__init__-1372"><span class="linenos">1372</span></a><span class="sd">            well.</span>
</span><span id="Horosphere.__init__-1373"><a href="#Horosphere.__init__-1373"><span class="linenos">1373</span></a>
</span><span id="Horosphere.__init__-1374"><a href="#Horosphere.__init__-1374"><span class="linenos">1374</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Horosphere.__init__-1375"><a href="#Horosphere.__init__-1375"><span class="linenos">1375</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Horosphere.__init__-1376"><a href="#Horosphere.__init__-1376"><span class="linenos">1376</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Horosphere.__init__-1377"><a href="#Horosphere.__init__-1377"><span class="linenos">1377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Horosphere.__init__-1378"><a href="#Horosphere.__init__-1378"><span class="linenos">1378</span></a>
</span><span id="Horosphere.__init__-1379"><a href="#Horosphere.__init__-1379"><span class="linenos">1379</span></a>        <span class="k">if</span> <span class="n">reference_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Horosphere.__init__-1380"><a href="#Horosphere.__init__-1380"><span class="linenos">1380</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="Horosphere.__init__-1381"><a href="#Horosphere.__init__-1381"><span class="linenos">1381</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Horosphere.__init__-1382"><a href="#Horosphere.__init__-1382"><span class="linenos">1382</span></a>                <span class="k">return</span>
</span><span id="Horosphere.__init__-1383"><a href="#Horosphere.__init__-1383"><span class="linenos">1383</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="Horosphere.__init__-1384"><a href="#Horosphere.__init__-1384"><span class="linenos">1384</span></a>                <span class="k">pass</span>
</span><span id="Horosphere.__init__-1385"><a href="#Horosphere.__init__-1385"><span class="linenos">1385</span></a>
</span><span id="Horosphere.__init__-1386"><a href="#Horosphere.__init__-1386"><span class="linenos">1386</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_center_ref</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If <code>reference_point</code> is <code>None</code>, interpret <code><a href="#Horosphere.center">center</a></code> as either:</p>

<ul>
<li><p>a (..., 2, n) <code>ndarray</code>, where first row of the last two
ndindices gives the (ideal) center point for this horosphere,
and the second row gives some reference point on the
horosphere itself, or</p></li>
<li><p>a <code><a href="#HyperbolicObject">HyperbolicObject</a></code> whose underlying data has the form above.</p></li>
</ul>

<p>If <code>reference_point</code> is given, then <code><a href="#Horosphere.center">center</a></code> can be used to
construct an <code><a href="#IdealPoint">IdealPoint</a></code> giving the center of the horosphere,
and <code>reference_point</code> can be used to construct a <code><a href="#Point">Point</a></code>
giving some point on the horosphere.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>center</strong> (Point or ndarray):
The (ideal) center point for this horosphere, or an object
which can be unpacked into all of the data for the
horosphere</li>
<li><strong>reference_point</strong> (Point or ndarray):
Any point lying on the horosphere itself. If <code>None</code>, then
<code><a href="#Horosphere.center">center</a></code> contains the data for the reference point as
well.</li>
</ul>
</div>


                            </div>
                            <div id="Horosphere.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#Horosphere.unit_ndims"></a>
    
    

                            </div>
                            <div id="Horosphere.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#Horosphere.aux_ndims"></a>
    
    

                            </div>
                            <div id="Horosphere.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#Horosphere.dual_ndims"></a>
    
    

                            </div>
                            <div id="Horosphere.center" class="classattr">
                                        <input id="Horosphere.center-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">center</span>

                <label class="view-source-button" for="Horosphere.center-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.center"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.center-1388"><a href="#Horosphere.center-1388"><span class="linenos">1388</span></a>    <span class="nd">@property</span>
</span><span id="Horosphere.center-1389"><a href="#Horosphere.center-1389"><span class="linenos">1389</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Horosphere.center-1390"><a href="#Horosphere.center-1390"><span class="linenos">1390</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="Horosphere.reference" class="classattr">
                                        <input id="Horosphere.reference-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">reference</span>

                <label class="view-source-button" for="Horosphere.reference-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.reference"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.reference-1392"><a href="#Horosphere.reference-1392"><span class="linenos">1392</span></a>    <span class="nd">@property</span>
</span><span id="Horosphere.reference-1393"><a href="#Horosphere.reference-1393"><span class="linenos">1393</span></a>    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Horosphere.reference-1394"><a href="#Horosphere.reference-1394"><span class="linenos">1394</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="Horosphere.set_center_ref" class="classattr">
                                        <input id="Horosphere.set_center_ref-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_center_ref</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Horosphere.set_center_ref-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.set_center_ref"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.set_center_ref-1396"><a href="#Horosphere.set_center_ref-1396"><span class="linenos">1396</span></a>    <span class="k">def</span> <span class="nf">set_center_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">reference_point</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Horosphere.set_center_ref-1397"><a href="#Horosphere.set_center_ref-1397"><span class="linenos">1397</span></a>        <span class="k">if</span> <span class="n">reference_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Horosphere.set_center_ref-1398"><a href="#Horosphere.set_center_ref-1398"><span class="linenos">1398</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Horosphere.set_center_ref-1399"><a href="#Horosphere.set_center_ref-1399"><span class="linenos">1399</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Horosphere.set_center_ref-1400"><a href="#Horosphere.set_center_ref-1400"><span class="linenos">1400</span></a>            <span class="n">center</span> <span class="o">=</span> <span class="n">IdealPoint</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</span><span id="Horosphere.set_center_ref-1401"><a href="#Horosphere.set_center_ref-1401"><span class="linenos">1401</span></a>            <span class="n">ref</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">reference_point</span><span class="p">)</span>
</span><span id="Horosphere.set_center_ref-1402"><a href="#Horosphere.set_center_ref-1402"><span class="linenos">1402</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">ref</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Horosphere.set_center_ref-1403"><a href="#Horosphere.set_center_ref-1403"><span class="linenos">1403</span></a>
</span><span id="Horosphere.set_center_ref-1404"><a href="#Horosphere.set_center_ref-1404"><span class="linenos">1404</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Horosphere.sphere_parameters" class="classattr">
                                        <input id="Horosphere.sphere_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sphere_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Horosphere.sphere_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.sphere_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.sphere_parameters-1406"><a href="#Horosphere.sphere_parameters-1406"><span class="linenos">1406</span></a>    <span class="k">def</span> <span class="nf">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">):</span>
</span><span id="Horosphere.sphere_parameters-1407"><a href="#Horosphere.sphere_parameters-1407"><span class="linenos">1407</span></a>        <span class="sd">&quot;&quot;&quot;Get the center and radius of a sphere giving this horosphere in</span>
</span><span id="Horosphere.sphere_parameters-1408"><a href="#Horosphere.sphere_parameters-1408"><span class="linenos">1408</span></a><span class="sd">        poincare coordinates.</span>
</span><span id="Horosphere.sphere_parameters-1409"><a href="#Horosphere.sphere_parameters-1409"><span class="linenos">1409</span></a>
</span><span id="Horosphere.sphere_parameters-1410"><a href="#Horosphere.sphere_parameters-1410"><span class="linenos">1410</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Horosphere.sphere_parameters-1411"><a href="#Horosphere.sphere_parameters-1411"><span class="linenos">1411</span></a>        <span class="n">ideal_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere.sphere_parameters-1412"><a href="#Horosphere.sphere_parameters-1412"><span class="linenos">1412</span></a>        <span class="n">ref_coords</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere.sphere_parameters-1413"><a href="#Horosphere.sphere_parameters-1413"><span class="linenos">1413</span></a>
</span><span id="Horosphere.sphere_parameters-1414"><a href="#Horosphere.sphere_parameters-1414"><span class="linenos">1414</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">:</span>
</span><span id="Horosphere.sphere_parameters-1415"><a href="#Horosphere.sphere_parameters-1415"><span class="linenos">1415</span></a>            <span class="n">model_radius</span> <span class="o">=</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">ideal_coords</span> <span class="o">-</span> <span class="n">ref_coords</span><span class="p">)</span> <span class="o">/</span>
</span><span id="Horosphere.sphere_parameters-1416"><a href="#Horosphere.sphere_parameters-1416"><span class="linenos">1416</span></a>                            <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">ideal_coords</span><span class="p">,</span>
</span><span id="Horosphere.sphere_parameters-1417"><a href="#Horosphere.sphere_parameters-1417"><span class="linenos">1417</span></a>                                                           <span class="n">ref_coords</span><span class="p">))))</span>
</span><span id="Horosphere.sphere_parameters-1418"><a href="#Horosphere.sphere_parameters-1418"><span class="linenos">1418</span></a>            <span class="n">model_center</span> <span class="o">=</span> <span class="n">ideal_coords</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model_radius</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>
</span><span id="Horosphere.sphere_parameters-1419"><a href="#Horosphere.sphere_parameters-1419"><span class="linenos">1419</span></a>        <span class="k">elif</span> <span class="n">model</span> <span class="o">==</span> <span class="n">Model</span><span class="o">.</span><span class="n">HALFSPACE</span><span class="p">:</span>
</span><span id="Horosphere.sphere_parameters-1420"><a href="#Horosphere.sphere_parameters-1420"><span class="linenos">1420</span></a>            <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
</span><span id="Horosphere.sphere_parameters-1421"><a href="#Horosphere.sphere_parameters-1421"><span class="linenos">1421</span></a>                <span class="n">ideal_euc</span> <span class="o">=</span> <span class="n">ideal_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Horosphere.sphere_parameters-1422"><a href="#Horosphere.sphere_parameters-1422"><span class="linenos">1422</span></a>                <span class="n">ref_euc</span> <span class="o">=</span> <span class="n">ref_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Horosphere.sphere_parameters-1423"><a href="#Horosphere.sphere_parameters-1423"><span class="linenos">1423</span></a>                <span class="n">ref_z</span> <span class="o">=</span> <span class="n">ref_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Horosphere.sphere_parameters-1424"><a href="#Horosphere.sphere_parameters-1424"><span class="linenos">1424</span></a>
</span><span id="Horosphere.sphere_parameters-1425"><a href="#Horosphere.sphere_parameters-1425"><span class="linenos">1425</span></a>
</span><span id="Horosphere.sphere_parameters-1426"><a href="#Horosphere.sphere_parameters-1426"><span class="linenos">1426</span></a>                <span class="n">model_radius</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">ideal_euc</span> <span class="o">-</span> <span class="n">ref_euc</span><span class="p">)</span> <span class="o">/</span> <span class="n">ref_z</span> <span class="o">+</span> <span class="n">ref_z</span><span class="p">)</span>
</span><span id="Horosphere.sphere_parameters-1427"><a href="#Horosphere.sphere_parameters-1427"><span class="linenos">1427</span></a>                <span class="n">model_center</span> <span class="o">=</span> <span class="n">ideal_coords</span><span class="p">[:]</span>
</span><span id="Horosphere.sphere_parameters-1428"><a href="#Horosphere.sphere_parameters-1428"><span class="linenos">1428</span></a>                <span class="n">model_center</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_radius</span>
</span><span id="Horosphere.sphere_parameters-1429"><a href="#Horosphere.sphere_parameters-1429"><span class="linenos">1429</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Horosphere.sphere_parameters-1430"><a href="#Horosphere.sphere_parameters-1430"><span class="linenos">1430</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="Horosphere.sphere_parameters-1431"><a href="#Horosphere.sphere_parameters-1431"><span class="linenos">1431</span></a>                <span class="s2">&quot;No implementation for spherical parameters for a horosphere in&quot;</span>
</span><span id="Horosphere.sphere_parameters-1432"><a href="#Horosphere.sphere_parameters-1432"><span class="linenos">1432</span></a>                <span class="s2">&quot; model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="Horosphere.sphere_parameters-1433"><a href="#Horosphere.sphere_parameters-1433"><span class="linenos">1433</span></a>            <span class="p">)</span>
</span><span id="Horosphere.sphere_parameters-1434"><a href="#Horosphere.sphere_parameters-1434"><span class="linenos">1434</span></a>
</span><span id="Horosphere.sphere_parameters-1435"><a href="#Horosphere.sphere_parameters-1435"><span class="linenos">1435</span></a>        <span class="k">return</span> <span class="n">model_center</span><span class="p">,</span> <span class="n">model_radius</span>
</span></pre></div>


            <div class="docstring"><p>Get the center and radius of a sphere giving this horosphere in
poincare coordinates.</p>
</div>


                            </div>
                            <div id="Horosphere.center_coords" class="classattr">
                                        <input id="Horosphere.center_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">center_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.KLEIN">Model.KLEIN</a></span><span class="p">:</span> <span class="s1">&#39;klein&#39;</span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Horosphere.center_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.center_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.center_coords-1437"><a href="#Horosphere.center_coords-1437"><span class="linenos">1437</span></a>    <span class="k">def</span> <span class="nf">center_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">):</span>
</span><span id="Horosphere.center_coords-1438"><a href="#Horosphere.center_coords-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Horosphere.ref_coords" class="classattr">
                                        <input id="Horosphere.ref_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ref_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Horosphere.ref_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.ref_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.ref_coords-1440"><a href="#Horosphere.ref_coords-1440"><span class="linenos">1440</span></a>    <span class="k">def</span> <span class="nf">ref_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
</span><span id="Horosphere.ref_coords-1441"><a href="#Horosphere.ref_coords-1441"><span class="linenos">1441</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reference</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Horosphere.intersect_geodesic" class="classattr">
                                        <input id="Horosphere.intersect_geodesic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">intersect_geodesic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">geodesic</span>, </span><span class="param"><span class="n">p2</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Horosphere.intersect_geodesic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Horosphere.intersect_geodesic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Horosphere.intersect_geodesic-1443"><a href="#Horosphere.intersect_geodesic-1443"><span class="linenos">1443</span></a>    <span class="k">def</span> <span class="nf">intersect_geodesic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">geodesic</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="Horosphere.intersect_geodesic-1444"><a href="#Horosphere.intersect_geodesic-1444"><span class="linenos">1444</span></a>        <span class="sd">&quot;&quot;&quot;Compute the intersection points of a geodesic with this horosphere</span>
</span><span id="Horosphere.intersect_geodesic-1445"><a href="#Horosphere.intersect_geodesic-1445"><span class="linenos">1445</span></a>
</span><span id="Horosphere.intersect_geodesic-1446"><a href="#Horosphere.intersect_geodesic-1446"><span class="linenos">1446</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Horosphere.intersect_geodesic-1447"><a href="#Horosphere.intersect_geodesic-1447"><span class="linenos">1447</span></a>        <span class="n">segment</span> <span class="o">=</span> <span class="n">Segment</span><span class="p">(</span><span class="n">geodesic</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1448"><a href="#Horosphere.intersect_geodesic-1448"><span class="linenos">1448</span></a>        <span class="n">geodesic_endpts</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">ideal_endpoint_coords</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1449"><a href="#Horosphere.intersect_geodesic-1449"><span class="linenos">1449</span></a>
</span><span id="Horosphere.intersect_geodesic-1450"><a href="#Horosphere.intersect_geodesic-1450"><span class="linenos">1450</span></a>        <span class="c1"># compute an isometry taking this geodesic to one which passes</span>
</span><span id="Horosphere.intersect_geodesic-1451"><a href="#Horosphere.intersect_geodesic-1451"><span class="linenos">1451</span></a>        <span class="c1"># through the origin (so we can do intersection calculations</span>
</span><span id="Horosphere.intersect_geodesic-1452"><a href="#Horosphere.intersect_geodesic-1452"><span class="linenos">1452</span></a>        <span class="c1"># in Euclidean geometry)</span>
</span><span id="Horosphere.intersect_geodesic-1453"><a href="#Horosphere.intersect_geodesic-1453"><span class="linenos">1453</span></a>        <span class="n">midpt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">((</span><span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="Horosphere.intersect_geodesic-1454"><a href="#Horosphere.intersect_geodesic-1454"><span class="linenos">1454</span></a>                       <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1455"><a href="#Horosphere.intersect_geodesic-1455"><span class="linenos">1455</span></a>        <span class="n">coord_change</span> <span class="o">=</span> <span class="n">midpt</span><span class="o">.</span><span class="n">origin_to</span><span class="p">()</span>
</span><span id="Horosphere.intersect_geodesic-1456"><a href="#Horosphere.intersect_geodesic-1456"><span class="linenos">1456</span></a>        <span class="n">coord_inv</span> <span class="o">=</span> <span class="n">coord_change</span><span class="o">.</span><span class="n">inv</span><span class="p">()</span>
</span><span id="Horosphere.intersect_geodesic-1457"><a href="#Horosphere.intersect_geodesic-1457"><span class="linenos">1457</span></a>
</span><span id="Horosphere.intersect_geodesic-1458"><a href="#Horosphere.intersect_geodesic-1458"><span class="linenos">1458</span></a>        <span class="n">c_hsph</span> <span class="o">=</span> <span class="n">coord_inv</span> <span class="o">@</span> <span class="bp">self</span>
</span><span id="Horosphere.intersect_geodesic-1459"><a href="#Horosphere.intersect_geodesic-1459"><span class="linenos">1459</span></a>        <span class="n">c_seg</span> <span class="o">=</span> <span class="n">coord_inv</span> <span class="o">@</span> <span class="n">segment</span>
</span><span id="Horosphere.intersect_geodesic-1460"><a href="#Horosphere.intersect_geodesic-1460"><span class="linenos">1460</span></a>
</span><span id="Horosphere.intersect_geodesic-1461"><a href="#Horosphere.intersect_geodesic-1461"><span class="linenos">1461</span></a>        <span class="n">p_center</span><span class="p">,</span> <span class="n">p_radius</span> <span class="o">=</span> <span class="n">c_hsph</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">()</span>
</span><span id="Horosphere.intersect_geodesic-1462"><a href="#Horosphere.intersect_geodesic-1462"><span class="linenos">1462</span></a>        <span class="n">geodesic_endpts</span> <span class="o">=</span> <span class="n">c_seg</span><span class="o">.</span><span class="n">ideal_endpoint_coords</span><span class="p">(</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1463"><a href="#Horosphere.intersect_geodesic-1463"><span class="linenos">1463</span></a>
</span><span id="Horosphere.intersect_geodesic-1464"><a href="#Horosphere.intersect_geodesic-1464"><span class="linenos">1464</span></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Horosphere.intersect_geodesic-1465"><a href="#Horosphere.intersect_geodesic-1465"><span class="linenos">1465</span></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">geodesic_endpts</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="Horosphere.intersect_geodesic-1466"><a href="#Horosphere.intersect_geodesic-1466"><span class="linenos">1466</span></a>
</span><span id="Horosphere.intersect_geodesic-1467"><a href="#Horosphere.intersect_geodesic-1467"><span class="linenos">1467</span></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">u</span> <span class="o">-</span> <span class="n">v</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1468"><a href="#Horosphere.intersect_geodesic-1468"><span class="linenos">1468</span></a>        <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">((</span><span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">p_center</span><span class="p">,</span> <span class="n">v</span> <span class="o">-</span> <span class="n">u</span><span class="p">)</span> <span class="o">+</span>
</span><span id="Horosphere.intersect_geodesic-1469"><a href="#Horosphere.intersect_geodesic-1469"><span class="linenos">1469</span></a>                  <span class="n">utils</span><span class="o">.</span><span class="n">apply_bilinear</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-</span>
</span><span id="Horosphere.intersect_geodesic-1470"><a href="#Horosphere.intersect_geodesic-1470"><span class="linenos">1470</span></a>                  <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
</span><span id="Horosphere.intersect_geodesic-1471"><a href="#Horosphere.intersect_geodesic-1471"><span class="linenos">1471</span></a>        <span class="n">c</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">p_center</span><span class="p">)</span> <span class="o">-</span> <span class="n">p_radius</span><span class="o">**</span><span class="mi">2</span>
</span><span id="Horosphere.intersect_geodesic-1472"><a href="#Horosphere.intersect_geodesic-1472"><span class="linenos">1472</span></a>
</span><span id="Horosphere.intersect_geodesic-1473"><a href="#Horosphere.intersect_geodesic-1473"><span class="linenos">1473</span></a>        <span class="c1">#TODO: check to see if the intersection actually occurs</span>
</span><span id="Horosphere.intersect_geodesic-1474"><a href="#Horosphere.intersect_geodesic-1474"><span class="linenos">1474</span></a>        <span class="n">t1</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">b</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1475"><a href="#Horosphere.intersect_geodesic-1475"><span class="linenos">1475</span></a>        <span class="n">t2</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">b</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">c</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">a</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1476"><a href="#Horosphere.intersect_geodesic-1476"><span class="linenos">1476</span></a>
</span><span id="Horosphere.intersect_geodesic-1477"><a href="#Horosphere.intersect_geodesic-1477"><span class="linenos">1477</span></a>        <span class="n">p1_poincare</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="Horosphere.intersect_geodesic-1478"><a href="#Horosphere.intersect_geodesic-1478"><span class="linenos">1478</span></a>        <span class="n">p2_poincare</span> <span class="o">=</span> <span class="n">t2</span> <span class="o">*</span> <span class="n">u</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">t2</span><span class="p">)</span> <span class="o">*</span> <span class="n">v</span>
</span><span id="Horosphere.intersect_geodesic-1479"><a href="#Horosphere.intersect_geodesic-1479"><span class="linenos">1479</span></a>
</span><span id="Horosphere.intersect_geodesic-1480"><a href="#Horosphere.intersect_geodesic-1480"><span class="linenos">1480</span></a>        <span class="n">poincare_pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">p1_poincare</span><span class="p">,</span> <span class="n">p2_poincare</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1481"><a href="#Horosphere.intersect_geodesic-1481"><span class="linenos">1481</span></a>        <span class="n">klein_pts</span> <span class="o">=</span> <span class="n">poincare_to_kleinian</span><span class="p">(</span><span class="n">poincare_pts</span><span class="p">)</span>
</span><span id="Horosphere.intersect_geodesic-1482"><a href="#Horosphere.intersect_geodesic-1482"><span class="linenos">1482</span></a>
</span><span id="Horosphere.intersect_geodesic-1483"><a href="#Horosphere.intersect_geodesic-1483"><span class="linenos">1483</span></a>        <span class="k">return</span> <span class="n">coord_change</span> <span class="o">@</span> <span class="n">Point</span><span class="p">(</span><span class="n">klein_pts</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Compute the intersection points of a geodesic with this horosphere</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Horosphere.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Horosphere.coords" class="function"><a href="#HyperbolicObject.coords">coords</a></dd>
                <dd id="Horosphere.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Horosphere.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Horosphere.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Horosphere.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Horosphere.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Horosphere.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Horosphere.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Horosphere.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Horosphere.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Horosphere.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Horosphere.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Horosphere.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Horosphere.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HorosphereArc">
                            <input id="HorosphereArc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">HorosphereArc</span><wbr>(<span class="base"><a href="#Horosphere">Horosphere</a></span>, <span class="base"><a href="#PointPair">PointPair</a></span>):

                <label class="view-source-button" for="HorosphereArc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc-1485"><a href="#HorosphereArc-1485"><span class="linenos">1485</span></a><span class="k">class</span> <span class="nc">HorosphereArc</span><span class="p">(</span><span class="n">Horosphere</span><span class="p">,</span> <span class="n">PointPair</span><span class="p">):</span>
</span><span id="HorosphereArc-1486"><a href="#HorosphereArc-1486"><span class="linenos">1486</span></a>    <span class="sd">&quot;&quot;&quot;Model for an arc lying along a horosphere</span>
</span><span id="HorosphereArc-1487"><a href="#HorosphereArc-1487"><span class="linenos">1487</span></a>
</span><span id="HorosphereArc-1488"><a href="#HorosphereArc-1488"><span class="linenos">1488</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="HorosphereArc-1489"><a href="#HorosphereArc-1489"><span class="linenos">1489</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HorosphereArc-1490"><a href="#HorosphereArc-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="HorosphereArc-1491"><a href="#HorosphereArc-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="HorosphereArc-1492"><a href="#HorosphereArc-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="HorosphereArc-1493"><a href="#HorosphereArc-1493"><span class="linenos">1493</span></a>
</span><span id="HorosphereArc-1494"><a href="#HorosphereArc-1494"><span class="linenos">1494</span></a>        <span class="k">if</span> <span class="n">p1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HorosphereArc-1495"><a href="#HorosphereArc-1495"><span class="linenos">1495</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="HorosphereArc-1496"><a href="#HorosphereArc-1496"><span class="linenos">1496</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HorosphereArc-1497"><a href="#HorosphereArc-1497"><span class="linenos">1497</span></a>                <span class="k">return</span>
</span><span id="HorosphereArc-1498"><a href="#HorosphereArc-1498"><span class="linenos">1498</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="HorosphereArc-1499"><a href="#HorosphereArc-1499"><span class="linenos">1499</span></a>                <span class="k">pass</span>
</span><span id="HorosphereArc-1500"><a href="#HorosphereArc-1500"><span class="linenos">1500</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="HorosphereArc-1501"><a href="#HorosphereArc-1501"><span class="linenos">1501</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HorosphereArc-1502"><a href="#HorosphereArc-1502"><span class="linenos">1502</span></a>                <span class="k">return</span>
</span><span id="HorosphereArc-1503"><a href="#HorosphereArc-1503"><span class="linenos">1503</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="HorosphereArc-1504"><a href="#HorosphereArc-1504"><span class="linenos">1504</span></a>                <span class="k">pass</span>
</span><span id="HorosphereArc-1505"><a href="#HorosphereArc-1505"><span class="linenos">1505</span></a>
</span><span id="HorosphereArc-1506"><a href="#HorosphereArc-1506"><span class="linenos">1506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_center_endpoints</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HorosphereArc-1507"><a href="#HorosphereArc-1507"><span class="linenos">1507</span></a>
</span><span id="HorosphereArc-1508"><a href="#HorosphereArc-1508"><span class="linenos">1508</span></a>    <span class="k">def</span> <span class="nf">set_center_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HorosphereArc-1509"><a href="#HorosphereArc-1509"><span class="linenos">1509</span></a>        <span class="k">if</span> <span class="p">((</span><span class="n">p1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="HorosphereArc-1510"><a href="#HorosphereArc-1510"><span class="linenos">1510</span></a>            <span class="p">(</span><span class="n">p1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="HorosphereArc-1511"><a href="#HorosphereArc-1511"><span class="linenos">1511</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="HorosphereArc-1512"><a href="#HorosphereArc-1512"><span class="linenos">1512</span></a>                <span class="s2">&quot;Horospherical arc determined by two endpoints and a centerpoint, but&quot;</span>
</span><span id="HorosphereArc-1513"><a href="#HorosphereArc-1513"><span class="linenos">1513</span></a>                <span class="s2">&quot; this was not provided&quot;</span>
</span><span id="HorosphereArc-1514"><a href="#HorosphereArc-1514"><span class="linenos">1514</span></a>            <span class="p">)</span>
</span><span id="HorosphereArc-1515"><a href="#HorosphereArc-1515"><span class="linenos">1515</span></a>
</span><span id="HorosphereArc-1516"><a href="#HorosphereArc-1516"><span class="linenos">1516</span></a>        <span class="k">if</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HorosphereArc-1517"><a href="#HorosphereArc-1517"><span class="linenos">1517</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc-1518"><a href="#HorosphereArc-1518"><span class="linenos">1518</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="HorosphereArc-1519"><a href="#HorosphereArc-1519"><span class="linenos">1519</span></a>            <span class="n">center_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc-1520"><a href="#HorosphereArc-1520"><span class="linenos">1520</span></a>            <span class="n">p1_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc-1521"><a href="#HorosphereArc-1521"><span class="linenos">1521</span></a>            <span class="n">p2_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc-1522"><a href="#HorosphereArc-1522"><span class="linenos">1522</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center_data</span><span class="p">,</span> <span class="n">p1_data</span><span class="p">,</span> <span class="n">p2_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="HorosphereArc-1523"><a href="#HorosphereArc-1523"><span class="linenos">1523</span></a>
</span><span id="HorosphereArc-1524"><a href="#HorosphereArc-1524"><span class="linenos">1524</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HorosphereArc-1525"><a href="#HorosphereArc-1525"><span class="linenos">1525</span></a>
</span><span id="HorosphereArc-1526"><a href="#HorosphereArc-1526"><span class="linenos">1526</span></a>    <span class="nd">@property</span>
</span><span id="HorosphereArc-1527"><a href="#HorosphereArc-1527"><span class="linenos">1527</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HorosphereArc-1528"><a href="#HorosphereArc-1528"><span class="linenos">1528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="HorosphereArc-1529"><a href="#HorosphereArc-1529"><span class="linenos">1529</span></a>
</span><span id="HorosphereArc-1530"><a href="#HorosphereArc-1530"><span class="linenos">1530</span></a>    <span class="nd">@property</span>
</span><span id="HorosphereArc-1531"><a href="#HorosphereArc-1531"><span class="linenos">1531</span></a>    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HorosphereArc-1532"><a href="#HorosphereArc-1532"><span class="linenos">1532</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="HorosphereArc-1533"><a href="#HorosphereArc-1533"><span class="linenos">1533</span></a>
</span><span id="HorosphereArc-1534"><a href="#HorosphereArc-1534"><span class="linenos">1534</span></a>    <span class="nd">@property</span>
</span><span id="HorosphereArc-1535"><a href="#HorosphereArc-1535"><span class="linenos">1535</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HorosphereArc-1536"><a href="#HorosphereArc-1536"><span class="linenos">1536</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span><span id="HorosphereArc-1537"><a href="#HorosphereArc-1537"><span class="linenos">1537</span></a>
</span><span id="HorosphereArc-1538"><a href="#HorosphereArc-1538"><span class="linenos">1538</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="HorosphereArc-1539"><a href="#HorosphereArc-1539"><span class="linenos">1539</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters for a circle describing this horospherical arc.</span>
</span><span id="HorosphereArc-1540"><a href="#HorosphereArc-1540"><span class="linenos">1540</span></a>
</span><span id="HorosphereArc-1541"><a href="#HorosphereArc-1541"><span class="linenos">1541</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HorosphereArc-1542"><a href="#HorosphereArc-1542"><span class="linenos">1542</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">Horosphere</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="HorosphereArc-1543"><a href="#HorosphereArc-1543"><span class="linenos">1543</span></a>        <span class="n">model_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="HorosphereArc-1544"><a href="#HorosphereArc-1544"><span class="linenos">1544</span></a>
</span><span id="HorosphereArc-1545"><a href="#HorosphereArc-1545"><span class="linenos">1545</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">model_coords</span><span class="p">)</span>
</span><span id="HorosphereArc-1546"><a href="#HorosphereArc-1546"><span class="linenos">1546</span></a>
</span><span id="HorosphereArc-1547"><a href="#HorosphereArc-1547"><span class="linenos">1547</span></a>        <span class="n">center_theta</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span>
</span><span id="HorosphereArc-1548"><a href="#HorosphereArc-1548"><span class="linenos">1548</span></a>            <span class="n">center</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="HorosphereArc-1549"><a href="#HorosphereArc-1549"><span class="linenos">1549</span></a>        <span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="HorosphereArc-1550"><a href="#HorosphereArc-1550"><span class="linenos">1550</span></a>
</span><span id="HorosphereArc-1551"><a href="#HorosphereArc-1551"><span class="linenos">1551</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">arc_include</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">center_theta</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="HorosphereArc-1552"><a href="#HorosphereArc-1552"><span class="linenos">1552</span></a>
</span><span id="HorosphereArc-1553"><a href="#HorosphereArc-1553"><span class="linenos">1553</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="HorosphereArc-1554"><a href="#HorosphereArc-1554"><span class="linenos">1554</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="HorosphereArc-1555"><a href="#HorosphereArc-1555"><span class="linenos">1555</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="HorosphereArc-1556"><a href="#HorosphereArc-1556"><span class="linenos">1556</span></a>
</span><span id="HorosphereArc-1557"><a href="#HorosphereArc-1557"><span class="linenos">1557</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Model for an arc lying along a horosphere</p>
</div>


                            <div id="HorosphereArc.__init__" class="classattr">
                                        <input id="HorosphereArc.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">HorosphereArc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">p1</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">p2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="HorosphereArc.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc.__init__-1489"><a href="#HorosphereArc.__init__-1489"><span class="linenos">1489</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HorosphereArc.__init__-1490"><a href="#HorosphereArc.__init__-1490"><span class="linenos">1490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">unit_ndims</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="HorosphereArc.__init__-1491"><a href="#HorosphereArc.__init__-1491"><span class="linenos">1491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">aux_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="HorosphereArc.__init__-1492"><a href="#HorosphereArc.__init__-1492"><span class="linenos">1492</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">dual_ndims</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="HorosphereArc.__init__-1493"><a href="#HorosphereArc.__init__-1493"><span class="linenos">1493</span></a>
</span><span id="HorosphereArc.__init__-1494"><a href="#HorosphereArc.__init__-1494"><span class="linenos">1494</span></a>        <span class="k">if</span> <span class="n">p1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HorosphereArc.__init__-1495"><a href="#HorosphereArc.__init__-1495"><span class="linenos">1495</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="HorosphereArc.__init__-1496"><a href="#HorosphereArc.__init__-1496"><span class="linenos">1496</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_construct_from_object</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HorosphereArc.__init__-1497"><a href="#HorosphereArc.__init__-1497"><span class="linenos">1497</span></a>                <span class="k">return</span>
</span><span id="HorosphereArc.__init__-1498"><a href="#HorosphereArc.__init__-1498"><span class="linenos">1498</span></a>            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
</span><span id="HorosphereArc.__init__-1499"><a href="#HorosphereArc.__init__-1499"><span class="linenos">1499</span></a>                <span class="k">pass</span>
</span><span id="HorosphereArc.__init__-1500"><a href="#HorosphereArc.__init__-1500"><span class="linenos">1500</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="HorosphereArc.__init__-1501"><a href="#HorosphereArc.__init__-1501"><span class="linenos">1501</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HorosphereArc.__init__-1502"><a href="#HorosphereArc.__init__-1502"><span class="linenos">1502</span></a>                <span class="k">return</span>
</span><span id="HorosphereArc.__init__-1503"><a href="#HorosphereArc.__init__-1503"><span class="linenos">1503</span></a>            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">GeometryError</span><span class="p">):</span>
</span><span id="HorosphereArc.__init__-1504"><a href="#HorosphereArc.__init__-1504"><span class="linenos">1504</span></a>                <span class="k">pass</span>
</span><span id="HorosphereArc.__init__-1505"><a href="#HorosphereArc.__init__-1505"><span class="linenos">1505</span></a>
</span><span id="HorosphereArc.__init__-1506"><a href="#HorosphereArc.__init__-1506"><span class="linenos">1506</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set_center_endpoints</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If <code>reference_point</code> is <code>None</code>, interpret <code><a href="#HorosphereArc.center">center</a></code> as either:</p>

<ul>
<li><p>a (..., 2, n) <code>ndarray</code>, where first row of the last two
ndindices gives the (ideal) center point for this horosphere,
and the second row gives some reference point on the
horosphere itself, or</p></li>
<li><p>a <code><a href="#HyperbolicObject">HyperbolicObject</a></code> whose underlying data has the form above.</p></li>
</ul>

<p>If <code>reference_point</code> is given, then <code><a href="#HorosphereArc.center">center</a></code> can be used to
construct an <code><a href="#IdealPoint">IdealPoint</a></code> giving the center of the horosphere,
and <code>reference_point</code> can be used to construct a <code><a href="#Point">Point</a></code>
giving some point on the horosphere.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>center</strong> (Point or ndarray):
The (ideal) center point for this horosphere, or an object
which can be unpacked into all of the data for the
horosphere</li>
<li><strong>reference_point</strong> (Point or ndarray):
Any point lying on the horosphere itself. If <code>None</code>, then
<code><a href="#HorosphereArc.center">center</a></code> contains the data for the reference point as
well.</li>
</ul>
</div>


                            </div>
                            <div id="HorosphereArc.unit_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">unit_ndims</span>

        
    </div>
    <a class="headerlink" href="#HorosphereArc.unit_ndims"></a>
    
    

                            </div>
                            <div id="HorosphereArc.aux_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">aux_ndims</span>

        
    </div>
    <a class="headerlink" href="#HorosphereArc.aux_ndims"></a>
    
    

                            </div>
                            <div id="HorosphereArc.dual_ndims" class="classattr">
                                <div class="attr variable">
            <span class="name">dual_ndims</span>

        
    </div>
    <a class="headerlink" href="#HorosphereArc.dual_ndims"></a>
    
    

                            </div>
                            <div id="HorosphereArc.set_center_endpoints" class="classattr">
                                        <input id="HorosphereArc.set_center_endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_center_endpoints</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">center</span>, </span><span class="param"><span class="n">p1</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">p2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HorosphereArc.set_center_endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc.set_center_endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc.set_center_endpoints-1508"><a href="#HorosphereArc.set_center_endpoints-1508"><span class="linenos">1508</span></a>    <span class="k">def</span> <span class="nf">set_center_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">p1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HorosphereArc.set_center_endpoints-1509"><a href="#HorosphereArc.set_center_endpoints-1509"><span class="linenos">1509</span></a>        <span class="k">if</span> <span class="p">((</span><span class="n">p1</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span>
</span><span id="HorosphereArc.set_center_endpoints-1510"><a href="#HorosphereArc.set_center_endpoints-1510"><span class="linenos">1510</span></a>            <span class="p">(</span><span class="n">p1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
</span><span id="HorosphereArc.set_center_endpoints-1511"><a href="#HorosphereArc.set_center_endpoints-1511"><span class="linenos">1511</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="HorosphereArc.set_center_endpoints-1512"><a href="#HorosphereArc.set_center_endpoints-1512"><span class="linenos">1512</span></a>                <span class="s2">&quot;Horospherical arc determined by two endpoints and a centerpoint, but&quot;</span>
</span><span id="HorosphereArc.set_center_endpoints-1513"><a href="#HorosphereArc.set_center_endpoints-1513"><span class="linenos">1513</span></a>                <span class="s2">&quot; this was not provided&quot;</span>
</span><span id="HorosphereArc.set_center_endpoints-1514"><a href="#HorosphereArc.set_center_endpoints-1514"><span class="linenos">1514</span></a>            <span class="p">)</span>
</span><span id="HorosphereArc.set_center_endpoints-1515"><a href="#HorosphereArc.set_center_endpoints-1515"><span class="linenos">1515</span></a>
</span><span id="HorosphereArc.set_center_endpoints-1516"><a href="#HorosphereArc.set_center_endpoints-1516"><span class="linenos">1516</span></a>        <span class="k">if</span> <span class="n">p2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="HorosphereArc.set_center_endpoints-1517"><a href="#HorosphereArc.set_center_endpoints-1517"><span class="linenos">1517</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc.set_center_endpoints-1518"><a href="#HorosphereArc.set_center_endpoints-1518"><span class="linenos">1518</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="HorosphereArc.set_center_endpoints-1519"><a href="#HorosphereArc.set_center_endpoints-1519"><span class="linenos">1519</span></a>            <span class="n">center_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc.set_center_endpoints-1520"><a href="#HorosphereArc.set_center_endpoints-1520"><span class="linenos">1520</span></a>            <span class="n">p1_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc.set_center_endpoints-1521"><a href="#HorosphereArc.set_center_endpoints-1521"><span class="linenos">1521</span></a>            <span class="n">p2_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="HorosphereArc.set_center_endpoints-1522"><a href="#HorosphereArc.set_center_endpoints-1522"><span class="linenos">1522</span></a>            <span class="n">proj_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">center_data</span><span class="p">,</span> <span class="n">p1_data</span><span class="p">,</span> <span class="n">p2_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="HorosphereArc.set_center_endpoints-1523"><a href="#HorosphereArc.set_center_endpoints-1523"><span class="linenos">1523</span></a>
</span><span id="HorosphereArc.set_center_endpoints-1524"><a href="#HorosphereArc.set_center_endpoints-1524"><span class="linenos">1524</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="HorosphereArc.center" class="classattr">
                                        <input id="HorosphereArc.center-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">center</span>

                <label class="view-source-button" for="HorosphereArc.center-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc.center"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc.center-1526"><a href="#HorosphereArc.center-1526"><span class="linenos">1526</span></a>    <span class="nd">@property</span>
</span><span id="HorosphereArc.center-1527"><a href="#HorosphereArc.center-1527"><span class="linenos">1527</span></a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HorosphereArc.center-1528"><a href="#HorosphereArc.center-1528"><span class="linenos">1528</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="HorosphereArc.reference" class="classattr">
                                        <input id="HorosphereArc.reference-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">reference</span>

                <label class="view-source-button" for="HorosphereArc.reference-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc.reference"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc.reference-1530"><a href="#HorosphereArc.reference-1530"><span class="linenos">1530</span></a>    <span class="nd">@property</span>
</span><span id="HorosphereArc.reference-1531"><a href="#HorosphereArc.reference-1531"><span class="linenos">1531</span></a>    <span class="k">def</span> <span class="nf">reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HorosphereArc.reference-1532"><a href="#HorosphereArc.reference-1532"><span class="linenos">1532</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="HorosphereArc.endpoints" class="classattr">
                                        <input id="HorosphereArc.endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">endpoints</span>

                <label class="view-source-button" for="HorosphereArc.endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc.endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc.endpoints-1534"><a href="#HorosphereArc.endpoints-1534"><span class="linenos">1534</span></a>    <span class="nd">@property</span>
</span><span id="HorosphereArc.endpoints-1535"><a href="#HorosphereArc.endpoints-1535"><span class="linenos">1535</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="HorosphereArc.endpoints-1536"><a href="#HorosphereArc.endpoints-1536"><span class="linenos">1536</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="HorosphereArc.circle_parameters" class="classattr">
                                        <input id="HorosphereArc.circle_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span>, </span><span class="param"><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HorosphereArc.circle_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HorosphereArc.circle_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HorosphereArc.circle_parameters-1538"><a href="#HorosphereArc.circle_parameters-1538"><span class="linenos">1538</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="HorosphereArc.circle_parameters-1539"><a href="#HorosphereArc.circle_parameters-1539"><span class="linenos">1539</span></a>        <span class="sd">&quot;&quot;&quot;Get parameters for a circle describing this horospherical arc.</span>
</span><span id="HorosphereArc.circle_parameters-1540"><a href="#HorosphereArc.circle_parameters-1540"><span class="linenos">1540</span></a>
</span><span id="HorosphereArc.circle_parameters-1541"><a href="#HorosphereArc.circle_parameters-1541"><span class="linenos">1541</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HorosphereArc.circle_parameters-1542"><a href="#HorosphereArc.circle_parameters-1542"><span class="linenos">1542</span></a>        <span class="n">center</span><span class="p">,</span> <span class="n">radius</span> <span class="o">=</span> <span class="n">Horosphere</span><span class="o">.</span><span class="n">sphere_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="HorosphereArc.circle_parameters-1543"><a href="#HorosphereArc.circle_parameters-1543"><span class="linenos">1543</span></a>        <span class="n">model_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="HorosphereArc.circle_parameters-1544"><a href="#HorosphereArc.circle_parameters-1544"><span class="linenos">1544</span></a>
</span><span id="HorosphereArc.circle_parameters-1545"><a href="#HorosphereArc.circle_parameters-1545"><span class="linenos">1545</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">model_coords</span><span class="p">)</span>
</span><span id="HorosphereArc.circle_parameters-1546"><a href="#HorosphereArc.circle_parameters-1546"><span class="linenos">1546</span></a>
</span><span id="HorosphereArc.circle_parameters-1547"><a href="#HorosphereArc.circle_parameters-1547"><span class="linenos">1547</span></a>        <span class="n">center_theta</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span>
</span><span id="HorosphereArc.circle_parameters-1548"><a href="#HorosphereArc.circle_parameters-1548"><span class="linenos">1548</span></a>            <span class="n">center</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">center_coords</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">)</span>
</span><span id="HorosphereArc.circle_parameters-1549"><a href="#HorosphereArc.circle_parameters-1549"><span class="linenos">1549</span></a>        <span class="p">)[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="HorosphereArc.circle_parameters-1550"><a href="#HorosphereArc.circle_parameters-1550"><span class="linenos">1550</span></a>
</span><span id="HorosphereArc.circle_parameters-1551"><a href="#HorosphereArc.circle_parameters-1551"><span class="linenos">1551</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">arc_include</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">center_theta</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="HorosphereArc.circle_parameters-1552"><a href="#HorosphereArc.circle_parameters-1552"><span class="linenos">1552</span></a>
</span><span id="HorosphereArc.circle_parameters-1553"><a href="#HorosphereArc.circle_parameters-1553"><span class="linenos">1553</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">thetas</span><span class="p">)</span>
</span><span id="HorosphereArc.circle_parameters-1554"><a href="#HorosphereArc.circle_parameters-1554"><span class="linenos">1554</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="HorosphereArc.circle_parameters-1555"><a href="#HorosphereArc.circle_parameters-1555"><span class="linenos">1555</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">pi</span>
</span><span id="HorosphereArc.circle_parameters-1556"><a href="#HorosphereArc.circle_parameters-1556"><span class="linenos">1556</span></a>
</span><span id="HorosphereArc.circle_parameters-1557"><a href="#HorosphereArc.circle_parameters-1557"><span class="linenos">1557</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Get parameters for a circle describing this horospherical arc.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Horosphere">Horosphere</a></dt>
                                <dd id="HorosphereArc.set_center_ref" class="function"><a href="#Horosphere.set_center_ref">set_center_ref</a></dd>
                <dd id="HorosphereArc.sphere_parameters" class="function"><a href="#Horosphere.sphere_parameters">sphere_parameters</a></dd>
                <dd id="HorosphereArc.center_coords" class="function"><a href="#Horosphere.center_coords">center_coords</a></dd>
                <dd id="HorosphereArc.ref_coords" class="function"><a href="#Horosphere.ref_coords">ref_coords</a></dd>
                <dd id="HorosphereArc.intersect_geodesic" class="function"><a href="#Horosphere.intersect_geodesic">intersect_geodesic</a></dd>

            </div>
            <div><dt><a href="#PointPair">PointPair</a></dt>
                                <dd id="HorosphereArc.endpoint_coords" class="function"><a href="#PointPair.endpoint_coords">endpoint_coords</a></dd>
                <dd id="HorosphereArc.get_endpoints" class="function"><a href="#PointPair.get_endpoints">get_endpoints</a></dd>
                <dd id="HorosphereArc.get_end_pair" class="function"><a href="#PointPair.get_end_pair">get_end_pair</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="HorosphereArc.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="HorosphereArc.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="HorosphereArc.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="HorosphereArc.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="HorosphereArc.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="HorosphereArc.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="HorosphereArc.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="HorosphereArc.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="HorosphereArc.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="HorosphereArc.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></dt>
                                <dd id="HorosphereArc.set_endpoints" class="function"><a href="projective.html#PointPair.set_endpoints">set_endpoints</a></dd>
                <dd id="HorosphereArc.endpoint_affine_coords" class="function"><a href="projective.html#PointPair.endpoint_affine_coords">endpoint_affine_coords</a></dd>
                <dd id="HorosphereArc.endpoint_projective_coords" class="function"><a href="projective.html#PointPair.endpoint_projective_coords">endpoint_projective_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="HorosphereArc.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="HorosphereArc.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="HorosphereArc.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="HorosphereArc.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="HorosphereArc.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="HorosphereArc.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="HorosphereArc.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="HorosphereArc.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="HorosphereArc.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="HorosphereArc.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="HorosphereArc.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="HorosphereArc.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="HorosphereArc.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="BoundaryArc">
                            <input id="BoundaryArc-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">BoundaryArc</span><wbr>(<span class="base"><a href="#Geodesic">Geodesic</a></span>):

                <label class="view-source-button" for="BoundaryArc-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc-1559"><a href="#BoundaryArc-1559"><span class="linenos">1559</span></a><span class="k">class</span> <span class="nc">BoundaryArc</span><span class="p">(</span><span class="n">Geodesic</span><span class="p">):</span>
</span><span id="BoundaryArc-1560"><a href="#BoundaryArc-1560"><span class="linenos">1560</span></a>    <span class="sd">&quot;&quot;&quot;Model for an arc sitting in the boundary of hyperbolic space.</span>
</span><span id="BoundaryArc-1561"><a href="#BoundaryArc-1561"><span class="linenos">1561</span></a>
</span><span id="BoundaryArc-1562"><a href="#BoundaryArc-1562"><span class="linenos">1562</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BoundaryArc-1563"><a href="#BoundaryArc-1563"><span class="linenos">1563</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BoundaryArc-1564"><a href="#BoundaryArc-1564"><span class="linenos">1564</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BoundaryArc-1565"><a href="#BoundaryArc-1565"><span class="linenos">1565</span></a>
</span><span id="BoundaryArc-1566"><a href="#BoundaryArc-1566"><span class="linenos">1566</span></a>    <span class="nd">@property</span>
</span><span id="BoundaryArc-1567"><a href="#BoundaryArc-1567"><span class="linenos">1567</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc-1568"><a href="#BoundaryArc-1568"><span class="linenos">1568</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="BoundaryArc-1569"><a href="#BoundaryArc-1569"><span class="linenos">1569</span></a>
</span><span id="BoundaryArc-1570"><a href="#BoundaryArc-1570"><span class="linenos">1570</span></a>    <span class="nd">@property</span>
</span><span id="BoundaryArc-1571"><a href="#BoundaryArc-1571"><span class="linenos">1571</span></a>    <span class="k">def</span> <span class="nf">orientation_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc-1572"><a href="#BoundaryArc-1572"><span class="linenos">1572</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span><span id="BoundaryArc-1573"><a href="#BoundaryArc-1573"><span class="linenos">1573</span></a>
</span><span id="BoundaryArc-1574"><a href="#BoundaryArc-1574"><span class="linenos">1574</span></a>    <span class="k">def</span> <span class="nf">set_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BoundaryArc-1575"><a href="#BoundaryArc-1575"><span class="linenos">1575</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BoundaryArc-1576"><a href="#BoundaryArc-1576"><span class="linenos">1576</span></a>            <span class="n">endpoint_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="BoundaryArc-1577"><a href="#BoundaryArc-1577"><span class="linenos">1577</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BoundaryArc-1578"><a href="#BoundaryArc-1578"><span class="linenos">1578</span></a>            <span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span>
</span><span id="BoundaryArc-1579"><a href="#BoundaryArc-1579"><span class="linenos">1579</span></a>            <span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint2</span><span class="p">)</span>
</span><span id="BoundaryArc-1580"><a href="#BoundaryArc-1580"><span class="linenos">1580</span></a>            <span class="n">endpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span id="BoundaryArc-1581"><a href="#BoundaryArc-1581"><span class="linenos">1581</span></a>                <span class="p">[</span><span class="n">pt1</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">pt2</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="BoundaryArc-1582"><a href="#BoundaryArc-1582"><span class="linenos">1582</span></a>            <span class="p">)</span>
</span><span id="BoundaryArc-1583"><a href="#BoundaryArc-1583"><span class="linenos">1583</span></a>
</span><span id="BoundaryArc-1584"><a href="#BoundaryArc-1584"><span class="linenos">1584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_build_orientation_point</span><span class="p">(</span><span class="n">endpoint_data</span><span class="p">)</span>
</span><span id="BoundaryArc-1585"><a href="#BoundaryArc-1585"><span class="linenos">1585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_optional</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="BoundaryArc-1586"><a href="#BoundaryArc-1586"><span class="linenos">1586</span></a>
</span><span id="BoundaryArc-1587"><a href="#BoundaryArc-1587"><span class="linenos">1587</span></a>    <span class="k">def</span> <span class="nf">orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc-1588"><a href="#BoundaryArc-1588"><span class="linenos">1588</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="BoundaryArc-1589"><a href="#BoundaryArc-1589"><span class="linenos">1589</span></a>
</span><span id="BoundaryArc-1590"><a href="#BoundaryArc-1590"><span class="linenos">1590</span></a>    <span class="k">def</span> <span class="nf">flip_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc-1591"><a href="#BoundaryArc-1591"><span class="linenos">1591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="BoundaryArc-1592"><a href="#BoundaryArc-1592"><span class="linenos">1592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="BoundaryArc-1593"><a href="#BoundaryArc-1593"><span class="linenos">1593</span></a>
</span><span id="BoundaryArc-1594"><a href="#BoundaryArc-1594"><span class="linenos">1594</span></a>    <span class="k">def</span> <span class="nf">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="BoundaryArc-1595"><a href="#BoundaryArc-1595"><span class="linenos">1595</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="BoundaryArc-1596"><a href="#BoundaryArc-1596"><span class="linenos">1596</span></a>        <span class="n">endpoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span>
</span><span id="BoundaryArc-1597"><a href="#BoundaryArc-1597"><span class="linenos">1597</span></a>            <span class="n">endpoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="BoundaryArc-1598"><a href="#BoundaryArc-1598"><span class="linenos">1598</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="BoundaryArc-1599"><a href="#BoundaryArc-1599"><span class="linenos">1599</span></a>        <span class="p">)</span>
</span><span id="BoundaryArc-1600"><a href="#BoundaryArc-1600"><span class="linenos">1600</span></a>        <span class="k">return</span> <span class="n">endpoints</span>
</span><span id="BoundaryArc-1601"><a href="#BoundaryArc-1601"><span class="linenos">1601</span></a>
</span><span id="BoundaryArc-1602"><a href="#BoundaryArc-1602"><span class="linenos">1602</span></a>    <span class="k">def</span> <span class="nf">_build_orientation_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoints</span><span class="p">):</span>
</span><span id="BoundaryArc-1603"><a href="#BoundaryArc-1603"><span class="linenos">1603</span></a>
</span><span id="BoundaryArc-1604"><a href="#BoundaryArc-1604"><span class="linenos">1604</span></a>        <span class="n">n</span> <span class="o">=</span> <span class="n">endpoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="BoundaryArc-1605"><a href="#BoundaryArc-1605"><span class="linenos">1605</span></a>        <span class="n">orientation_pt_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">endpoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
</span><span id="BoundaryArc-1606"><a href="#BoundaryArc-1606"><span class="linenos">1606</span></a>                                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span><span id="BoundaryArc-1607"><a href="#BoundaryArc-1607"><span class="linenos">1607</span></a>        <span class="n">orientation_pt_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">endpoints</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
</span><span id="BoundaryArc-1608"><a href="#BoundaryArc-1608"><span class="linenos">1608</span></a>                                    <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
</span><span id="BoundaryArc-1609"><a href="#BoundaryArc-1609"><span class="linenos">1609</span></a>        <span class="n">orientation_pt_1</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="BoundaryArc-1610"><a href="#BoundaryArc-1610"><span class="linenos">1610</span></a>        <span class="n">orientation_pt_2</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="BoundaryArc-1611"><a href="#BoundaryArc-1611"><span class="linenos">1611</span></a>
</span><span id="BoundaryArc-1612"><a href="#BoundaryArc-1612"><span class="linenos">1612</span></a>        <span class="n">point_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">endpoints</span><span class="p">,</span> <span class="n">orientation_pt_1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="BoundaryArc-1613"><a href="#BoundaryArc-1613"><span class="linenos">1613</span></a>
</span><span id="BoundaryArc-1614"><a href="#BoundaryArc-1614"><span class="linenos">1614</span></a>        <span class="c1"># force numerical approximation for determinants, since we&#39;re</span>
</span><span id="BoundaryArc-1615"><a href="#BoundaryArc-1615"><span class="linenos">1615</span></a>        <span class="c1"># only using them to find point determining the orientation of</span>
</span><span id="BoundaryArc-1616"><a href="#BoundaryArc-1616"><span class="linenos">1616</span></a>        <span class="c1"># the arc</span>
</span><span id="BoundaryArc-1617"><a href="#BoundaryArc-1617"><span class="linenos">1617</span></a>        <span class="n">dets</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</span><span id="BoundaryArc-1618"><a href="#BoundaryArc-1618"><span class="linenos">1618</span></a>
</span><span id="BoundaryArc-1619"><a href="#BoundaryArc-1619"><span class="linenos">1619</span></a>        <span class="n">point_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dets</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">orientation_pt_2</span>
</span><span id="BoundaryArc-1620"><a href="#BoundaryArc-1620"><span class="linenos">1620</span></a>
</span><span id="BoundaryArc-1621"><a href="#BoundaryArc-1621"><span class="linenos">1621</span></a>        <span class="n">signs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</span><span id="BoundaryArc-1622"><a href="#BoundaryArc-1622"><span class="linenos">1622</span></a>        <span class="n">point_data</span><span class="p">[</span><span class="n">dets</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="BoundaryArc-1623"><a href="#BoundaryArc-1623"><span class="linenos">1623</span></a>
</span><span id="BoundaryArc-1624"><a href="#BoundaryArc-1624"><span class="linenos">1624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">point_data</span><span class="p">)</span>
</span><span id="BoundaryArc-1625"><a href="#BoundaryArc-1625"><span class="linenos">1625</span></a>
</span><span id="BoundaryArc-1626"><a href="#BoundaryArc-1626"><span class="linenos">1626</span></a>
</span><span id="BoundaryArc-1627"><a href="#BoundaryArc-1627"><span class="linenos">1627</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="BoundaryArc-1628"><a href="#BoundaryArc-1628"><span class="linenos">1628</span></a>        <span class="sd">&quot;&quot;&quot;Compute parameters (center, radius) for this boundary arc.</span>
</span><span id="BoundaryArc-1629"><a href="#BoundaryArc-1629"><span class="linenos">1629</span></a>
</span><span id="BoundaryArc-1630"><a href="#BoundaryArc-1630"><span class="linenos">1630</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BoundaryArc-1631"><a href="#BoundaryArc-1631"><span class="linenos">1631</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">!=</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span> <span class="ow">and</span> <span class="n">model</span> <span class="o">!=</span> <span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">:</span>
</span><span id="BoundaryArc-1632"><a href="#BoundaryArc-1632"><span class="linenos">1632</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="BoundaryArc-1633"><a href="#BoundaryArc-1633"><span class="linenos">1633</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute circular parameters for a boundary arc in model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span>
</span><span id="BoundaryArc-1634"><a href="#BoundaryArc-1634"><span class="linenos">1634</span></a>                 <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="BoundaryArc-1635"><a href="#BoundaryArc-1635"><span class="linenos">1635</span></a>            <span class="p">)</span>
</span><span id="BoundaryArc-1636"><a href="#BoundaryArc-1636"><span class="linenos">1636</span></a>        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
</span><span id="BoundaryArc-1637"><a href="#BoundaryArc-1637"><span class="linenos">1637</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="BoundaryArc-1638"><a href="#BoundaryArc-1638"><span class="linenos">1638</span></a>
</span><span id="BoundaryArc-1639"><a href="#BoundaryArc-1639"><span class="linenos">1639</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="BoundaryArc-1640"><a href="#BoundaryArc-1640"><span class="linenos">1640</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="BoundaryArc-1641"><a href="#BoundaryArc-1641"><span class="linenos">1641</span></a>
</span><span id="BoundaryArc-1642"><a href="#BoundaryArc-1642"><span class="linenos">1642</span></a>        <span class="c1"># WRAPLITERAL</span>
</span><span id="BoundaryArc-1643"><a href="#BoundaryArc-1643"><span class="linenos">1643</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="BoundaryArc-1644"><a href="#BoundaryArc-1644"><span class="linenos">1644</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="BoundaryArc-1645"><a href="#BoundaryArc-1645"><span class="linenos">1645</span></a>
</span><span id="BoundaryArc-1646"><a href="#BoundaryArc-1646"><span class="linenos">1646</span></a>
</span><span id="BoundaryArc-1647"><a href="#BoundaryArc-1647"><span class="linenos">1647</span></a>
</span><span id="BoundaryArc-1648"><a href="#BoundaryArc-1648"><span class="linenos">1648</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Model for an arc sitting in the boundary of hyperbolic space.</p>
</div>


                            <div id="BoundaryArc.__init__" class="classattr">
                                        <input id="BoundaryArc.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">BoundaryArc</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">endpoint1</span>, </span><span class="param"><span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="BoundaryArc.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.__init__-1563"><a href="#BoundaryArc.__init__-1563"><span class="linenos">1563</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BoundaryArc.__init__-1564"><a href="#BoundaryArc.__init__-1564"><span class="linenos">1564</span></a>        <span class="n">PointPair</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>If <code>endpoint2</code> is <code>None</code>, interpret <code>endpoint1</code> as either a (2
x...x n) <code>ndarray</code> (where n is the dimension of the underlying
vector space), or else a composite <code><a href="#Point">Point</a></code> object which can be
unpacked into two Points (which may themselves be composite).</p>

<p>If <code>endpoint2</code> is given, then both <code>endpoint1</code> and <code>endpoint2</code>
can be used to construct <code><a href="#Point">Point</a></code> objects, which serve as the
endpoints for this pair of points.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>endpoint1</strong> (Point or ndarray):
One (or both) endpoints of the point pair</li>
<li><strong>endpoint2</strong> (Point or ndarray):
The other endpoint of the point pair. If <code>None</code>,
<code>endpoint1</code> contains the data for both points in the pair.</li>
</ul>
</div>


                            </div>
                            <div id="BoundaryArc.endpoints" class="classattr">
                                        <input id="BoundaryArc.endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">endpoints</span>

                <label class="view-source-button" for="BoundaryArc.endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.endpoints-1566"><a href="#BoundaryArc.endpoints-1566"><span class="linenos">1566</span></a>    <span class="nd">@property</span>
</span><span id="BoundaryArc.endpoints-1567"><a href="#BoundaryArc.endpoints-1567"><span class="linenos">1567</span></a>    <span class="k">def</span> <span class="nf">endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc.endpoints-1568"><a href="#BoundaryArc.endpoints-1568"><span class="linenos">1568</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="BoundaryArc.orientation_pt" class="classattr">
                                        <input id="BoundaryArc.orientation_pt-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr variable">
            <span class="name">orientation_pt</span>

                <label class="view-source-button" for="BoundaryArc.orientation_pt-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.orientation_pt"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.orientation_pt-1570"><a href="#BoundaryArc.orientation_pt-1570"><span class="linenos">1570</span></a>    <span class="nd">@property</span>
</span><span id="BoundaryArc.orientation_pt-1571"><a href="#BoundaryArc.orientation_pt-1571"><span class="linenos">1571</span></a>    <span class="k">def</span> <span class="nf">orientation_pt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc.orientation_pt-1572"><a href="#BoundaryArc.orientation_pt-1572"><span class="linenos">1572</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span>
</span></pre></div>


    

                            </div>
                            <div id="BoundaryArc.set_endpoints" class="classattr">
                                        <input id="BoundaryArc.set_endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_endpoints</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">endpoint1</span>, </span><span class="param"><span class="n">endpoint2</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BoundaryArc.set_endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.set_endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.set_endpoints-1574"><a href="#BoundaryArc.set_endpoints-1574"><span class="linenos">1574</span></a>    <span class="k">def</span> <span class="nf">set_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">endpoint1</span><span class="p">,</span> <span class="n">endpoint2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="BoundaryArc.set_endpoints-1575"><a href="#BoundaryArc.set_endpoints-1575"><span class="linenos">1575</span></a>        <span class="k">if</span> <span class="n">endpoint2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="BoundaryArc.set_endpoints-1576"><a href="#BoundaryArc.set_endpoints-1576"><span class="linenos">1576</span></a>            <span class="n">endpoint_data</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="BoundaryArc.set_endpoints-1577"><a href="#BoundaryArc.set_endpoints-1577"><span class="linenos">1577</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="BoundaryArc.set_endpoints-1578"><a href="#BoundaryArc.set_endpoints-1578"><span class="linenos">1578</span></a>            <span class="n">pt1</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint1</span><span class="p">)</span>
</span><span id="BoundaryArc.set_endpoints-1579"><a href="#BoundaryArc.set_endpoints-1579"><span class="linenos">1579</span></a>            <span class="n">pt2</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">endpoint2</span><span class="p">)</span>
</span><span id="BoundaryArc.set_endpoints-1580"><a href="#BoundaryArc.set_endpoints-1580"><span class="linenos">1580</span></a>            <span class="n">endpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
</span><span id="BoundaryArc.set_endpoints-1581"><a href="#BoundaryArc.set_endpoints-1581"><span class="linenos">1581</span></a>                <span class="p">[</span><span class="n">pt1</span><span class="o">.</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">pt2</span><span class="o">.</span><span class="n">proj_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="BoundaryArc.set_endpoints-1582"><a href="#BoundaryArc.set_endpoints-1582"><span class="linenos">1582</span></a>            <span class="p">)</span>
</span><span id="BoundaryArc.set_endpoints-1583"><a href="#BoundaryArc.set_endpoints-1583"><span class="linenos">1583</span></a>
</span><span id="BoundaryArc.set_endpoints-1584"><a href="#BoundaryArc.set_endpoints-1584"><span class="linenos">1584</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_build_orientation_point</span><span class="p">(</span><span class="n">endpoint_data</span><span class="p">)</span>
</span><span id="BoundaryArc.set_endpoints-1585"><a href="#BoundaryArc.set_endpoints-1585"><span class="linenos">1585</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_set_optional</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Set the endpoints of a segment.</p>

<p>If <code>endpoint2</code> is <code>None</code>, expect <code>endpoint1</code> to be an array of
points with shape <code>(..., 2, n)</code>. Otherwise, expect <code>endpoint1</code>
and <code>endpoint2</code> to be arrays of points with the same shape.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>endpoint1</strong> (Point or ndarray):
One (or both) endpoints of the point pair</li>
<li><strong>endpoint2</strong> (Point or ndarray):
The other endpoint of the point pair. If <code>None</code>,
<code>endpoint1</code> contains the data for both points in the pair.</li>
</ul>
</div>


                            </div>
                            <div id="BoundaryArc.orientation" class="classattr">
                                        <input id="BoundaryArc.orientation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">orientation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BoundaryArc.orientation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.orientation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.orientation-1587"><a href="#BoundaryArc.orientation-1587"><span class="linenos">1587</span></a>    <span class="k">def</span> <span class="nf">orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc.orientation-1588"><a href="#BoundaryArc.orientation-1588"><span class="linenos">1588</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="BoundaryArc.flip_orientation" class="classattr">
                                        <input id="BoundaryArc.flip_orientation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flip_orientation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BoundaryArc.flip_orientation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.flip_orientation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.flip_orientation-1590"><a href="#BoundaryArc.flip_orientation-1590"><span class="linenos">1590</span></a>    <span class="k">def</span> <span class="nf">flip_orientation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="BoundaryArc.flip_orientation-1591"><a href="#BoundaryArc.flip_orientation-1591"><span class="linenos">1591</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="BoundaryArc.flip_orientation-1592"><a href="#BoundaryArc.flip_orientation-1592"><span class="linenos">1592</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="BoundaryArc.endpoint_coords" class="classattr">
                                        <input id="BoundaryArc.endpoint_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">endpoint_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span>, </span><span class="param"><span class="n">ordered</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BoundaryArc.endpoint_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.endpoint_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.endpoint_coords-1594"><a href="#BoundaryArc.endpoint_coords-1594"><span class="linenos">1594</span></a>    <span class="k">def</span> <span class="nf">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="BoundaryArc.endpoint_coords-1595"><a href="#BoundaryArc.endpoint_coords-1595"><span class="linenos">1595</span></a>        <span class="n">endpoints</span> <span class="o">=</span> <span class="n">Geodesic</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="BoundaryArc.endpoint_coords-1596"><a href="#BoundaryArc.endpoint_coords-1596"><span class="linenos">1596</span></a>        <span class="n">endpoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span>
</span><span id="BoundaryArc.endpoint_coords-1597"><a href="#BoundaryArc.endpoint_coords-1597"><span class="linenos">1597</span></a>            <span class="n">endpoints</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">orientation</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span>
</span><span id="BoundaryArc.endpoint_coords-1598"><a href="#BoundaryArc.endpoint_coords-1598"><span class="linenos">1598</span></a>            <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span>
</span><span id="BoundaryArc.endpoint_coords-1599"><a href="#BoundaryArc.endpoint_coords-1599"><span class="linenos">1599</span></a>        <span class="p">)</span>
</span><span id="BoundaryArc.endpoint_coords-1600"><a href="#BoundaryArc.endpoint_coords-1600"><span class="linenos">1600</span></a>        <span class="k">return</span> <span class="n">endpoints</span>
</span></pre></div>


            <div class="docstring"><p>Get coordinates for the endpoints of this point pair</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>model</strong> (Model):
model to compute coordinates in</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray</strong>: Coordinates for the endpoints of this PointPair, as an
ndarray with shape <code>(2, ... n)</code> (where <code>n</code> is the
dimension of the hyperbolic space).</li>
</ul>
</div>


                            </div>
                            <div id="BoundaryArc.circle_parameters" class="classattr">
                                        <input id="BoundaryArc.circle_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_parameters</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span>, </span><span class="param"><span class="n">degrees</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="BoundaryArc.circle_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BoundaryArc.circle_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BoundaryArc.circle_parameters-1627"><a href="#BoundaryArc.circle_parameters-1627"><span class="linenos">1627</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="BoundaryArc.circle_parameters-1628"><a href="#BoundaryArc.circle_parameters-1628"><span class="linenos">1628</span></a>        <span class="sd">&quot;&quot;&quot;Compute parameters (center, radius) for this boundary arc.</span>
</span><span id="BoundaryArc.circle_parameters-1629"><a href="#BoundaryArc.circle_parameters-1629"><span class="linenos">1629</span></a>
</span><span id="BoundaryArc.circle_parameters-1630"><a href="#BoundaryArc.circle_parameters-1630"><span class="linenos">1630</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BoundaryArc.circle_parameters-1631"><a href="#BoundaryArc.circle_parameters-1631"><span class="linenos">1631</span></a>        <span class="k">if</span> <span class="n">model</span> <span class="o">!=</span> <span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span> <span class="ow">and</span> <span class="n">model</span> <span class="o">!=</span> <span class="n">Model</span><span class="o">.</span><span class="n">KLEIN</span><span class="p">:</span>
</span><span id="BoundaryArc.circle_parameters-1632"><a href="#BoundaryArc.circle_parameters-1632"><span class="linenos">1632</span></a>            <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span>
</span><span id="BoundaryArc.circle_parameters-1633"><a href="#BoundaryArc.circle_parameters-1633"><span class="linenos">1633</span></a>                <span class="p">(</span><span class="s2">&quot;Cannot compute circular parameters for a boundary arc in model: &#39;</span><span class="si">{}</span><span class="s2">&#39;&quot;</span>
</span><span id="BoundaryArc.circle_parameters-1634"><a href="#BoundaryArc.circle_parameters-1634"><span class="linenos">1634</span></a>                 <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</span><span id="BoundaryArc.circle_parameters-1635"><a href="#BoundaryArc.circle_parameters-1635"><span class="linenos">1635</span></a>            <span class="p">)</span>
</span><span id="BoundaryArc.circle_parameters-1636"><a href="#BoundaryArc.circle_parameters-1636"><span class="linenos">1636</span></a>        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
</span><span id="BoundaryArc.circle_parameters-1637"><a href="#BoundaryArc.circle_parameters-1637"><span class="linenos">1637</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</span><span id="BoundaryArc.circle_parameters-1638"><a href="#BoundaryArc.circle_parameters-1638"><span class="linenos">1638</span></a>
</span><span id="BoundaryArc.circle_parameters-1639"><a href="#BoundaryArc.circle_parameters-1639"><span class="linenos">1639</span></a>        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">endpoint_coords</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="BoundaryArc.circle_parameters-1640"><a href="#BoundaryArc.circle_parameters-1640"><span class="linenos">1640</span></a>        <span class="n">thetas</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">circle_angles</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
</span><span id="BoundaryArc.circle_parameters-1641"><a href="#BoundaryArc.circle_parameters-1641"><span class="linenos">1641</span></a>
</span><span id="BoundaryArc.circle_parameters-1642"><a href="#BoundaryArc.circle_parameters-1642"><span class="linenos">1642</span></a>        <span class="c1"># WRAPLITERAL</span>
</span><span id="BoundaryArc.circle_parameters-1643"><a href="#BoundaryArc.circle_parameters-1643"><span class="linenos">1643</span></a>        <span class="k">if</span> <span class="n">degrees</span><span class="p">:</span>
</span><span id="BoundaryArc.circle_parameters-1644"><a href="#BoundaryArc.circle_parameters-1644"><span class="linenos">1644</span></a>            <span class="n">thetas</span> <span class="o">*=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</span><span id="BoundaryArc.circle_parameters-1645"><a href="#BoundaryArc.circle_parameters-1645"><span class="linenos">1645</span></a>
</span><span id="BoundaryArc.circle_parameters-1646"><a href="#BoundaryArc.circle_parameters-1646"><span class="linenos">1646</span></a>
</span><span id="BoundaryArc.circle_parameters-1647"><a href="#BoundaryArc.circle_parameters-1647"><span class="linenos">1647</span></a>
</span><span id="BoundaryArc.circle_parameters-1648"><a href="#BoundaryArc.circle_parameters-1648"><span class="linenos">1648</span></a>        <span class="k">return</span> <span class="n">center</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">thetas</span>
</span></pre></div>


            <div class="docstring"><p>Compute parameters (center, radius) for this boundary arc.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Geodesic">Geodesic</a></dt>
                                <dd id="BoundaryArc.ideal_basis" class="variable"><a href="#Geodesic.ideal_basis">ideal_basis</a></dd>
                <dd id="BoundaryArc.from_reflection" class="function"><a href="#Geodesic.from_reflection">from_reflection</a></dd>

            </div>
            <div><dt><a href="#PointPair">PointPair</a></dt>
                                <dd id="BoundaryArc.get_endpoints" class="function"><a href="#PointPair.get_endpoints">get_endpoints</a></dd>
                <dd id="BoundaryArc.get_end_pair" class="function"><a href="#PointPair.get_end_pair">get_end_pair</a></dd>

            </div>
            <div><dt><a href="#Subspace">Subspace</a></dt>
                                <dd id="BoundaryArc.ideal_basis_coords" class="function"><a href="#Subspace.ideal_basis_coords">ideal_basis_coords</a></dd>
                <dd id="BoundaryArc.spacelike_complement" class="function"><a href="#Subspace.spacelike_complement">spacelike_complement</a></dd>
                <dd id="BoundaryArc.sphere_parameters" class="function"><a href="#Subspace.sphere_parameters">sphere_parameters</a></dd>
                <dd id="BoundaryArc.reflection_across" class="function"><a href="#Subspace.reflection_across">reflection_across</a></dd>

            </div>
            <div><dt><a href="#IdealPoint">IdealPoint</a></dt>
                                <dd id="BoundaryArc.from_angle" class="function"><a href="#IdealPoint.from_angle">from_angle</a></dd>

            </div>
            <div><dt><a href="#Point">Point</a></dt>
                                <dd id="BoundaryArc.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="BoundaryArc.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="BoundaryArc.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="BoundaryArc.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="BoundaryArc.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="BoundaryArc.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="BoundaryArc.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="BoundaryArc.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="BoundaryArc.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="BoundaryArc.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="BoundaryArc.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="BoundaryArc.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="BoundaryArc.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#PointPair">geometry_tools.projective.PointPair</a></dt>
                                <dd id="BoundaryArc.endpoint_affine_coords" class="function"><a href="projective.html#PointPair.endpoint_affine_coords">endpoint_affine_coords</a></dd>
                <dd id="BoundaryArc.endpoint_projective_coords" class="function"><a href="projective.html#PointPair.endpoint_projective_coords">endpoint_projective_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="BoundaryArc.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="BoundaryArc.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="BoundaryArc.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="BoundaryArc.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="BoundaryArc.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="BoundaryArc.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="BoundaryArc.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="BoundaryArc.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="BoundaryArc.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="BoundaryArc.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="BoundaryArc.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="BoundaryArc.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="BoundaryArc.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Polygon">
                            <input id="Polygon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Polygon</span><wbr>(<span class="base"><a href="#Point">Point</a></span>, <span class="base"><a href="projective.html#Polygon">geometry_tools.projective.Polygon</a></span>):

                <label class="view-source-button" for="Polygon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon-1650"><a href="#Polygon-1650"><span class="linenos">1650</span></a><span class="k">class</span> <span class="nc">Polygon</span><span class="p">(</span><span class="n">Point</span><span class="p">,</span> <span class="n">projective</span><span class="o">.</span><span class="n">Polygon</span><span class="p">):</span>
</span><span id="Polygon-1651"><a href="#Polygon-1651"><span class="linenos">1651</span></a>    <span class="sd">&quot;&quot;&quot;Model for a geodesic polygon in hyperbolic space.</span>
</span><span id="Polygon-1652"><a href="#Polygon-1652"><span class="linenos">1652</span></a>
</span><span id="Polygon-1653"><a href="#Polygon-1653"><span class="linenos">1653</span></a><span class="sd">    Underlying data consists of the vertices of the polygon. We also</span>
</span><span id="Polygon-1654"><a href="#Polygon-1654"><span class="linenos">1654</span></a><span class="sd">    keep track of auxiliary data, namely the proj_data of the segments</span>
</span><span id="Polygon-1655"><a href="#Polygon-1655"><span class="linenos">1655</span></a><span class="sd">    making up the edges of the polygon.</span>
</span><span id="Polygon-1656"><a href="#Polygon-1656"><span class="linenos">1656</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Polygon-1657"><a href="#Polygon-1657"><span class="linenos">1657</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon-1658"><a href="#Polygon-1658"><span class="linenos">1658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">segment_class</span> <span class="o">=</span> <span class="n">Segment</span>
</span><span id="Polygon-1659"><a href="#Polygon-1659"><span class="linenos">1659</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span>
</span><span id="Polygon-1660"><a href="#Polygon-1660"><span class="linenos">1660</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="Polygon-1661"><a href="#Polygon-1661"><span class="linenos">1661</span></a>                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon-1662"><a href="#Polygon-1662"><span class="linenos">1662</span></a>
</span><span id="Polygon-1663"><a href="#Polygon-1663"><span class="linenos">1663</span></a>    <span class="k">def</span> <span class="nf">_compute_aux_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">):</span>
</span><span id="Polygon-1664"><a href="#Polygon-1664"><span class="linenos">1664</span></a>        <span class="n">segments</span> <span class="o">=</span> <span class="n">Segment</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">proj_data</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Polygon-1665"><a href="#Polygon-1665"><span class="linenos">1665</span></a>        <span class="k">return</span> <span class="n">segments</span><span class="o">.</span><span class="n">proj_data</span>
</span><span id="Polygon-1666"><a href="#Polygon-1666"><span class="linenos">1666</span></a>
</span><span id="Polygon-1667"><a href="#Polygon-1667"><span class="linenos">1667</span></a>    <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-1668"><a href="#Polygon-1668"><span class="linenos">1668</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span><span id="Polygon-1669"><a href="#Polygon-1669"><span class="linenos">1669</span></a>
</span><span id="Polygon-1670"><a href="#Polygon-1670"><span class="linenos">1670</span></a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon-1671"><a href="#Polygon-1671"><span class="linenos">1671</span></a>        <span class="k">return</span> <span class="n">Segment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span><span id="Polygon-1672"><a href="#Polygon-1672"><span class="linenos">1672</span></a>
</span><span id="Polygon-1673"><a href="#Polygon-1673"><span class="linenos">1673</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">short_arc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Polygon-1674"><a href="#Polygon-1674"><span class="linenos">1674</span></a>                          <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Polygon-1675"><a href="#Polygon-1675"><span class="linenos">1675</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">flatten</span><span class="p">:</span>
</span><span id="Polygon-1676"><a href="#Polygon-1676"><span class="linenos">1676</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span><span class="o">.</span><span class="n">circle_parameters</span><span class="p">(</span><span class="n">short_arc</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="Polygon-1677"><a href="#Polygon-1677"><span class="linenos">1677</span></a>
</span><span id="Polygon-1678"><a href="#Polygon-1678"><span class="linenos">1678</span></a>        <span class="n">flat_segments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">()</span>
</span><span id="Polygon-1679"><a href="#Polygon-1679"><span class="linenos">1679</span></a>        <span class="k">return</span> <span class="n">flat_segments</span><span class="o">.</span><span class="n">circle_parameters</span><span class="p">(</span><span class="n">short_arc</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="Polygon-1680"><a href="#Polygon-1680"><span class="linenos">1680</span></a>
</span><span id="Polygon-1681"><a href="#Polygon-1681"><span class="linenos">1681</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Polygon-1682"><a href="#Polygon-1682"><span class="linenos">1682</span></a>    <span class="k">def</span> <span class="nf">regular_polygon</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon-1683"><a href="#Polygon-1683"><span class="linenos">1683</span></a>        <span class="sd">&quot;&quot;&quot;Get a regular polygon with n vertices, inscribed on a circle of</span>
</span><span id="Polygon-1684"><a href="#Polygon-1684"><span class="linenos">1684</span></a><span class="sd">        radius hyp_radius.</span>
</span><span id="Polygon-1685"><a href="#Polygon-1685"><span class="linenos">1685</span></a>
</span><span id="Polygon-1686"><a href="#Polygon-1686"><span class="linenos">1686</span></a><span class="sd">        (This is actually vectorized.)</span>
</span><span id="Polygon-1687"><a href="#Polygon-1687"><span class="linenos">1687</span></a>
</span><span id="Polygon-1688"><a href="#Polygon-1688"><span class="linenos">1688</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon-1689"><a href="#Polygon-1689"><span class="linenos">1689</span></a>        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">angle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Polygon-1690"><a href="#Polygon-1690"><span class="linenos">1690</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Polygon-1691"><a href="#Polygon-1691"><span class="linenos">1691</span></a>                <span class="s2">&quot;Must provide either an angle or a radius to regular_polygon&quot;</span>
</span><span id="Polygon-1692"><a href="#Polygon-1692"><span class="linenos">1692</span></a>            <span class="p">)</span>
</span><span id="Polygon-1693"><a href="#Polygon-1693"><span class="linenos">1693</span></a>
</span><span id="Polygon-1694"><a href="#Polygon-1694"><span class="linenos">1694</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon-1695"><a href="#Polygon-1695"><span class="linenos">1695</span></a>
</span><span id="Polygon-1696"><a href="#Polygon-1696"><span class="linenos">1696</span></a>        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Polygon-1697"><a href="#Polygon-1697"><span class="linenos">1697</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">regular_polygon_radius</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="Polygon-1698"><a href="#Polygon-1698"><span class="linenos">1698</span></a>
</span><span id="Polygon-1699"><a href="#Polygon-1699"><span class="linenos">1699</span></a>        <span class="n">hyp_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="Polygon-1700"><a href="#Polygon-1700"><span class="linenos">1700</span></a>        <span class="n">tangent</span> <span class="o">=</span> <span class="n">TangentVector</span><span class="o">.</span><span class="n">get_base_tangent</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span>
</span><span id="Polygon-1701"><a href="#Polygon-1701"><span class="linenos">1701</span></a>                                                 <span class="n">hyp_radius</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="Polygon-1702"><a href="#Polygon-1702"><span class="linenos">1702</span></a>                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span><span id="Polygon-1703"><a href="#Polygon-1703"><span class="linenos">1703</span></a>
</span><span id="Polygon-1704"><a href="#Polygon-1704"><span class="linenos">1704</span></a>        <span class="n">start_vertex</span> <span class="o">=</span> <span class="n">tangent</span><span class="o">.</span><span class="n">point_along</span><span class="p">(</span><span class="n">hyp_radius</span><span class="p">)</span>
</span><span id="Polygon-1705"><a href="#Polygon-1705"><span class="linenos">1705</span></a>
</span><span id="Polygon-1706"><a href="#Polygon-1706"><span class="linenos">1706</span></a>        <span class="n">cyclic_rep</span> <span class="o">=</span> <span class="n">HyperbolicRepresentation</span><span class="p">()</span>
</span><span id="Polygon-1707"><a href="#Polygon-1707"><span class="linenos">1707</span></a>        <span class="n">cyclic_rep</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Isometry</span><span class="o">.</span><span class="n">standard_rotation</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">)</span>
</span><span id="Polygon-1708"><a href="#Polygon-1708"><span class="linenos">1708</span></a>
</span><span id="Polygon-1709"><a href="#Polygon-1709"><span class="linenos">1709</span></a>        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span><span id="Polygon-1710"><a href="#Polygon-1710"><span class="linenos">1710</span></a>        <span class="n">mats</span> <span class="o">=</span> <span class="n">cyclic_rep</span><span class="o">.</span><span class="n">isometries</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span><span id="Polygon-1711"><a href="#Polygon-1711"><span class="linenos">1711</span></a>
</span><span id="Polygon-1712"><a href="#Polygon-1712"><span class="linenos">1712</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="n">mats</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">start_vertex</span><span class="p">,</span> <span class="s2">&quot;pairwise_reversed&quot;</span><span class="p">)</span>
</span><span id="Polygon-1713"><a href="#Polygon-1713"><span class="linenos">1713</span></a>
</span><span id="Polygon-1714"><a href="#Polygon-1714"><span class="linenos">1714</span></a>        <span class="k">return</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon-1715"><a href="#Polygon-1715"><span class="linenos">1715</span></a>
</span><span id="Polygon-1716"><a href="#Polygon-1716"><span class="linenos">1716</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Polygon-1717"><a href="#Polygon-1717"><span class="linenos">1717</span></a>    <span class="k">def</span> <span class="nf">regular_surface_polygon</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon-1718"><a href="#Polygon-1718"><span class="linenos">1718</span></a>        <span class="sd">&quot;&quot;&quot;Get a regular polygon which is the fundamental domain for the</span>
</span><span id="Polygon-1719"><a href="#Polygon-1719"><span class="linenos">1719</span></a><span class="sd">        action of a hyperbolic surface group with genus g.</span>
</span><span id="Polygon-1720"><a href="#Polygon-1720"><span class="linenos">1720</span></a>
</span><span id="Polygon-1721"><a href="#Polygon-1721"><span class="linenos">1721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon-1722"><a href="#Polygon-1722"><span class="linenos">1722</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">genus_g_surface_radius</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon-1723"><a href="#Polygon-1723"><span class="linenos">1723</span></a>
</span><span id="Polygon-1724"><a href="#Polygon-1724"><span class="linenos">1724</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Polygon-1725"><a href="#Polygon-1725"><span class="linenos">1725</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">base_ring</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="Polygon-1726"><a href="#Polygon-1726"><span class="linenos">1726</span></a>        <span class="k">return</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">regular_polygon</span><span class="p">(</span>
</span><span id="Polygon-1727"><a href="#Polygon-1727"><span class="linenos">1727</span></a>            <span class="mi">4</span> <span class="o">*</span> <span class="n">g</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Polygon-1728"><a href="#Polygon-1728"><span class="linenos">1728</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model for a geodesic polygon in hyperbolic space.</p>

<p>Underlying data consists of the vertices of the polygon. We also
keep track of auxiliary data, namely the proj_data of the segments
making up the edges of the polygon.</p>
</div>


                            <div id="Polygon.__init__" class="classattr">
                                        <input id="Polygon.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Polygon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vertices</span>, </span><span class="param"><span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Polygon.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.__init__-1657"><a href="#Polygon.__init__-1657"><span class="linenos">1657</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon.__init__-1658"><a href="#Polygon.__init__-1658"><span class="linenos">1658</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">segment_class</span> <span class="o">=</span> <span class="n">Segment</span>
</span><span id="Polygon.__init__-1659"><a href="#Polygon.__init__-1659"><span class="linenos">1659</span></a>        <span class="n">HyperbolicObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span>
</span><span id="Polygon.__init__-1660"><a href="#Polygon.__init__-1660"><span class="linenos">1660</span></a>                                  <span class="n">unit_ndims</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">aux_ndims</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
</span><span id="Polygon.__init__-1661"><a href="#Polygon.__init__-1661"><span class="linenos">1661</span></a>                                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>point</strong> (HyperbolicObject or iterable or ndarray):
Data used to construct a point or an array of points. If
<code>point</code> is a <code><a href="#HyperbolicObject">HyperbolicObject</a></code>, then use the underlying
coordinate data to build an array of points. If <code>point</code> is
an iterable of <code><a href="#HyperbolicObject">HyperbolicObject</a></code>s, build a composite <code><a href="#Point">Point</a></code>
object out of this array. If <code>point</code> is an <code>ndarray</code>, then
interpret this as coordinate data for an array of points
in some hyperbolic model.</li>
<li><strong>model</strong> (Model):
if <code>point</code> is numerical data, then what model of
hyperbolic space we should use to interpret <code>point</code> as
coordinates.</li>
</ul>
</div>


                            </div>
                            <div id="Polygon.segment_class" class="classattr">
                                <div class="attr variable">
            <span class="name">segment_class</span>

        
    </div>
    <a class="headerlink" href="#Polygon.segment_class"></a>
    
    

                            </div>
                            <div id="Polygon.get_vertices" class="classattr">
                                        <input id="Polygon.get_vertices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_vertices</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.get_vertices-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.get_vertices"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.get_vertices-1667"><a href="#Polygon.get_vertices-1667"><span class="linenos">1667</span></a>    <span class="k">def</span> <span class="nf">get_vertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.get_vertices-1668"><a href="#Polygon.get_vertices-1668"><span class="linenos">1668</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the vertices of the polygon.</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Vertices of this polygon, as a composite Point object.</li>
</ul>
</div>


                            </div>
                            <div id="Polygon.get_edges" class="classattr">
                                        <input id="Polygon.get_edges-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_edges</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.get_edges-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.get_edges"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.get_edges-1670"><a href="#Polygon.get_edges-1670"><span class="linenos">1670</span></a>    <span class="k">def</span> <span class="nf">get_edges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Polygon.get_edges-1671"><a href="#Polygon.get_edges-1671"><span class="linenos">1671</span></a>        <span class="k">return</span> <span class="n">Segment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the edges of this polygon</p>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>PointPair</strong>: Edges of this polygon, as a composite PointPair object.</li>
</ul>
</div>


                            </div>
                            <div id="Polygon.circle_parameters" class="classattr">
                                        <input id="Polygon.circle_parameters-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">circle_parameters</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">short_arc</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">degrees</span><span class="o">=</span><span class="kc">True</span>,</span><span class="param">	<span class="n">model</span><span class="o">=&lt;</span><span class="n"><a href="#Model.POINCARE">Model.POINCARE</a></span><span class="p">:</span> <span class="s1">&#39;poincare&#39;</span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">flatten</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.circle_parameters-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.circle_parameters"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.circle_parameters-1673"><a href="#Polygon.circle_parameters-1673"><span class="linenos">1673</span></a>    <span class="k">def</span> <span class="nf">circle_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">short_arc</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">degrees</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Polygon.circle_parameters-1674"><a href="#Polygon.circle_parameters-1674"><span class="linenos">1674</span></a>                          <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="o">.</span><span class="n">POINCARE</span><span class="p">,</span> <span class="n">flatten</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="Polygon.circle_parameters-1675"><a href="#Polygon.circle_parameters-1675"><span class="linenos">1675</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">flatten</span><span class="p">:</span>
</span><span id="Polygon.circle_parameters-1676"><a href="#Polygon.circle_parameters-1676"><span class="linenos">1676</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span><span class="o">.</span><span class="n">circle_parameters</span><span class="p">(</span><span class="n">short_arc</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span><span id="Polygon.circle_parameters-1677"><a href="#Polygon.circle_parameters-1677"><span class="linenos">1677</span></a>
</span><span id="Polygon.circle_parameters-1678"><a href="#Polygon.circle_parameters-1678"><span class="linenos">1678</span></a>        <span class="n">flat_segments</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_edges</span><span class="p">()</span><span class="o">.</span><span class="n">flatten_to_unit</span><span class="p">()</span>
</span><span id="Polygon.circle_parameters-1679"><a href="#Polygon.circle_parameters-1679"><span class="linenos">1679</span></a>        <span class="k">return</span> <span class="n">flat_segments</span><span class="o">.</span><span class="n">circle_parameters</span><span class="p">(</span><span class="n">short_arc</span><span class="p">,</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Polygon.regular_polygon" class="classattr">
                                        <input id="Polygon.regular_polygon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">regular_polygon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">radius</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">angle</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="n">dimension</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.regular_polygon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.regular_polygon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.regular_polygon-1681"><a href="#Polygon.regular_polygon-1681"><span class="linenos">1681</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Polygon.regular_polygon-1682"><a href="#Polygon.regular_polygon-1682"><span class="linenos">1682</span></a>    <span class="k">def</span> <span class="nf">regular_polygon</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon.regular_polygon-1683"><a href="#Polygon.regular_polygon-1683"><span class="linenos">1683</span></a>        <span class="sd">&quot;&quot;&quot;Get a regular polygon with n vertices, inscribed on a circle of</span>
</span><span id="Polygon.regular_polygon-1684"><a href="#Polygon.regular_polygon-1684"><span class="linenos">1684</span></a><span class="sd">        radius hyp_radius.</span>
</span><span id="Polygon.regular_polygon-1685"><a href="#Polygon.regular_polygon-1685"><span class="linenos">1685</span></a>
</span><span id="Polygon.regular_polygon-1686"><a href="#Polygon.regular_polygon-1686"><span class="linenos">1686</span></a><span class="sd">        (This is actually vectorized.)</span>
</span><span id="Polygon.regular_polygon-1687"><a href="#Polygon.regular_polygon-1687"><span class="linenos">1687</span></a>
</span><span id="Polygon.regular_polygon-1688"><a href="#Polygon.regular_polygon-1688"><span class="linenos">1688</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon.regular_polygon-1689"><a href="#Polygon.regular_polygon-1689"><span class="linenos">1689</span></a>        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">angle</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Polygon.regular_polygon-1690"><a href="#Polygon.regular_polygon-1690"><span class="linenos">1690</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="Polygon.regular_polygon-1691"><a href="#Polygon.regular_polygon-1691"><span class="linenos">1691</span></a>                <span class="s2">&quot;Must provide either an angle or a radius to regular_polygon&quot;</span>
</span><span id="Polygon.regular_polygon-1692"><a href="#Polygon.regular_polygon-1692"><span class="linenos">1692</span></a>            <span class="p">)</span>
</span><span id="Polygon.regular_polygon-1693"><a href="#Polygon.regular_polygon-1693"><span class="linenos">1693</span></a>
</span><span id="Polygon.regular_polygon-1694"><a href="#Polygon.regular_polygon-1694"><span class="linenos">1694</span></a>        <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1695"><a href="#Polygon.regular_polygon-1695"><span class="linenos">1695</span></a>
</span><span id="Polygon.regular_polygon-1696"><a href="#Polygon.regular_polygon-1696"><span class="linenos">1696</span></a>        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Polygon.regular_polygon-1697"><a href="#Polygon.regular_polygon-1697"><span class="linenos">1697</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">regular_polygon_radius</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1698"><a href="#Polygon.regular_polygon-1698"><span class="linenos">1698</span></a>
</span><span id="Polygon.regular_polygon-1699"><a href="#Polygon.regular_polygon-1699"><span class="linenos">1699</span></a>        <span class="n">hyp_radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1700"><a href="#Polygon.regular_polygon-1700"><span class="linenos">1700</span></a>        <span class="n">tangent</span> <span class="o">=</span> <span class="n">TangentVector</span><span class="o">.</span><span class="n">get_base_tangent</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span>
</span><span id="Polygon.regular_polygon-1701"><a href="#Polygon.regular_polygon-1701"><span class="linenos">1701</span></a>                                                 <span class="n">hyp_radius</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
</span><span id="Polygon.regular_polygon-1702"><a href="#Polygon.regular_polygon-1702"><span class="linenos">1702</span></a>                                                 <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</span><span id="Polygon.regular_polygon-1703"><a href="#Polygon.regular_polygon-1703"><span class="linenos">1703</span></a>
</span><span id="Polygon.regular_polygon-1704"><a href="#Polygon.regular_polygon-1704"><span class="linenos">1704</span></a>        <span class="n">start_vertex</span> <span class="o">=</span> <span class="n">tangent</span><span class="o">.</span><span class="n">point_along</span><span class="p">(</span><span class="n">hyp_radius</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1705"><a href="#Polygon.regular_polygon-1705"><span class="linenos">1705</span></a>
</span><span id="Polygon.regular_polygon-1706"><a href="#Polygon.regular_polygon-1706"><span class="linenos">1706</span></a>        <span class="n">cyclic_rep</span> <span class="o">=</span> <span class="n">HyperbolicRepresentation</span><span class="p">()</span>
</span><span id="Polygon.regular_polygon-1707"><a href="#Polygon.regular_polygon-1707"><span class="linenos">1707</span></a>        <span class="n">cyclic_rep</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Isometry</span><span class="o">.</span><span class="n">standard_rotation</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1708"><a href="#Polygon.regular_polygon-1708"><span class="linenos">1708</span></a>
</span><span id="Polygon.regular_polygon-1709"><a href="#Polygon.regular_polygon-1709"><span class="linenos">1709</span></a>        <span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
</span><span id="Polygon.regular_polygon-1710"><a href="#Polygon.regular_polygon-1710"><span class="linenos">1710</span></a>        <span class="n">mats</span> <span class="o">=</span> <span class="n">cyclic_rep</span><span class="o">.</span><span class="n">isometries</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1711"><a href="#Polygon.regular_polygon-1711"><span class="linenos">1711</span></a>
</span><span id="Polygon.regular_polygon-1712"><a href="#Polygon.regular_polygon-1712"><span class="linenos">1712</span></a>        <span class="n">vertices</span> <span class="o">=</span> <span class="n">mats</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">start_vertex</span><span class="p">,</span> <span class="s2">&quot;pairwise_reversed&quot;</span><span class="p">)</span>
</span><span id="Polygon.regular_polygon-1713"><a href="#Polygon.regular_polygon-1713"><span class="linenos">1713</span></a>
</span><span id="Polygon.regular_polygon-1714"><a href="#Polygon.regular_polygon-1714"><span class="linenos">1714</span></a>        <span class="k">return</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">vertices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a regular polygon with n vertices, inscribed on a circle of
radius hyp_radius.</p>

<p>(This is actually vectorized.)</p>
</div>


                            </div>
                            <div id="Polygon.regular_surface_polygon" class="classattr">
                                        <input id="Polygon.regular_surface_polygon-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">regular_surface_polygon</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">g</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Polygon.regular_surface_polygon-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Polygon.regular_surface_polygon"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Polygon.regular_surface_polygon-1716"><a href="#Polygon.regular_surface_polygon-1716"><span class="linenos">1716</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Polygon.regular_surface_polygon-1717"><a href="#Polygon.regular_surface_polygon-1717"><span class="linenos">1717</span></a>    <span class="k">def</span> <span class="nf">regular_surface_polygon</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Polygon.regular_surface_polygon-1718"><a href="#Polygon.regular_surface_polygon-1718"><span class="linenos">1718</span></a>        <span class="sd">&quot;&quot;&quot;Get a regular polygon which is the fundamental domain for the</span>
</span><span id="Polygon.regular_surface_polygon-1719"><a href="#Polygon.regular_surface_polygon-1719"><span class="linenos">1719</span></a><span class="sd">        action of a hyperbolic surface group with genus g.</span>
</span><span id="Polygon.regular_surface_polygon-1720"><a href="#Polygon.regular_surface_polygon-1720"><span class="linenos">1720</span></a>
</span><span id="Polygon.regular_surface_polygon-1721"><a href="#Polygon.regular_surface_polygon-1721"><span class="linenos">1721</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Polygon.regular_surface_polygon-1722"><a href="#Polygon.regular_surface_polygon-1722"><span class="linenos">1722</span></a>        <span class="n">radius</span> <span class="o">=</span> <span class="n">genus_g_surface_radius</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Polygon.regular_surface_polygon-1723"><a href="#Polygon.regular_surface_polygon-1723"><span class="linenos">1723</span></a>
</span><span id="Polygon.regular_surface_polygon-1724"><a href="#Polygon.regular_surface_polygon-1724"><span class="linenos">1724</span></a>        <span class="k">if</span> <span class="n">base_ring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Polygon.regular_surface_polygon-1725"><a href="#Polygon.regular_surface_polygon-1725"><span class="linenos">1725</span></a>            <span class="n">radius</span> <span class="o">=</span> <span class="n">base_ring</span><span class="p">(</span><span class="n">radius</span><span class="p">)</span>
</span><span id="Polygon.regular_surface_polygon-1726"><a href="#Polygon.regular_surface_polygon-1726"><span class="linenos">1726</span></a>        <span class="k">return</span> <span class="n">Polygon</span><span class="o">.</span><span class="n">regular_polygon</span><span class="p">(</span>
</span><span id="Polygon.regular_surface_polygon-1727"><a href="#Polygon.regular_surface_polygon-1727"><span class="linenos">1727</span></a>            <span class="mi">4</span> <span class="o">*</span> <span class="n">g</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Polygon.regular_surface_polygon-1728"><a href="#Polygon.regular_surface_polygon-1728"><span class="linenos">1728</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a regular polygon which is the fundamental domain for the
action of a hyperbolic surface group with genus g.</p>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#Point">Point</a></dt>
                                <dd id="Polygon.unit_ndims" class="variable"><a href="#Point.unit_ndims">unit_ndims</a></dd>
                <dd id="Polygon.aux_ndims" class="variable"><a href="#Point.aux_ndims">aux_ndims</a></dd>
                <dd id="Polygon.dual_ndims" class="variable"><a href="#Point.dual_ndims">dual_ndims</a></dd>
                <dd id="Polygon.hyperboloid_coords" class="function"><a href="#Point.hyperboloid_coords">hyperboloid_coords</a></dd>
                <dd id="Polygon.poincare_coords" class="function"><a href="#Point.poincare_coords">poincare_coords</a></dd>
                <dd id="Polygon.halfspace_coords" class="function"><a href="#Point.halfspace_coords">halfspace_coords</a></dd>
                <dd id="Polygon.coords" class="function"><a href="#Point.coords">coords</a></dd>
                <dd id="Polygon.distance" class="function"><a href="#Point.distance">distance</a></dd>
                <dd id="Polygon.origin_to" class="function"><a href="#Point.origin_to">origin_to</a></dd>
                <dd id="Polygon.unit_tangent_towards" class="function"><a href="#Point.unit_tangent_towards">unit_tangent_towards</a></dd>
                <dd id="Polygon.get_origin" class="function"><a href="#Point.get_origin">get_origin</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Polygon.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Polygon.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#Polygon">geometry_tools.projective.Polygon</a></dt>
                                <dd id="Polygon.in_standard_chart" class="function"><a href="projective.html#Polygon.in_standard_chart">in_standard_chart</a></dd>
                <dd id="Polygon.vertices" class="variable"><a href="projective.html#Polygon.vertices">vertices</a></dd>
                <dd id="Polygon.edges" class="variable"><a href="projective.html#Polygon.edges">edges</a></dd>

            </div>
            <div><dt><a href="projective.html#Point">geometry_tools.projective.Point</a></dt>
                                <dd id="Polygon.in_affine_chart" class="function"><a href="projective.html#Point.in_affine_chart">in_affine_chart</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Polygon.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Polygon.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Polygon.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Polygon.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Polygon.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Polygon.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Polygon.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Polygon.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Polygon.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Polygon.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Polygon.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Polygon.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="Isometry">
                            <input id="Isometry-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Isometry</span><wbr>(<span class="base"><a href="projective.html#Transformation">geometry_tools.projective.Transformation</a></span>, <span class="base"><a href="#HyperbolicObject">HyperbolicObject</a></span>):

                <label class="view-source-button" for="Isometry-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry-1730"><a href="#Isometry-1730"><span class="linenos">1730</span></a><span class="k">class</span> <span class="nc">Isometry</span><span class="p">(</span><span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="p">,</span> <span class="n">HyperbolicObject</span><span class="p">):</span>
</span><span id="Isometry-1731"><a href="#Isometry-1731"><span class="linenos">1731</span></a>    <span class="sd">&quot;&quot;&quot;Model for an isometry of hyperbolic space.</span>
</span><span id="Isometry-1732"><a href="#Isometry-1732"><span class="linenos">1732</span></a>
</span><span id="Isometry-1733"><a href="#Isometry-1733"><span class="linenos">1733</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Isometry-1734"><a href="#Isometry-1734"><span class="linenos">1734</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry-1735"><a href="#Isometry-1735"><span class="linenos">1735</span></a>        <span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="p">,</span>
</span><span id="Isometry-1736"><a href="#Isometry-1736"><span class="linenos">1736</span></a>                                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry-1737"><a href="#Isometry-1737"><span class="linenos">1737</span></a>
</span><span id="Isometry-1738"><a href="#Isometry-1738"><span class="linenos">1738</span></a>    <span class="k">def</span> <span class="nf">_fixpoint_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort_eigvals</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Isometry-1739"><a href="#Isometry-1739"><span class="linenos">1739</span></a>
</span><span id="Isometry-1740"><a href="#Isometry-1740"><span class="linenos">1740</span></a>        <span class="c1"># find fixpoints in projective space, and their eigenvalues and minkowski norms</span>
</span><span id="Isometry-1741"><a href="#Isometry-1741"><span class="linenos">1741</span></a>
</span><span id="Isometry-1742"><a href="#Isometry-1742"><span class="linenos">1742</span></a>        <span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span><span id="Isometry-1743"><a href="#Isometry-1743"><span class="linenos">1743</span></a>        <span class="n">norms</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">eigvecs</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>  <span class="bp">self</span><span class="o">.</span><span class="n">minkowski</span><span class="p">)</span>
</span><span id="Isometry-1744"><a href="#Isometry-1744"><span class="linenos">1744</span></a>
</span><span id="Isometry-1745"><a href="#Isometry-1745"><span class="linenos">1745</span></a>        <span class="c1"># 1 for eigenvectors which actually lie in H^n, 0 for outside vectors</span>
</span><span id="Isometry-1746"><a href="#Isometry-1746"><span class="linenos">1746</span></a>        <span class="n">in_plane</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">norms</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Isometry-1747"><a href="#Isometry-1747"><span class="linenos">1747</span></a>
</span><span id="Isometry-1748"><a href="#Isometry-1748"><span class="linenos">1748</span></a>        <span class="c1"># primary sort key is whether or not we&#39;re in the plane,</span>
</span><span id="Isometry-1749"><a href="#Isometry-1749"><span class="linenos">1749</span></a>        <span class="c1"># secondary is the eigenvalue modulus</span>
</span><span id="Isometry-1750"><a href="#Isometry-1750"><span class="linenos">1750</span></a>        <span class="k">if</span> <span class="n">sort_eigvals</span><span class="p">:</span>
</span><span id="Isometry-1751"><a href="#Isometry-1751"><span class="linenos">1751</span></a>            <span class="n">sort_order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">eigvals</span><span class="p">),</span>
</span><span id="Isometry-1752"><a href="#Isometry-1752"><span class="linenos">1752</span></a>                                   <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eigvals</span><span class="p">)),</span>
</span><span id="Isometry-1753"><a href="#Isometry-1753"><span class="linenos">1753</span></a>                                   <span class="n">in_plane</span><span class="p">])</span>
</span><span id="Isometry-1754"><a href="#Isometry-1754"><span class="linenos">1754</span></a>            <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">lexsort</span><span class="p">(</span><span class="n">sort_order</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Isometry-1755"><a href="#Isometry-1755"><span class="linenos">1755</span></a>            <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">sort_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Isometry-1756"><a href="#Isometry-1756"><span class="linenos">1756</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="Isometry-1757"><a href="#Isometry-1757"><span class="linenos">1757</span></a>            <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">in_plane</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Isometry-1758"><a href="#Isometry-1758"><span class="linenos">1758</span></a>
</span><span id="Isometry-1759"><a href="#Isometry-1759"><span class="linenos">1759</span></a>        <span class="c1"># we want a descending sort to put maximum modulus eigenvalues first</span>
</span><span id="Isometry-1760"><a href="#Isometry-1760"><span class="linenos">1760</span></a>        <span class="n">sort_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">sort_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="Isometry-1761"><a href="#Isometry-1761"><span class="linenos">1761</span></a>
</span><span id="Isometry-1762"><a href="#Isometry-1762"><span class="linenos">1762</span></a>        <span class="n">pt_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">eigvecs</span><span class="p">,</span> <span class="n">sort_indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Isometry-1763"><a href="#Isometry-1763"><span class="linenos">1763</span></a>
</span><span id="Isometry-1764"><a href="#Isometry-1764"><span class="linenos">1764</span></a>        <span class="k">return</span> <span class="n">pt_data</span>
</span><span id="Isometry-1765"><a href="#Isometry-1765"><span class="linenos">1765</span></a>
</span><span id="Isometry-1766"><a href="#Isometry-1766"><span class="linenos">1766</span></a>    <span class="k">def</span> <span class="nf">_data_to_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span><span id="Isometry-1767"><a href="#Isometry-1767"><span class="linenos">1767</span></a>        <span class="k">return</span> <span class="n">HyperbolicObject</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span><span id="Isometry-1768"><a href="#Isometry-1768"><span class="linenos">1768</span></a>
</span><span id="Isometry-1769"><a href="#Isometry-1769"><span class="linenos">1769</span></a>    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Isometry-1770"><a href="#Isometry-1770"><span class="linenos">1770</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_point_pair</span><span class="p">())</span>
</span><span id="Isometry-1771"><a href="#Isometry-1771"><span class="linenos">1771</span></a>
</span><span id="Isometry-1772"><a href="#Isometry-1772"><span class="linenos">1772</span></a>    <span class="k">def</span> <span class="nf">isometry_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Isometry-1773"><a href="#Isometry-1773"><span class="linenos">1773</span></a>        <span class="o">...</span>
</span><span id="Isometry-1774"><a href="#Isometry-1774"><span class="linenos">1774</span></a>
</span><span id="Isometry-1775"><a href="#Isometry-1775"><span class="linenos">1775</span></a>    <span class="k">def</span> <span class="nf">fixed_point_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort_eigvals</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Isometry-1776"><a href="#Isometry-1776"><span class="linenos">1776</span></a>        <span class="sd">&quot;&quot;&quot;Find fixed points for this isometry in the closure of hyperbolic space.</span>
</span><span id="Isometry-1777"><a href="#Isometry-1777"><span class="linenos">1777</span></a>
</span><span id="Isometry-1778"><a href="#Isometry-1778"><span class="linenos">1778</span></a><span class="sd">        Parameters</span>
</span><span id="Isometry-1779"><a href="#Isometry-1779"><span class="linenos">1779</span></a><span class="sd">        ----------</span>
</span><span id="Isometry-1780"><a href="#Isometry-1780"><span class="linenos">1780</span></a><span class="sd">        sort_eigvals : bool</span>
</span><span id="Isometry-1781"><a href="#Isometry-1781"><span class="linenos">1781</span></a><span class="sd">            If `True`, guarantee that the fixpoints are ordered in</span>
</span><span id="Isometry-1782"><a href="#Isometry-1782"><span class="linenos">1782</span></a><span class="sd">            order of descending eigenvalue moduli</span>
</span><span id="Isometry-1783"><a href="#Isometry-1783"><span class="linenos">1783</span></a>
</span><span id="Isometry-1784"><a href="#Isometry-1784"><span class="linenos">1784</span></a><span class="sd">        Returns</span>
</span><span id="Isometry-1785"><a href="#Isometry-1785"><span class="linenos">1785</span></a><span class="sd">        -------</span>
</span><span id="Isometry-1786"><a href="#Isometry-1786"><span class="linenos">1786</span></a><span class="sd">        Point</span>
</span><span id="Isometry-1787"><a href="#Isometry-1787"><span class="linenos">1787</span></a><span class="sd">            Points fixed by this isometry object.</span>
</span><span id="Isometry-1788"><a href="#Isometry-1788"><span class="linenos">1788</span></a>
</span><span id="Isometry-1789"><a href="#Isometry-1789"><span class="linenos">1789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry-1790"><a href="#Isometry-1790"><span class="linenos">1790</span></a>        <span class="n">fixpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixpoint_data</span><span class="p">(</span><span class="n">sort_eigvals</span><span class="p">))</span>
</span><span id="Isometry-1791"><a href="#Isometry-1791"><span class="linenos">1791</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="n">fixpoint_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Isometry-1792"><a href="#Isometry-1792"><span class="linenos">1792</span></a>
</span><span id="Isometry-1793"><a href="#Isometry-1793"><span class="linenos">1793</span></a>    <span class="k">def</span> <span class="nf">fixed_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_eigval</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Isometry-1794"><a href="#Isometry-1794"><span class="linenos">1794</span></a>        <span class="sd">&quot;&quot;&quot;Find a fixed point for this isometry in the closure of hyperbolic</span>
</span><span id="Isometry-1795"><a href="#Isometry-1795"><span class="linenos">1795</span></a><span class="sd">           space.</span>
</span><span id="Isometry-1796"><a href="#Isometry-1796"><span class="linenos">1796</span></a>
</span><span id="Isometry-1797"><a href="#Isometry-1797"><span class="linenos">1797</span></a><span class="sd">        Parameters</span>
</span><span id="Isometry-1798"><a href="#Isometry-1798"><span class="linenos">1798</span></a><span class="sd">        ----------</span>
</span><span id="Isometry-1799"><a href="#Isometry-1799"><span class="linenos">1799</span></a><span class="sd">        max_eigval : bool</span>
</span><span id="Isometry-1800"><a href="#Isometry-1800"><span class="linenos">1800</span></a><span class="sd">            If `True`, guarantee that the eigenvalue for this fixed</span>
</span><span id="Isometry-1801"><a href="#Isometry-1801"><span class="linenos">1801</span></a><span class="sd">            point has maximum modulus</span>
</span><span id="Isometry-1802"><a href="#Isometry-1802"><span class="linenos">1802</span></a>
</span><span id="Isometry-1803"><a href="#Isometry-1803"><span class="linenos">1803</span></a><span class="sd">        Returns</span>
</span><span id="Isometry-1804"><a href="#Isometry-1804"><span class="linenos">1804</span></a><span class="sd">        -------</span>
</span><span id="Isometry-1805"><a href="#Isometry-1805"><span class="linenos">1805</span></a><span class="sd">        Point</span>
</span><span id="Isometry-1806"><a href="#Isometry-1806"><span class="linenos">1806</span></a><span class="sd">            A point (possibly ideal) fixed by this isometry object.</span>
</span><span id="Isometry-1807"><a href="#Isometry-1807"><span class="linenos">1807</span></a>
</span><span id="Isometry-1808"><a href="#Isometry-1808"><span class="linenos">1808</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry-1809"><a href="#Isometry-1809"><span class="linenos">1809</span></a>        <span class="n">fixpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixpoint_data</span><span class="p">(</span><span class="n">max_eigval</span><span class="p">))</span>
</span><span id="Isometry-1810"><a href="#Isometry-1810"><span class="linenos">1810</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">fixpoint_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</span><span id="Isometry-1811"><a href="#Isometry-1811"><span class="linenos">1811</span></a>
</span><span id="Isometry-1812"><a href="#Isometry-1812"><span class="linenos">1812</span></a>
</span><span id="Isometry-1813"><a href="#Isometry-1813"><span class="linenos">1813</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry-1814"><a href="#Isometry-1814"><span class="linenos">1814</span></a>    <span class="k">def</span> <span class="nf">elliptic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">block_elliptic</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Isometry-1815"><a href="#Isometry-1815"><span class="linenos">1815</span></a>                 <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry-1816"><a href="#Isometry-1816"><span class="linenos">1816</span></a>        <span class="sd">&quot;&quot;&quot;Get an elliptic isometry stabilizing the origin in the</span>
</span><span id="Isometry-1817"><a href="#Isometry-1817"><span class="linenos">1817</span></a><span class="sd">        Poincare/Klein models.</span>
</span><span id="Isometry-1818"><a href="#Isometry-1818"><span class="linenos">1818</span></a>
</span><span id="Isometry-1819"><a href="#Isometry-1819"><span class="linenos">1819</span></a><span class="sd">        block_elliptic is an element of O(n), whose image is taken</span>
</span><span id="Isometry-1820"><a href="#Isometry-1820"><span class="linenos">1820</span></a><span class="sd">        diagonally in O(n,1).</span>
</span><span id="Isometry-1821"><a href="#Isometry-1821"><span class="linenos">1821</span></a>
</span><span id="Isometry-1822"><a href="#Isometry-1822"><span class="linenos">1822</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry-1823"><a href="#Isometry-1823"><span class="linenos">1823</span></a>
</span><span id="Isometry-1824"><a href="#Isometry-1824"><span class="linenos">1824</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Isometry-1825"><a href="#Isometry-1825"><span class="linenos">1825</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="n">block_elliptic</span>
</span><span id="Isometry-1826"><a href="#Isometry-1826"><span class="linenos">1826</span></a>
</span><span id="Isometry-1827"><a href="#Isometry-1827"><span class="linenos">1827</span></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="Isometry-1828"><a href="#Isometry-1828"><span class="linenos">1828</span></a>                          <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry-1829"><a href="#Isometry-1829"><span class="linenos">1829</span></a>
</span><span id="Isometry-1830"><a href="#Isometry-1830"><span class="linenos">1830</span></a>        <span class="c1"># add one to preserve base_ring</span>
</span><span id="Isometry-1831"><a href="#Isometry-1831"><span class="linenos">1831</span></a>        <span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry-1832"><a href="#Isometry-1832"><span class="linenos">1832</span></a>        <span class="n">mat</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">block_elliptic</span>
</span><span id="Isometry-1833"><a href="#Isometry-1833"><span class="linenos">1833</span></a>
</span><span id="Isometry-1834"><a href="#Isometry-1834"><span class="linenos">1834</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span><span id="Isometry-1835"><a href="#Isometry-1835"><span class="linenos">1835</span></a>
</span><span id="Isometry-1836"><a href="#Isometry-1836"><span class="linenos">1836</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry-1837"><a href="#Isometry-1837"><span class="linenos">1837</span></a>    <span class="k">def</span> <span class="nf">standard_loxodromic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
</span><span id="Isometry-1838"><a href="#Isometry-1838"><span class="linenos">1838</span></a>        <span class="sd">&quot;&quot;&quot;Get a loxodromic isometry whose axis intersects the origin.</span>
</span><span id="Isometry-1839"><a href="#Isometry-1839"><span class="linenos">1839</span></a>
</span><span id="Isometry-1840"><a href="#Isometry-1840"><span class="linenos">1840</span></a><span class="sd">        WARNING: not vectorized.</span>
</span><span id="Isometry-1841"><a href="#Isometry-1841"><span class="linenos">1841</span></a>
</span><span id="Isometry-1842"><a href="#Isometry-1842"><span class="linenos">1842</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry-1843"><a href="#Isometry-1843"><span class="linenos">1843</span></a>        <span class="n">basis_change</span> <span class="o">=</span> <span class="n">_loxodromic_basis_change</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
</span><span id="Isometry-1844"><a href="#Isometry-1844"><span class="linenos">1844</span></a>        <span class="n">diagonal_loxodromic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="Isometry-1845"><a href="#Isometry-1845"><span class="linenos">1845</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">parameter</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">parameter</span><span class="p">],</span>
</span><span id="Isometry-1846"><a href="#Isometry-1846"><span class="linenos">1846</span></a>                       <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimension</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="Isometry-1847"><a href="#Isometry-1847"><span class="linenos">1847</span></a>        <span class="p">)</span>
</span><span id="Isometry-1848"><a href="#Isometry-1848"><span class="linenos">1848</span></a>
</span><span id="Isometry-1849"><a href="#Isometry-1849"><span class="linenos">1849</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">((</span><span class="n">basis_change</span> <span class="o">@</span> <span class="n">diagonal_loxodromic</span> <span class="o">@</span>
</span><span id="Isometry-1850"><a href="#Isometry-1850"><span class="linenos">1850</span></a>                        <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">basis_change</span><span class="p">)),</span>
</span><span id="Isometry-1851"><a href="#Isometry-1851"><span class="linenos">1851</span></a>                        <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="Isometry-1852"><a href="#Isometry-1852"><span class="linenos">1852</span></a>
</span><span id="Isometry-1853"><a href="#Isometry-1853"><span class="linenos">1853</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry-1854"><a href="#Isometry-1854"><span class="linenos">1854</span></a>    <span class="k">def</span> <span class="nf">standard_rotation</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry-1855"><a href="#Isometry-1855"><span class="linenos">1855</span></a>        <span class="sd">&quot;&quot;&quot;Get a rotation about the origin by a fixed angle.</span>
</span><span id="Isometry-1856"><a href="#Isometry-1856"><span class="linenos">1856</span></a>
</span><span id="Isometry-1857"><a href="#Isometry-1857"><span class="linenos">1857</span></a><span class="sd">        WARNING: not vectorized.</span>
</span><span id="Isometry-1858"><a href="#Isometry-1858"><span class="linenos">1858</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry-1859"><a href="#Isometry-1859"><span class="linenos">1859</span></a>
</span><span id="Isometry-1860"><a href="#Isometry-1860"><span class="linenos">1860</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Isometry-1861"><a href="#Isometry-1861"><span class="linenos">1861</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="n">angle</span>
</span><span id="Isometry-1862"><a href="#Isometry-1862"><span class="linenos">1862</span></a>
</span><span id="Isometry-1863"><a href="#Isometry-1863"><span class="linenos">1863</span></a>        <span class="n">affine</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span>
</span><span id="Isometry-1864"><a href="#Isometry-1864"><span class="linenos">1864</span></a>            <span class="n">dimension</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Isometry-1865"><a href="#Isometry-1865"><span class="linenos">1865</span></a>        <span class="p">)</span>
</span><span id="Isometry-1866"><a href="#Isometry-1866"><span class="linenos">1866</span></a>
</span><span id="Isometry-1867"><a href="#Isometry-1867"><span class="linenos">1867</span></a>        <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span>
</span><span id="Isometry-1868"><a href="#Isometry-1868"><span class="linenos">1868</span></a>            <span class="n">angle</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Isometry-1869"><a href="#Isometry-1869"><span class="linenos">1869</span></a>        <span class="p">)</span>
</span><span id="Isometry-1870"><a href="#Isometry-1870"><span class="linenos">1870</span></a>
</span><span id="Isometry-1871"><a href="#Isometry-1871"><span class="linenos">1871</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="o">.</span><span class="n">elliptic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">affine</span><span class="p">,</span>
</span><span id="Isometry-1872"><a href="#Isometry-1872"><span class="linenos">1872</span></a>                                 <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry-1873"><a href="#Isometry-1873"><span class="linenos">1873</span></a>
</span><span id="Isometry-1874"><a href="#Isometry-1874"><span class="linenos">1874</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry-1875"><a href="#Isometry-1875"><span class="linenos">1875</span></a>    <span class="k">def</span> <span class="nf">from_sl2</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry-1876"><a href="#Isometry-1876"><span class="linenos">1876</span></a>        <span class="k">return</span> <span class="n">sl2_iso</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry-1877"><a href="#Isometry-1877"><span class="linenos">1877</span></a>
</span><span id="Isometry-1878"><a href="#Isometry-1878"><span class="linenos">1878</span></a>    <span class="k">def</span> <span class="nf">to_sl2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Isometry-1879"><a href="#Isometry-1879"><span class="linenos">1879</span></a>        <span class="k">return</span> <span class="n">lie</span><span class="o">.</span><span class="n">o_to_pgl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Model for an isometry of hyperbolic space.</p>
</div>


                            <div id="Isometry.__init__" class="classattr">
                                        <input id="Isometry.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Isometry</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">proj_data</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span>)</span>

                <label class="view-source-button" for="Isometry.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.__init__-1734"><a href="#Isometry.__init__-1734"><span class="linenos">1734</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry.__init__-1735"><a href="#Isometry.__init__-1735"><span class="linenos">1735</span></a>        <span class="n">projective</span><span class="o">.</span><span class="n">Transformation</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">proj_data</span><span class="p">,</span> <span class="n">column_vectors</span><span class="p">,</span>
</span><span id="Isometry.__init__-1736"><a href="#Isometry.__init__-1736"><span class="linenos">1736</span></a>                                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>By default, the underlying data for a projective
transformation is a <em>row matrix</em> (or an ndarray of row
matrices), acting on vectors on the <em>right</em>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>proj_data</strong> (ProjectiveObject or ndarray):
Data to use to construct a projective transformation (or
array of projective transformations).</li>
<li><strong>column_vectors</strong> (bool):
If <code>True</code>, interpret proj_data as a <em>column matrix</em> acting
on the left. Otherwise proj_data gives a <em>row matrix</em>.</li>
</ul>
</div>


                            </div>
                            <div id="Isometry.axis" class="classattr">
                                        <input id="Isometry.axis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">axis</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.axis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.axis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.axis-1769"><a href="#Isometry.axis-1769"><span class="linenos">1769</span></a>    <span class="k">def</span> <span class="nf">axis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Isometry.axis-1770"><a href="#Isometry.axis-1770"><span class="linenos">1770</span></a>        <span class="k">return</span> <span class="n">Geodesic</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fixed_point_pair</span><span class="p">())</span>
</span></pre></div>


    

                            </div>
                            <div id="Isometry.isometry_type" class="classattr">
                                        <input id="Isometry.isometry_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isometry_type</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.isometry_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.isometry_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.isometry_type-1772"><a href="#Isometry.isometry_type-1772"><span class="linenos">1772</span></a>    <span class="k">def</span> <span class="nf">isometry_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Isometry.isometry_type-1773"><a href="#Isometry.isometry_type-1773"><span class="linenos">1773</span></a>        <span class="o">...</span>
</span></pre></div>


    

                            </div>
                            <div id="Isometry.fixed_point_pair" class="classattr">
                                        <input id="Isometry.fixed_point_pair-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fixed_point_pair</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">sort_eigvals</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.fixed_point_pair-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.fixed_point_pair"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.fixed_point_pair-1775"><a href="#Isometry.fixed_point_pair-1775"><span class="linenos">1775</span></a>    <span class="k">def</span> <span class="nf">fixed_point_pair</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort_eigvals</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Isometry.fixed_point_pair-1776"><a href="#Isometry.fixed_point_pair-1776"><span class="linenos">1776</span></a>        <span class="sd">&quot;&quot;&quot;Find fixed points for this isometry in the closure of hyperbolic space.</span>
</span><span id="Isometry.fixed_point_pair-1777"><a href="#Isometry.fixed_point_pair-1777"><span class="linenos">1777</span></a>
</span><span id="Isometry.fixed_point_pair-1778"><a href="#Isometry.fixed_point_pair-1778"><span class="linenos">1778</span></a><span class="sd">        Parameters</span>
</span><span id="Isometry.fixed_point_pair-1779"><a href="#Isometry.fixed_point_pair-1779"><span class="linenos">1779</span></a><span class="sd">        ----------</span>
</span><span id="Isometry.fixed_point_pair-1780"><a href="#Isometry.fixed_point_pair-1780"><span class="linenos">1780</span></a><span class="sd">        sort_eigvals : bool</span>
</span><span id="Isometry.fixed_point_pair-1781"><a href="#Isometry.fixed_point_pair-1781"><span class="linenos">1781</span></a><span class="sd">            If `True`, guarantee that the fixpoints are ordered in</span>
</span><span id="Isometry.fixed_point_pair-1782"><a href="#Isometry.fixed_point_pair-1782"><span class="linenos">1782</span></a><span class="sd">            order of descending eigenvalue moduli</span>
</span><span id="Isometry.fixed_point_pair-1783"><a href="#Isometry.fixed_point_pair-1783"><span class="linenos">1783</span></a>
</span><span id="Isometry.fixed_point_pair-1784"><a href="#Isometry.fixed_point_pair-1784"><span class="linenos">1784</span></a><span class="sd">        Returns</span>
</span><span id="Isometry.fixed_point_pair-1785"><a href="#Isometry.fixed_point_pair-1785"><span class="linenos">1785</span></a><span class="sd">        -------</span>
</span><span id="Isometry.fixed_point_pair-1786"><a href="#Isometry.fixed_point_pair-1786"><span class="linenos">1786</span></a><span class="sd">        Point</span>
</span><span id="Isometry.fixed_point_pair-1787"><a href="#Isometry.fixed_point_pair-1787"><span class="linenos">1787</span></a><span class="sd">            Points fixed by this isometry object.</span>
</span><span id="Isometry.fixed_point_pair-1788"><a href="#Isometry.fixed_point_pair-1788"><span class="linenos">1788</span></a>
</span><span id="Isometry.fixed_point_pair-1789"><a href="#Isometry.fixed_point_pair-1789"><span class="linenos">1789</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry.fixed_point_pair-1790"><a href="#Isometry.fixed_point_pair-1790"><span class="linenos">1790</span></a>        <span class="n">fixpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixpoint_data</span><span class="p">(</span><span class="n">sort_eigvals</span><span class="p">))</span>
</span><span id="Isometry.fixed_point_pair-1791"><a href="#Isometry.fixed_point_pair-1791"><span class="linenos">1791</span></a>        <span class="k">return</span> <span class="n">PointPair</span><span class="p">(</span><span class="n">fixpoint_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Find fixed points for this isometry in the closure of hyperbolic space.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>sort_eigvals</strong> (bool):
If <code>True</code>, guarantee that the fixpoints are ordered in
order of descending eigenvalue moduli</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: Points fixed by this isometry object.</li>
</ul>
</div>


                            </div>
                            <div id="Isometry.fixed_point" class="classattr">
                                        <input id="Isometry.fixed_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fixed_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">max_eigval</span><span class="o">=</span><span class="kc">True</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.fixed_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.fixed_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.fixed_point-1793"><a href="#Isometry.fixed_point-1793"><span class="linenos">1793</span></a>    <span class="k">def</span> <span class="nf">fixed_point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_eigval</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="Isometry.fixed_point-1794"><a href="#Isometry.fixed_point-1794"><span class="linenos">1794</span></a>        <span class="sd">&quot;&quot;&quot;Find a fixed point for this isometry in the closure of hyperbolic</span>
</span><span id="Isometry.fixed_point-1795"><a href="#Isometry.fixed_point-1795"><span class="linenos">1795</span></a><span class="sd">           space.</span>
</span><span id="Isometry.fixed_point-1796"><a href="#Isometry.fixed_point-1796"><span class="linenos">1796</span></a>
</span><span id="Isometry.fixed_point-1797"><a href="#Isometry.fixed_point-1797"><span class="linenos">1797</span></a><span class="sd">        Parameters</span>
</span><span id="Isometry.fixed_point-1798"><a href="#Isometry.fixed_point-1798"><span class="linenos">1798</span></a><span class="sd">        ----------</span>
</span><span id="Isometry.fixed_point-1799"><a href="#Isometry.fixed_point-1799"><span class="linenos">1799</span></a><span class="sd">        max_eigval : bool</span>
</span><span id="Isometry.fixed_point-1800"><a href="#Isometry.fixed_point-1800"><span class="linenos">1800</span></a><span class="sd">            If `True`, guarantee that the eigenvalue for this fixed</span>
</span><span id="Isometry.fixed_point-1801"><a href="#Isometry.fixed_point-1801"><span class="linenos">1801</span></a><span class="sd">            point has maximum modulus</span>
</span><span id="Isometry.fixed_point-1802"><a href="#Isometry.fixed_point-1802"><span class="linenos">1802</span></a>
</span><span id="Isometry.fixed_point-1803"><a href="#Isometry.fixed_point-1803"><span class="linenos">1803</span></a><span class="sd">        Returns</span>
</span><span id="Isometry.fixed_point-1804"><a href="#Isometry.fixed_point-1804"><span class="linenos">1804</span></a><span class="sd">        -------</span>
</span><span id="Isometry.fixed_point-1805"><a href="#Isometry.fixed_point-1805"><span class="linenos">1805</span></a><span class="sd">        Point</span>
</span><span id="Isometry.fixed_point-1806"><a href="#Isometry.fixed_point-1806"><span class="linenos">1806</span></a><span class="sd">            A point (possibly ideal) fixed by this isometry object.</span>
</span><span id="Isometry.fixed_point-1807"><a href="#Isometry.fixed_point-1807"><span class="linenos">1807</span></a>
</span><span id="Isometry.fixed_point-1808"><a href="#Isometry.fixed_point-1808"><span class="linenos">1808</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry.fixed_point-1809"><a href="#Isometry.fixed_point-1809"><span class="linenos">1809</span></a>        <span class="n">fixpoint_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_fixpoint_data</span><span class="p">(</span><span class="n">max_eigval</span><span class="p">))</span>
</span><span id="Isometry.fixed_point-1810"><a href="#Isometry.fixed_point-1810"><span class="linenos">1810</span></a>        <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">fixpoint_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>
</span></pre></div>


            <div class="docstring"><p>Find a fixed point for this isometry in the closure of hyperbolic
   space.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>max_eigval</strong> (bool):
If <code>True</code>, guarantee that the eigenvalue for this fixed
point has maximum modulus</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>Point</strong>: A point (possibly ideal) fixed by this isometry object.</li>
</ul>
</div>


                            </div>
                            <div id="Isometry.elliptic" class="classattr">
                                        <input id="Isometry.elliptic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">elliptic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span>, </span><span class="param"><span class="n">block_elliptic</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span>, </span><span class="param"><span class="n">like</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.elliptic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.elliptic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.elliptic-1813"><a href="#Isometry.elliptic-1813"><span class="linenos">1813</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry.elliptic-1814"><a href="#Isometry.elliptic-1814"><span class="linenos">1814</span></a>    <span class="k">def</span> <span class="nf">elliptic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">block_elliptic</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="Isometry.elliptic-1815"><a href="#Isometry.elliptic-1815"><span class="linenos">1815</span></a>                 <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry.elliptic-1816"><a href="#Isometry.elliptic-1816"><span class="linenos">1816</span></a>        <span class="sd">&quot;&quot;&quot;Get an elliptic isometry stabilizing the origin in the</span>
</span><span id="Isometry.elliptic-1817"><a href="#Isometry.elliptic-1817"><span class="linenos">1817</span></a><span class="sd">        Poincare/Klein models.</span>
</span><span id="Isometry.elliptic-1818"><a href="#Isometry.elliptic-1818"><span class="linenos">1818</span></a>
</span><span id="Isometry.elliptic-1819"><a href="#Isometry.elliptic-1819"><span class="linenos">1819</span></a><span class="sd">        block_elliptic is an element of O(n), whose image is taken</span>
</span><span id="Isometry.elliptic-1820"><a href="#Isometry.elliptic-1820"><span class="linenos">1820</span></a><span class="sd">        diagonally in O(n,1).</span>
</span><span id="Isometry.elliptic-1821"><a href="#Isometry.elliptic-1821"><span class="linenos">1821</span></a>
</span><span id="Isometry.elliptic-1822"><a href="#Isometry.elliptic-1822"><span class="linenos">1822</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry.elliptic-1823"><a href="#Isometry.elliptic-1823"><span class="linenos">1823</span></a>
</span><span id="Isometry.elliptic-1824"><a href="#Isometry.elliptic-1824"><span class="linenos">1824</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Isometry.elliptic-1825"><a href="#Isometry.elliptic-1825"><span class="linenos">1825</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="n">block_elliptic</span>
</span><span id="Isometry.elliptic-1826"><a href="#Isometry.elliptic-1826"><span class="linenos">1826</span></a>
</span><span id="Isometry.elliptic-1827"><a href="#Isometry.elliptic-1827"><span class="linenos">1827</span></a>        <span class="n">mat</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
</span><span id="Isometry.elliptic-1828"><a href="#Isometry.elliptic-1828"><span class="linenos">1828</span></a>                          <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry.elliptic-1829"><a href="#Isometry.elliptic-1829"><span class="linenos">1829</span></a>
</span><span id="Isometry.elliptic-1830"><a href="#Isometry.elliptic-1830"><span class="linenos">1830</span></a>        <span class="c1"># add one to preserve base_ring</span>
</span><span id="Isometry.elliptic-1831"><a href="#Isometry.elliptic-1831"><span class="linenos">1831</span></a>        <span class="n">mat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="Isometry.elliptic-1832"><a href="#Isometry.elliptic-1832"><span class="linenos">1832</span></a>        <span class="n">mat</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">block_elliptic</span>
</span><span id="Isometry.elliptic-1833"><a href="#Isometry.elliptic-1833"><span class="linenos">1833</span></a>
</span><span id="Isometry.elliptic-1834"><a href="#Isometry.elliptic-1834"><span class="linenos">1834</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get an elliptic isometry stabilizing the origin in the
Poincare/Klein models.</p>

<p>block_elliptic is an element of O(n), whose image is taken
diagonally in O(n,1).</p>
</div>


                            </div>
                            <div id="Isometry.standard_loxodromic" class="classattr">
                                        <input id="Isometry.standard_loxodromic-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">standard_loxodromic</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span>, </span><span class="param"><span class="n">parameter</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.standard_loxodromic-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.standard_loxodromic"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.standard_loxodromic-1836"><a href="#Isometry.standard_loxodromic-1836"><span class="linenos">1836</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry.standard_loxodromic-1837"><a href="#Isometry.standard_loxodromic-1837"><span class="linenos">1837</span></a>    <span class="k">def</span> <span class="nf">standard_loxodromic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">parameter</span><span class="p">):</span>
</span><span id="Isometry.standard_loxodromic-1838"><a href="#Isometry.standard_loxodromic-1838"><span class="linenos">1838</span></a>        <span class="sd">&quot;&quot;&quot;Get a loxodromic isometry whose axis intersects the origin.</span>
</span><span id="Isometry.standard_loxodromic-1839"><a href="#Isometry.standard_loxodromic-1839"><span class="linenos">1839</span></a>
</span><span id="Isometry.standard_loxodromic-1840"><a href="#Isometry.standard_loxodromic-1840"><span class="linenos">1840</span></a><span class="sd">        WARNING: not vectorized.</span>
</span><span id="Isometry.standard_loxodromic-1841"><a href="#Isometry.standard_loxodromic-1841"><span class="linenos">1841</span></a>
</span><span id="Isometry.standard_loxodromic-1842"><a href="#Isometry.standard_loxodromic-1842"><span class="linenos">1842</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry.standard_loxodromic-1843"><a href="#Isometry.standard_loxodromic-1843"><span class="linenos">1843</span></a>        <span class="n">basis_change</span> <span class="o">=</span> <span class="n">_loxodromic_basis_change</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
</span><span id="Isometry.standard_loxodromic-1844"><a href="#Isometry.standard_loxodromic-1844"><span class="linenos">1844</span></a>        <span class="n">diagonal_loxodromic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span>
</span><span id="Isometry.standard_loxodromic-1845"><a href="#Isometry.standard_loxodromic-1845"><span class="linenos">1845</span></a>            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(([</span><span class="n">parameter</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">parameter</span><span class="p">],</span>
</span><span id="Isometry.standard_loxodromic-1846"><a href="#Isometry.standard_loxodromic-1846"><span class="linenos">1846</span></a>                       <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">dimension</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
</span><span id="Isometry.standard_loxodromic-1847"><a href="#Isometry.standard_loxodromic-1847"><span class="linenos">1847</span></a>        <span class="p">)</span>
</span><span id="Isometry.standard_loxodromic-1848"><a href="#Isometry.standard_loxodromic-1848"><span class="linenos">1848</span></a>
</span><span id="Isometry.standard_loxodromic-1849"><a href="#Isometry.standard_loxodromic-1849"><span class="linenos">1849</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">((</span><span class="n">basis_change</span> <span class="o">@</span> <span class="n">diagonal_loxodromic</span> <span class="o">@</span>
</span><span id="Isometry.standard_loxodromic-1850"><a href="#Isometry.standard_loxodromic-1850"><span class="linenos">1850</span></a>                        <span class="n">utils</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">basis_change</span><span class="p">)),</span>
</span><span id="Isometry.standard_loxodromic-1851"><a href="#Isometry.standard_loxodromic-1851"><span class="linenos">1851</span></a>                        <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a loxodromic isometry whose axis intersects the origin.</p>

<p>WARNING: not vectorized.</p>
</div>


                            </div>
                            <div id="Isometry.standard_rotation" class="classattr">
                                        <input id="Isometry.standard_rotation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">standard_rotation</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle</span>, </span><span class="param"><span class="n">dimension</span><span class="o">=</span><span class="mi">2</span>, </span><span class="param"><span class="n">like</span><span class="o">=</span><span class="kc">None</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.standard_rotation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.standard_rotation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.standard_rotation-1853"><a href="#Isometry.standard_rotation-1853"><span class="linenos">1853</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry.standard_rotation-1854"><a href="#Isometry.standard_rotation-1854"><span class="linenos">1854</span></a>    <span class="k">def</span> <span class="nf">standard_rotation</span><span class="p">(</span><span class="n">angle</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry.standard_rotation-1855"><a href="#Isometry.standard_rotation-1855"><span class="linenos">1855</span></a>        <span class="sd">&quot;&quot;&quot;Get a rotation about the origin by a fixed angle.</span>
</span><span id="Isometry.standard_rotation-1856"><a href="#Isometry.standard_rotation-1856"><span class="linenos">1856</span></a>
</span><span id="Isometry.standard_rotation-1857"><a href="#Isometry.standard_rotation-1857"><span class="linenos">1857</span></a><span class="sd">        WARNING: not vectorized.</span>
</span><span id="Isometry.standard_rotation-1858"><a href="#Isometry.standard_rotation-1858"><span class="linenos">1858</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Isometry.standard_rotation-1859"><a href="#Isometry.standard_rotation-1859"><span class="linenos">1859</span></a>
</span><span id="Isometry.standard_rotation-1860"><a href="#Isometry.standard_rotation-1860"><span class="linenos">1860</span></a>        <span class="k">if</span> <span class="n">like</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="Isometry.standard_rotation-1861"><a href="#Isometry.standard_rotation-1861"><span class="linenos">1861</span></a>            <span class="n">like</span> <span class="o">=</span> <span class="n">angle</span>
</span><span id="Isometry.standard_rotation-1862"><a href="#Isometry.standard_rotation-1862"><span class="linenos">1862</span></a>
</span><span id="Isometry.standard_rotation-1863"><a href="#Isometry.standard_rotation-1863"><span class="linenos">1863</span></a>        <span class="n">affine</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span>
</span><span id="Isometry.standard_rotation-1864"><a href="#Isometry.standard_rotation-1864"><span class="linenos">1864</span></a>            <span class="n">dimension</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Isometry.standard_rotation-1865"><a href="#Isometry.standard_rotation-1865"><span class="linenos">1865</span></a>        <span class="p">)</span>
</span><span id="Isometry.standard_rotation-1866"><a href="#Isometry.standard_rotation-1866"><span class="linenos">1866</span></a>
</span><span id="Isometry.standard_rotation-1867"><a href="#Isometry.standard_rotation-1867"><span class="linenos">1867</span></a>        <span class="n">affine</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span>
</span><span id="Isometry.standard_rotation-1868"><a href="#Isometry.standard_rotation-1868"><span class="linenos">1868</span></a>            <span class="n">angle</span><span class="p">,</span> <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
</span><span id="Isometry.standard_rotation-1869"><a href="#Isometry.standard_rotation-1869"><span class="linenos">1869</span></a>        <span class="p">)</span>
</span><span id="Isometry.standard_rotation-1870"><a href="#Isometry.standard_rotation-1870"><span class="linenos">1870</span></a>
</span><span id="Isometry.standard_rotation-1871"><a href="#Isometry.standard_rotation-1871"><span class="linenos">1871</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="o">.</span><span class="n">elliptic</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">affine</span><span class="p">,</span>
</span><span id="Isometry.standard_rotation-1872"><a href="#Isometry.standard_rotation-1872"><span class="linenos">1872</span></a>                                 <span class="n">like</span><span class="o">=</span><span class="n">like</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get a rotation about the origin by a fixed angle.</p>

<p>WARNING: not vectorized.</p>
</div>


                            </div>
                            <div id="Isometry.from_sl2" class="classattr">
                                        <input id="Isometry.from_sl2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">from_sl2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">matrix</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.from_sl2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.from_sl2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.from_sl2-1874"><a href="#Isometry.from_sl2-1874"><span class="linenos">1874</span></a>    <span class="nd">@staticmethod</span>
</span><span id="Isometry.from_sl2-1875"><a href="#Isometry.from_sl2-1875"><span class="linenos">1875</span></a>    <span class="k">def</span> <span class="nf">from_sl2</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="Isometry.from_sl2-1876"><a href="#Isometry.from_sl2-1876"><span class="linenos">1876</span></a>        <span class="k">return</span> <span class="n">sl2_iso</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="Isometry.to_sl2" class="classattr">
                                        <input id="Isometry.to_sl2-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">to_sl2</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Isometry.to_sl2-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Isometry.to_sl2"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Isometry.to_sl2-1878"><a href="#Isometry.to_sl2-1878"><span class="linenos">1878</span></a>    <span class="k">def</span> <span class="nf">to_sl2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Isometry.to_sl2-1879"><a href="#Isometry.to_sl2-1879"><span class="linenos">1879</span></a>        <span class="k">return</span> <span class="n">lie</span><span class="o">.</span><span class="n">o_to_pgl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">proj_data</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="projective.html#Transformation">geometry_tools.projective.Transformation</a></dt>
                                <dd id="Isometry.unit_ndims" class="variable"><a href="projective.html#Transformation.unit_ndims">unit_ndims</a></dd>
                <dd id="Isometry.aux_ndims" class="variable"><a href="projective.html#Transformation.aux_ndims">aux_ndims</a></dd>
                <dd id="Isometry.dual_ndims" class="variable"><a href="projective.html#Transformation.dual_ndims">dual_ndims</a></dd>
                <dd id="Isometry.matrix" class="variable"><a href="projective.html#Transformation.matrix">matrix</a></dd>
                <dd id="Isometry.apply" class="function"><a href="projective.html#Transformation.apply">apply</a></dd>
                <dd id="Isometry.eigenvector" class="function"><a href="projective.html#Transformation.eigenvector">eigenvector</a></dd>
                <dd id="Isometry.commute" class="function"><a href="projective.html#Transformation.commute">commute</a></dd>
                <dd id="Isometry.diagonalize" class="function"><a href="projective.html#Transformation.diagonalize">diagonalize</a></dd>
                <dd id="Isometry.inv" class="function"><a href="projective.html#Transformation.inv">inv</a></dd>

            </div>
            <div><dt><a href="#HyperbolicObject">HyperbolicObject</a></dt>
                                <dd id="Isometry.minkowski" class="variable"><a href="#HyperbolicObject.minkowski">minkowski</a></dd>
                <dd id="Isometry.coords" class="function"><a href="#HyperbolicObject.coords">coords</a></dd>
                <dd id="Isometry.kleinian_coords" class="function"><a href="#HyperbolicObject.kleinian_coords">kleinian_coords</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveObject">geometry_tools.projective.ProjectiveObject</a></dt>
                                <dd id="Isometry.dimension" class="variable"><a href="projective.html#ProjectiveObject.dimension">dimension</a></dd>
                <dd id="Isometry.shape" class="variable"><a href="projective.html#ProjectiveObject.shape">shape</a></dd>
                <dd id="Isometry.reshape" class="function"><a href="projective.html#ProjectiveObject.reshape">reshape</a></dd>
                <dd id="Isometry.set" class="function"><a href="projective.html#ProjectiveObject.set">set</a></dd>
                <dd id="Isometry.flatten_to_unit" class="function"><a href="projective.html#ProjectiveObject.flatten_to_unit">flatten_to_unit</a></dd>
                <dd id="Isometry.flatten_to_aux" class="function"><a href="projective.html#ProjectiveObject.flatten_to_aux">flatten_to_aux</a></dd>
                <dd id="Isometry.astype" class="function"><a href="projective.html#ProjectiveObject.astype">astype</a></dd>
                <dd id="Isometry.change_base_ring" class="function"><a href="projective.html#ProjectiveObject.change_base_ring">change_base_ring</a></dd>
                <dd id="Isometry.projective_coords" class="function"><a href="projective.html#ProjectiveObject.projective_coords">projective_coords</a></dd>
                <dd id="Isometry.affine_coords" class="function"><a href="projective.html#ProjectiveObject.affine_coords">affine_coords</a></dd>
                <dd id="Isometry.combine" class="function"><a href="projective.html#ProjectiveObject.combine">combine</a></dd>
                <dd id="Isometry.set_ndims" class="function"><a href="projective.html#ProjectiveObject.set_ndims">set_ndims</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="HyperbolicRepresentation">
                            <input id="HyperbolicRepresentation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">HyperbolicRepresentation</span><wbr>(<span class="base"><a href="projective.html#ProjectiveRepresentation">geometry_tools.projective.ProjectiveRepresentation</a></span>):

                <label class="view-source-button" for="HyperbolicRepresentation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation-1881"><a href="#HyperbolicRepresentation-1881"><span class="linenos">1881</span></a><span class="k">class</span> <span class="nc">HyperbolicRepresentation</span><span class="p">(</span><span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1882"><a href="#HyperbolicRepresentation-1882"><span class="linenos">1882</span></a>    <span class="sd">&quot;&quot;&quot;Model a representation for a finitely generated group</span>
</span><span id="HyperbolicRepresentation-1883"><a href="#HyperbolicRepresentation-1883"><span class="linenos">1883</span></a><span class="sd">    representation into O(n,1).</span>
</span><span id="HyperbolicRepresentation-1884"><a href="#HyperbolicRepresentation-1884"><span class="linenos">1884</span></a>
</span><span id="HyperbolicRepresentation-1885"><a href="#HyperbolicRepresentation-1885"><span class="linenos">1885</span></a><span class="sd">    Really this is just a convenient way of mapping words in the</span>
</span><span id="HyperbolicRepresentation-1886"><a href="#HyperbolicRepresentation-1886"><span class="linenos">1886</span></a><span class="sd">    generators to hyperbolic isometries - there&#39;s no group theory</span>
</span><span id="HyperbolicRepresentation-1887"><a href="#HyperbolicRepresentation-1887"><span class="linenos">1887</span></a><span class="sd">    being done here at all.</span>
</span><span id="HyperbolicRepresentation-1888"><a href="#HyperbolicRepresentation-1888"><span class="linenos">1888</span></a>
</span><span id="HyperbolicRepresentation-1889"><a href="#HyperbolicRepresentation-1889"><span class="linenos">1889</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="HyperbolicRepresentation-1890"><a href="#HyperbolicRepresentation-1890"><span class="linenos">1890</span></a>
</span><span id="HyperbolicRepresentation-1891"><a href="#HyperbolicRepresentation-1891"><span class="linenos">1891</span></a>    <span class="nd">@staticmethod</span>
</span><span id="HyperbolicRepresentation-1892"><a href="#HyperbolicRepresentation-1892"><span class="linenos">1892</span></a>    <span class="k">def</span> <span class="nf">wrap_func</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1893"><a href="#HyperbolicRepresentation-1893"><span class="linenos">1893</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation-1894"><a href="#HyperbolicRepresentation-1894"><span class="linenos">1894</span></a>
</span><span id="HyperbolicRepresentation-1895"><a href="#HyperbolicRepresentation-1895"><span class="linenos">1895</span></a>    <span class="nd">@staticmethod</span>
</span><span id="HyperbolicRepresentation-1896"><a href="#HyperbolicRepresentation-1896"><span class="linenos">1896</span></a>    <span class="k">def</span> <span class="nf">array_wrap_func</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1897"><a href="#HyperbolicRepresentation-1897"><span class="linenos">1897</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation-1898"><a href="#HyperbolicRepresentation-1898"><span class="linenos">1898</span></a>
</span><span id="HyperbolicRepresentation-1899"><a href="#HyperbolicRepresentation-1899"><span class="linenos">1899</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1900"><a href="#HyperbolicRepresentation-1900"><span class="linenos">1900</span></a>        <span class="n">dimension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="HyperbolicRepresentation-1901"><a href="#HyperbolicRepresentation-1901"><span class="linenos">1901</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">indefinite_orthogonalize</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dimension</span><span class="p">),</span> <span class="n">matrix</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation-1902"><a href="#HyperbolicRepresentation-1902"><span class="linenos">1902</span></a>
</span><span id="HyperbolicRepresentation-1903"><a href="#HyperbolicRepresentation-1903"><span class="linenos">1903</span></a>    <span class="k">def</span> <span class="nf">isometries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1904"><a href="#HyperbolicRepresentation-1904"><span class="linenos">1904</span></a>        <span class="sd">&quot;&quot;&quot;Get an Isometry object holding the matrices which are the images of</span>
</span><span id="HyperbolicRepresentation-1905"><a href="#HyperbolicRepresentation-1905"><span class="linenos">1905</span></a><span class="sd">        a sequence of words in the generators.</span>
</span><span id="HyperbolicRepresentation-1906"><a href="#HyperbolicRepresentation-1906"><span class="linenos">1906</span></a>
</span><span id="HyperbolicRepresentation-1907"><a href="#HyperbolicRepresentation-1907"><span class="linenos">1907</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HyperbolicRepresentation-1908"><a href="#HyperbolicRepresentation-1908"><span class="linenos">1908</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation-1909"><a href="#HyperbolicRepresentation-1909"><span class="linenos">1909</span></a>
</span><span id="HyperbolicRepresentation-1910"><a href="#HyperbolicRepresentation-1910"><span class="linenos">1910</span></a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1911"><a href="#HyperbolicRepresentation-1911"><span class="linenos">1911</span></a>        <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">hom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation-1912"><a href="#HyperbolicRepresentation-1912"><span class="linenos">1912</span></a>
</span><span id="HyperbolicRepresentation-1913"><a href="#HyperbolicRepresentation-1913"><span class="linenos">1913</span></a>
</span><span id="HyperbolicRepresentation-1914"><a href="#HyperbolicRepresentation-1914"><span class="linenos">1914</span></a>    <span class="k">def</span> <span class="nf">gln_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation-1915"><a href="#HyperbolicRepresentation-1915"><span class="linenos">1915</span></a>        <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">(</span>
</span><span id="HyperbolicRepresentation-1916"><a href="#HyperbolicRepresentation-1916"><span class="linenos">1916</span></a>            <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="o">.</span><span class="n">gln_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation-1917"><a href="#HyperbolicRepresentation-1917"><span class="linenos">1917</span></a>        <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Model a representation for a finitely generated group
representation into O(n,1).</p>

<p>Really this is just a convenient way of mapping words in the
generators to hyperbolic isometries - there's no group theory
being done here at all.</p>
</div>


                            <div id="HyperbolicRepresentation.wrap_func" class="classattr">
                                        <input id="HyperbolicRepresentation.wrap_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">wrap_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">numpy_matrix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicRepresentation.wrap_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation.wrap_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation.wrap_func-1891"><a href="#HyperbolicRepresentation.wrap_func-1891"><span class="linenos">1891</span></a>    <span class="nd">@staticmethod</span>
</span><span id="HyperbolicRepresentation.wrap_func-1892"><a href="#HyperbolicRepresentation.wrap_func-1892"><span class="linenos">1892</span></a>    <span class="k">def</span> <span class="nf">wrap_func</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation.wrap_func-1893"><a href="#HyperbolicRepresentation.wrap_func-1893"><span class="linenos">1893</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">numpy_matrix</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="HyperbolicRepresentation.array_wrap_func" class="classattr">
                                        <input id="HyperbolicRepresentation.array_wrap_func-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">array_wrap_func</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">numpy_array</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicRepresentation.array_wrap_func-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation.array_wrap_func"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation.array_wrap_func-1895"><a href="#HyperbolicRepresentation.array_wrap_func-1895"><span class="linenos">1895</span></a>    <span class="nd">@staticmethod</span>
</span><span id="HyperbolicRepresentation.array_wrap_func-1896"><a href="#HyperbolicRepresentation.array_wrap_func-1896"><span class="linenos">1896</span></a>    <span class="k">def</span> <span class="nf">array_wrap_func</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation.array_wrap_func-1897"><a href="#HyperbolicRepresentation.array_wrap_func-1897"><span class="linenos">1897</span></a>        <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">numpy_array</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="HyperbolicRepresentation.normalize" class="classattr">
                                        <input id="HyperbolicRepresentation.normalize-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">normalize</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">matrix</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicRepresentation.normalize-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation.normalize"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation.normalize-1899"><a href="#HyperbolicRepresentation.normalize-1899"><span class="linenos">1899</span></a>    <span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation.normalize-1900"><a href="#HyperbolicRepresentation.normalize-1900"><span class="linenos">1900</span></a>        <span class="n">dimension</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="HyperbolicRepresentation.normalize-1901"><a href="#HyperbolicRepresentation.normalize-1901"><span class="linenos">1901</span></a>        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">indefinite_orthogonalize</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dimension</span><span class="p">),</span> <span class="n">matrix</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="HyperbolicRepresentation.isometries" class="classattr">
                                        <input id="HyperbolicRepresentation.isometries-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">isometries</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">words</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicRepresentation.isometries-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation.isometries"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation.isometries-1903"><a href="#HyperbolicRepresentation.isometries-1903"><span class="linenos">1903</span></a>    <span class="k">def</span> <span class="nf">isometries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation.isometries-1904"><a href="#HyperbolicRepresentation.isometries-1904"><span class="linenos">1904</span></a>        <span class="sd">&quot;&quot;&quot;Get an Isometry object holding the matrices which are the images of</span>
</span><span id="HyperbolicRepresentation.isometries-1905"><a href="#HyperbolicRepresentation.isometries-1905"><span class="linenos">1905</span></a><span class="sd">        a sequence of words in the generators.</span>
</span><span id="HyperbolicRepresentation.isometries-1906"><a href="#HyperbolicRepresentation.isometries-1906"><span class="linenos">1906</span></a>
</span><span id="HyperbolicRepresentation.isometries-1907"><a href="#HyperbolicRepresentation.isometries-1907"><span class="linenos">1907</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="HyperbolicRepresentation.isometries-1908"><a href="#HyperbolicRepresentation.isometries-1908"><span class="linenos">1908</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get an Isometry object holding the matrices which are the images of
a sequence of words in the generators.</p>
</div>


                            </div>
                            <div id="HyperbolicRepresentation.compose" class="classattr">
                                        <input id="HyperbolicRepresentation.compose-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">compose</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">hom</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicRepresentation.compose-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation.compose"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation.compose-1910"><a href="#HyperbolicRepresentation.compose-1910"><span class="linenos">1910</span></a>    <span class="k">def</span> <span class="nf">compose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation.compose-1911"><a href="#HyperbolicRepresentation.compose-1911"><span class="linenos">1911</span></a>        <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">hom</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div id="HyperbolicRepresentation.gln_adjoint" class="classattr">
                                        <input id="HyperbolicRepresentation.gln_adjoint-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">gln_adjoint</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="HyperbolicRepresentation.gln_adjoint-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#HyperbolicRepresentation.gln_adjoint"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="HyperbolicRepresentation.gln_adjoint-1914"><a href="#HyperbolicRepresentation.gln_adjoint-1914"><span class="linenos">1914</span></a>    <span class="k">def</span> <span class="nf">gln_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="HyperbolicRepresentation.gln_adjoint-1915"><a href="#HyperbolicRepresentation.gln_adjoint-1915"><span class="linenos">1915</span></a>        <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="p">(</span>
</span><span id="HyperbolicRepresentation.gln_adjoint-1916"><a href="#HyperbolicRepresentation.gln_adjoint-1916"><span class="linenos">1916</span></a>            <span class="n">projective</span><span class="o">.</span><span class="n">ProjectiveRepresentation</span><span class="o">.</span><span class="n">gln_adjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="HyperbolicRepresentation.gln_adjoint-1917"><a href="#HyperbolicRepresentation.gln_adjoint-1917"><span class="linenos">1917</span></a>        <span class="p">)</span>
</span></pre></div>


    

                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="representation.html#Representation">geometry_tools.representation.Representation</a></dt>
                                <dd id="HyperbolicRepresentation.__init__" class="function"><a href="representation.html#Representation.__init__">Representation</a></dd>
                <dd id="HyperbolicRepresentation.dim" class="variable"><a href="representation.html#Representation.dim">dim</a></dd>
                <dd id="HyperbolicRepresentation.dtype" class="variable"><a href="representation.html#Representation.dtype">dtype</a></dd>
                <dd id="HyperbolicRepresentation.base_ring" class="variable"><a href="representation.html#Representation.base_ring">base_ring</a></dd>
                <dd id="HyperbolicRepresentation.parse_word" class="function"><a href="representation.html#Representation.parse_word">parse_word</a></dd>
                <dd id="HyperbolicRepresentation.element" class="function"><a href="representation.html#Representation.element">element</a></dd>
                <dd id="HyperbolicRepresentation.parse_simple" class="variable"><a href="representation.html#Representation.parse_simple">parse_simple</a></dd>
                <dd id="HyperbolicRepresentation.relations" class="variable"><a href="representation.html#Representation.relations">relations</a></dd>
                <dd id="HyperbolicRepresentation.freely_reduced_elements" class="function"><a href="representation.html#Representation.freely_reduced_elements">freely_reduced_elements</a></dd>
                <dd id="HyperbolicRepresentation.free_words_of_length" class="function"><a href="representation.html#Representation.free_words_of_length">free_words_of_length</a></dd>
                <dd id="HyperbolicRepresentation.free_words_less_than" class="function"><a href="representation.html#Representation.free_words_less_than">free_words_less_than</a></dd>
                <dd id="HyperbolicRepresentation.automaton_accepted" class="function"><a href="representation.html#Representation.automaton_accepted">automaton_accepted</a></dd>
                <dd id="HyperbolicRepresentation.elements" class="function"><a href="representation.html#Representation.elements">elements</a></dd>
                <dd id="HyperbolicRepresentation.asym_gens" class="function"><a href="representation.html#Representation.asym_gens">asym_gens</a></dd>
                <dd id="HyperbolicRepresentation.dual" class="function"><a href="representation.html#Representation.dual">dual</a></dd>
                <dd id="HyperbolicRepresentation.set_generator" class="function"><a href="representation.html#Representation.set_generator">set_generator</a></dd>
                <dd id="HyperbolicRepresentation.change_base_ring" class="function"><a href="representation.html#Representation.change_base_ring">change_base_ring</a></dd>
                <dd id="HyperbolicRepresentation.astype" class="function"><a href="representation.html#Representation.astype">astype</a></dd>
                <dd id="HyperbolicRepresentation.conjugate" class="function"><a href="representation.html#Representation.conjugate">conjugate</a></dd>
                <dd id="HyperbolicRepresentation.subgroup" class="function"><a href="representation.html#Representation.subgroup">subgroup</a></dd>
                <dd id="HyperbolicRepresentation.differential" class="function"><a href="representation.html#Representation.differential">differential</a></dd>
                <dd id="HyperbolicRepresentation.differentials" class="function"><a href="representation.html#Representation.differentials">differentials</a></dd>
                <dd id="HyperbolicRepresentation.cocycle_matrix" class="function"><a href="representation.html#Representation.cocycle_matrix">cocycle_matrix</a></dd>
                <dd id="HyperbolicRepresentation.coboundary_matrix" class="function"><a href="representation.html#Representation.coboundary_matrix">coboundary_matrix</a></dd>
                <dd id="HyperbolicRepresentation.sln_adjoint" class="function"><a href="representation.html#Representation.sln_adjoint">sln_adjoint</a></dd>
                <dd id="HyperbolicRepresentation.tensor_product" class="function"><a href="representation.html#Representation.tensor_product">tensor_product</a></dd>
                <dd id="HyperbolicRepresentation.symmetric_square" class="function"><a href="representation.html#Representation.symmetric_square">symmetric_square</a></dd>

            </div>
            <div><dt><a href="projective.html#ProjectiveRepresentation">geometry_tools.projective.ProjectiveRepresentation</a></dt>
                                <dd id="HyperbolicRepresentation.unwrap_func" class="function"><a href="projective.html#ProjectiveRepresentation.unwrap_func">unwrap_func</a></dd>
                <dd id="HyperbolicRepresentation.transformations" class="function"><a href="projective.html#ProjectiveRepresentation.transformations">transformations</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="minkowski">
                            <input id="minkowski-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">minkowski</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span>, </span><span class="param"><span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="minkowski-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#minkowski"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="minkowski-1921"><a href="#minkowski-1921"><span class="linenos">1921</span></a><span class="k">def</span> <span class="nf">minkowski</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="minkowski-1922"><a href="#minkowski-1922"><span class="linenos">1922</span></a>    <span class="n">form</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">base_ring</span><span class="p">)</span>
</span><span id="minkowski-1923"><a href="#minkowski-1923"><span class="linenos">1923</span></a>    <span class="n">form</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">form</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="minkowski-1924"><a href="#minkowski-1924"><span class="linenos">1924</span></a>    <span class="k">return</span> <span class="n">form</span>
</span></pre></div>


    

                </section>
                <section id="kleinian_coords">
                            <input id="kleinian_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">kleinian_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="kleinian_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#kleinian_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="kleinian_coords-1926"><a href="#kleinian_coords-1926"><span class="linenos">1926</span></a><span class="k">def</span> <span class="nf">kleinian_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="kleinian_coords-1927"><a href="#kleinian_coords-1927"><span class="linenos">1927</span></a>    <span class="sd">&quot;&quot;&quot;Get kleinian coordinates for an ndarray of points.</span>
</span><span id="kleinian_coords-1928"><a href="#kleinian_coords-1928"><span class="linenos">1928</span></a>
</span><span id="kleinian_coords-1929"><a href="#kleinian_coords-1929"><span class="linenos">1929</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="kleinian_coords-1930"><a href="#kleinian_coords-1930"><span class="linenos">1930</span></a>    <span class="k">return</span> <span class="n">projective</span><span class="o">.</span><span class="n">affine_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">chart_index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
</span><span id="kleinian_coords-1931"><a href="#kleinian_coords-1931"><span class="linenos">1931</span></a>                                    <span class="n">column_vectors</span><span class="o">=</span><span class="n">column_vectors</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get kleinian coordinates for an ndarray of points.</p>
</div>


                </section>
                <section id="get_point">
                            <input id="get_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">coords</span>, </span><span class="param"><span class="n">model</span><span class="o">=</span><span class="s1">&#39;klein&#39;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_point-1933"><a href="#get_point-1933"><span class="linenos">1933</span></a><span class="k">def</span> <span class="nf">get_point</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;klein&quot;</span><span class="p">):</span>
</span><span id="get_point-1934"><a href="#get_point-1934"><span class="linenos">1934</span></a>    <span class="k">return</span> <span class="n">Point</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="get_boundary_point">
                            <input id="get_boundary_point-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_boundary_point</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">angle</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="get_boundary_point-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_boundary_point"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_boundary_point-1936"><a href="#get_boundary_point-1936"><span class="linenos">1936</span></a><span class="k">def</span> <span class="nf">get_boundary_point</span><span class="p">(</span><span class="n">angle</span><span class="p">):</span>
</span><span id="get_boundary_point-1937"><a href="#get_boundary_point-1937"><span class="linenos">1937</span></a>    <span class="k">return</span> <span class="n">IdealPoint</span><span class="o">.</span><span class="n">from_angle</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
</span></pre></div>


    

                </section>
                <section id="hyperboloid_coords">
                            <input id="hyperboloid_coords-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hyperboloid_coords</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span>, </span><span class="param"><span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hyperboloid_coords-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hyperboloid_coords"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hyperboloid_coords-1939"><a href="#hyperboloid_coords-1939"><span class="linenos">1939</span></a><span class="k">def</span> <span class="nf">hyperboloid_coords</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="hyperboloid_coords-1940"><a href="#hyperboloid_coords-1940"><span class="linenos">1940</span></a>    <span class="sd">&quot;&quot;&quot;Project an ndarray of points to the unit hyperboloid defined by the</span>
</span><span id="hyperboloid_coords-1941"><a href="#hyperboloid_coords-1941"><span class="linenos">1941</span></a><span class="sd">    Minkowski quadratic form.&quot;&quot;&quot;</span>
</span><span id="hyperboloid_coords-1942"><a href="#hyperboloid_coords-1942"><span class="linenos">1942</span></a>
</span><span id="hyperboloid_coords-1943"><a href="#hyperboloid_coords-1943"><span class="linenos">1943</span></a>    <span class="n">proj_coords</span> <span class="o">=</span> <span class="n">points</span>
</span><span id="hyperboloid_coords-1944"><a href="#hyperboloid_coords-1944"><span class="linenos">1944</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="hyperboloid_coords-1945"><a href="#hyperboloid_coords-1945"><span class="linenos">1945</span></a>        <span class="n">proj_coords</span> <span class="o">=</span> <span class="n">coords</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="hyperboloid_coords-1946"><a href="#hyperboloid_coords-1946"><span class="linenos">1946</span></a>
</span><span id="hyperboloid_coords-1947"><a href="#hyperboloid_coords-1947"><span class="linenos">1947</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">proj_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="hyperboloid_coords-1948"><a href="#hyperboloid_coords-1948"><span class="linenos">1948</span></a>    <span class="n">hyperbolized</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">proj_coords</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
</span><span id="hyperboloid_coords-1949"><a href="#hyperboloid_coords-1949"><span class="linenos">1949</span></a>
</span><span id="hyperboloid_coords-1950"><a href="#hyperboloid_coords-1950"><span class="linenos">1950</span></a>    <span class="k">if</span> <span class="n">column_vectors</span><span class="p">:</span>
</span><span id="hyperboloid_coords-1951"><a href="#hyperboloid_coords-1951"><span class="linenos">1951</span></a>        <span class="n">hyperbolized</span> <span class="o">=</span> <span class="n">hyperbolized</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="hyperboloid_coords-1952"><a href="#hyperboloid_coords-1952"><span class="linenos">1952</span></a>
</span><span id="hyperboloid_coords-1953"><a href="#hyperboloid_coords-1953"><span class="linenos">1953</span></a>    <span class="k">return</span> <span class="n">hyperbolized</span>
</span></pre></div>


            <div class="docstring"><p>Project an ndarray of points to the unit hyperboloid defined by the
Minkowski quadratic form.</p>
</div>


                </section>
                <section id="spacelike">
                            <input id="spacelike-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">spacelike</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vectors</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacelike-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacelike"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacelike-1955"><a href="#spacelike-1955"><span class="linenos">1955</span></a><span class="k">def</span> <span class="nf">spacelike</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
</span><span id="spacelike-1956"><a href="#spacelike-1956"><span class="linenos">1956</span></a>    <span class="sd">&quot;&quot;&quot;Determine if a vector in R^(n,1) is spacelike.</span>
</span><span id="spacelike-1957"><a href="#spacelike-1957"><span class="linenos">1957</span></a>
</span><span id="spacelike-1958"><a href="#spacelike-1958"><span class="linenos">1958</span></a><span class="sd">    Parameters</span>
</span><span id="spacelike-1959"><a href="#spacelike-1959"><span class="linenos">1959</span></a><span class="sd">    ----------</span>
</span><span id="spacelike-1960"><a href="#spacelike-1960"><span class="linenos">1960</span></a><span class="sd">    vectors : ndarray</span>
</span><span id="spacelike-1961"><a href="#spacelike-1961"><span class="linenos">1961</span></a><span class="sd">        Vectors to test for spacelike norms. The last index of the</span>
</span><span id="spacelike-1962"><a href="#spacelike-1962"><span class="linenos">1962</span></a><span class="sd">        array is the dimension of the vector space.</span>
</span><span id="spacelike-1963"><a href="#spacelike-1963"><span class="linenos">1963</span></a>
</span><span id="spacelike-1964"><a href="#spacelike-1964"><span class="linenos">1964</span></a><span class="sd">    Returns</span>
</span><span id="spacelike-1965"><a href="#spacelike-1965"><span class="linenos">1965</span></a><span class="sd">    -------</span>
</span><span id="spacelike-1966"><a href="#spacelike-1966"><span class="linenos">1966</span></a><span class="sd">    ndarray(bool)</span>
</span><span id="spacelike-1967"><a href="#spacelike-1967"><span class="linenos">1967</span></a><span class="sd">        `True` for vectors which have Minkowski norm above a fixed</span>
</span><span id="spacelike-1968"><a href="#spacelike-1968"><span class="linenos">1968</span></a><span class="sd">        error threshold.</span>
</span><span id="spacelike-1969"><a href="#spacelike-1969"><span class="linenos">1969</span></a>
</span><span id="spacelike-1970"><a href="#spacelike-1970"><span class="linenos">1970</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="spacelike-1971"><a href="#spacelike-1971"><span class="linenos">1971</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="spacelike-1972"><a href="#spacelike-1972"><span class="linenos">1972</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Determine if a vector in R^(n,1) is spacelike.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>vectors</strong> (ndarray):
Vectors to test for spacelike norms. The last index of the
array is the dimension of the vector space.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray(bool)</strong>: <code>True</code> for vectors which have Minkowski norm above a fixed
error threshold.</li>
</ul>
</div>


                </section>
                <section id="timelike">
                            <input id="timelike-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">timelike</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vectors</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="timelike-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#timelike"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="timelike-1974"><a href="#timelike-1974"><span class="linenos">1974</span></a><span class="k">def</span> <span class="nf">timelike</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
</span><span id="timelike-1975"><a href="#timelike-1975"><span class="linenos">1975</span></a>    <span class="sd">&quot;&quot;&quot;Determine if a vector in R^(n,1) is timelike.</span>
</span><span id="timelike-1976"><a href="#timelike-1976"><span class="linenos">1976</span></a>
</span><span id="timelike-1977"><a href="#timelike-1977"><span class="linenos">1977</span></a><span class="sd">    Parameters</span>
</span><span id="timelike-1978"><a href="#timelike-1978"><span class="linenos">1978</span></a><span class="sd">    ----------</span>
</span><span id="timelike-1979"><a href="#timelike-1979"><span class="linenos">1979</span></a><span class="sd">    vectors : ndarray</span>
</span><span id="timelike-1980"><a href="#timelike-1980"><span class="linenos">1980</span></a><span class="sd">        Vectors to test for timelike norms. The last index of the</span>
</span><span id="timelike-1981"><a href="#timelike-1981"><span class="linenos">1981</span></a><span class="sd">        array is the dimension of the vector space.</span>
</span><span id="timelike-1982"><a href="#timelike-1982"><span class="linenos">1982</span></a>
</span><span id="timelike-1983"><a href="#timelike-1983"><span class="linenos">1983</span></a><span class="sd">    Returns</span>
</span><span id="timelike-1984"><a href="#timelike-1984"><span class="linenos">1984</span></a><span class="sd">    -------</span>
</span><span id="timelike-1985"><a href="#timelike-1985"><span class="linenos">1985</span></a><span class="sd">    ndarray(bool)</span>
</span><span id="timelike-1986"><a href="#timelike-1986"><span class="linenos">1986</span></a><span class="sd">        `True` for vectors which have Minkowski norm below a fixed</span>
</span><span id="timelike-1987"><a href="#timelike-1987"><span class="linenos">1987</span></a><span class="sd">        error threshold.</span>
</span><span id="timelike-1988"><a href="#timelike-1988"><span class="linenos">1988</span></a>
</span><span id="timelike-1989"><a href="#timelike-1989"><span class="linenos">1989</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="timelike-1990"><a href="#timelike-1990"><span class="linenos">1990</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="timelike-1991"><a href="#timelike-1991"><span class="linenos">1991</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Determine if a vector in R^(n,1) is timelike.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>vectors</strong> (ndarray):
Vectors to test for timelike norms. The last index of the
array is the dimension of the vector space.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray(bool)</strong>: <code>True</code> for vectors which have Minkowski norm below a fixed
error threshold.</li>
</ul>
</div>


                </section>
                <section id="lightlike">
                            <input id="lightlike-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">lightlike</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vectors</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="lightlike-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#lightlike"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="lightlike-1993"><a href="#lightlike-1993"><span class="linenos">1993</span></a><span class="k">def</span> <span class="nf">lightlike</span><span class="p">(</span><span class="n">vectors</span><span class="p">):</span>
</span><span id="lightlike-1994"><a href="#lightlike-1994"><span class="linenos">1994</span></a>    <span class="sd">&quot;&quot;&quot;Determine if a vector in R^(n,1) is lightlike.</span>
</span><span id="lightlike-1995"><a href="#lightlike-1995"><span class="linenos">1995</span></a>
</span><span id="lightlike-1996"><a href="#lightlike-1996"><span class="linenos">1996</span></a><span class="sd">    Parameters</span>
</span><span id="lightlike-1997"><a href="#lightlike-1997"><span class="linenos">1997</span></a><span class="sd">    ----------</span>
</span><span id="lightlike-1998"><a href="#lightlike-1998"><span class="linenos">1998</span></a><span class="sd">    vectors : ndarray</span>
</span><span id="lightlike-1999"><a href="#lightlike-1999"><span class="linenos">1999</span></a><span class="sd">        Vectors to test for lightlike norms. The last index of the</span>
</span><span id="lightlike-2000"><a href="#lightlike-2000"><span class="linenos">2000</span></a><span class="sd">        array is the dimension of the vector space.</span>
</span><span id="lightlike-2001"><a href="#lightlike-2001"><span class="linenos">2001</span></a>
</span><span id="lightlike-2002"><a href="#lightlike-2002"><span class="linenos">2002</span></a><span class="sd">    Returns</span>
</span><span id="lightlike-2003"><a href="#lightlike-2003"><span class="linenos">2003</span></a><span class="sd">    -------</span>
</span><span id="lightlike-2004"><a href="#lightlike-2004"><span class="linenos">2004</span></a><span class="sd">    ndarray(bool)</span>
</span><span id="lightlike-2005"><a href="#lightlike-2005"><span class="linenos">2005</span></a><span class="sd">        `True` for vectors where the absolute value of the Minkowski</span>
</span><span id="lightlike-2006"><a href="#lightlike-2006"><span class="linenos">2006</span></a><span class="sd">        norm is below a fixed error threshold.</span>
</span><span id="lightlike-2007"><a href="#lightlike-2007"><span class="linenos">2007</span></a>
</span><span id="lightlike-2008"><a href="#lightlike-2008"><span class="linenos">2008</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="lightlike-2009"><a href="#lightlike-2009"><span class="linenos">2009</span></a>
</span><span id="lightlike-2010"><a href="#lightlike-2010"><span class="linenos">2010</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vectors</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="lightlike-2011"><a href="#lightlike-2011"><span class="linenos">2011</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">vectors</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">)))</span> <span class="o">&lt;</span> <span class="n">ERROR_THRESHOLD</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Determine if a vector in R^(n,1) is lightlike.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>vectors</strong> (ndarray):
Vectors to test for lightlike norms. The last index of the
array is the dimension of the vector space.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>ndarray(bool)</strong>: <code>True</code> for vectors where the absolute value of the Minkowski
norm is below a fixed error threshold.</li>
</ul>
</div>


                </section>
                <section id="kleinian_to_poincare">
                            <input id="kleinian_to_poincare-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">kleinian_to_poincare</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="kleinian_to_poincare-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#kleinian_to_poincare"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="kleinian_to_poincare-2014"><a href="#kleinian_to_poincare-2014"><span class="linenos">2014</span></a><span class="k">def</span> <span class="nf">kleinian_to_poincare</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="kleinian_to_poincare-2015"><a href="#kleinian_to_poincare-2015"><span class="linenos">2015</span></a>    <span class="n">euc_norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>
</span><span id="kleinian_to_poincare-2016"><a href="#kleinian_to_poincare-2016"><span class="linenos">2016</span></a>
</span><span id="kleinian_to_poincare-2017"><a href="#kleinian_to_poincare-2017"><span class="linenos">2017</span></a>    <span class="c1">#we take absolute value to combat roundoff error</span>
</span><span id="kleinian_to_poincare-2018"><a href="#kleinian_to_poincare-2018"><span class="linenos">2018</span></a>    <span class="n">mult_factor</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">euc_norms</span><span class="p">)))</span>
</span><span id="kleinian_to_poincare-2019"><a href="#kleinian_to_poincare-2019"><span class="linenos">2019</span></a>
</span><span id="kleinian_to_poincare-2020"><a href="#kleinian_to_poincare-2020"><span class="linenos">2020</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">mult_factor</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span></pre></div>


    

                </section>
                <section id="poincare_to_kleinian">
                            <input id="poincare_to_kleinian-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">poincare_to_kleinian</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="poincare_to_kleinian-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#poincare_to_kleinian"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="poincare_to_kleinian-2022"><a href="#poincare_to_kleinian-2022"><span class="linenos">2022</span></a><span class="k">def</span> <span class="nf">poincare_to_kleinian</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="poincare_to_kleinian-2023"><a href="#poincare_to_kleinian-2023"><span class="linenos">2023</span></a>    <span class="n">euc_norms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">points</span><span class="p">))</span>
</span><span id="poincare_to_kleinian-2024"><a href="#poincare_to_kleinian-2024"><span class="linenos">2024</span></a>    <span class="n">mult_factor</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">euc_norms</span><span class="p">)</span>
</span><span id="poincare_to_kleinian-2025"><a href="#poincare_to_kleinian-2025"><span class="linenos">2025</span></a>
</span><span id="poincare_to_kleinian-2026"><a href="#poincare_to_kleinian-2026"><span class="linenos">2026</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">points</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">mult_factor</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</span></pre></div>


    

                </section>
                <section id="poincare_to_halfspace">
                            <input id="poincare_to_halfspace-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">poincare_to_halfspace</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="poincare_to_halfspace-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#poincare_to_halfspace"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="poincare_to_halfspace-2028"><a href="#poincare_to_halfspace-2028"><span class="linenos">2028</span></a><span class="k">def</span> <span class="nf">poincare_to_halfspace</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="poincare_to_halfspace-2029"><a href="#poincare_to_halfspace-2029"><span class="linenos">2029</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="poincare_to_halfspace-2030"><a href="#poincare_to_halfspace-2030"><span class="linenos">2030</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
</span><span id="poincare_to_halfspace-2031"><a href="#poincare_to_halfspace-2031"><span class="linenos">2031</span></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="poincare_to_halfspace-2032"><a href="#poincare_to_halfspace-2032"><span class="linenos">2032</span></a>
</span><span id="poincare_to_halfspace-2033"><a href="#poincare_to_halfspace-2033"><span class="linenos">2033</span></a>    <span class="n">halfspace_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="poincare_to_halfspace-2034"><a href="#poincare_to_halfspace-2034"><span class="linenos">2034</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="poincare_to_halfspace-2035"><a href="#poincare_to_halfspace-2035"><span class="linenos">2035</span></a>
</span><span id="poincare_to_halfspace-2036"><a href="#poincare_to_halfspace-2036"><span class="linenos">2036</span></a>    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
</span><span id="poincare_to_halfspace-2037"><a href="#poincare_to_halfspace-2037"><span class="linenos">2037</span></a>        <span class="n">halfspace_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="poincare_to_halfspace-2038"><a href="#poincare_to_halfspace-2038"><span class="linenos">2038</span></a>        <span class="n">halfspace_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="poincare_to_halfspace-2039"><a href="#poincare_to_halfspace-2039"><span class="linenos">2039</span></a>
</span><span id="poincare_to_halfspace-2040"><a href="#poincare_to_halfspace-2040"><span class="linenos">2040</span></a>    <span class="k">return</span> <span class="n">halfspace_coords</span>
</span></pre></div>


    

                </section>
                <section id="halfspace_to_poincare">
                            <input id="halfspace_to_poincare-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">halfspace_to_poincare</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">points</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="halfspace_to_poincare-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#halfspace_to_poincare"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="halfspace_to_poincare-2042"><a href="#halfspace_to_poincare-2042"><span class="linenos">2042</span></a><span class="k">def</span> <span class="nf">halfspace_to_poincare</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
</span><span id="halfspace_to_poincare-2043"><a href="#halfspace_to_poincare-2043"><span class="linenos">2043</span></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="halfspace_to_poincare-2044"><a href="#halfspace_to_poincare-2044"><span class="linenos">2044</span></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="halfspace_to_poincare-2045"><a href="#halfspace_to_poincare-2045"><span class="linenos">2045</span></a>    <span class="n">x2</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</span><span id="halfspace_to_poincare-2046"><a href="#halfspace_to_poincare-2046"><span class="linenos">2046</span></a>
</span><span id="halfspace_to_poincare-2047"><a href="#halfspace_to_poincare-2047"><span class="linenos">2047</span></a>    <span class="n">poincare_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
</span><span id="halfspace_to_poincare-2048"><a href="#halfspace_to_poincare-2048"><span class="linenos">2048</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span><span id="halfspace_to_poincare-2049"><a href="#halfspace_to_poincare-2049"><span class="linenos">2049</span></a>    <span class="n">poincare_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">v</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
</span><span id="halfspace_to_poincare-2050"><a href="#halfspace_to_poincare-2050"><span class="linenos">2050</span></a>    <span class="n">poincare_coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span>
</span><span id="halfspace_to_poincare-2051"><a href="#halfspace_to_poincare-2051"><span class="linenos">2051</span></a>
</span><span id="halfspace_to_poincare-2052"><a href="#halfspace_to_poincare-2052"><span class="linenos">2052</span></a>    <span class="k">return</span> <span class="n">poincare_coords</span>
</span></pre></div>


    

                </section>
                <section id="timelike_to">
                            <input id="timelike_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">timelike_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">v</span>, </span><span class="param"><span class="n">force_oriented</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="timelike_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#timelike_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="timelike_to-2054"><a href="#timelike_to-2054"><span class="linenos">2054</span></a><span class="k">def</span> <span class="nf">timelike_to</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="timelike_to-2055"><a href="#timelike_to-2055"><span class="linenos">2055</span></a>    <span class="sd">&quot;&quot;&quot;Find an isometry taking the origin of the Poincare/Klein models to</span>
</span><span id="timelike_to-2056"><a href="#timelike_to-2056"><span class="linenos">2056</span></a><span class="sd">    the given vector v.</span>
</span><span id="timelike_to-2057"><a href="#timelike_to-2057"><span class="linenos">2057</span></a>
</span><span id="timelike_to-2058"><a href="#timelike_to-2058"><span class="linenos">2058</span></a><span class="sd">    We expect v to be timelike in order for this to make sense.</span>
</span><span id="timelike_to-2059"><a href="#timelike_to-2059"><span class="linenos">2059</span></a>
</span><span id="timelike_to-2060"><a href="#timelike_to-2060"><span class="linenos">2060</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="timelike_to-2061"><a href="#timelike_to-2061"><span class="linenos">2061</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">timelike</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="timelike_to-2062"><a href="#timelike_to-2062"><span class="linenos">2062</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;Cannot find isometry taking a&quot;</span>
</span><span id="timelike_to-2063"><a href="#timelike_to-2063"><span class="linenos">2063</span></a>        <span class="s2">&quot; timelike vector to a non-timelike vector.&quot;</span>  <span class="p">)</span>
</span><span id="timelike_to-2064"><a href="#timelike_to-2064"><span class="linenos">2064</span></a>
</span><span id="timelike_to-2065"><a href="#timelike_to-2065"><span class="linenos">2065</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="timelike_to-2066"><a href="#timelike_to-2066"><span class="linenos">2066</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span>
</span><span id="timelike_to-2067"><a href="#timelike_to-2067"><span class="linenos">2067</span></a>                                        <span class="n">v</span><span class="p">,</span> <span class="n">force_oriented</span><span class="p">),</span>
</span><span id="timelike_to-2068"><a href="#timelike_to-2068"><span class="linenos">2068</span></a>                    <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find an isometry taking the origin of the Poincare/Klein models to
the given vector v.</p>

<p>We expect v to be timelike in order for this to make sense.</p>
</div>


                </section>
                <section id="sl2_iso">
                            <input id="sl2_iso-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">sl2_iso</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">matrix</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="sl2_iso-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#sl2_iso"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="sl2_iso-2070"><a href="#sl2_iso-2070"><span class="linenos">2070</span></a><span class="k">def</span> <span class="nf">sl2_iso</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="sl2_iso-2071"><a href="#sl2_iso-2071"><span class="linenos">2071</span></a>    <span class="sd">&quot;&quot;&quot;Convert 2x2 matrices to isometries.</span>
</span><span id="sl2_iso-2072"><a href="#sl2_iso-2072"><span class="linenos">2072</span></a>
</span><span id="sl2_iso-2073"><a href="#sl2_iso-2073"><span class="linenos">2073</span></a><span class="sd">    matrix is an array of shape (..., 2, 2), and interpreted as an</span>
</span><span id="sl2_iso-2074"><a href="#sl2_iso-2074"><span class="linenos">2074</span></a><span class="sd">    array of elements of SL^+-(2, R).</span>
</span><span id="sl2_iso-2075"><a href="#sl2_iso-2075"><span class="linenos">2075</span></a>
</span><span id="sl2_iso-2076"><a href="#sl2_iso-2076"><span class="linenos">2076</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="sl2_iso-2077"><a href="#sl2_iso-2077"><span class="linenos">2077</span></a>
</span><span id="sl2_iso-2078"><a href="#sl2_iso-2078"><span class="linenos">2078</span></a>    <span class="n">m_array</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">array_like</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="sl2_iso-2079"><a href="#sl2_iso-2079"><span class="linenos">2079</span></a>
</span><span id="sl2_iso-2080"><a href="#sl2_iso-2080"><span class="linenos">2080</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">lie</span><span class="o">.</span><span class="n">sl2_to_so21</span><span class="p">(</span><span class="n">m_array</span><span class="p">),</span>
</span><span id="sl2_iso-2081"><a href="#sl2_iso-2081"><span class="linenos">2081</span></a>                    <span class="n">column_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Convert 2x2 matrices to isometries.</p>

<p>matrix is an array of shape (..., 2, 2), and interpreted as an
array of elements of SL^+-(2, R).</p>
</div>


                </section>
                <section id="project_to_hyperboloid">
                            <input id="project_to_hyperboloid-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">project_to_hyperboloid</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">basepoint</span>, </span><span class="param"><span class="n">tangent_vector</span>, </span><span class="param"><span class="n">form</span><span class="o">=</span><span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="project_to_hyperboloid-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#project_to_hyperboloid"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="project_to_hyperboloid-2083"><a href="#project_to_hyperboloid-2083"><span class="linenos">2083</span></a><span class="k">def</span> <span class="nf">project_to_hyperboloid</span><span class="p">(</span><span class="n">basepoint</span><span class="p">,</span> <span class="n">tangent_vector</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="project_to_hyperboloid-2084"><a href="#project_to_hyperboloid-2084"><span class="linenos">2084</span></a>    <span class="sd">&quot;&quot;&quot;Project a vector in R^(n,1) to lie in the tangent space to the unit</span>
</span><span id="project_to_hyperboloid-2085"><a href="#project_to_hyperboloid-2085"><span class="linenos">2085</span></a><span class="sd">    hyperboloid at a given basepoint.</span>
</span><span id="project_to_hyperboloid-2086"><a href="#project_to_hyperboloid-2086"><span class="linenos">2086</span></a>
</span><span id="project_to_hyperboloid-2087"><a href="#project_to_hyperboloid-2087"><span class="linenos">2087</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="project_to_hyperboloid-2088"><a href="#project_to_hyperboloid-2088"><span class="linenos">2088</span></a>    <span class="k">if</span> <span class="n">form</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="project_to_hyperboloid-2089"><a href="#project_to_hyperboloid-2089"><span class="linenos">2089</span></a>        <span class="n">form</span> <span class="o">=</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">basepoint</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="project_to_hyperboloid-2090"><a href="#project_to_hyperboloid-2090"><span class="linenos">2090</span></a>
</span><span id="project_to_hyperboloid-2091"><a href="#project_to_hyperboloid-2091"><span class="linenos">2091</span></a>    <span class="k">return</span> <span class="n">tangent_vector</span> <span class="o">-</span> <span class="n">utils</span><span class="o">.</span><span class="n">projection</span><span class="p">(</span>
</span><span id="project_to_hyperboloid-2092"><a href="#project_to_hyperboloid-2092"><span class="linenos">2092</span></a>        <span class="n">tangent_vector</span><span class="p">,</span> <span class="n">basepoint</span><span class="p">,</span> <span class="n">form</span>
</span><span id="project_to_hyperboloid-2093"><a href="#project_to_hyperboloid-2093"><span class="linenos">2093</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Project a vector in R^(n,1) to lie in the tangent space to the unit
hyperboloid at a given basepoint.</p>
</div>


                </section>
                <section id="hyp_to_affine_dist">
                            <input id="hyp_to_affine_dist-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">hyp_to_affine_dist</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">r</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="hyp_to_affine_dist-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#hyp_to_affine_dist"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="hyp_to_affine_dist-2095"><a href="#hyp_to_affine_dist-2095"><span class="linenos">2095</span></a><span class="k">def</span> <span class="nf">hyp_to_affine_dist</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
</span><span id="hyp_to_affine_dist-2096"><a href="#hyp_to_affine_dist-2096"><span class="linenos">2096</span></a>    <span class="sd">&quot;&quot;&quot;Convert distance in hyperbolic space to distance from the origin in</span>
</span><span id="hyp_to_affine_dist-2097"><a href="#hyp_to_affine_dist-2097"><span class="linenos">2097</span></a><span class="sd">    the Klein model.</span>
</span><span id="hyp_to_affine_dist-2098"><a href="#hyp_to_affine_dist-2098"><span class="linenos">2098</span></a>
</span><span id="hyp_to_affine_dist-2099"><a href="#hyp_to_affine_dist-2099"><span class="linenos">2099</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="hyp_to_affine_dist-2100"><a href="#hyp_to_affine_dist-2100"><span class="linenos">2100</span></a>    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Convert distance in hyperbolic space to distance from the origin in
the Klein model.</p>
</div>


                </section>
                <section id="regular_polygon_radius">
                            <input id="regular_polygon_radius-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">regular_polygon_radius</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">interior_angle</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="regular_polygon_radius-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#regular_polygon_radius"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="regular_polygon_radius-2113"><a href="#regular_polygon_radius-2113"><span class="linenos">2113</span></a><span class="k">def</span> <span class="nf">regular_polygon_radius</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">interior_angle</span><span class="p">):</span>
</span><span id="regular_polygon_radius-2114"><a href="#regular_polygon_radius-2114"><span class="linenos">2114</span></a>    <span class="sd">&quot;&quot;&quot;Find r such that a regular n-gon inscribed on a circle of radius r</span>
</span><span id="regular_polygon_radius-2115"><a href="#regular_polygon_radius-2115"><span class="linenos">2115</span></a><span class="sd">    has the given interior angle.</span>
</span><span id="regular_polygon_radius-2116"><a href="#regular_polygon_radius-2116"><span class="linenos">2116</span></a>
</span><span id="regular_polygon_radius-2117"><a href="#regular_polygon_radius-2117"><span class="linenos">2117</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="regular_polygon_radius-2118"><a href="#regular_polygon_radius-2118"><span class="linenos">2118</span></a>    <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">interior_angle</span><span class="p">)</span>
</span><span id="regular_polygon_radius-2119"><a href="#regular_polygon_radius-2119"><span class="linenos">2119</span></a>
</span><span id="regular_polygon_radius-2120"><a href="#regular_polygon_radius-2120"><span class="linenos">2120</span></a>    <span class="n">alpha</span> <span class="o">=</span> <span class="n">interior_angle</span> <span class="o">/</span> <span class="mi">2</span>
</span><span id="regular_polygon_radius-2121"><a href="#regular_polygon_radius-2121"><span class="linenos">2121</span></a>    <span class="n">gamma</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="regular_polygon_radius-2122"><a href="#regular_polygon_radius-2122"><span class="linenos">2122</span></a>    <span class="n">term</span> <span class="o">=</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span>
</span><span id="regular_polygon_radius-2123"><a href="#regular_polygon_radius-2123"><span class="linenos">2123</span></a>            <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
</span><span id="regular_polygon_radius-2124"><a href="#regular_polygon_radius-2124"><span class="linenos">2124</span></a>
</span><span id="regular_polygon_radius-2125"><a href="#regular_polygon_radius-2125"><span class="linenos">2125</span></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">term</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Find r such that a regular n-gon inscribed on a circle of radius r
has the given interior angle.</p>
</div>


                </section>
                <section id="polygon_interior_angle">
                            <input id="polygon_interior_angle-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">polygon_interior_angle</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">n</span>, </span><span class="param"><span class="n">hyp_radius</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="polygon_interior_angle-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#polygon_interior_angle"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="polygon_interior_angle-2127"><a href="#polygon_interior_angle-2127"><span class="linenos">2127</span></a><span class="k">def</span> <span class="nf">polygon_interior_angle</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">hyp_radius</span><span class="p">):</span>
</span><span id="polygon_interior_angle-2128"><a href="#polygon_interior_angle-2128"><span class="linenos">2128</span></a>    <span class="sd">&quot;&quot;&quot;Get the interior angle of a regular n-gon inscribed on a circle</span>
</span><span id="polygon_interior_angle-2129"><a href="#polygon_interior_angle-2129"><span class="linenos">2129</span></a><span class="sd">    with the given hyperbolic radius.</span>
</span><span id="polygon_interior_angle-2130"><a href="#polygon_interior_angle-2130"><span class="linenos">2130</span></a>
</span><span id="polygon_interior_angle-2131"><a href="#polygon_interior_angle-2131"><span class="linenos">2131</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="polygon_interior_angle-2132"><a href="#polygon_interior_angle-2132"><span class="linenos">2132</span></a>    <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="n">like</span><span class="o">=</span><span class="n">hyp_radius</span><span class="p">)</span>
</span><span id="polygon_interior_angle-2133"><a href="#polygon_interior_angle-2133"><span class="linenos">2133</span></a>
</span><span id="polygon_interior_angle-2134"><a href="#polygon_interior_angle-2134"><span class="linenos">2134</span></a>    <span class="n">gamma</span> <span class="o">=</span> <span class="n">pi</span> <span class="o">/</span> <span class="n">n</span>
</span><span id="polygon_interior_angle-2135"><a href="#polygon_interior_angle-2135"><span class="linenos">2135</span></a>    <span class="n">denom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sinh</span><span class="p">(</span><span class="n">hyp_radius</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="polygon_interior_angle-2136"><a href="#polygon_interior_angle-2136"><span class="linenos">2136</span></a>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span> <span class="o">/</span> <span class="n">denom</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Get the interior angle of a regular n-gon inscribed on a circle
with the given hyperbolic radius.</p>
</div>


                </section>
                <section id="genus_g_surface_radius">
                            <input id="genus_g_surface_radius-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">genus_g_surface_radius</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">g</span>, </span><span class="param"><span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="genus_g_surface_radius-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#genus_g_surface_radius"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="genus_g_surface_radius-2138"><a href="#genus_g_surface_radius-2138"><span class="linenos">2138</span></a><span class="k">def</span> <span class="nf">genus_g_surface_radius</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="genus_g_surface_radius-2139"><a href="#genus_g_surface_radius-2139"><span class="linenos">2139</span></a>    <span class="sd">&quot;&quot;&quot;Find the radius of a regular polygon giving the fundamental domain</span>
</span><span id="genus_g_surface_radius-2140"><a href="#genus_g_surface_radius-2140"><span class="linenos">2140</span></a><span class="sd">    for the action of a hyperbolic surface group with genus g.</span>
</span><span id="genus_g_surface_radius-2141"><a href="#genus_g_surface_radius-2141"><span class="linenos">2141</span></a>
</span><span id="genus_g_surface_radius-2142"><a href="#genus_g_surface_radius-2142"><span class="linenos">2142</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="genus_g_surface_radius-2143"><a href="#genus_g_surface_radius-2143"><span class="linenos">2143</span></a>    <span class="n">pi</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pi</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</span><span id="genus_g_surface_radius-2144"><a href="#genus_g_surface_radius-2144"><span class="linenos">2144</span></a>
</span><span id="genus_g_surface_radius-2145"><a href="#genus_g_surface_radius-2145"><span class="linenos">2145</span></a>    <span class="k">return</span> <span class="n">regular_polygon_radius</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">g</span><span class="p">,</span> <span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="p">))</span>
</span></pre></div>


            <div class="docstring"><p>Find the radius of a regular polygon giving the fundamental domain
for the action of a hyperbolic surface group with genus g.</p>
</div>


                </section>
                <section id="spacelike_to">
                            <input id="spacelike_to-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">spacelike_to</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">v</span>, </span><span class="param"><span class="n">force_oriented</span><span class="o">=</span><span class="kc">False</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="spacelike_to-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#spacelike_to"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="spacelike_to-2147"><a href="#spacelike_to-2147"><span class="linenos">2147</span></a><span class="k">def</span> <span class="nf">spacelike_to</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">force_oriented</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
</span><span id="spacelike_to-2148"><a href="#spacelike_to-2148"><span class="linenos">2148</span></a>    <span class="sd">&quot;&quot;&quot;Find an isometry taking the second standard basis vector (0, 1, 0,</span>
</span><span id="spacelike_to-2149"><a href="#spacelike_to-2149"><span class="linenos">2149</span></a><span class="sd">    ...) to the given vector v.</span>
</span><span id="spacelike_to-2150"><a href="#spacelike_to-2150"><span class="linenos">2150</span></a>
</span><span id="spacelike_to-2151"><a href="#spacelike_to-2151"><span class="linenos">2151</span></a><span class="sd">    We expect v to be spacelike in order for this to make sense.</span>
</span><span id="spacelike_to-2152"><a href="#spacelike_to-2152"><span class="linenos">2152</span></a>
</span><span id="spacelike_to-2153"><a href="#spacelike_to-2153"><span class="linenos">2153</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="spacelike_to-2154"><a href="#spacelike_to-2154"><span class="linenos">2154</span></a>    <span class="n">dim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="spacelike_to-2155"><a href="#spacelike_to-2155"><span class="linenos">2155</span></a>
</span><span id="spacelike_to-2156"><a href="#spacelike_to-2156"><span class="linenos">2156</span></a>    <span class="n">normed</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">))</span>
</span><span id="spacelike_to-2157"><a href="#spacelike_to-2157"><span class="linenos">2157</span></a>
</span><span id="spacelike_to-2158"><a href="#spacelike_to-2158"><span class="linenos">2158</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">spacelike</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
</span><span id="spacelike_to-2159"><a href="#spacelike_to-2159"><span class="linenos">2159</span></a>        <span class="k">raise</span> <span class="n">GeometryError</span><span class="p">(</span> <span class="s2">&quot;Cannot find isometry taking a&quot;</span>
</span><span id="spacelike_to-2160"><a href="#spacelike_to-2160"><span class="linenos">2160</span></a>        <span class="s2">&quot; spacelike vector to a non-spacelike vector.&quot;</span><span class="p">)</span>
</span><span id="spacelike_to-2161"><a href="#spacelike_to-2161"><span class="linenos">2161</span></a>
</span><span id="spacelike_to-2162"><a href="#spacelike_to-2162"><span class="linenos">2162</span></a>    <span class="n">iso</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_isometry</span><span class="p">(</span><span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">),</span> <span class="n">normed</span><span class="p">)</span>
</span><span id="spacelike_to-2163"><a href="#spacelike_to-2163"><span class="linenos">2163</span></a>
</span><span id="spacelike_to-2164"><a href="#spacelike_to-2164"><span class="linenos">2164</span></a>    <span class="c1">#find the index of the timelike basis vector</span>
</span><span id="spacelike_to-2165"><a href="#spacelike_to-2165"><span class="linenos">2165</span></a>    <span class="n">lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">normsq</span><span class="p">(</span><span class="n">iso</span><span class="p">,</span> <span class="n">minkowski</span><span class="p">(</span><span class="n">dim</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</span><span id="spacelike_to-2166"><a href="#spacelike_to-2166"><span class="linenos">2166</span></a>    <span class="n">t_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">lengths</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2167"><a href="#spacelike_to-2167"><span class="linenos">2167</span></a>
</span><span id="spacelike_to-2168"><a href="#spacelike_to-2168"><span class="linenos">2168</span></a>    <span class="c1">#apply a permutation so the isometry actually preserves the</span>
</span><span id="spacelike_to-2169"><a href="#spacelike_to-2169"><span class="linenos">2169</span></a>    <span class="c1">#form. we do the permutation in two steps because it could be</span>
</span><span id="spacelike_to-2170"><a href="#spacelike_to-2170"><span class="linenos">2170</span></a>    <span class="c1">#either a 2-cycle or a 3-cycle.</span>
</span><span id="spacelike_to-2171"><a href="#spacelike_to-2171"><span class="linenos">2171</span></a>    <span class="n">p_iso</span> <span class="o">=</span> <span class="n">iso</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span><span id="spacelike_to-2172"><a href="#spacelike_to-2172"><span class="linenos">2172</span></a>
</span><span id="spacelike_to-2173"><a href="#spacelike_to-2173"><span class="linenos">2173</span></a>    <span class="c1">#first swap timelike index with zero</span>
</span><span id="spacelike_to-2174"><a href="#spacelike_to-2174"><span class="linenos">2174</span></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">),</span> <span class="n">t_index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2175"><a href="#spacelike_to-2175"><span class="linenos">2175</span></a>    <span class="n">p_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">t_index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2176"><a href="#spacelike_to-2176"><span class="linenos">2176</span></a>
</span><span id="spacelike_to-2177"><a href="#spacelike_to-2177"><span class="linenos">2177</span></a>    <span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">iso</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2178"><a href="#spacelike_to-2178"><span class="linenos">2178</span></a>    <span class="n">np</span><span class="o">.</span><span class="n">put_along_axis</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">p_indices</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2179"><a href="#spacelike_to-2179"><span class="linenos">2179</span></a>
</span><span id="spacelike_to-2180"><a href="#spacelike_to-2180"><span class="linenos">2180</span></a>    <span class="c1">#then swap timelike index with one</span>
</span><span id="spacelike_to-2181"><a href="#spacelike_to-2181"><span class="linenos">2181</span></a>    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">),</span> <span class="n">t_index</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2182"><a href="#spacelike_to-2182"><span class="linenos">2182</span></a>    <span class="n">p_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">t_index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">t_index</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2183"><a href="#spacelike_to-2183"><span class="linenos">2183</span></a>
</span><span id="spacelike_to-2184"><a href="#spacelike_to-2184"><span class="linenos">2184</span></a>    <span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">take_along_axis</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2185"><a href="#spacelike_to-2185"><span class="linenos">2185</span></a>    <span class="n">np</span><span class="o">.</span><span class="n">put_along_axis</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">p_indices</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</span><span id="spacelike_to-2186"><a href="#spacelike_to-2186"><span class="linenos">2186</span></a>
</span><span id="spacelike_to-2187"><a href="#spacelike_to-2187"><span class="linenos">2187</span></a>    <span class="k">if</span> <span class="n">force_oriented</span><span class="p">:</span>
</span><span id="spacelike_to-2188"><a href="#spacelike_to-2188"><span class="linenos">2188</span></a>        <span class="n">p_iso</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_orientation_preserving</span><span class="p">(</span><span class="n">p_iso</span><span class="p">)</span>
</span><span id="spacelike_to-2189"><a href="#spacelike_to-2189"><span class="linenos">2189</span></a>
</span><span id="spacelike_to-2190"><a href="#spacelike_to-2190"><span class="linenos">2190</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">p_iso</span><span class="p">,</span> <span class="n">column_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find an isometry taking the second standard basis vector (0, 1, 0,
...) to the given vector v.</p>

<p>We expect v to be spacelike in order for this to make sense.</p>
</div>


                </section>
                <section id="identity">
                            <input id="identity-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">identity</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">dimension</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="identity-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#identity"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="identity-2192"><a href="#identity-2192"><span class="linenos">2192</span></a><span class="k">def</span> <span class="nf">identity</span><span class="p">(</span><span class="n">dimension</span><span class="p">):</span>
</span><span id="identity-2193"><a href="#identity-2193"><span class="linenos">2193</span></a>    <span class="k">return</span> <span class="n">Isometry</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">dimension</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
</span></pre></div>


    

                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>